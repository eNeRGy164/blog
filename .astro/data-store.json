[["Map",1,2,7,8],"meta::meta",["Map",3,4,5,6],"astro-version","5.0.2","config-digest","9fd08f6cf1a9a372","posts",["Map",9,10,35,36,54,55,75,76,96,97,122,123,148,149,173,174,205,206,230,231,261,262,283,284,309,310,331,332,351,352,372,373,396,397,417,418,439,440,465,466,487,488,507,508,528,529,576,577,603,604,646,647,672,673,703,704,755,756,790,791,826,827,854,855,895,896,920,921,945,946,973,974,1004,1005,1030,1031,1059,1060,1093,1094,1121,1122,1152,1153,1185,1186,1215,1216,1250,1251,1291,1292,1329,1330,1378,1379,1409,1410,1440,1441,1481,1482,1515,1516,1545,1546,1580,1581,1622,1623,1657,1658,1677,1678,1730,1731,1774,1775,1794,1795,1831,1832,1869,1870,1897,1898,1925,1926,1951,1952,1992,1993,2021,2022,2051,2052,2079,2080,2114,2115,2150,2151,2181,2182,2210,2211,2245,2246,2277,2278,2297,2298,2317,2318],"2007-08-31-an-addition-to-the-project-server-2007-sdk",{"id":9,"data":11,"body":27,"filePath":28,"digest":29,"rendered":30},{"id":12,"title":13,"date":14,"author":15,"excerpt":16,"layout":17,"permalink":18,"image":19,"categories":20,"tags":22,"draft":26},7,"An addition to the Project Server 2007 SDK",["Date","2007-08-31T09:39:00.000Z"],"Michaël Hompus","Currently I'm working on a project which uses Microsoft Project Server 2007. However, the SDK is poorly documented.\n","../layouts/BlogPost.astro","/2007/08/31/an-addition-to-the-project-server-2007-sdk/","/wp-content/uploads/2007/08/post-7-thumbnail.png",[21],"Project Server",[23,24,25],"Project Server 2007","PWA","SDK",false,"Currently I'm working on a project which uses Microsoft Project Server 2007. However, the SDK is poorly documented. Today I was looking at the Admin web service which can be used to configure settings on the server. In this article I am not going in to detail how to do this yourself, but the details that I have discovered.\n\nI have researched the connection between PWA's \"Task Settings and Display\" page and the properties on the [`StatusingSettingsRow` class](https://learn.microsoft.com/previous-versions/office/developer/office-2007/ms419700(v=office.12)) which were not described. See the following image:\n\n![Screenshot of \"Task Settings and Display\"](/wp-content/uploads/2007/08/task-settings-and-display.png)\n\nSo, in addition to the SDK:\n\n| Name                             | Description                                                                                                                   | Enumeration                                                                                                                |\n| -------------------------------- | ----------------------------------------------------------------------------------------------------------------------------- | -------------------------------------------------------------------------------------------------------------------------- |\n| WADMIN_DEFAULT_TRACKING_METHOD   | Specify the default method for reporting progress or tasks,\u003Cbr>and whether the tracking mode should be enforced on all projects. | 1 = Hours of work done per period.\u003Cbr>2 = Percent of work complete.\u003Cbr>3 = Actual work done and work remaining.                  |\n| WADMIN_IS_TRACKING_METHOD_LOCKED | Force project managers to use the progress reporting method specified above for all projects.                                 |                                                                                                                            |\n| WADMIN_PROTECT_ACTUALS           | Restrict updates to Project Web Access.                                                                                       |                                                                                                                            |\n| WADMIN_STAT_ENABLE_DOWNLOAD      | Enable ActiveX Gantt view for all users.                                                                                      |                                                                                                                            |\n| WADMIN_STAT_LOOK_AHEAD           | Current tasks are those tasks which are not older than or further in the future more than this number of days.                |                                                                                                                            |\n| WADMIN_STAT_TIMESHEET_TIED       | Time entry by Timesheet only.\u003Cbr>Users will sync to update tasks.                                                                |                                                                                                                            |\n| WADMIN_TS_DEF_ENTRY_MODE_ENUM    | Specify how you want resources to report their hours.                                                                         | 0 = Resources should report their hours worked every day.\u003Cbr>1 = Resources should report their total hours worked for a week. |\n| WADMIN_WEEK_START_ON_ENUM        | Week starts on this day.                                                                                                      | 0 = Sunday\u003Cbr>1 = Monday \u003Cbr>2 = Tuesday\u003Cbr>3 = Wednesday\u003Cbr>4 = Thursday\u003Cbr>5 = Friday\u003Cbr>6 = Saturday                                       |","src/posts/2007-08-31-an-addition-to-the-project-server-2007-sdk.md","a055d1fead1ca016",{"html":31,"metadata":32},"\u003Cp>Currently I’m working on a project which uses Microsoft Project Server 2007. However, the \u003Cdfn>\u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/dfn> is poorly documented. Today I was looking at the Admin web service which can be used to configure settings on the server. In this article I am not going in to detail how to do this yourself, but the details that I have discovered.\u003C/p>\n\u003Cp>I have researched the connection between PWA’s “Task Settings and Display” page and the properties on the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/developer/office-2007/ms419700(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>StatusingSettingsRow\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> which were not described. See the following image:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2007/08/task-settings-and-display.webp\" type=\"image/webp\" media=\"(max-width: 605px)\">\u003Csource srcset=\"/wp-content/uploads/2007/08/task-settings-and-display-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2007/08/task-settings-and-display-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2007/08/task-settings-and-display.png\" alt=\"Screenshot of &#x22;Task Settings and Display&#x22;\" loading=\"lazy\" decoding=\"async\" width=\"605\" height=\"562\" srcset=\"/wp-content/uploads/2007/08/task-settings-and-display.png 605w, /wp-content/uploads/2007/08/task-settings-and-display-150x150.png 150w, /wp-content/uploads/2007/08/task-settings-and-display-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>So, in addition to the \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>:\u003C/p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>Name\u003C/th>\u003Cth>Description\u003C/th>\u003Cth>Enumeration\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>WADMIN_DEFAULT_TRACKING_METHOD\u003C/td>\u003Ctd>Specify the default method for reporting progress or tasks,\u003Cbr>and whether the tracking mode should be enforced on all projects.\u003C/td>\u003Ctd>1 = Hours of work done per period.\u003Cbr>2 = Percent of work complete.\u003Cbr>3 = Actual work done and work remaining.\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>WADMIN_IS_TRACKING_METHOD_LOCKED\u003C/td>\u003Ctd>Force project managers to use the progress reporting method specified above for all projects.\u003C/td>\u003Ctd>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>WADMIN_PROTECT_ACTUALS\u003C/td>\u003Ctd>Restrict updates to Project Web Access.\u003C/td>\u003Ctd>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>WADMIN_STAT_ENABLE_DOWNLOAD\u003C/td>\u003Ctd>Enable ActiveX Gantt view for all users.\u003C/td>\u003Ctd>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>WADMIN_STAT_LOOK_AHEAD\u003C/td>\u003Ctd>Current tasks are those tasks which are not older than or further in the future more than this number of days.\u003C/td>\u003Ctd>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>WADMIN_STAT_TIMESHEET_TIED\u003C/td>\u003Ctd>Time entry by Timesheet only.\u003Cbr>Users will sync to update tasks.\u003C/td>\u003Ctd>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>WADMIN_TS_DEF_ENTRY_MODE_ENUM\u003C/td>\u003Ctd>Specify how you want resources to report their hours.\u003C/td>\u003Ctd>0 = Resources should report their hours worked every day.\u003Cbr>1 = Resources should report their total hours worked for a week.\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>WADMIN_WEEK_START_ON_ENUM\u003C/td>\u003Ctd>Week starts on this day.\u003C/td>\u003Ctd>0 = Sunday\u003Cbr>1 = Monday \u003Cbr>2 = Tuesday\u003Cbr>3 = Wednesday\u003Cbr>4 = Thursday\u003Cbr>5 = Friday\u003Cbr>6 = Saturday\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>",{"headings":33,"imagePaths":34,"frontmatter":11},[],[],"2007-09-07-an-addition-to-the-project-server-2007-sdk-part-2",{"id":35,"data":37,"body":46,"filePath":47,"digest":48,"rendered":49},{"id":38,"title":39,"date":40,"author":15,"excerpt":41,"layout":17,"permalink":42,"image":43,"categories":44,"tags":45,"draft":26},12,"An addition to the Project Server 2007 SDK (Part 2)",["Date","2007-09-07T12:16:00.000Z"],"I was browsing through the Project Server 2007 TimePeriodDataSet.TimePeriodsRow Members and found the following empty entries I could fill.\n","/2007/09/07/an-addition-to-the-project-server-2007-sdk-part-2/","/wp-content/uploads/2007/09/post-12-thumnail-1.png",[21],[23,25],"I was browsing through the Project Server 2007 [`TimePeriodDataSet.TimePeriodsRow` members](https://learn.microsoft.com/previous-versions/office/developer/office-2007/ms479524(v=office.12)) and found there were some empty entries in the SDK.\n\nThe following empty entries I could fill:\n\n| Name                  | Description                                                                                             | Enumeration                                                                          |\n| --------------------- | ------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------ |\n| RES_TIMESHEET_MGR_UID | Specifies the resource unique identifier of the (next)\u003Cbr>enterprise resource reviewing on this timesheet. |                                                                                      |\n| TS_WEEK_STARTS_ON     | Specifies the first day of the week for this timesheet.                                                 | 0 = Sunday\u003Cbr>1 = Monday\u003Cbr>2 = Tuesday\u003Cbr>3 = Wednesday\u003Cbr>4 = Thursday\u003Cbr>5 = Friday\u003Cbr>6 = Saturday |\n| WPRD_UID              | Specifies the period unique identifier of the time period.                                              |                                                                                      |","src/posts/2007-09-07-an-addition-to-the-project-server-2007-sdk-part-2.md","acd9316c0107ad65",{"html":50,"metadata":51},"\u003Cp>I was browsing through the Project Server 2007 \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/developer/office-2007/ms479524(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>TimePeriodDataSet.TimePeriodsRow\u003C/code> members\u003Cspan>\u003C/span>\u003C/a> and found there were some empty entries in the \u003Cdfn>\u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/dfn>.\u003C/p>\n\u003Cp>The following empty entries I could fill:\u003C/p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>Name\u003C/th>\u003Cth>Description\u003C/th>\u003Cth>Enumeration\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>RES_TIMESHEET_MGR_UID\u003C/td>\u003Ctd>Specifies the resource unique identifier of the (next)\u003Cbr>enterprise resource reviewing on this timesheet.\u003C/td>\u003Ctd>\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>TS_WEEK_STARTS_ON\u003C/td>\u003Ctd>Specifies the first day of the week for this timesheet.\u003C/td>\u003Ctd>0 = Sunday\u003Cbr>1 = Monday\u003Cbr>2 = Tuesday\u003Cbr>3 = Wednesday\u003Cbr>4 = Thursday\u003Cbr>5 = Friday\u003Cbr>6 = Saturday\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>WPRD_UID\u003C/td>\u003Ctd>Specifies the period unique identifier of the time period.\u003C/td>\u003Ctd>\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>",{"headings":52,"imagePaths":53,"frontmatter":37},[],[],"2007-09-07-pitfall-using-the-sitedata-ws-to-get-the-siteguid",{"id":54,"data":56,"body":67,"filePath":68,"digest":69,"rendered":70},{"id":57,"title":58,"date":59,"author":15,"excerpt":60,"layout":17,"permalink":61,"image":62,"categories":63,"tags":64,"draft":26},10,"Pitfall: Using the SiteData Web Service to get the Site GUID",["Date","2007-09-07T14:50:00.000Z"],"When you want to use the PSI interface you need to have a PSContextInfo Class. Inside a Project Server Event this will be provided so you don’t need to worry about it’s contents. But outside the Event you will need to create one from scratch. One of the properties you need is the Site GUID. According to the SDK you can get this value in your code using three different methods. I use the third option in my application, but it returned the wrong GUID. After some debugging I finally found the problem.\n","/2007/09/07/pitfall-using-the-sitedata-ws-to-get-the-siteguid/","/wp-content/uploads/2007/09/post-10-thumnail-1.png",[21],[23,65,24,66],"PSI","WSS 3.0","When you want to use the PSI interface you need to have a [`PSContextInfo` class](https://learn.microsoft.com/previous-versions/office/developer/office-2007/ms482944(v=office.12)).\nInside a Project Server Event this will be provided automatically, so you don't need to worry about its contents (except when you want to impersonate as a different user).\nBut outside the Event you will need to create one from scratch.\n\nOne of the properties you need is the Site GUID.\nAccording to the SDK you can get this value in your code using three different methods:\n\n1. Hard-code the GUID _(Not very flexible)_\n2. Use the Windows SharePoint Services `SPSite.ID` property in the Windows SharePoint Services _(Very heavy on resources)_\n3. Call the SiteData Web Service with the PWA URL _(The best solution, if you ask me)_\n\nI use the third option in my application, but it did return an incorrect GUID.\nAfter some debugging, I finally found the problem.\nI requested the URL `http://localhost/PWA/` and that was a mistake.\nThe trailing `/` results in getting the GUID of the root site, not the PWA site!\n\nI am sure that I am not the first one falling in this pitfall, so this article is to prevent you from doing the same.","src/posts/2007-09-07-pitfall-using-the-sitedata-ws-to-get-the-siteguid.md","ea67870a0ecf31cf",{"html":71,"metadata":72},"\u003Cp>When you want to use the \u003Cdfn>\u003Cabbr title=\"Project Server Interface\">PSI\u003C/abbr>\u003C/dfn> interface you need to have a \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/developer/office-2007/ms482944(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>PSContextInfo\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>.\nInside a Project Server Event this will be provided automatically, so you don’t need to worry about its contents (except when you want to impersonate as a different user).\nBut outside the Event you will need to create one from scratch.\u003C/p>\n\u003Cp>One of the properties you need is the Site GUID.\nAccording to the \u003Cdfn>\u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/dfn> you can get this value in your code using three different methods:\u003C/p>\n\u003Col>\n\u003Cli>Hard-code the GUID \u003Cem>(Not very flexible)\u003C/em>\u003C/li>\n\u003Cli>Use the Windows SharePoint Services \u003Ccode>SPSite.ID\u003C/code> property in the Windows SharePoint Services \u003Cem>(Very heavy on resources)\u003C/em>\u003C/li>\n\u003Cli>Call the SiteData Web Service with the PWA \u003Cdfn>\u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>\u003C/dfn> \u003Cem>(The best solution, if you ask me)\u003C/em>\u003C/li>\n\u003C/ol>\n\u003Cp>I use the third option in my application, but it did return an incorrect GUID.\nAfter some debugging, I finally found the problem.\nI requested the \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr> \u003Ccode>http://localhost/PWA/\u003C/code> and that was a mistake.\nThe trailing \u003Ccode>/\u003C/code> results in getting the GUID of the root site, not the PWA site!\u003C/p>\n\u003Cp>I am sure that I am not the first one falling in this pitfall, so this article is to prevent you from doing the same.\u003C/p>",{"headings":73,"imagePaths":74,"frontmatter":56},[],[],"2007-10-31-project-conference-2007",{"id":75,"data":77,"body":88,"filePath":89,"digest":90,"rendered":91},{"id":78,"title":79,"date":80,"author":15,"excerpt":81,"layout":17,"permalink":82,"image":83,"categories":84,"tags":85,"draft":26},13,"Project Conference 2007",["Date","2007-10-31T13:18:00.000Z"],"I am currently at the Project Conference 2007 in Seattle and by visiting the sessions and talking to the guys at Microsoft developing the solution I got a lot of answers for things I could not find on the web or in the SDK.\n","/2007/10/31/project-conference-2007/","/wp-content/uploads/2007/10/post-13-thumbnail.png",[21],[86,87,23],"Certification","Conference","It has been a while having time and content to post on this blog but I am back again. 🙂\n\nI am currently at the Project Conference 2007 in Seattle and by visiting the sessions and talking to the guys at Microsoft developing the solution I got a lot of answers for things I could not find on the web or in the SDK.  \nThe next couple of weeks I will try to post the things I found out.\n\nAlso, [Prometric](https://www.prometric.com/) was present so you could do the official Project exams. Being bold I just entered the \"Managing Projects with Microsoft Office Project Server\" exam and guess what, I am now a *Microsoft Certified Technology Specialist*!","src/posts/2007-10-31-project-conference-2007.md","9509be4da4164379",{"html":92,"metadata":93},"\u003Cp>It has been a while having time and content to post on this blog but I am back again. \u003Cspan role=\"img\" aria-label=\"slightly smiling face\">🙂\u003C/span>\u003C/p>\n\u003Cp>I am currently at the Project Conference 2007 in Seattle and by visiting the sessions and talking to the guys at Microsoft developing the solution I got a lot of answers for things I could not find on the web or in the \u003Cdfn>\u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/dfn>.\u003Cbr>\nThe next couple of weeks I will try to post the things I found out.\u003C/p>\n\u003Cp>Also, \u003Ca href=\"https://www.prometric.com/\" rel=\"noopener noreferrer external\" target=\"_blank\">Prometric\u003Cspan>\u003C/span>\u003C/a> was present so you could do the official Project exams. Being bold I just entered the “Managing Projects with Microsoft Office Project Server” exam and guess what, I am now a \u003Cem>Microsoft Certified Technology Specialist\u003C/em>!\u003C/p>",{"headings":94,"imagePaths":95,"frontmatter":77},[],[],"2009-03-13-recording-converter-for-microsoft-office-live-meeting-2007",{"id":96,"data":98,"body":114,"filePath":115,"digest":116,"rendered":117},{"id":99,"title":100,"date":101,"author":15,"excerpt":102,"layout":17,"permalink":103,"image":104,"categories":105,"tags":107,"draft":26},18,"Recording Converter for Microsoft Office Live Meeting 2007",["Date","2009-03-13T13:32:34.000Z"],"This week I gave a presentation at Winvision and recorded it in Microsoft Office Live Meeting 2007. The resulting recording is a webpage with multiple streams: desktop video, presenter video and audio. The problem is that the codec used doesn't work on x64 systems or Windows 7 (Server). Watching the separate streams isn't really an option because there is no audio included in the video streams. But I got lucky as it seems Microsoft has released a new tool called “Recording Converter for Microsoft Office Live Meeting 2007” only last month.\n","/2009/03/13/recording-converter-for-microsoft-office-live-meeting-2007/","/wp-content/uploads/2009/03/post-18-thumnail-1.png",[106],"Office",[108,109,106,110,111,112,113],"Converter","Live Meeting","Recording","Windows 7","WMV","x64","This week I gave a presentation at Winvision and recorded it in Microsoft Office Live Meeting 2007.\nThe resulting recording is a webpage with multiple streams: desktop video, presenter video and audio.\n\nThe problem is that the codec used does not work on x64 systems or Windows 7 (Server).\nWatching the separate streams is not really an option because there is no audio included in the video streams.\n\n\u003C!--more-->\n\nBut I got lucky as it seems Microsoft has released a new tool called \"**Recording Converter for Microsoft Office Live Meeting 2007**\" only last month.\n\nThis tool allows you to convert a Live Meeting recording into a WMV file.\nYou can choose the output resolution and, optionally, you can include the presenter and/or panoramic video streams.\n\nIt takes one hour to process, my presentation was nearly 2 hours, and now I have a file most video players can render.","src/posts/2009-03-13-recording-converter-for-microsoft-office-live-meeting-2007.md","426da0b3d9308e88",{"html":118,"metadata":119},"\u003Cp>This week I gave a presentation at Winvision and recorded it in Microsoft Office Live Meeting 2007.\nThe resulting recording is a webpage with multiple streams: desktop video, presenter video and audio.\u003C/p>\n\u003Cp>The problem is that the codec used does not work on x64 systems or Windows 7 (Server).\nWatching the separate streams is not really an option because there is no audio included in the video streams.\u003C/p>\n\u003C!--more-->\n\u003Cp>But I got lucky as it seems Microsoft has released a new tool called “\u003Cstrong>Recording Converter for Microsoft Office Live Meeting 2007\u003C/strong>” only last month.\u003C/p>\n\u003Cp>This tool allows you to convert a Live Meeting recording into a WMV file.\nYou can choose the output resolution and, optionally, you can include the presenter and/or panoramic video streams.\u003C/p>\n\u003Cp>It takes one hour to process, my presentation was nearly 2 hours, and now I have a file most video players can render.\u003C/p>",{"headings":120,"imagePaths":121,"frontmatter":98},[],[],"2009-03-23-sharepoint-incremental-crawl-takes-much-longer-after-adding-or-removing-a-user",{"id":122,"data":124,"body":140,"filePath":141,"digest":142,"rendered":143},{"id":125,"title":126,"date":127,"author":15,"excerpt":128,"layout":17,"permalink":129,"image":130,"categories":131,"tags":133,"draft":26},19,"SharePoint Incremental Crawl takes much longer after adding or removing a user",["Date","2009-03-23T07:15:38.000Z"],"It is a sad and known fact that having lots of ACLs in your SharePoint database has a negative effect on the performance of your site. What I did not know yet was that changes to the ACL will impact you incremental crawls.\n","/2009/03/23/sharepoint-incremental-crawl-takes-much-longer-after-adding-or-removing-a-user/","/wp-content/uploads/2009/03/post-19-thumnail-1.png",[132],"SharePoint",[134,135,136,137,138,139],"ACL","Crawl","Incremental","Performance","Search","SharePoint 2007","It is a sad and known fact that having lots of ACLs in your SharePoint database has a negative effect on the performance of your site.\nWhat I did not know yet was that changes to the ACL will impact your incremental crawls.\n\n\u003C!--more-->\n\nVikram Lakhotia has posted a description about this in his blog post:\n\"[SharePoint Incremental Crawl taking a long time after adding or removing a user](https://weblogs.asp.net/vikram/sharepoint-incremental-crawl-taking-a-long-time-after-adding-or-removing-a-user)\".","src/posts/2009-03-23-sharepoint-incremental-crawl-takes-much-longer-after-adding-or-removing-a-user.md","e2f27a9e4e100ecd",{"html":144,"metadata":145},"\u003Cp>It is a sad and known fact that having lots of ACLs in your SharePoint database has a negative effect on the performance of your site.\nWhat I did not know yet was that changes to the ACL will impact your incremental crawls.\u003C/p>\n\u003C!--more-->\n\u003Cp>Vikram Lakhotia has posted a description about this in his blog post:\n“\u003Ca href=\"https://weblogs.asp.net/vikram/sharepoint-incremental-crawl-taking-a-long-time-after-adding-or-removing-a-user\" rel=\"noopener noreferrer external\" target=\"_blank\">SharePoint Incremental Crawl taking a long time after adding or removing a user\u003Cspan>\u003C/span>\u003C/a>”.\u003C/p>",{"headings":146,"imagePaths":147,"frontmatter":124},[],[],"2009-05-12-sharepoint-2010-and-project-server-2010",{"id":148,"data":150,"body":165,"filePath":166,"digest":167,"rendered":168},{"id":151,"title":152,"date":153,"author":15,"excerpt":154,"layout":17,"permalink":155,"image":156,"categories":157,"tags":158,"draft":26},21,"SharePoint 2010 and Project Server 2010 system requirements",["Date","2009-05-12T00:14:28.000Z"],"As announced yesterday by Microsoft the Office 2010 products will be 64bit only. Well no surprise there, we already knew that. But they went even further: Windows Server 2008 and SQL Server on 64bit is a must for ensuring the best performance possible.\n","/2009/05/12/sharepoint-2010-and-project-server-2010/","/wp-content/uploads/2009/05/post-21-thumnail-1.png",[21,132],[159,160,161,162,163,164,113],"Project Server 2010","SharePoint 2010","SQL Server 2005","SQL Server 2008","Windows Server 2008","Windows Server 2008R2","As announced yesterday by Microsoft, the Office 2010 products will be 64bit only in the future.\nWell, no surprise there, we already knew that.\nBut they went even further.\n\n\u003C!--more-->\n\nBecause of their experience with customer implementations of the 2007 series they recognize that having Windows Server 2008 and SQL Server on 64bit is a must for ensuring the best performance possible.\nTherefore the 2010 series of products will only be available on those versions!\n\nAlso, on the client side there will be an improvement as Internet Explorer 6 will not be supported anymore.\n\nSo, to summarize:\n\n- SharePoint Server & Project Server 2010 will be _64-bit only_\n- SharePoint Server & Project Server 2010 will require _64-bit Windows Server 2008 or 2008R2_\n- SharePoint Server & Project Server 2010 will require _64-bit SQL Server 2005 or 2008_ (But you should choose 2008)\n- SharePoint Server & Project Server 2010 will only support _Internet Explorer 7 or 8_","src/posts/2009-05-12-sharepoint-2010-and-project-server-2010.md","9383980cd4439aa5",{"html":169,"metadata":170},"\u003Cp>As announced yesterday by Microsoft, the Office 2010 products will be 64bit only in the future.\nWell, no surprise there, we already knew that.\nBut they went even further.\u003C/p>\n\u003C!--more-->\n\u003Cp>Because of their experience with customer implementations of the 2007 series they recognize that having Windows Server 2008 and \u003Cdfn>\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr>\u003C/dfn> Server on 64bit is a must for ensuring the best performance possible.\nTherefore the 2010 series of products will only be available on those versions!\u003C/p>\n\u003Cp>Also, on the client side there will be an improvement as Internet Explorer 6 will not be supported anymore.\u003C/p>\n\u003Cp>So, to summarize:\u003C/p>\n\u003Cul>\n\u003Cli>SharePoint Server &#x26; Project Server 2010 will be \u003Cem>64-bit only\u003C/em>\u003C/li>\n\u003Cli>SharePoint Server &#x26; Project Server 2010 will require \u003Cem>64-bit Windows Server 2008 or 2008R2\u003C/em>\u003C/li>\n\u003Cli>SharePoint Server &#x26; Project Server 2010 will require \u003Cem>64-bit \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Server 2005 or 2008\u003C/em> (But you should choose 2008)\u003C/li>\n\u003Cli>SharePoint Server &#x26; Project Server 2010 will only support \u003Cem>Internet Explorer 7 or 8\u003C/em>\u003C/li>\n\u003C/ul>",{"headings":171,"imagePaths":172,"frontmatter":150},[],[],"2009-07-09-moss-2007-c-protocol-handler-errors-fixed",{"id":173,"data":175,"body":190,"filePath":191,"digest":192,"rendered":193},{"id":176,"title":177,"date":178,"author":15,"excerpt":179,"layout":17,"permalink":180,"image":181,"categories":182,"tags":184,"draft":26},22,"MOSS 2007 – C# Protocol Handler errors fixed",["Date","2009-07-09T17:44:24.000Z"],"On CodePlex you can find the “MOSS 2007 - C# Protocol Handler” project. When working with the code I discovered 2 issues which I both fixed. Both solutions are summarized here.\n","/2009/07/09/moss-2007-c-protocol-handler-errors-fixed/","/wp-content/uploads/2009/07/post-22-thumnail-1.png",[183,132],"C#",[185,186,187,188,139,113,189],"Buffer","CodePlex","Exception","Protocol Handler","x86","On CodePlex you can find the [MOSS 2007 - C# Protocol Handler project](https://web.archive.org/web/20210629141705/https://archive.codeplex.com/?p=mossph).\nI am currently using this in a project to index a custom content source.\n\nWhen working with the code I discovered two issues which I both fixed.\nBoth solutions are posted in the discussions and/or submitted as patch and I will summarize them here.\n\n\u003C!--more-->\n\n### Running on x64\n\nThe first problem is the code not working in x64 environments.\nSince we are talking to native code, there are a lot of [structs](https://learn.microsoft.com/dotnet/csharp/language-reference/builtin-types/struct) in the code.\nThese structs are containing metadata to indicate the layout in memory.\nThis is done using the [`StructLayoutAttribute` class](https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.structlayoutattribute?view=netframework-2.0) which contains a [`Value` property](https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.structlayoutattribute.value?view=netframework-2.0) with a [`LayoutKind` enumeration](https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.layoutkind?view=netframework-2.0) and a [`Pack` field](https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.structlayoutattribute.pack?view=netframework-2.0).\n\nThe problem is the `Pack` value was set to `1`.\nThis is normal for 32bit systems, but not for 64bit where a pack of `8` is expected.\n\nLucky enough, the following is written in the remarks section:\n\n> A value of `0` indicates that the packing alignment is set to the default for the current platform.\n\nThis solves our problem! Now the same code runs fine on both x86 and x64 systems.\n\n### Using Security Descriptors\n\nOne of the most important features of SharePoint search is security trimming.\nTo make this possible an [ACL Structure](https://learn.microsoft.com/windows/win32/api/winnt/ns-winnt-acl) is stored with the crawled item in the index database.\nThe problem is when the ACL is larger then 1kB the crawler goes into an endless loop.\n\nThe way it should go is the search service calling the [GetSecurityDescriptor method](https://learn.microsoft.com/previous-versions/office/developer/sharepoint-2007/aa981497(v=office.12)) with a pointer and a size.\nThis size is `1024` by default.\nWhen the ACL is larger an `ERROR_INSUFFICIENT_BUFFER` error message should be returned and the required size should be set.\nThe search service then should allocate enough memory and call the `GetSecurityDescriptor` method again, which is now able to assign the complete ACL to the pointer.\n\nThe problem with the current version on CodePlex is the value of the error message is incorrect.\nInstead of [`0x00000122`](https://learn.microsoft.com/windows/win32/debug/system-error-codes--0-499-#ERROR_INSUFFICIENT_BUFFER) it should be `0x8007007A` ([which is also 112](https://learn.microsoft.com/windows/win32/adsi/win32-error-codes-for-adsi-2-0)).\n\nAfter changing the code, the ACL will be stored (as long as it stays \u003C64kB).","src/posts/2009-07-09-moss-2007-c-protocol-handler-errors-fixed.md","9a6a32018fdca81f",{"html":194,"metadata":195},"\u003Cp>On CodePlex you can find the \u003Ca href=\"https://web.archive.org/web/20210629141705/https://archive.codeplex.com/?p=mossph\" rel=\"noopener noreferrer external\" target=\"_blank\">MOSS 2007 - C# Protocol Handler project\u003Cspan>\u003C/span>\u003C/a>.\nI am currently using this in a project to index a custom content source.\u003C/p>\n\u003Cp>When working with the code I discovered two issues which I both fixed.\nBoth solutions are posted in the discussions and/or submitted as patch and I will summarize them here.\u003C/p>\n\u003C!--more-->\n\u003Ch3 id=\"running-on-x64\">Running on x64\u003C/h3>\n\u003Cp>The first problem is the code not working in x64 environments.\nSince we are talking to native code, there are a lot of \u003Ca href=\"https://learn.microsoft.com/dotnet/csharp/language-reference/builtin-types/struct?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">structs\u003Cspan>\u003C/span>\u003C/a> in the code.\nThese structs are containing metadata to indicate the layout in memory.\nThis is done using the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.structlayoutattribute?view=netframework-2.0&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>StructLayoutAttribute\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> which contains a \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.structlayoutattribute.value?view=netframework-2.0&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Value\u003C/code> property\u003Cspan>\u003C/span>\u003C/a> with a \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.layoutkind?view=netframework-2.0&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>LayoutKind\u003C/code> enumeration\u003Cspan>\u003C/span>\u003C/a> and a \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.runtime.interopservices.structlayoutattribute.pack?view=netframework-2.0&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Pack\u003C/code> field\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>The problem is the \u003Ccode>Pack\u003C/code> value was set to \u003Ccode>1\u003C/code>.\nThis is normal for 32bit systems, but not for 64bit where a pack of \u003Ccode>8\u003C/code> is expected.\u003C/p>\n\u003Cp>Lucky enough, the following is written in the remarks section:\u003C/p>\n\u003Cblockquote>\n\u003Cp>A value of \u003Ccode>0\u003C/code> indicates that the packing alignment is set to the default for the current platform.\u003C/p>\n\u003C/blockquote>\n\u003Cp>This solves our problem! Now the same code runs fine on both x86 and x64 systems.\u003C/p>\n\u003Ch3 id=\"using-security-descriptors\">Using Security Descriptors\u003C/h3>\n\u003Cp>One of the most important features of SharePoint search is security trimming.\nTo make this possible an \u003Ca href=\"https://learn.microsoft.com/windows/win32/api/winnt/ns-winnt-acl?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">ACL Structure\u003Cspan>\u003C/span>\u003C/a> is stored with the crawled item in the index database.\nThe problem is when the ACL is larger then 1kB the crawler goes into an endless loop.\u003C/p>\n\u003Cp>The way it should go is the search service calling the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/developer/sharepoint-2007/aa981497(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">GetSecurityDescriptor method\u003Cspan>\u003C/span>\u003C/a> with a pointer and a size.\nThis size is \u003Ccode>1024\u003C/code> by default.\nWhen the ACL is larger an \u003Ccode>ERROR_INSUFFICIENT_BUFFER\u003C/code> error message should be returned and the required size should be set.\nThe search service then should allocate enough memory and call the \u003Ccode>GetSecurityDescriptor\u003C/code> method again, which is now able to assign the complete ACL to the pointer.\u003C/p>\n\u003Cp>The problem with the current version on CodePlex is the value of the error message is incorrect.\nInstead of \u003Ca href=\"https://learn.microsoft.com/windows/win32/debug/system-error-codes--0-499-?wt.mc_id=AZ-MVP-5004268#ERROR_INSUFFICIENT_BUFFER\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>0x00000122\u003C/code>\u003Cspan>\u003C/span>\u003C/a> it should be \u003Ccode>0x8007007A\u003C/code> (\u003Ca href=\"https://learn.microsoft.com/windows/win32/adsi/win32-error-codes-for-adsi-2-0?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">which is also 112\u003Cspan>\u003C/span>\u003C/a>).\u003C/p>\n\u003Cp>After changing the code, the ACL will be stored (as long as it stays &#x3C;64kB).\u003C/p>",{"headings":196,"imagePaths":204,"frontmatter":175},[197,201],{"depth":198,"slug":199,"text":200},3,"running-on-x64","Running on x64",{"depth":198,"slug":202,"text":203},"using-security-descriptors","Using Security Descriptors",[],"2010-01-06-blog-now-running-on-wordpress",{"id":205,"data":207,"body":219,"filePath":220,"digest":221,"rendered":222},{"id":208,"title":209,"date":210,"author":15,"excerpt":211,"layout":17,"permalink":212,"image":213,"categories":214,"tags":215,"draft":26},61,"Blog now running on WordPress",["Date","2010-01-06T16:01:24.000Z"],"After having major, and unsolvable, problems with MovableType (MovableType was causing segfaults in Perl) for over half a year I finally switched to WordPress for hosting my blog.\n","/2010/01/06/blog-now-running-on-wordpress/","/wp-content/uploads/2010/01/post-61-thumnail-1.png",[],[216,217,218],"Blog","Plugin","WordPress","After having major, and unsolvable, problems with [MovableType](https://movabletype.org/) (MovableType was causing segfaults in Perl) for over half a year I finally switched to WordPress for hosting my blog.\n\nI did consider SharePoint Server 2010 for hosting my blog, but the out-of-the-box support is nowhere near the possibilities with [WordPress](https://wordpress.org/) (or any other major blogging framework).\n\n\u003C!--more-->\n\n### Configuration\n\nAfter trying some themes, I settled for the \"Paperpunch Theme\" by [The Theme Foundry](https://thethemefoundry.com/).\n\nThis is completed with the following plugins:\n\n- **Akismet**  \n   Akismet checks your comments against the Akismet web service to see if they look like spam or not.\n- **Google XML Sitemaps**  \n   This plugin will generate a special XML sitemap which will help search engines like Google, Yahoo, Bing and Ask.com to better index your blog.\n- **SI CAPTCHA Anti-Spam**  \n   Adds CAPTCHA anti-spam methods to WordPress on the comment form, registration form, login, or all.\n   This prevents spam from automated bots.\n- **TweetMeme Retweet Button**  \n   Adds a button which easily lets you retweet your blog posts.\n- **Twitter Widget Pro**  \n   A widget that properly handles twitter feeds, including @username, #hashtag, and link parsing.\n- **WP Super Cache**  \n   Very fast caching plugin for WordPress.\n\nIf somebody has comments or suggestions, please let me now.","src/posts/2010-01-06-blog-now-running-on-wordpress.md","47e01b040fc5404b",{"html":223,"metadata":224},"\u003Cp>After having major, and unsolvable, problems with \u003Ca href=\"https://movabletype.org/\" rel=\"noopener noreferrer external\" target=\"_blank\">MovableType\u003Cspan>\u003C/span>\u003C/a> (MovableType was causing segfaults in \u003Cdfn>\u003Cabbr title=\"Practical Extraction and Reporting Language\">Perl\u003C/abbr>\u003C/dfn>) for over half a year I finally switched to WordPress for hosting my blog.\u003C/p>\n\u003Cp>I did consider SharePoint Server 2010 for hosting my blog, but the out-of-the-box support is nowhere near the possibilities with \u003Ca href=\"https://wordpress.org/\" rel=\"noopener noreferrer external\" target=\"_blank\">WordPress\u003Cspan>\u003C/span>\u003C/a> (or any other major blogging framework).\u003C/p>\n\u003C!--more-->\n\u003Ch3 id=\"configuration\">Configuration\u003C/h3>\n\u003Cp>After trying some themes, I settled for the “Paperpunch Theme” by \u003Ca href=\"https://thethemefoundry.com/\" rel=\"noopener noreferrer external\" target=\"_blank\">The Theme Foundry\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>This is completed with the following plugins:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Cstrong>Akismet\u003C/strong>\u003Cbr>\nAkismet checks your comments against the Akismet web service to see if they look like spam or not.\u003C/li>\n\u003Cli>\u003Cstrong>Google \u003Cdfn>\u003Cabbr title=\"eXtensible Markup Language\">XML\u003C/abbr>\u003C/dfn> Sitemaps\u003C/strong>\u003Cbr>\nThis plugin will generate a special \u003Cabbr title=\"eXtensible Markup Language\">XML\u003C/abbr> sitemap which will help search engines like Google, Yahoo, Bing and Ask.com to better index your blog.\u003C/li>\n\u003Cli>\u003Cstrong>SI CAPTCHA Anti-Spam\u003C/strong>\u003Cbr>\nAdds CAPTCHA anti-spam methods to WordPress on the comment form, registration form, login, or all.\nThis prevents spam from automated bots.\u003C/li>\n\u003Cli>\u003Cstrong>TweetMeme Retweet Button\u003C/strong>\u003Cbr>\nAdds a button which easily lets you retweet your blog posts.\u003C/li>\n\u003Cli>\u003Cstrong>Twitter Widget Pro\u003C/strong>\u003Cbr>\nA widget that properly handles twitter feeds, including @username, #hashtag, and link parsing.\u003C/li>\n\u003Cli>\u003Cstrong>\u003Cdfn>\u003Cabbr title=\"WordPress\">WP\u003C/abbr>\u003C/dfn> Super Cache\u003C/strong>\u003Cbr>\nVery fast caching plugin for WordPress.\u003C/li>\n\u003C/ul>\n\u003Cp>If somebody has comments or suggestions, please let me now.\u003C/p>",{"headings":225,"imagePaths":229,"frontmatter":207},[226],{"depth":198,"slug":227,"text":228},"configuration","Configuration",[],"2010-01-06-remote-desktop-client-doesnt-use-stored-credentials",{"id":230,"data":232,"body":247,"filePath":248,"digest":249,"rendered":250},{"id":233,"title":234,"date":235,"author":15,"excerpt":236,"layout":17,"permalink":237,"image":238,"categories":239,"tags":241,"draft":26},66,"Remote Desktop Client doesn’t use stored credentials",["Date","2010-01-06T18:54:30.000Z"],"Learn how I solved the problem of the Remote Desktop Client not using stored credentials due to a local policy setting, and simplified my RDP connections.\n","/2010/01/06/remote-desktop-client-doesnt-use-stored-credentials/","/wp-content/uploads/2010/01/post-66-thumnail-1.png",[240],"Windows",[242,243,244,245,246,240],"Credentials","GPEdit","NTLM","RDP","Remote Desktop","When I frequently connect to the same development machine using Remote Desktop Protocol (RDP),\nI want to store my credentials for easier access.\nHowever, I still have to provide my password each time I connect.\n\nIn this article, I explain the reason behind this issue and how I resolved it by adjusting a local policy setting.\n\n\u003C!--more-->\n\n### The problem\n\nWhen I connect to the same development machine repeatedly using RDP,\nI want to store my credentials for easier access.\n\n![First logon attempt](/wp-content/uploads/2010/01/first-logon-attempt.png \"First logon attempt\")\n\nHowever, when I try to connect again, I'm still prompted to provide my password.\n\n![Second logon attempt](/wp-content/uploads/2010/01/second-logon-attempt.png \"Second logon attempt\")\n\nAfter entering my password 1387 times in the past year,\nI started searching for the reason why it does not use my stored credentials.\nAs it turns out this is because of a local policy.\n\n### The solution\n\n1. Start \u003Ckbd>GPEdit.msc\u003C/kbd> and navigate to `Computer Configuration` > `Administrative Templates` > `System` > `Credentials Delegation`\n2. Open the policy `Allow Saved Credentials with NTLM-only Server Authentication`\n   (or `Allow Delegating Saved Credentials with NTLM-only Server Authentication` for Windows 7)\n3. Select `Enabled` and click on \u003Ckbd>Show\u003C/kbd>\n4. Enter the server where you want to connect to with the stored credentials.\n   You are allowed to use wildcards, so I choose `TERMSRV/*.int`\n   (since my development machines are always in a domain ending with `.int`)\n5. Close the screens and run \u003Ckbd>gpupdate\u003C/kbd>\n\n![Allow delegating saved credentials](/wp-content/uploads/2010/01/allow-delegating-saved-credentials.png \"Allow delegating saved credentials\")\n\nNow, I can connect to the server without having to provide the same password over and over again.","src/posts/2010-01-06-remote-desktop-client-doesnt-use-stored-credentials.md","3d85b706c2efcea0",{"html":251,"metadata":252},"\u003Cp>When I frequently connect to the same development machine using Remote Desktop Protocol (RDP),\nI want to store my credentials for easier access.\nHowever, I still have to provide my password each time I connect.\u003C/p>\n\u003Cp>In this article, I explain the reason behind this issue and how I resolved it by adjusting a local policy setting.\u003C/p>\n\u003C!--more-->\n\u003Ch3 id=\"the-problem\">The problem\u003C/h3>\n\u003Cp>When I connect to the same development machine repeatedly using RDP,\nI want to store my credentials for easier access.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/01/first-logon-attempt.webp\" type=\"image/webp\" media=\"(max-width: 445px)\">\u003Csource srcset=\"/wp-content/uploads/2010/01/first-logon-attempt-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/01/first-logon-attempt-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/01/first-logon-attempt.png\" alt=\"First logon attempt\" loading=\"lazy\" decoding=\"async\" width=\"445\" height=\"408\" srcset=\"/wp-content/uploads/2010/01/first-logon-attempt.png 445w, /wp-content/uploads/2010/01/first-logon-attempt-150x150.png 150w, /wp-content/uploads/2010/01/first-logon-attempt-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>First logon attempt\u003C/figcaption>\u003C/figure>\n\u003Cp>However, when I try to connect again, I’m still prompted to provide my password.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/01/second-logon-attempt.webp\" type=\"image/webp\" media=\"(max-width: 443px)\">\u003Csource srcset=\"/wp-content/uploads/2010/01/second-logon-attempt-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/01/second-logon-attempt-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/01/second-logon-attempt.png\" alt=\"Second logon attempt\" loading=\"lazy\" decoding=\"async\" width=\"443\" height=\"437\" srcset=\"/wp-content/uploads/2010/01/second-logon-attempt.png 443w, /wp-content/uploads/2010/01/second-logon-attempt-150x150.png 150w, /wp-content/uploads/2010/01/second-logon-attempt-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Second logon attempt\u003C/figcaption>\u003C/figure>\n\u003Cp>After entering my password 1387 times in the past year,\nI started searching for the reason why it does not use my stored credentials.\nAs it turns out this is because of a local policy.\u003C/p>\n\u003Ch3 id=\"the-solution\">The solution\u003C/h3>\n\u003Col>\n\u003Cli>Start \u003Ckbd>GPEdit.msc\u003C/kbd> and navigate to \u003Ccode>Computer Configuration\u003C/code> > \u003Ccode>Administrative Templates\u003C/code> > \u003Ccode>System\u003C/code> > \u003Ccode>Credentials Delegation\u003C/code>\u003C/li>\n\u003Cli>Open the policy \u003Ccode>Allow Saved Credentials with NTLM-only Server Authentication\u003C/code>\n(or \u003Ccode>Allow Delegating Saved Credentials with NTLM-only Server Authentication\u003C/code> for Windows 7)\u003C/li>\n\u003Cli>Select \u003Ccode>Enabled\u003C/code> and click on \u003Ckbd>Show\u003C/kbd>\u003C/li>\n\u003Cli>Enter the server where you want to connect to with the stored credentials.\nYou are allowed to use wildcards, so I choose \u003Ccode>TERMSRV/*.int\u003C/code>\n(since my development machines are always in a domain ending with \u003Ccode>.int\u003C/code>)\u003C/li>\n\u003Cli>Close the screens and run \u003Ckbd>gpupdate\u003C/kbd>\u003C/li>\n\u003C/ol>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/01/allow-delegating-saved-credentials.webp\" type=\"image/webp\" media=\"(max-width: 525px)\">\u003Csource srcset=\"/wp-content/uploads/2010/01/allow-delegating-saved-credentials-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/01/allow-delegating-saved-credentials-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/01/allow-delegating-saved-credentials.png\" alt=\"Allow delegating saved credentials\" loading=\"lazy\" decoding=\"async\" width=\"525\" height=\"480\" srcset=\"/wp-content/uploads/2010/01/allow-delegating-saved-credentials.png 525w, /wp-content/uploads/2010/01/allow-delegating-saved-credentials-150x150.png 150w, /wp-content/uploads/2010/01/allow-delegating-saved-credentials-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Allow delegating saved credentials\u003C/figcaption>\u003C/figure>\n\u003Cp>Now, I can connect to the server without having to provide the same password over and over again.\u003C/p>",{"headings":253,"imagePaths":260,"frontmatter":232},[254,257],{"depth":198,"slug":255,"text":256},"the-problem","The problem",{"depth":198,"slug":258,"text":259},"the-solution","The solution",[],"2007-09-07-installer-application-folder",{"id":261,"data":263,"body":275,"filePath":276,"digest":277,"rendered":278},{"id":264,"title":265,"date":266,"author":15,"excerpt":267,"layout":17,"permalink":268,"image":269,"categories":270,"tags":272,"draft":26},11,"MSI Installer Application Folder from code",["Date","2007-09-07T11:35:00.000Z"],"To deploy our code, we create MSI installers using Visual Studio. One problem I encountered is that there is no property available in code to know where the user has chosen to install the application.\n","/2007/09/07/installer-application-folder/","/wp-content/uploads/2007/09/post-11-thumnail-1.png",[183,271],"Visual Studio",[273,274],"Installer","MSI","To deploy our code, we create MSI installers using [Visual Studio](https://visualstudio.microsoft.com/).\r\nOne problem I encountered is that there is no property available in code to know where the user has chosen to install the application.\r\n\r\nAfter some searching and testing, I now use the following code to get the installation path:\r\n\r\n```csharp\r\n// Installer Application Folder\r\nstring installPath = Context.Parameters[\"assemblypath\"];\r\ninstallPath = installPath.Substring(0, installPath.LastIndexOf(\"\\\\\"));\r\n\r\nif (!installPath.EndsWith(\"\\\\\"))\r\n{\r\n    installPath += \"\\\\\";\r\n}\r\n```\r\n\r\nThat is all!","src/posts/2007-09-07-installer-application-folder.md","7443825e42a72b75",{"html":279,"metadata":280},"\u003Cp>To deploy our code, we create \u003Cdfn>\u003Cabbr title=\"Microsoft Installer\">MSI\u003C/abbr>\u003C/dfn> installers using \u003Ca href=\"https://visualstudio.microsoft.com/\" rel=\"noopener noreferrer external\" target=\"_blank\">Visual Studio\u003Cspan>\u003C/span>\u003C/a>.\r\nOne problem I encountered is that there is no property available in code to know where the user has chosen to install the application.\u003C/p>\n\u003Cp>After some searching and testing, I now use the following code to get the installation path:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:70ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// Installer Application Folder\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">installPath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Parameters\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"assemblypath\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">];\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">installPath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">installPath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Substring\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">installPath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">LastIndexOf\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\\\\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">installPath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">EndsWith\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\\\\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">))\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">installPath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\\\\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// Installer Application Folderstring installPath = Context.Parameters[&#x22;assemblypath&#x22;];installPath = installPath.Substring(0, installPath.LastIndexOf(&#x22;\\\\&#x22;));if (!installPath.EndsWith(&#x22;\\\\&#x22;)){    installPath += &#x22;\\\\&#x22;;}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>That is all!\u003C/p>",{"headings":281,"imagePaths":282,"frontmatter":263},[],[],"2010-01-08-correcting-time-drift-with-centos-on-hyper-v",{"id":283,"data":285,"body":301,"filePath":302,"digest":303,"rendered":304},{"id":286,"title":287,"date":288,"author":15,"excerpt":289,"layout":17,"permalink":290,"image":291,"categories":292,"tags":294,"draft":26},78,"Correcting time drift with CentOS on Hyper-V",["Date","2010-01-08T11:34:58.000Z"],"I was having trouble with the clock in my Linux Hyper-V VMs. The time was constantly drifting forward. Using NTP only slowed the drift a bit down but often NTP gave up after several days.\n","/2010/01/08/correcting-time-drift-with-centos-on-hyper-v/","/wp-content/uploads/2010/01/post-78-thumnail-1.png",[293],"Hyper-V",[295,296,297,298,299,300],"CentOS","Clock","grub","Linux","NTP","VM","I was having trouble with the clock in my Linux Hyper-V VM’s.\nThe time was constantly drifting forward.\nUsing the Network Time Protocol (NTP) only slowed the drift a bit down but often the NTP-service gave up after several days.\n\n\u003C!--more-->\n\nI tried a lot of NTP configurations, but basically the local clock was just unreliable.\nEven using [rdate](https://linux.die.net/man/1/rdate) every 10 minutes was already showing backwards jumps of several seconds.\nAs one of my VMs is running dovecot this really was a problem because [dovecot](https://www.dovecot.org/) hates [time moving backwards](https://doc.dovecot.org/2.3/admin_manual/errors/time_moved_backwards/).\n\nI finally found the solution posted by Mat Mirabito in the blogpost\n\"[Linux (specifically CentOS running trixbox) gains excessive time on system clock](https://bloggymcblogface.blog/linux-specifically-centos-running-trixbox-gains-excessive-time-on-system-clock/)\".\n\nEdit `grub.conf` and add the following to the kernel line:\n\n```ini\ndivider=10 clocksource=acpi_pm\n```\n\nAfter this it works like… clockwork 🙂","src/posts/2010-01-08-correcting-time-drift-with-centos-on-hyper-v.md","30f743655698651d",{"html":305,"metadata":306},"\u003Cp>I was having trouble with the clock in my Linux Hyper-V \u003Cdfn>\u003Cabbr title=\"Virtual Machine\">VM\u003C/abbr>\u003C/dfn>’s.\nThe time was constantly drifting forward.\nUsing the Network Time Protocol (\u003Cdfn>\u003Cabbr title=\"Network Time Protocol\">NTP\u003C/abbr>\u003C/dfn>) only slowed the drift a bit down but often the \u003Cabbr title=\"Network Time Protocol\">NTP\u003C/abbr>-service gave up after several days.\u003C/p>\n\u003C!--more-->\n\u003Cp>I tried a lot of \u003Cabbr title=\"Network Time Protocol\">NTP\u003C/abbr> configurations, but basically the local clock was just unreliable.\nEven using \u003Ca href=\"https://linux.die.net/man/1/rdate\" rel=\"noopener noreferrer external\" target=\"_blank\">rdate\u003Cspan>\u003C/span>\u003C/a> every 10 minutes was already showing backwards jumps of several seconds.\nAs one of my VMs is running dovecot this really was a problem because \u003Ca href=\"https://www.dovecot.org/\" rel=\"noopener noreferrer external\" target=\"_blank\">dovecot\u003Cspan>\u003C/span>\u003C/a> hates \u003Ca href=\"https://doc.dovecot.org/2.3/admin_manual/errors/time_moved_backwards/\" rel=\"noopener noreferrer external\" target=\"_blank\">time moving backwards\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>I finally found the solution posted by Mat Mirabito in the blogpost\n“\u003Ca href=\"https://bloggymcblogface.blog/linux-specifically-centos-running-trixbox-gains-excessive-time-on-system-clock/\" rel=\"noopener noreferrer external\" target=\"_blank\">Linux (specifically CentOS running trixbox) gains excessive time on system clock\u003Cspan>\u003C/span>\u003C/a>”.\u003C/p>\n\u003Cp>Edit \u003Ccode>grub.conf\u003C/code> and add the following to the kernel line:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"ini\" class=\"wrap\" style=\"--ecMaxLine:30ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">divider\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=10 \u003C/span>\u003Cspan style=\"--0:#569CD6\">clocksource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=acpi_pm\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"divider=10 clocksource=acpi_pm\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>After this it works like… clockwork \u003Cspan role=\"img\" aria-label=\"slightly smiling face\">🙂\u003C/span>\u003C/p>",{"headings":307,"imagePaths":308,"frontmatter":285},[],[],"2009-03-03-using-linq-with-the-moss-userprofilemanager",{"id":309,"data":311,"body":323,"filePath":324,"digest":325,"rendered":326},{"id":312,"title":313,"date":314,"author":15,"excerpt":315,"layout":17,"permalink":316,"image":317,"categories":318,"tags":319,"draft":26},14,"Using LINQ with the MOSS UserProfileManager",["Date","2009-03-03T20:40:17.000Z"],"Lately I am working a lot with LINQ and al types like LINQ to XML, LINQ to XSD, LINQ to objects, etc. Today I had to build some functionality in SharePoint where I had to split users in 2 groups based on a profile property in their User Profile. In this post I will show you how I did this.\n","/2009/03/03/using-linq-with-the-moss-userprofilemanager/","/wp-content/uploads/2009/03/post-14-thumnail-1.png",[183,132],[320,321,139,322],"LINQ","ProfileManager","User Profile","Lately I am working a lot with LINQ and all flavors like LINQ to XML, LINQ to XSD, LINQ to objects, etc.  \nToday I had to build some functionality in SharePoint where I had to split users in two groups based on a profile property in their User Profile.\n\nIn this article I will show you how I did this.\n\n\u003C!--more-->\n\nThe users I have to query are stored in a `DataView` (represented by the variable `webUsers`) so that's my starting point.\nFirst, I have to create an instance of the [`UserProfileManager` class](https://learn.microsoft.com/previous-versions/office/developer/sharepoint-2007/ms499834(v=office.12)).\nThis is the connection with the User Profile Database.\n\nThen I iterate the `DataView` and `Cast` every item to the `row` variable.\nIn the `DataRowView` the `AccountName` column contains a `domain\\user` value.\nBecause it is an `object` and I need it multiple times I store it in a locale variable using the `let` keyword so I only have to cast it one time.\n\nOne of the great things is that you are allowed to combine multiple `let`'s and `where` statements. So, every `AccountName` that is `null` or `empty` will be filtered out.\n\nIf I would use the [`GetUserProfile` method](https://learn.microsoft.com/previous-versions/office/developer/sharepoint-2007/ms562764(v=office.12)) and pass an account which is not (yet) present in the profile database, this would result in an exception.\nThat is why I first use a `where` query in combination with the [`UserExists` method](https://learn.microsoft.com/previous-versions/office/developer/sharepoint-2007/ms517538(v=office.12)).\n\nFor readability, I use another `let` to store the value I need in the comparison.\nNow I can create an anonymous object with a `boolean` if the title was equal to `student`, and some other profile properties.\n\n```csharp\nvar profileManager = new UserProfileManager();\nvar users = (from DataRowView row in webUsers\n             let accountName = (string)row[\"AccountName\"]\n             where !string.IsNullOrEmpty(accountName)\n             where profileManager.UserExists(accountName)\n             let userProfile = profileManager.GetUserProfile(accountName)\n             let title = (userProfile[\"Title\"] != null)\n                     ? (string)userProfile[\"Title\"].Value\n                     : string.Empty\n             select new\n             {\n                 IsStudent = title == \"student\",\n                 Initials = (userProfile[\"Initials\"] != null)\n                     ? (string)userProfile[\"Initials\"].Value\n                     : string.Empty,\n                 LastName = (userProfile[\"LastName\"] != null)\n                     ? (string)userProfile[\"LastName\"].Value\n                     : string.Empty,\n             }).AsEnumerable();\n\n\nvar employees = from employee in users\n                where !employee.IsStudent\n                select employee;\n\nvar students = from student in users\n               where student.IsStudent\n               select student;\n```\n\nNow, I can easily get all students and employees in different collections based on that boolean property.\nAnd never call the ProfileManager more than necessary.","src/posts/2009-03-03-using-linq-with-the-moss-userprofilemanager.md","2821be92f8818952",{"html":327,"metadata":328},"\u003Cp>Lately I am working a lot with LINQ and all flavors like LINQ to \u003Cdfn>\u003Cabbr title=\"eXtensible Markup Language\">XML\u003C/abbr>\u003C/dfn>, LINQ to XSD, LINQ to objects, etc.\u003Cbr>\nToday I had to build some functionality in SharePoint where I had to split users in two groups based on a profile property in their User Profile.\u003C/p>\n\u003Cp>In this article I will show you how I did this.\u003C/p>\n\u003C!--more-->\n\u003Cp>The users I have to query are stored in a \u003Ccode>DataView\u003C/code> (represented by the variable \u003Ccode>webUsers\u003C/code>) so that’s my starting point.\nFirst, I have to create an instance of the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/developer/sharepoint-2007/ms499834(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>UserProfileManager\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>.\nThis is the connection with the User Profile Database.\u003C/p>\n\u003Cp>Then I iterate the \u003Ccode>DataView\u003C/code> and \u003Ccode>Cast\u003C/code> every item to the \u003Ccode>row\u003C/code> variable.\nIn the \u003Ccode>DataRowView\u003C/code> the \u003Ccode>AccountName\u003C/code> column contains a \u003Ccode>domain\\user\u003C/code> value.\nBecause it is an \u003Ccode>object\u003C/code> and I need it multiple times I store it in a locale variable using the \u003Ccode>let\u003C/code> keyword so I only have to cast it one time.\u003C/p>\n\u003Cp>One of the great things is that you are allowed to combine multiple \u003Ccode>let\u003C/code>’s and \u003Ccode>where\u003C/code> statements. So, every \u003Ccode>AccountName\u003C/code> that is \u003Ccode>null\u003C/code> or \u003Ccode>empty\u003C/code> will be filtered out.\u003C/p>\n\u003Cp>If I would use the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/developer/sharepoint-2007/ms562764(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>GetUserProfile\u003C/code> method\u003Cspan>\u003C/span>\u003C/a> and pass an account which is not (yet) present in the profile database, this would result in an exception.\nThat is why I first use a \u003Ccode>where\u003C/code> query in combination with the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/developer/sharepoint-2007/ms517538(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>UserExists\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>For readability, I use another \u003Ccode>let\u003C/code> to store the value I need in the comparison.\nNow I can create an anonymous object with a \u003Ccode>boolean\u003C/code> if the title was equal to \u003Ccode>student\u003C/code>, and some other profile properties.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:73ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">profileManager\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">UserProfileManager\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">users\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">from\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">DataRowView\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">row\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">in\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">webUsers\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:13ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">             \u003C/span>\u003Cspan style=\"--0:#569CD6\">let\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">accountName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">row\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"AccountName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:13ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">             \u003C/span>\u003Cspan style=\"--0:#569CD6\">where\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsNullOrEmpty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">accountName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:13ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">             \u003C/span>\u003Cspan style=\"--0:#569CD6\">where\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">profileManager\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">UserExists\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">accountName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:13ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">             \u003C/span>\u003Cspan style=\"--0:#569CD6\">let\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">userProfile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">profileManager\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetUserProfile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">accountName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:13ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">             \u003C/span>\u003Cspan style=\"--0:#569CD6\">let\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">title\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">userProfile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Title\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:21ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                     \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">?\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">userProfile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Title\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">].\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:21ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                     \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Empty\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:13ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">             \u003C/span>\u003Cspan style=\"--0:#569CD6\">select\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:13ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">             \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:17ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                 \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">IsStudent\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">title\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">==\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"student\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:17ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                 \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Initials\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">userProfile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Initials\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:21ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                     \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">?\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">userProfile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Initials\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">].\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:21ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                     \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Empty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:17ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                 \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LastName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">userProfile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LastName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:21ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                     \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">?\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">userProfile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LastName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">].\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:21ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                     \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Empty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:13ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">             \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}).\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">AsEnumerable\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">employees\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">from\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">employee\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">in\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">users\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#569CD6\">where\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">employee\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">IsStudent\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#569CD6\">select\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">employee\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">students\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">from\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">student\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">in\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">users\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:15ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">               \u003C/span>\u003Cspan style=\"--0:#569CD6\">where\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">student\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">IsStudent\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:15ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">               \u003C/span>\u003Cspan style=\"--0:#569CD6\">select\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">student\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var profileManager = new UserProfileManager();var users = (from DataRowView row in webUsers             let accountName = (string)row[&#x22;AccountName&#x22;]             where !string.IsNullOrEmpty(accountName)             where profileManager.UserExists(accountName)             let userProfile = profileManager.GetUserProfile(accountName)             let title = (userProfile[&#x22;Title&#x22;] != null)                     ? (string)userProfile[&#x22;Title&#x22;].Value                     : string.Empty             select new             {                 IsStudent = title == &#x22;student&#x22;,                 Initials = (userProfile[&#x22;Initials&#x22;] != null)                     ? (string)userProfile[&#x22;Initials&#x22;].Value                     : string.Empty,                 LastName = (userProfile[&#x22;LastName&#x22;] != null)                     ? (string)userProfile[&#x22;LastName&#x22;].Value                     : string.Empty,             }).AsEnumerable();var employees = from employee in users                where !employee.IsStudent                select employee;var students = from student in users               where student.IsStudent               select student;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now, I can easily get all students and employees in different collections based on that boolean property.\nAnd never call the ProfileManager more than necessary.\u003C/p>",{"headings":329,"imagePaths":330,"frontmatter":311},[],[],"2007-09-04-using-appconfig-with-project-server-events",{"id":331,"data":333,"body":343,"filePath":344,"digest":345,"rendered":346},{"id":334,"title":335,"date":336,"author":15,"excerpt":337,"layout":17,"permalink":338,"image":339,"categories":340,"tags":341,"draft":26},9,"Using app.config with Project Server Events",["Date","2007-09-04T14:50:00.000Z"],"When building custom Project Server Event Receivers the result is a dll file. Using app.config and the ConfigurationManagement class will not work. Well actually, it’s possible!\n","/2007/09/04/using-appconfig-with-project-server-events/","/wp-content/uploads/2007/09/post-9-thumnail-1.png",[183,21],[228,342,23],"Events","When building custom Project Server Event Receivers, the result is a DLL file. Using app.config and the [`ConfigurationManagement` class](https://learn.microsoft.com/dotnet/api/system.configuration.configurationmanager?view=netframework-2.0) will not work.  \nWell actually it’s possible!\n\nThe `Microsoft Office Project Server Events Service` executable has its own `app.config` where you can add entries.\nIf you go to the Project Server bin directory (default: `C:\\Program Files\\Microsoft Office Servers\\12.0\\Bin`) you will find the config file named `Microsoft.Office.Project.Server.Eventing.exe.config`.\n\nAdd the `appSettings` section like this:\n\n```xml\n\u003Cconfiguration>\n   \u003Cruntime>\n      \u003CassemblyBinding xmlns=\"urn:schemas-microsoft-com:asm.v1\">\n         \u003Cprobing privatePath=\"ProjectServerEventHandlers\"/>\n      \u003C/assemblyBinding>\n   \u003C/runtime>\n   \u003CappSettings>\n      \u003Cadd key=\"SSP Location\" value=\"http://localhost:56737/SharedServices1\" />\n   \u003C/appSettings>\n\u003C/configuration>\n```\n\nand your application can happily use the following syntax:\n\n```csharp\nConfigurationManager.AppSettings[\"SSP Location\"]\n```\n\nThis can make your event just a bit easier to deploy in different configurations without the recompiling or use of extra configuration libraries.","src/posts/2007-09-04-using-appconfig-with-project-server-events.md","0d231d0078452ef0",{"html":347,"metadata":348},"\u003Cp>When building custom Project Server Event Receivers, the result is a \u003Cdfn>\u003Cabbr title=\"Dynamic Link Library\">DLL\u003C/abbr>\u003C/dfn> file. Using app.config and the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.configuration.configurationmanager?view=netframework-2.0&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ConfigurationManagement\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> will not work.\u003Cbr>\nWell actually it’s possible!\u003C/p>\n\u003Cp>The \u003Ccode>Microsoft Office Project Server Events Service\u003C/code> executable has its own \u003Ccode>app.config\u003C/code> where you can add entries.\nIf you go to the Project Server bin directory (default: \u003Ccode>C:\\Program Files\\Microsoft Office Servers\\12.0\\Bin\u003C/code>) you will find the config file named \u003Ccode>Microsoft.Office.Project.Server.Eventing.exe.config\u003C/code>.\u003C/p>\n\u003Cp>Add the \u003Ccode>appSettings\u003C/code> section like this:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:79ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">configuration\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:3ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">   \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">runtime\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">assemblyBinding\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">xmlns\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"urn:schemas-microsoft-com:asm.v1\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:9ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">         \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">probing\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">privatePath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"ProjectServerEventHandlers\"\u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">assemblyBinding\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:3ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">   \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">runtime\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:3ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">   \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">appSettings\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">add\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">key\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"SSP Location\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"http://localhost:56737/SharedServices1\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:3ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">   \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">appSettings\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">configuration\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003Cconfiguration>   \u003Cruntime>      \u003CassemblyBinding xmlns=&#x22;urn:schemas-microsoft-com:asm.v1&#x22;>         \u003Cprobing privatePath=&#x22;ProjectServerEventHandlers&#x22;/>      \u003C/assemblyBinding>   \u003C/runtime>   \u003CappSettings>      \u003Cadd key=&#x22;SSP Location&#x22; value=&#x22;http://localhost:56737/SharedServices1&#x22; />   \u003C/appSettings>\u003C/configuration>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>and your application can happily use the following syntax:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:48ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">ConfigurationManager\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">AppSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"SSP Location\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"ConfigurationManager.AppSettings[&#x22;SSP Location&#x22;]\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This can make your event just a bit easier to deploy in different configurations without the recompiling or use of extra configuration libraries.\u003C/p>",{"headings":349,"imagePaths":350,"frontmatter":333},[],[],"2007-09-04-textbox-process-accounts-with-access-to-the-ssp-doesnt-exist",{"id":351,"data":353,"body":364,"filePath":365,"digest":366,"rendered":367},{"id":354,"title":355,"date":356,"author":15,"excerpt":357,"layout":17,"permalink":358,"image":359,"categories":360,"tags":361,"draft":26},8,"Textbox “Process Accounts with Access to the SSP” doesn’t exist",["Date","2007-09-04T13:23:00.000Z"],"I had a lot of trouble using impersonation with the PSI web services in Project Server 2007. I found some posts on the web suggesting that you need to add the account to the “Process Accounts with Access to the SSP” textbox, but guess what? That box was nowhere to find!\n","/2007/09/04/textbox-process-accounts-with-access-to-the-ssp-doesnt-exist/","/wp-content/uploads/2007/09/post-8-thumnail-1.png",[21],[23,362,363,66],"SSP","stsadm","I had a lot of trouble using impersonation with the PSI web services in Project Server 2007. I found some posts on the web suggesting that you need to add the account to the `Process Accounts with Access to the SSP` textbox, but guess what? That box was nowhere to be found!\n\nI found one post in the [Setup/Installation Related FAQ's](https://web.archive.org/web/20101012014536/https://pstfsconnector.codeplex.com/wikipage?title=Setup%2fInstallation%20Related%20FAQ%27s&referringTitle=Home) of the \"Project Server 2007 VSTS Connector\" on CodePlex.\nIt says:\n\n> Sometimes the textbox for \"Process Accounts with Access to the SSP\" will not exist on the web page. To add the account in this circumstance, go to the command line, navigate to Program Files\\Common Files\\Microsoft Shared\\web server extensions\\12\\BIN and run:\n>\n> stsadm.exe -o editssp -title &lt;sspname&gt; -setaccounts &lt;accounts&gt;\n\nSo, since my SSP is called `SharedServices1` to following line did miracles:\n\n```shell\nstsadm.exe -o editssp -title SharedServices1 -setaccounts domain\\user\n```\n\nReading the [documentation](https://learn.microsoft.com/previous-versions/office/sharepoint-2007-products-and-technologies/cc262727(v=office.12)) of the `stsadm` application, it mentions that \"New process accounts should be appended to the existing list\".\nSo, if you execute the above line any existing configuration of accounts will be gone.\n\nTo view a list of current configured account you can use the `-enumssp` option:\n\n```shell\nstsadm.exe -o enumssp -title SharedServices1\n```\n\nThis will return the details of the SSP (in XML):\n\n```xml\n\u003Cssps>\n  \u003Cssp name=\"SharedServices1\" default=\"true\" ssl=\"False\" status=\"Online\">\n    \u003Caccount username=\"NT AUTHORITY\\NETWORK SERVICE\" />\n    \u003Csite type=\"Administration\" url=\"http://server:4389/ssp/admin\" />\n    \u003Cdatabase type=\"ServiceDatabase\"\n              server=\"server\\OfficeServers\"\n              name=\"SharedServices1_DB_2b6d2c6a-2374-4f0f-8d1e-e4577988aa80\"\n              authentication=\"Windows\">\n    \u003Cprocessaccounts>\n      \u003Caccount username=\"domain\\user\">\n    \u003C/processaccounts>\n    \u003Cassociatedwebapplications>\n      \u003Cwebapplication name=\"SharePoint - 4389\" url=\"http://server:4389/\" />\n      \u003Cwebapplication name=\"SharePoint - 80\" url=\"http://server/\" />\n    \u003C/associatedwebapplications>\n  \u003C/ssp>\n\u003C/ssps>\n```\n\nYou can use this to prevent loss of your current configured accounts.","src/posts/2007-09-04-textbox-process-accounts-with-access-to-the-ssp-doesnt-exist.md","5f16f7f954bc6398",{"html":368,"metadata":369},"\u003Cp>I had a lot of trouble using impersonation with the \u003Cdfn>\u003Cabbr title=\"Project Server Interface\">PSI\u003C/abbr>\u003C/dfn> web services in Project Server 2007. I found some posts on the web suggesting that you need to add the account to the \u003Ccode>Process Accounts with Access to the SSP\u003C/code> textbox, but guess what? That box was nowhere to be found!\u003C/p>\n\u003Cp>I found one post in the \u003Ca href=\"https://web.archive.org/web/20101012014536/https://pstfsconnector.codeplex.com/wikipage?title=Setup%2fInstallation%20Related%20FAQ%27s&#x26;referringTitle=Home\" rel=\"noopener noreferrer external\" target=\"_blank\">Setup/Installation Related FAQ’s\u003Cspan>\u003C/span>\u003C/a> of the “Project Server 2007 \u003Cdfn>\u003Cabbr title=\"Visual Studio Team Services\">VSTS\u003C/abbr>\u003C/dfn> Connector” on CodePlex.\nIt says:\u003C/p>\n\u003Cblockquote>\n\u003Cp>Sometimes the textbox for “Process Accounts with Access to the \u003Cdfn>\u003Cabbr title=\"Shared Service Provider\">SSP\u003C/abbr>\u003C/dfn>” will not exist on the web page. To add the account in this circumstance, go to the command line, navigate to Program Files\\Common Files\\Microsoft Shared\\web server extensions\\12\\BIN and run:\u003C/p>\n\u003Cp>stsadm.exe -o editssp -title &#x3C;sspname> -setaccounts &#x3C;accounts>\u003C/p>\n\u003C/blockquote>\n\u003Cp>So, since my \u003Cabbr title=\"Shared Service Provider\">SSP\u003C/abbr> is called \u003Ccode>SharedServices1\u003C/code> to following line did miracles:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:69ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">stsadm.exe\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-o\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">editssp\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-title\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">SharedServices1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-setaccounts\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">domain\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\u\u003C/span>\u003Cspan style=\"--0:#CE9178\">ser\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"stsadm.exe -o editssp -title SharedServices1 -setaccounts domain\\user\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Reading the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-2007-products-and-technologies/cc262727(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">documentation\u003Cspan>\u003C/span>\u003C/a> of the \u003Ccode>stsadm\u003C/code> application, it mentions that “New process accounts should be appended to the existing list”.\nSo, if you execute the above line any existing configuration of accounts will be gone.\u003C/p>\n\u003Cp>To view a list of current configured account you can use the \u003Ccode>-enumssp\u003C/code> option:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:44ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">stsadm.exe\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-o\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">enumssp\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-title\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">SharedServices1\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"stsadm.exe -o enumssp -title SharedServices1\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This will return the details of the \u003Cabbr title=\"Shared Service Provider\">SSP\u003C/abbr> (in \u003Cdfn>\u003Cabbr title=\"eXtensible Markup Language\">XML\u003C/abbr>\u003C/dfn>):\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:76ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ssps\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ssp\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"SharedServices1\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">default\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"true\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ssl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"False\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">status\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Online\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">account\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">username\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"NT AUTHORITY\\NETWORK SERVICE\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">site\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">type\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Administration\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">url\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"http://server:4389/ssp/admin\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">database\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">type\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"ServiceDatabase\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:14ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">              \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">server\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"server\\OfficeServers\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:14ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">              \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"SharedServices1_DB_2b6d2c6a-2374-4f0f-8d1e-e4577988aa80\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:14ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">              \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">authentication\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Windows\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">processaccounts\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">account\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">username\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"domain\\user\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">processaccounts\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">associatedwebapplications\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">webapplication\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"SharePoint - 4389\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">url\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"http://server:4389/\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">webapplication\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"SharePoint - 80\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">url\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"http://server/\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">associatedwebapplications\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">ssp\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">ssps\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003Cssps>  \u003Cssp name=&#x22;SharedServices1&#x22; default=&#x22;true&#x22; ssl=&#x22;False&#x22; status=&#x22;Online&#x22;>    \u003Caccount username=&#x22;NT AUTHORITY\\NETWORK SERVICE&#x22; />    \u003Csite type=&#x22;Administration&#x22; url=&#x22;http://server:4389/ssp/admin&#x22; />    \u003Cdatabase type=&#x22;ServiceDatabase&#x22;              server=&#x22;server\\OfficeServers&#x22;              name=&#x22;SharedServices1_DB_2b6d2c6a-2374-4f0f-8d1e-e4577988aa80&#x22;              authentication=&#x22;Windows&#x22;>    \u003Cprocessaccounts>      \u003Caccount username=&#x22;domain\\user&#x22;>    \u003C/processaccounts>    \u003Cassociatedwebapplications>      \u003Cwebapplication name=&#x22;SharePoint - 4389&#x22; url=&#x22;http://server:4389/&#x22; />      \u003Cwebapplication name=&#x22;SharePoint - 80&#x22; url=&#x22;http://server/&#x22; />    \u003C/associatedwebapplications>  \u003C/ssp>\u003C/ssps>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>You can use this to prevent loss of your current configured accounts.\u003C/p>",{"headings":370,"imagePaths":371,"frontmatter":353},[],[],"2009-03-04-cs0122-x-is-inaccessible-due-to-its-protection-level-but-you-dont-want-to-go-public",{"id":372,"data":374,"body":387,"filePath":388,"digest":389,"rendered":390},{"id":375,"title":376,"date":377,"author":15,"excerpt":378,"layout":17,"permalink":379,"image":380,"categories":381,"tags":382,"draft":26},15,"“CS0122: ‘x’ is inaccessible due to its protection level” but you don’t want to go public",["Date","2009-03-04T10:00:16.000Z"],"Sometimes you have to split your code into different assemblies. For example when I created a custom Admin Page which inherits from WebAdminPageBase (Microsoft.SharePoint.ApplicationPages). The problem with Microsoft.SharePoint.ApplicationPages is that it's not deployed to the GAC. When compiling you will get the following message: “CS0122: 'foo.bar.x' is inaccessible due to its protection level”\nNow you have only one choice: make x public. Or maybe not?\n","/2009/03/04/cs0122-x-is-inaccessible-due-to-its-protection-level-but-you-dont-want-to-go-public/","/wp-content/uploads/2009/03/post-15-thumnail-1.png",[183,132,271],[187,383,384,385,386],"Internal","InternalsVisibleTo","public key","sn","Sometimes you have to split your code into different assemblies.\nFor example, when I created a custom `Admin Page` which inherits from `WebAdminPageBase` (`Microsoft.SharePoint.ApplicationPages`).\n\nThe problem with `Microsoft.SharePoint.ApplicationPages` is that it’s not deployed to the GAC.\n\n\u003C!--more-->\n\nPutting a reference to this assembly from my assembly,\nalso containing custom web parts and other controls which have to be registered as `SafeControls` in the `web.config`,\nwill result in deployment troubles when you use a WSP file.\nThe problem is when SharePoint is going to register the safe controls,\nit will reflect your assembly and will not be able to access the `Microsoft.SharePoint.ApplicationPages` assembly because it is not available in the GAC.  \nThe same problem can be found using the `Content Deployment` option.\n\nSo, you split your code in 2 assemblies, for example `foo.bar` and `foo.bar.ApplicationPages`.\nBut when your custom application page is depending on an internal type declared in `foo.bar` you are in trouble.\nWhen compiling you will get the following message:\n\n```plain\nCS0122: 'foo.bar.x' is inaccessible due to its protection level\n```\n\nNow you have only one choice: make `x` public. Or maybe not?\n\n### The solution\n\nIt is also possible to make your assembly share their internals with other assemblies. Add the following to you code (in `foo.bar`):\n\n```csharp\n[assembly: InternalsVisibleTo(\"foo.bar.ApplicationPages, PublicKey=0a240a … c2f34c7\")]\n```\n\nBut the public key is not your public key token.\nThanks to Burt Harris’s comment at the [`InternalsVisibleToAttribute` class](https://learn.microsoft.com/en-us/dotnet/api/system.runtime.compilerservices.internalsvisibletoattribute?view=net-5.0),\nyou can find your real public key using the following command:\n\n```shell\nsn.exe -Tp foo.bar.dll\n```\n\nNow compile your project and there you go!","src/posts/2009-03-04-cs0122-x-is-inaccessible-due-to-its-protection-level-but-you-dont-want-to-go-public.md","554b0665dbb4886f",{"html":391,"metadata":392},"\u003Cp>Sometimes you have to split your code into different assemblies.\nFor example, when I created a custom \u003Ccode>Admin Page\u003C/code> which inherits from \u003Ccode>WebAdminPageBase\u003C/code> (\u003Ccode>Microsoft.SharePoint.ApplicationPages\u003C/code>).\u003C/p>\n\u003Cp>The problem with \u003Ccode>Microsoft.SharePoint.ApplicationPages\u003C/code> is that it’s not deployed to the \u003Cdfn>\u003Cabbr title=\"Global Assembly Cache\">GAC\u003C/abbr>\u003C/dfn>.\u003C/p>\n\u003C!--more-->\n\u003Cp>Putting a reference to this assembly from my assembly,\nalso containing custom web parts and other controls which have to be registered as \u003Ccode>SafeControls\u003C/code> in the \u003Ccode>web.config\u003C/code>,\nwill result in deployment troubles when you use a WSP file.\nThe problem is when SharePoint is going to register the safe controls,\nit will reflect your assembly and will not be able to access the \u003Ccode>Microsoft.SharePoint.ApplicationPages\u003C/code> assembly because it is not available in the \u003Cabbr title=\"Global Assembly Cache\">GAC\u003C/abbr>.\u003Cbr>\nThe same problem can be found using the \u003Ccode>Content Deployment\u003C/code> option.\u003C/p>\n\u003Cp>So, you split your code in 2 assemblies, for example \u003Ccode>foo.bar\u003C/code> and \u003Ccode>foo.bar.ApplicationPages\u003C/code>.\nBut when your custom application page is depending on an internal type declared in \u003Ccode>foo.bar\u003C/code> you are in trouble.\nWhen compiling you will get the following message:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:63ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">CS0122: 'foo.bar.x' is inaccessible due to its protection level\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"CS0122: &#x27;foo.bar.x&#x27; is inaccessible due to its protection level\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now you have only one choice: make \u003Ccode>x\u003C/code> public. Or maybe not?\u003C/p>\n\u003Ch3 id=\"the-solution\">The solution\u003C/h3>\n\u003Cp>It is also possible to make your assembly share their internals with other assemblies. Add the following to you code (in \u003Ccode>foo.bar\u003C/code>):\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:86ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#569CD6\">assembly\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">InternalsVisibleTo\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"foo.bar.ApplicationPages, PublicKey=0a240a … c2f34c7\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)]\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[assembly: InternalsVisibleTo(&#x22;foo.bar.ApplicationPages, PublicKey=0a240a … c2f34c7&#x22;)]\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>But the public key is not your public key token.\nThanks to Burt Harris’s comment at the \u003Ca href=\"https://learn.microsoft.com/en-us/dotnet/api/system.runtime.compilerservices.internalsvisibletoattribute?view=net-5.0&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>InternalsVisibleToAttribute\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>,\nyou can find your real public key using the following command:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:22ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">sn.exe\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-Tp\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">foo.bar.dll\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"sn.exe -Tp foo.bar.dll\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now compile your project and there you go!\u003C/p>",{"headings":393,"imagePaths":395,"frontmatter":374},[394],{"depth":198,"slug":258,"text":259},[],"2009-03-25-generate-integer-lists-using-linq",{"id":396,"data":398,"body":409,"filePath":410,"digest":411,"rendered":412},{"id":399,"title":400,"date":401,"author":15,"excerpt":402,"layout":17,"permalink":403,"image":404,"categories":405,"tags":406,"draft":26},20,"Generate integer lists using LINQ",["Date","2009-03-25T13:35:00.000Z"],"I was working on some old code which created three DropDown controls with hours, minutes and seconds. I wanted to LINQify it using the LINQ Range method.\n","/2009/03/25/generate-integer-lists-using-linq/","/wp-content/uploads/2009/03/post-20-thumnail-1.png",[183],[407,320,408],"IEnumerable","Range","I was working on some old code which created three DropDown controls with _hours_, _minutes_, and _seconds_.\n\n\u003C!--more-->\n\nThis was the original code:\n\n```csharp\nfor (var i = 0; i \u003C 24; i++)\n{\n    Hour.Items.Add(new ListItem(i.ToString()));\n}\n\nfor (var i = 0; i \u003C 60; i++)\n{\n    Minute.Items.Add(new ListItem(i.ToString()));\n    Second.Items.Add(new ListItem(i.ToString()));\n}\n```\n\nI wanted to \"LINQify\" this code using the LINQ range method:\n\n```csharp\nEnumerable.Range(int start, int count)\n```\n\nThis returns an `IEnumerable\u003Cint>` collection with the corresponding range of values.\nSo, my DropDown controls are now created with the following code:\n\n```csharp\nHour.Items.AddRange(\n    Enumerable\n        .Range(0, 24)\n        .Select(i => new ListItem(i.ToString())).ToArray());\n\nMinute.Items.AddRange(\n    Enumerable\n        .Range(0, 60)\n        .Select(i => new ListItem(i.ToString())).ToArray());\n\nSecond.Items.AddRange(\n    Enumerable\n        .Range(0, 60)\n        .Select(i => new ListItem(i.ToString())).ToArray());\n```\n\nThis could be optimized by using a variable for the sixty values which could be used twice.","src/posts/2009-03-25-generate-integer-lists-using-linq.md","3f4db712ed4130f9",{"html":413,"metadata":414},"\u003Cp>I was working on some old code which created three DropDown controls with \u003Cem>hours\u003C/em>, \u003Cem>minutes\u003C/em>, and \u003Cem>seconds\u003C/em>.\u003C/p>\n\u003C!--more-->\n\u003Cp>This was the original code:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:49ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">for\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">24\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">++\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Hour\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Items\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Add\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ListItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">()));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">for\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">60\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">++\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Minute\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Items\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Add\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ListItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">()));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Second\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Items\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Add\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ListItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">()));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"for (var i = 0; i \u003C 24; i++){    Hour.Items.Add(new ListItem(i.ToString()));}for (var i = 0; i \u003C 60; i++){    Minute.Items.Add(new ListItem(i.ToString()));    Second.Items.Add(new ListItem(i.ToString()));}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>I wanted to “LINQify” this code using the LINQ range method:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:38ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">Enumerable\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Range\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">int\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">start\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#569CD6\">int\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">count\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Enumerable.Range(int start, int count)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This returns an \u003Ccode>IEnumerable&#x3C;int>\u003C/code> collection with the corresponding range of values.\nSo, my DropDown controls are now created with the following code:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:60ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">Hour\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Items\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">AddRange\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Enumerable\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Range\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">24\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Select\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ListItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">())).\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToArray\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">());\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">Minute\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Items\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">AddRange\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Enumerable\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Range\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">60\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Select\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ListItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">())).\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToArray\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">());\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">Second\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Items\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">AddRange\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Enumerable\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Range\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">60\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Select\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ListItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">())).\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToArray\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">());\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Hour.Items.AddRange(    Enumerable        .Range(0, 24)        .Select(i => new ListItem(i.ToString())).ToArray());Minute.Items.AddRange(    Enumerable        .Range(0, 60)        .Select(i => new ListItem(i.ToString())).ToArray());Second.Items.AddRange(    Enumerable        .Range(0, 60)        .Select(i => new ListItem(i.ToString())).ToArray());\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This could be optimized by using a variable for the sixty values which could be used twice.\u003C/p>",{"headings":415,"imagePaths":416,"frontmatter":398},[],[],"2009-03-12-access-denied-when-crawling-mysite-people-on-localhost-with-a-different-hostname",{"id":417,"data":419,"body":431,"filePath":432,"digest":433,"rendered":434},{"id":420,"title":421,"date":422,"author":15,"excerpt":423,"layout":17,"permalink":424,"image":425,"categories":426,"tags":427,"draft":26},17,"Access Denied when crawling mysite / people on localhost with a different hostname",["Date","2009-03-12T21:55:34.000Z"],"I have a clean install on the latest and greatest: Windows Server 2008, SQL Server 2008 and MOSS 2007 SP1 with all updates. Everything works fine, except the search crawl gave Access Denied errors on http://mysite and sps3://mysite. This post explains how I fixed the problem.\n","/2009/03/12/access-denied-when-crawling-mysite-people-on-localhost-with-a-different-hostname/","/wp-content/uploads/2009/03/post-17-thumnail-1.png",[132,240],[135,187,428,429,430,138,139,163],"Local loopback","MySite","regedit","I have a clean install on the latest and greatest: Windows Server 2008, SQL Server 2008 and MOSS 2007 SP1 with all updates.\nThis is the layout of my farm:\n\n```plain\nhttp://\u003Cserver>:80   - Portal  \nhttp://\u003Cserver>:8000 - Central Admin  \nhttp://\u003Cserver>:8001 - SSP\nhttp://mysite        - MySites\n```\n\nEverything works fine, except the search crawl gave Access Denied errors on `http://mysite` and `sps3://mysite`.\n\n\u003C!--more-->\n\nI checked everything, but could only find this in the Application event log:\n\n```plain\nThe start address \u003Chttp://mysite> cannot be crawled.\nContext: Application 'SharedServices1', Catalog 'Portal_Content'\nDetails:\nAccess is denied. Check that the Default Content Access Account\nhas access to this content, or add a crawl rule to crawl this\ncontent.   (0x80041205)\n```\n\nAlso the Security event log says:\n\n```plain\nAn account failed to log on.\nSubject:\nSecurity ID:              NULL SID\nAccount Name:             -\nAccount Domain:           -\nLogon ID:                 0x0\nLogon Type:               3\nAccount For Which Logon Failed:\nSecurity ID:              NULL SID\nAccount Name:             \u003CDCA account>\nAccount Domain:           \u003CDomain>\nFailure Information:\nFailure Reason:           An Error occured during Logon.\nStatus:                   0xc000006d\nSub Status:               0x0\nProcess Information:\nCaller Process ID:        0x0\nCaller Process Name:      -\nNetwork Information:\nWorkstation Name:         \u003CServer>\nSource Network Address:   127.0.0.1\nSource Port:              50678\nDetailed Authentication Information:\nLogon Process:\nAuthentication Package:   NTLM\nTransited Services:       -\nPackage Name (NTLM only): -\nKey Length:               0\n```\n\nI had a hard time finding the solution, until I encountered Ron Grzywacz's Blog:\n[Crawling Issue with .NET 3.5 SP1](https://techcommunity.microsoft.com/blog/coreinfrastructureandsecurityblog/crawling-issue-with-net-3-5-sp1/333193).\n\nAlthough **KB896861** only mentions Windows XP and Windows Server 2003, it seems to fix the issue on Windows Server 2008 as well.\n\nSo to fix this:\n\n1. Click **Start**, click **Run**, type `regedit`, and then click **OK**\n2. In Registry Editor, locate and then click the following registry key: `HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0`\n3. Right-click **MSV1_0**, point to **New**, and then click **Multi-String Value**\n4. Type `BackConnectionHostNames`, and then press ENTER.\n5. Right-click **BackConnectionHostNames**, and then click **Modify**\n6. In the **Value data** box, type the host name or the host names for the sites that are on the local computer, and then click **OK**\n7. Quit the Registry Editor, and then restart the IISAdmin service\n\nIt worked immediately!","src/posts/2009-03-12-access-denied-when-crawling-mysite-people-on-localhost-with-a-different-hostname.md","ea26eba952528b49",{"html":435,"metadata":436},"\u003Cp>I have a clean install on the latest and greatest: Windows Server 2008, \u003Cdfn>\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr>\u003C/dfn> Server 2008 and MOSS 2007 \u003Cdfn>\u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr>\u003C/dfn> with all updates.\nThis is the layout of my farm:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:36ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">http://&#x3C;server>:80   - Portal\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">http://&#x3C;server>:8000 - Central Admin\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">http://&#x3C;server>:8001 - SSP\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">http://mysite        - MySites\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"http://\u003Cserver>:80   - Portalhttp://\u003Cserver>:8000 - Central Adminhttp://\u003Cserver>:8001 - SSPhttp://mysite        - MySites\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Everything works fine, except the search crawl gave Access Denied errors on \u003Ccode>http://mysite\u003C/code> and \u003Ccode>sps3://mysite\u003C/code>.\u003C/p>\n\u003C!--more-->\n\u003Cp>I checked everything, but could only find this in the Application event log:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:64ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">The start address &#x3C;http://mysite> cannot be crawled.\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Context: Application 'SharedServices1', Catalog 'Portal_Content'\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Details:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Access is denied. Check that the Default Content Access Account\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">has access to this content, or add a crawl rule to crawl this\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">content.   (0x80041205)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"The start address \u003Chttp://mysite> cannot be crawled.Context: Application &#x27;SharedServices1&#x27;, Catalog &#x27;Portal_Content&#x27;Details:Access is denied. Check that the Default Content Access Accounthas access to this content, or add a crawl rule to crawl thiscontent.   (0x80041205)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Also the Security event log says:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:56ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">An account failed to log on.\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Subject:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Security ID:              NULL SID\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Account Name:             -\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Account Domain:           -\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Logon ID:                 0x0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Logon Type:               3\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Account For Which Logon Failed:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Security ID:              NULL SID\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Account Name:             &#x3C;DCA account>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Account Domain:           &#x3C;Domain>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Failure Information:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Failure Reason:           An Error occured during Logon.\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Status:                   0xc000006d\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Sub Status:               0x0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Process Information:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Caller Process ID:        0x0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Caller Process Name:      -\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Network Information:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Workstation Name:         &#x3C;Server>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Source Network Address:   127.0.0.1\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Source Port:              50678\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Detailed Authentication Information:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Logon Process:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Authentication Package:   NTLM\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Transited Services:       -\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Package Name (NTLM only): -\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">Key Length:               0\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"An account failed to log on.Subject:Security ID:              NULL SIDAccount Name:             -Account Domain:           -Logon ID:                 0x0Logon Type:               3Account For Which Logon Failed:Security ID:              NULL SIDAccount Name:             \u003CDCA account>Account Domain:           \u003CDomain>Failure Information:Failure Reason:           An Error occured during Logon.Status:                   0xc000006dSub Status:               0x0Process Information:Caller Process ID:        0x0Caller Process Name:      -Network Information:Workstation Name:         \u003CServer>Source Network Address:   127.0.0.1Source Port:              50678Detailed Authentication Information:Logon Process:Authentication Package:   NTLMTransited Services:       -Package Name (NTLM only): -Key Length:               0\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>I had a hard time finding the solution, until I encountered Ron Grzywacz’s Blog:\n\u003Ca href=\"https://techcommunity.microsoft.com/blog/coreinfrastructureandsecurityblog/crawling-issue-with-net-3-5-sp1/333193?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Crawling Issue with .NET 3.5 \u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr>\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>Although \u003Cstrong>KB896861\u003C/strong> only mentions Windows XP and Windows Server 2003, it seems to fix the issue on Windows Server 2008 as well.\u003C/p>\n\u003Cp>So to fix this:\u003C/p>\n\u003Col>\n\u003Cli>Click \u003Cstrong>Start\u003C/strong>, click \u003Cstrong>Run\u003C/strong>, type \u003Ccode>regedit\u003C/code>, and then click \u003Cstrong>OK\u003C/strong>\u003C/li>\n\u003Cli>In Registry Editor, locate and then click the following registry key: \u003Ccode>HKEY_LOCAL_MACHINE\\SYSTEM\\CurrentControlSet\\Control\\Lsa\\MSV1_0\u003C/code>\u003C/li>\n\u003Cli>Right-click \u003Cstrong>MSV1_0\u003C/strong>, point to \u003Cstrong>New\u003C/strong>, and then click \u003Cstrong>Multi-String Value\u003C/strong>\u003C/li>\n\u003Cli>Type \u003Ccode>BackConnectionHostNames\u003C/code>, and then press ENTER.\u003C/li>\n\u003Cli>Right-click \u003Cstrong>BackConnectionHostNames\u003C/strong>, and then click \u003Cstrong>Modify\u003C/strong>\u003C/li>\n\u003Cli>In the \u003Cstrong>Value data\u003C/strong> box, type the host name or the host names for the sites that are on the local computer, and then click \u003Cstrong>OK\u003C/strong>\u003C/li>\n\u003Cli>Quit the Registry Editor, and then restart the IISAdmin service\u003C/li>\n\u003C/ol>\n\u003Cp>It worked immediately!\u003C/p>",{"headings":437,"imagePaths":438,"frontmatter":419},[],[],"2010-02-02-prevent-user-to-recall-or-delete-a-timesheet-after-approving",{"id":439,"data":441,"body":452,"filePath":453,"digest":454,"rendered":455},{"id":442,"title":443,"date":444,"author":15,"excerpt":445,"layout":17,"permalink":446,"image":447,"categories":448,"tags":449,"draft":26},99,"Prevent user to recall or delete a timesheet after approving",["Date","2010-02-02T12:49:30.000Z"],"Working on a Project Server project we discovered it's quite easy to get issues with data integrity when users start retracting and deleting timesheets. After discussing the issue with Microsoft they gave us a workaround which solves our problem.\n","/2010/02/02/prevent-user-to-recall-or-delete-a-timesheet-after-approving/","/wp-content/uploads/2010/02/post-99-thumnail-1.png",[21],[450,23,65,451],"Microsoft","Timesheet","Working on a Project Server project we discovered it is quite easy to get issues with data integrity when users start retracting and deleting timesheets.\r\nAfter discussing the issue with Microsoft, they gave us a workaround which solves our problem.\r\n\r\n\u003C!--more-->\r\n\r\n### The problem\r\n\r\nAfter a user has submitted a timesheet and the timesheet manager approves this timesheet as well, the data is exported to an external system for invoicing.\r\n\r\nHowever, the user is still is able to retract the timesheet, modify it and resubmit it.\r\nIt is even possible to delete the timesheet.\r\n\r\nOur first thought was to close the period of the submitted timesheets.\r\nBut this only works partially. The user cannot modify the timesheet anymore, but is still able to retract and delete it. Not a very solid solution.\r\n\r\n### The cause\r\n\r\nAfter discussing the issue with Microsoft, we got this response:\r\n\r\n> Period close is designed to block new entries, not changes which include deletions.\r\n\r\nSo, this is pretty much \"*by design*\".\r\n\r\n### The solution\r\n\r\nLucky enough for us the answer of Microsoft did not stop there:\r\n\r\n> There is a Flag field in the PSI dataset that is called `TS_IS_PROCESSED`.\r\n>\r\n> This can be set by a custom event or script when the period is closed for timesheets within the period or as originally designed,\r\n> when the timesheet has been exported to a third-party system for processing.\r\n>\r\n> In 2007, we are looking at the data from a position where the system of record can modify the data and to help customers determine when Project Server is no longer the system of record,\r\n> we are leaving it up to the customer to check that flag.\r\n>\r\n> After the flag is set to true then no action can be performed on the timesheet except by duly authorized system administrators for adjustments theoretically coming from the third-party system.\r\n\r\nI already knew about the [`TS_IS_PROCESSED` property](https://learn.microsoft.com/previous-versions/office/ms507406(v=office.14)) as it is described by the **Project Server SDK**.\r\nBut the description there only states:\r\n\r\n> Indicates whether the timesheet is finalized and should not be changed.\r\n>\r\n> When `TS_IS_PROCESSED` is `true`, the timesheet cannot be recalled, changed, or deleted.\r\n\r\nThe, important, missing piece of information is that this field is supposed to be altered by custom code instead of Project Server itself.\r\n\r\nThis allows us to lock the timesheet when it is appropriate to do so.","src/posts/2010-02-02-prevent-user-to-recall-or-delete-a-timesheet-after-approving.md","a6e87a0cc0dfe632",{"html":456,"metadata":457},"\u003Cp>Working on a Project Server project we discovered it is quite easy to get issues with data integrity when users start retracting and deleting timesheets.\r\nAfter discussing the issue with Microsoft, they gave us a workaround which solves our problem.\u003C/p>\n\u003C!--more-->\n\u003Ch3 id=\"the-problem\">The problem\u003C/h3>\n\u003Cp>After a user has submitted a timesheet and the timesheet manager approves this timesheet as well, the data is exported to an external system for invoicing.\u003C/p>\n\u003Cp>However, the user is still is able to retract the timesheet, modify it and resubmit it.\r\nIt is even possible to delete the timesheet.\u003C/p>\n\u003Cp>Our first thought was to close the period of the submitted timesheets.\r\nBut this only works partially. The user cannot modify the timesheet anymore, but is still able to retract and delete it. Not a very solid solution.\u003C/p>\n\u003Ch3 id=\"the-cause\">The cause\u003C/h3>\n\u003Cp>After discussing the issue with Microsoft, we got this response:\u003C/p>\n\u003Cblockquote>\n\u003Cp>Period close is designed to block new entries, not changes which include deletions.\u003C/p>\n\u003C/blockquote>\n\u003Cp>So, this is pretty much “\u003Cem>by design\u003C/em>”.\u003C/p>\n\u003Ch3 id=\"the-solution\">The solution\u003C/h3>\n\u003Cp>Lucky enough for us the answer of Microsoft did not stop there:\u003C/p>\n\u003Cblockquote>\n\u003Cp>There is a Flag field in the \u003Cdfn>\u003Cabbr title=\"Project Server Interface\">PSI\u003C/abbr>\u003C/dfn> dataset that is called \u003Ccode>TS_IS_PROCESSED\u003C/code>.\u003C/p>\n\u003Cp>This can be set by a custom event or script when the period is closed for timesheets within the period or as originally designed,\r\nwhen the timesheet has been exported to a third-party system for processing.\u003C/p>\n\u003Cp>In 2007, we are looking at the data from a position where the system of record can modify the data and to help customers determine when Project Server is no longer the system of record,\r\nwe are leaving it up to the customer to check that flag.\u003C/p>\n\u003Cp>After the flag is set to true then no action can be performed on the timesheet except by duly authorized system administrators for adjustments theoretically coming from the third-party system.\u003C/p>\n\u003C/blockquote>\n\u003Cp>I already knew about the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/ms507406(v=office.14)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>TS_IS_PROCESSED\u003C/code> property\u003Cspan>\u003C/span>\u003C/a> as it is described by the \u003Cstrong>Project Server \u003Cdfn>\u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/dfn>\u003C/strong>.\r\nBut the description there only states:\u003C/p>\n\u003Cblockquote>\n\u003Cp>Indicates whether the timesheet is finalized and should not be changed.\u003C/p>\n\u003Cp>When \u003Ccode>TS_IS_PROCESSED\u003C/code> is \u003Ccode>true\u003C/code>, the timesheet cannot be recalled, changed, or deleted.\u003C/p>\n\u003C/blockquote>\n\u003Cp>The, important, missing piece of information is that this field is supposed to be altered by custom code instead of Project Server itself.\u003C/p>\n\u003Cp>This allows us to lock the timesheet when it is appropriate to do so.\u003C/p>",{"headings":458,"imagePaths":464,"frontmatter":441},[459,460,463],{"depth":198,"slug":255,"text":256},{"depth":198,"slug":461,"text":462},"the-cause","The cause",{"depth":198,"slug":258,"text":259},[],"2010-01-11-wss-3-0-sharepoint-2007-and-project-server-sp1-support-ends-soon",{"id":465,"data":467,"body":479,"filePath":480,"digest":481,"rendered":482},{"id":468,"title":469,"date":470,"author":15,"excerpt":471,"layout":17,"permalink":472,"image":473,"categories":474,"tags":475,"draft":26},81,"WSS 3.0, SharePoint 2007 and Project Server SP1 support ends soon",["Date","2010-01-11T16:26:39.000Z"],"Stefan Goßner reminds us of the fact that support for WSS 3.0 SP1, SharePoint 2007 SP1 and Project Server SP1 will soon end.\n","/2010/01/11/wss-3-0-sharepoint-2007-and-project-server-sp1-support-ends-soon/","/wp-content/uploads/2010/01/post-81-thumnail-1.png",[21,132],[23,139,476,477,478,66],"SP1","SP2","Support","> [!NOTE]\n> _Update on \u003Ctime datetime=\"2010-03-24\">March 24th, 2010\u003C/time>_  \n> [Microsoft extends support for WSS 3.0, SharePoint 2007 and Project Server SP1](/2010/03/24/microsoft-extends-support-for-wss-3-0-sharepoint-2007-and-project-server-sp1/)\n\nStefan Goßner [reminds](https://blog.stefan-gossner.com/2010/01/07/is-your-sharepoint-2007-farm-already-on-service-pack-2-if-not-read-this/) us of the fact that support for WSS 3.0 SP1, SharePoint 2007 SP1 and Project Server SP1 will soon end.\n\n\u003C!--more-->\n\nSupport ends when the next service pack is out for over a year.\nAnd SP2 was released \u003Ctime datetime=\"2009-04-28\">April 28th 2009\u003C/time> so SP1 won’t be supported from \u003Ctime datetime=\"2010-04-29\">April 29th 2010\u003C/time>, so roughly in 3 months.\n\nBe sure to test & deploy your upgrade soon!","src/posts/2010-01-11-wss-3-0-sharepoint-2007-and-project-server-sp1-support-ends-soon.md","1ec404f0f09f6b90",{"html":483,"metadata":484},"\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\u003Cem>Update on \u003Ctime datetime=\"2010-03-24\">March 24th, 2010\u003C/time>\u003C/em>\u003Cbr>\n\u003Ca href=\"/2010/03/24/microsoft-extends-support-for-wss-3-0-sharepoint-2007-and-project-server-sp1/\">Microsoft extends support for \u003Cdfn>\u003Cabbr title=\"Windows SharePoint Services\">WSS\u003C/abbr>\u003C/dfn> 3.0, SharePoint 2007 and Project Server \u003Cdfn>\u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr>\u003C/dfn>\u003C/a>\u003C/p>\n\u003C/div>\n\u003Cp>Stefan Goßner \u003Ca href=\"https://blog.stefan-gossner.com/2010/01/07/is-your-sharepoint-2007-farm-already-on-service-pack-2-if-not-read-this/\" rel=\"noopener noreferrer external\" target=\"_blank\">reminds\u003Cspan>\u003C/span>\u003C/a> us of the fact that support for \u003Cabbr title=\"Windows SharePoint Services\">WSS\u003C/abbr> 3.0 \u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr>, SharePoint 2007 \u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr> and Project Server \u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr> will soon end.\u003C/p>\n\u003C!--more-->\n\u003Cp>Support ends when the next service pack is out for over a year.\nAnd \u003Cdfn>\u003Cabbr title=\"Service Pack 2\">SP2\u003C/abbr>\u003C/dfn> was released \u003Ctime datetime=\"2009-04-28\">April 28th 2009\u003C/time> so \u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr> won’t be supported from \u003Ctime datetime=\"2010-04-29\">April 29th 2010\u003C/time>, so roughly in 3 months.\u003C/p>\n\u003Cp>Be sure to test &#x26; deploy your upgrade soon!\u003C/p>",{"headings":485,"imagePaths":486,"frontmatter":467},[],[],"2010-03-24-microsoft-extends-support-for-wss-3-0-sharepoint-2007-and-project-server-sp1",{"id":487,"data":489,"body":499,"filePath":500,"digest":501,"rendered":502},{"id":490,"title":491,"date":492,"updated":493,"author":15,"excerpt":494,"layout":17,"permalink":495,"image":496,"categories":497,"tags":498,"draft":26},136,"Microsoft extends support for WSS 3.0, SharePoint 2007 and Project Server SP1",["Date","2010-03-24T16:44:40.000Z"],["Date","2020-12-03T22:41:55.000Z"],"Today the news broke Microsoft has extended the support for installations of Windows SharePoint Services 3.0 SP1, Microsoft Office SharePoint Server 2007 SP1 and Project Server 2007 SP1.\n","/2010/03/24/microsoft-extends-support-for-wss-3-0-sharepoint-2007-and-project-server-sp1/","/wp-content/uploads/2010/03/post-136-thumnail-1.png",[21,132],[23,139,476,478,66],"As I wrote in \u003Ctime datetime=\"2010-01-11\">January\u003C/time>\r\n\"[WSS 3.0, SharePoint 2007 and Project Server SP1 support ends soon](/2010/01/11/wss-3-0-sharepoint-2007-and-project-server-sp1-support-ends-soon/)\".\r\nBut today I discovered Microsoft has extended the support for installations of Windows SharePoint Services 3.0 SP1,\r\nMicrosoft Office SharePoint Server 2007 SP1 and Project Server 2007 SP1.\r\n\r\n\u003C!--more-->\r\n\r\nOn the [Microsoft Lifecycle Policy](https://learn.microsoft.com/lifecycle/) pages for\r\n[Windows SharePoint Services 3.0](https://learn.microsoft.com/lifecycle/products/microsoft-windows-sharepoint-services-30) and\r\n[Microsoft Office SharePoint Server 2007](https://learn.microsoft.com/lifecycle/products/microsoft-office-sharepoint-server-2007) \r\nthe new retirement date is set for \u003Ctime datetime=\"2010-07-13\">July 13th, 2010\u003C/time>.","src/posts/2010-03-24-microsoft-extends-support-for-wss-3-0-sharepoint-2007-and-project-server-sp1.md","d76cd892ef0afb25",{"html":503,"metadata":504},"\u003Cp>As I wrote in \u003Ctime datetime=\"2010-01-11\">January\u003C/time>\r\n“\u003Ca href=\"/2010/01/11/wss-3-0-sharepoint-2007-and-project-server-sp1-support-ends-soon/\">\u003Cdfn>\u003Cabbr title=\"Windows SharePoint Services\">WSS\u003C/abbr>\u003C/dfn> 3.0, SharePoint 2007 and Project Server \u003Cdfn>\u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr>\u003C/dfn> support ends soon\u003C/a>”.\r\nBut today I discovered Microsoft has extended the support for installations of Windows SharePoint Services 3.0 \u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr>,\r\nMicrosoft Office SharePoint Server 2007 \u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr> and Project Server 2007 \u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr>.\u003C/p>\n\u003C!--more-->\n\u003Cp>On the \u003Ca href=\"https://learn.microsoft.com/lifecycle/?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Microsoft Lifecycle Policy\u003Cspan>\u003C/span>\u003C/a> pages for\r\n\u003Ca href=\"https://learn.microsoft.com/lifecycle/products/microsoft-windows-sharepoint-services-30?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows SharePoint Services 3.0\u003Cspan>\u003C/span>\u003C/a> and\r\n\u003Ca href=\"https://learn.microsoft.com/lifecycle/products/microsoft-office-sharepoint-server-2007?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Microsoft Office SharePoint Server 2007\u003Cspan>\u003C/span>\u003C/a>\r\nthe new retirement date is set for \u003Ctime datetime=\"2010-07-13\">July 13th, 2010\u003C/time>.\u003C/p>",{"headings":505,"imagePaths":506,"frontmatter":489},[],[],"2010-01-07-running-centos-5-x-on-hyper-v",{"id":507,"data":509,"body":520,"filePath":521,"digest":522,"rendered":523},{"id":510,"title":511,"date":512,"author":15,"excerpt":513,"layout":17,"permalink":514,"image":515,"categories":516,"tags":517,"draft":26},71,"Running CentOS 5.x on Hyper-V",["Date","2010-01-07T15:31:47.000Z"],"I’m running Linux in Hyper-V VMs since the launch of the Windows Server 2008 RTM. It was quite complex to get performance and support for the network drivers. Recently with the launch of Windows Server 2008 R2 there are also new Linux Integration Components which also work for 2008 RTM. Here is the list of steps to install CentOS with these components.\n","/2010/01/07/running-centos-5-x-on-hyper-v/","/wp-content/uploads/2010/01/post-71-thumnail-1.png",[293],[295,518,519,298,163,164],"Integration Components","LIC","I am running Linux in Hyper-V VMs since the launch of the Windows Server 2008 RTM.\nBut in the beginning it was quite complex to get real performance and support for the network drivers.\n\nRecently, with the launch of Windows Server 2008 R2,\nthere are also new Linux Integration Components which also work for Windows Server 2008 RTM.\n\n\u003C!--more-->\n\nSo, here is the list of steps to install CentOS with the integration components.\n\n1. Download the latest CentOS distribution from \u003Chttps://vault.centos.org/5.0/isos/>\n   (I use the x86_64 version).\n2. Create a VM, I suggest:\n\n   * &gt;400MB memory\n   * Add a Legacy Network Adapter (connect to network)\n   * Add a Network Adapter (connect to network)\n\n3. Mount the CD-ROM and install CentOS (I use the minimal setup)\n4. After the installation is done make certain you are up to date\n\n   ```shell\n   yum update\n   ```\n\n5. Install the required components for the Linux Integration Components\n\n   ```shell\n   yum install gcc make gnupg kernel-devel\n   ```\n\n6. Reboot into the latest kernel\n7. Download the [Linux Integration Components](https://www.microsoft.com/en-us/download/details.aspx?id=55106)\n8. Mount the CD-ROM and copy the contents  \n\n   ```shell\n   mkdir -p /mnt/cdrom\n   mount /dev/cdrom /mnt/cdrom\n   cp -rp /mnt/cdrom /opt/linux_ic\n   umount /mnt/cdrom\n   ```\n\n9. Build the drivers\n\n   ```shell\n   cd /opt/linux_ic ./setup.pl drivers\n   ```\n\n   If you get the message \"No kernel-xen-devel or kernel-source package installed. You must install this package before installing the drivers.\" edit the `setup.pl` file and change the following:\n\n   ```diff\n   -$kernel = `rpm -q kernel-xen-devel`;\n   +$kernel = `rpm -q kernel-devel`;\n   ```\n\n   If everything went OK you can now see a new nic (network interface controller) called `seth0` using `ifconfig`\n\n10. You can now remove the Legacy Network Adapter.\n\n> [!IMPORTANT]\n> Remember, every time you update the kernel you have to run the `setup.pl drivers` command.","src/posts/2010-01-07-running-centos-5-x-on-hyper-v.md","4e96e7db0e7c27a6",{"html":524,"metadata":525},"\u003Cp>I am running Linux in Hyper-V VMs since the launch of the Windows Server 2008 RTM.\nBut in the beginning it was quite complex to get real performance and support for the network drivers.\u003C/p>\n\u003Cp>Recently, with the launch of Windows Server 2008 R2,\nthere are also new Linux Integration Components which also work for Windows Server 2008 RTM.\u003C/p>\n\u003C!--more-->\n\u003Cp>So, here is the list of steps to install CentOS with the integration components.\u003C/p>\n\u003Col>\n\u003Cli>\n\u003Cp>Download the latest CentOS distribution from \u003Ca href=\"https://vault.centos.org/5.0/isos/\" rel=\"noopener noreferrer external\" target=\"_blank\">https://vault.centos.org/5.0/isos/\u003Cspan>\u003C/span>\u003C/a>\n(I use the x86_64 version).\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Create a \u003Cdfn>\u003Cabbr title=\"Virtual Machine\">VM\u003C/abbr>\u003C/dfn>, I suggest:\u003C/p>\n\u003Cul>\n\u003Cli>>400MB memory\u003C/li>\n\u003Cli>Add a Legacy Network Adapter (connect to network)\u003C/li>\n\u003Cli>Add a Network Adapter (connect to network)\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>\n\u003Cp>Mount the \u003Cdfn>\u003Cabbr title=\"Continuous Deployment\">CD\u003C/abbr>\u003C/dfn>-ROM and install CentOS (I use the minimal setup)\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>After the installation is done make certain you are up to date\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:10ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">yum\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">update\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"yum update\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003Cli>\n\u003Cp>Install the required components for the Linux Integration Components\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:39ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">yum\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">install\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">gcc\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">make\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">gnupg\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">kernel-devel\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"yum install gcc make gnupg kernel-devel\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003Cli>\n\u003Cp>Reboot into the latest kernel\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Download the \u003Ca href=\"https://www.microsoft.com/en-us/download/details.aspx?id=55106\" rel=\"noopener noreferrer external\" target=\"_blank\">Linux Integration Components\u003Cspan>\u003C/span>\u003C/a>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Mount the \u003Cabbr title=\"Continuous Deployment\">CD\u003C/abbr>-ROM and copy the contents\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:31ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">mkdir\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-p\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/mnt/cdrom\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">mount\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/dev/cdrom\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/mnt/cdrom\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">cp\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-rp\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/mnt/cdrom\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/opt/linux_ic\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">umount\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/mnt/cdrom\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"mkdir -p /mnt/cdrommount /dev/cdrom /mnt/cdromcp -rp /mnt/cdrom /opt/linux_icumount /mnt/cdrom\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003Cli>\n\u003Cp>Build the drivers\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:35ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">cd\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/opt/linux_ic\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">./setup.pl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">drivers\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"cd /opt/linux_ic ./setup.pl drivers\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>If you get the message “No kernel-xen-devel or kernel-source package installed. You must install this package before installing the drivers.” edit the \u003Ccode>setup.pl\u003C/code> file and change the following:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"diff\" class=\"wrap\" style=\"--ecMaxLine:36ch\">\u003Ccode>\u003Cdiv class=\"ec-line highlight del\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">$kernel = `rpm -q kernel-xen-devel`;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight ins\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">$kernel = `rpm -q kernel-devel`;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"$kernel = &#x60;rpm -q kernel-xen-devel&#x60;;$kernel = &#x60;rpm -q kernel-devel&#x60;;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>If everything went OK you can now see a new nic (network interface controller) called \u003Ccode>seth0\u003C/code> using \u003Ccode>ifconfig\u003C/code>\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>You can now remove the Legacy Network Adapter.\u003C/p>\n\u003C/li>\n\u003C/ol>\n\u003Cdiv class=\"markdown-alert markdown-alert-important\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M14 1a1 1 0 0 1 1 1v12a1 1 0 0 1-1 1H2a1 1 0 0 1-1-1V2a1 1 0 0 1 1-1zM2 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2z\">\u003C/path>\u003Cpath d=\"M7.002 11a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 4.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z\">\u003C/path>\u003C/svg>Important\u003C/p>\n\u003Cp>\nRemember, every time you update the kernel you have to run the \u003Ccode>setup.pl drivers\u003C/code> command.\u003C/p>\n\u003C/div>",{"headings":526,"imagePaths":527,"frontmatter":509},[],[],"2010-02-05-prevent-hardcoded-sharepoint-ids-in-your-code",{"id":528,"data":530,"body":544,"filePath":545,"digest":546,"rendered":547},{"id":531,"title":532,"date":533,"author":15,"excerpt":534,"layout":17,"permalink":535,"image":536,"categories":537,"tags":538,"draft":26},100,"Prevent hardcoded SharePoint ID’s in your code",["Date","2010-02-05T11:44:39.000Z"],"Now and again I come across code with hardcoded SharePoint ID's in it. Or scary loops matching a field, list or property name. SharePoint provides some classes containing the out of the box ID's, you only have to know they exist. I made an overview so nobody has to hardcode those pesky GUID's, ContentTypeId's or property names.\n","/2010/02/05/prevent-hardcoded-sharepoint-ids-in-your-code/","/wp-content/uploads/2010/02/post-100-thumnail-1.png",[132],[539,540,541,542,139,160,543,322,66],"ContentType","Feature","Field","Publishing","SharePoint 2013","Now and again I come across code with hardcoded SharePoint IDs in it.\nOr scary loops matching a field, list or property name.  \nSharePoint provides some classes containing the out of the box IDs, you only have to know they exist.  \nI made an overview so nobody has to hardcode those pesky GUIDs, ContentTypeId’s or property names any longer.\n\n\u003C!--more-->\n\n### WSS/Core - Microsoft.SharePoint.SPBuiltInFieldId\n\nThe [`SPBuiltInFieldId` class](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms435407(v=office.15)) contains 314 GUIDs for the default SharePoint fields.\nYou can find them all on the [`SPBuiltInFieldId` fields](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms439470(v=office.15)) page, but I name some of the more common ones:\n\n* `Created`\n* `Created_x0020_By`\n* `ID`\n* `Modified`\n* `Modified_x0020_By`\n* `Title`\n* `UniqueId`\n\n### WSS/Core - Microsoft.SharePoint.SPBuiltInContentTypeId\n\nThe [`SPBuiltInContentTypeId` class](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms461338(v=office.15)) contains 34 content type IDs for the default SharePoint content types.\nYou can find them all on the [`SPBuiltInContentTypeId` fields](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms434482(v=office.15)) page, but I name some of the more common ones:\n\n* `Announcement`\n* `Document`\n* `Folder`\n* `Item`\n* `Task`\n\n### WSS/Core - Microsoft.SharePoint.SPListTemplateType\n\nThe [`SPListTemplateType` enumeration](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms413878(v=office.15))\nis more commonly known and used but what’s more special about this enumeration is to use it in combination with the\n[`SPSite.GetCatalog` method](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms480807(v=office.15)).\n\nWith this method you can easily retrieve the `MasterPageCatalog` for the current site collection:\n\n```csharp\nvar site = SPContext.Current.Site;\nvar masterPageGallery = \n    site.GetCatalog(SPListTemplateType.MasterPageCatalog) as SPDocumentLibrary;\n\nif (masterPageGallery != null)\n{\n    // DoStuff()\n}\n```\n\nThe enumerations contain four list template IDs for the default SharePoint catalogs.\n\n* `ListTemplateCatalog`\n* `MasterPageCatalog`\n* `WebPartCatalog`\n* `WebTemplateCatalog`\n\n### MOSS - Microsoft.SharePoint.Publishing.FeatureIds\n\nThe [`FeatureIds` class](https://learn.microsoft.comprevious-versions/office/sharepoint-server/ms583113(v=office.15)) contains 16 GUIDs for the MOSS publishing features.\nYou can find them all on the [`FeatureIds` fields](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms559490(v=office.15)) page,\nbut I name the most common ones:\n\n* `Navigation`\n* `Publishing`\n\n### Server - Microsoft.SharePoint.Publishing.Internal.WssFeatureIds\n\nThis class is not documented and the namespace implies its internal.\nThe `WssFeatureIds` class however is public and the only place the 24 WSS feature IDs are available.\n\nBecause this class is not documented I list all fields:\n\n* `AnnouncementsList`\n* `BasicWebParts`\n* `ContactsList`\n* `CustomList`\n* `DataConnectionLibrary`\n* `DataSourceLibrary`\n* `DiscussionsList`\n* `DocumentLibrary`\n* `EventsList`\n* `GanttTasksList`\n* `GlobalContentTypes`\n* `GlobalFields`\n* `GlobalMobilityRedirect`\n* `GridList`\n* `IssuesList`\n* `LinksList`\n* `NoCodeWorkflowLibrary`\n* `PictureLibrary`\n* `SurveysList`\n* `TasksList`\n* `TeamCollaboration`\n* `WebPageLibrary`\n* `WorkflowHistoryList`\n* `XmlFormLibrary`\n\n### Server - Microsoft.SharePoint.Publishing.FieldId\n\nThe [`FieldId` class](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms498502(v=office.15)) contains 61 GUIDs for the publishing fields.\nYou can find them all on the [`FieldId` properties](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms552092(v=office.15)) page,\nbut I name some of the more common ones:\n\n* `Contact`\n* `PageLayout`\n* `PreviewImage`\n* `PublishingPageContent`\n* `PublishingPageImage`\n* `RollupImage`\n\n### Server - Microsoft.SharePoint.Publishing.ContentTypeId\n\nThe [`ContentTypeId` class](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms584122(v=office.15)) contains 10 content type IDs for the publishing content types.\nYou can find them all on the [`ContentTypeId` properties](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms500588(v=office.15)) page,\nbut I name some of the more common ones:\n\n* `ArticlePage`\n* `MasterPage`\n* `PageLayout`\n* `WelcomePage`\n\n### MOSS - Microsoft.Office.Server.UserProfiles.PropertyConstants\n\nThe [`PropertyConstants` class](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms564607(v=office.15)) contains 42 names of the standard user profile properties.\nYou can find them all on the [`PropertyConstants` fields](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms549392(v=office.15)) page,\nbut I name some of the more common ones:\n\n* `BirthDay`\n* `CellPhone`\n* `Department`\n* `FirstName`\n* `LastName`\n* `Manager`\n* `PictureUrl`\n* `PreferredName`\n* `Title`\n* `WorkEmail`\n* `WorkPhone`","src/posts/2010-02-05-prevent-hardcoded-sharepoint-ids-in-your-code.md","368add713f05de4f",{"html":548,"metadata":549},"\u003Cp>Now and again I come across code with hardcoded SharePoint IDs in it.\nOr scary loops matching a field, list or property name.\u003Cbr>\nSharePoint provides some classes containing the out of the box IDs, you only have to know they exist.\u003Cbr>\nI made an overview so nobody has to hardcode those pesky GUIDs, ContentTypeId’s or property names any longer.\u003C/p>\n\u003C!--more-->\n\u003Ch3 id=\"wsscore---microsoftsharepointspbuiltinfieldid\">\u003Cdfn>\u003Cabbr title=\"Windows SharePoint Services\">WSS\u003C/abbr>\u003C/dfn>/Core - Microsoft.SharePoint.SPBuiltInFieldId\u003C/h3>\n\u003Cp>The \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms435407(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPBuiltInFieldId\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> contains 314 GUIDs for the default SharePoint fields.\nYou can find them all on the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms439470(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPBuiltInFieldId\u003C/code> fields\u003Cspan>\u003C/span>\u003C/a> page, but I name some of the more common ones:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>Created\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Created_x0020_By\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>ID\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Modified\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Modified_x0020_By\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Title\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>UniqueId\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"wsscore---microsoftsharepointspbuiltincontenttypeid\">\u003Cabbr title=\"Windows SharePoint Services\">WSS\u003C/abbr>/Core - Microsoft.SharePoint.SPBuiltInContentTypeId\u003C/h3>\n\u003Cp>The \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms461338(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPBuiltInContentTypeId\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> contains 34 content type IDs for the default SharePoint content types.\nYou can find them all on the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms434482(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPBuiltInContentTypeId\u003C/code> fields\u003Cspan>\u003C/span>\u003C/a> page, but I name some of the more common ones:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>Announcement\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Document\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Folder\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Item\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Task\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"wsscore---microsoftsharepointsplisttemplatetype\">\u003Cabbr title=\"Windows SharePoint Services\">WSS\u003C/abbr>/Core - Microsoft.SharePoint.SPListTemplateType\u003C/h3>\n\u003Cp>The \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms413878(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPListTemplateType\u003C/code> enumeration\u003Cspan>\u003C/span>\u003C/a>\nis more commonly known and used but what’s more special about this enumeration is to use it in combination with the\n\u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms480807(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPSite.GetCatalog\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>With this method you can easily retrieve the \u003Ccode>MasterPageCatalog\u003C/code> for the current site collection:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:79ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">site\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SPContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Current\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Site\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">masterPageGallery\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">site\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetCatalog\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SPListTemplateType\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">MasterPageCatalog\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#569CD6\">as\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">SPDocumentLibrary\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">masterPageGallery\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#76A162\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#76A162\">// DoStuff()\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var site = SPContext.Current.Site;var masterPageGallery =    site.GetCatalog(SPListTemplateType.MasterPageCatalog) as SPDocumentLibrary;if (masterPageGallery != null){    // DoStuff()}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>The enumerations contain four list template IDs for the default SharePoint catalogs.\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>ListTemplateCatalog\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>MasterPageCatalog\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>WebPartCatalog\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>WebTemplateCatalog\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"moss---microsoftsharepointpublishingfeatureids\">MOSS - Microsoft.SharePoint.Publishing.FeatureIds\u003C/h3>\n\u003Cp>The \u003Ca href=\"https://learn.microsoft.comprevious-versions/office/sharepoint-server/ms583113(v=office.15)\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>FeatureIds\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> contains 16 GUIDs for the MOSS publishing features.\nYou can find them all on the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms559490(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>FeatureIds\u003C/code> fields\u003Cspan>\u003C/span>\u003C/a> page,\nbut I name the most common ones:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>Navigation\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Publishing\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"server---microsoftsharepointpublishinginternalwssfeatureids\">Server - Microsoft.SharePoint.Publishing.Internal.WssFeatureIds\u003C/h3>\n\u003Cp>This class is not documented and the namespace implies its internal.\nThe \u003Ccode>WssFeatureIds\u003C/code> class however is public and the only place the 24 \u003Cabbr title=\"Windows SharePoint Services\">WSS\u003C/abbr> feature IDs are available.\u003C/p>\n\u003Cp>Because this class is not documented I list all fields:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>AnnouncementsList\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>BasicWebParts\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>ContactsList\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>CustomList\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>DataConnectionLibrary\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>DataSourceLibrary\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>DiscussionsList\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>DocumentLibrary\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>EventsList\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>GanttTasksList\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>GlobalContentTypes\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>GlobalFields\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>GlobalMobilityRedirect\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>GridList\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>IssuesList\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>LinksList\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>NoCodeWorkflowLibrary\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>PictureLibrary\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>SurveysList\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>TasksList\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>TeamCollaboration\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>WebPageLibrary\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>WorkflowHistoryList\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>XmlFormLibrary\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"server---microsoftsharepointpublishingfieldid\">Server - Microsoft.SharePoint.Publishing.FieldId\u003C/h3>\n\u003Cp>The \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms498502(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>FieldId\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> contains 61 GUIDs for the publishing fields.\nYou can find them all on the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms552092(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>FieldId\u003C/code> properties\u003Cspan>\u003C/span>\u003C/a> page,\nbut I name some of the more common ones:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>Contact\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>PageLayout\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>PreviewImage\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>PublishingPageContent\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>PublishingPageImage\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>RollupImage\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"server---microsoftsharepointpublishingcontenttypeid\">Server - Microsoft.SharePoint.Publishing.ContentTypeId\u003C/h3>\n\u003Cp>The \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms584122(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ContentTypeId\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> contains 10 content type IDs for the publishing content types.\nYou can find them all on the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms500588(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ContentTypeId\u003C/code> properties\u003Cspan>\u003C/span>\u003C/a> page,\nbut I name some of the more common ones:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>ArticlePage\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>MasterPage\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>PageLayout\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>WelcomePage\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"moss---microsoftofficeserveruserprofilespropertyconstants\">MOSS - Microsoft.Office.Server.UserProfiles.PropertyConstants\u003C/h3>\n\u003Cp>The \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms564607(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>PropertyConstants\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> contains 42 names of the standard user profile properties.\nYou can find them all on the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms549392(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>PropertyConstants\u003C/code> fields\u003Cspan>\u003C/span>\u003C/a> page,\nbut I name some of the more common ones:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>BirthDay\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>CellPhone\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Department\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>FirstName\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>LastName\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Manager\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>PictureUrl\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>PreferredName\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Title\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>WorkEmail\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>WorkPhone\u003C/code>\u003C/li>\n\u003C/ul>",{"headings":550,"imagePaths":575,"frontmatter":530},[551,554,557,560,563,566,569,572],{"depth":198,"slug":552,"text":553},"wsscore---microsoftsharepointspbuiltinfieldid","WSS/Core - Microsoft.SharePoint.SPBuiltInFieldId",{"depth":198,"slug":555,"text":556},"wsscore---microsoftsharepointspbuiltincontenttypeid","WSS/Core - Microsoft.SharePoint.SPBuiltInContentTypeId",{"depth":198,"slug":558,"text":559},"wsscore---microsoftsharepointsplisttemplatetype","WSS/Core - Microsoft.SharePoint.SPListTemplateType",{"depth":198,"slug":561,"text":562},"moss---microsoftsharepointpublishingfeatureids","MOSS - Microsoft.SharePoint.Publishing.FeatureIds",{"depth":198,"slug":564,"text":565},"server---microsoftsharepointpublishinginternalwssfeatureids","Server - Microsoft.SharePoint.Publishing.Internal.WssFeatureIds",{"depth":198,"slug":567,"text":568},"server---microsoftsharepointpublishingfieldid","Server - Microsoft.SharePoint.Publishing.FieldId",{"depth":198,"slug":570,"text":571},"server---microsoftsharepointpublishingcontenttypeid","Server - Microsoft.SharePoint.Publishing.ContentTypeId",{"depth":198,"slug":573,"text":574},"moss---microsoftofficeserveruserprofilespropertyconstants","MOSS - Microsoft.Office.Server.UserProfiles.PropertyConstants",[],"2010-01-15-mysitepublicwebpartpage-throws-nullreferenceexception-with-august-cumulative-update",{"id":576,"data":578,"body":589,"filePath":590,"digest":591,"rendered":592},{"id":579,"title":580,"date":581,"author":15,"excerpt":582,"layout":17,"permalink":583,"image":584,"categories":585,"tags":586,"draft":26},84,"MySitePublicWebPartPage throws NullReferenceException with August Cumulative Update",["Date","2010-01-15T12:27:31.000Z"],"With the introduction of the August Cumulative Update for SharePoint 2007 (KB973399) we encountered “System.NullReferenceException: Object reference not set to an instance of an object.” on all pages inheriting from MySitePublicWebPartPage.\n","/2010/01/15/mysitepublicwebpartpage-throws-nullreferenceexception-with-august-cumulative-update/","/wp-content/uploads/2010/01/post-84-thumnail-1.png",[132],[587,187,429,588,139],"CU","ProfilePropertyImage","### The problem\n\nWith the introduction of the **August Cumulative Update for SharePoint 2007** (KB973399) we encountered `System.NullReferenceException: Object reference not set to an instance of an object.` on all pages inheriting from [`MySitePublicWebPartPage`](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms547244(v=office.15)).\n\n\u003C!--more-->\n\n![Stack Trace of the exception](/wp-content/uploads/2010/01/stacktrace-of-exception.png \"Stack Trace of the exception\")\n\nAs can be seen in the stack trace the error occurs from a call by the [`ProfilePropertyImage` control](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms565011(v=office.15)), which is on the page by default.\n\n### The cause\n\nThis call was not present in the control prior to the august update, so let’s take a look at the **description of the update** (KB973409).\n\n> A Shared Services Provider administrator edits the **About me** property or the **Picture** property to make the property display \"Only me\". However, these properties continue to be visible when the profile owner sets their **As Seen By** option to \"Everyone\", \"My Colleagues\", \"My Workgroup\" or \"My Manager\" on their own Person.aspx page.\n\nSo, this explains why the control was changed, it now looks if the image should be rendered for the current visitor of the page.\n\n### The reason\n\nWe already know the problem starts inside the ProfilePropertyImage which is calling the [`MySitePublicWebPartPage.GetEffectivePrivacy` method](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms499526(v=office.15)).\nThis method reads the value of the [`MySitePublicWebPartPage.PrivacySelected` property](https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms549073(v=office.15)).\nInside the getter of the property the following code is used:\n\n```csharp\nobject obj2 = this.ViewState[\"__PrivacySelected__\"];\nreturn (Privacy) obj2;\n```\n\nAs we all know SharePoint's code is never about defensive programming and so is the case here if there is no `ViewState` Property available, it will return a `null`.\nAnd of course, there is no check anywhere for that.\n\nBut this code works for the default `person.aspx` page, so the setter for this property has to be called somewhere.\nAnalysis of the code shows only the [`AsSeenBy` class](https://learn.microsoft.com/previous-versions/office/developer/sharepoint-2007/aa594189(v=office.12)) ever calls the setter.\nAs this control is on the `person.aspx` page by default, the property is set and that page works fine.\nAs we do not have this control on our page, we get a `NullReferenceException`.\n\n### The solution\n\nIf you are bound to the August release the solution is simple: add the `AsSeenBy` control to your page.\n\nBut what if you do not want to have the control on your page?\nWe get lucky, because if you do not make it visible it will still work, so add:\n\n```xml\n\u003CSPSWC:AsSeenBy runat=\"server\" id=\"ddlAsSeenBy\" SelectionMode=\"Single\"\n                autopostback=\"True\" Visible=\"False\" />\n```\n\nIf you are not bound to the August upgrade you can upgrade to the **October Cumulative Update** or newer.\nMicrosoft has fixed the issue in those versions.","src/posts/2010-01-15-mysitepublicwebpartpage-throws-nullreferenceexception-with-august-cumulative-update.md","9241e817abce7760",{"html":593,"metadata":594},"\u003Ch3 id=\"the-problem\">The problem\u003C/h3>\n\u003Cp>With the introduction of the \u003Cstrong>August Cumulative Update for SharePoint 2007\u003C/strong> (KB973399) we encountered \u003Ccode>System.NullReferenceException: Object reference not set to an instance of an object.\u003C/code> on all pages inheriting from \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms547244(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>MySitePublicWebPartPage\u003C/code>\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003C!--more-->\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/01/stacktrace-of-exception.webp\" type=\"image/webp\" media=\"(max-width: 584px)\">\u003Csource srcset=\"/wp-content/uploads/2010/01/stacktrace-of-exception-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/01/stacktrace-of-exception-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/01/stacktrace-of-exception.png\" alt=\"Stack Trace of the exception\" loading=\"lazy\" decoding=\"async\" width=\"584\" height=\"429\" srcset=\"/wp-content/uploads/2010/01/stacktrace-of-exception.png 584w, /wp-content/uploads/2010/01/stacktrace-of-exception-150x150.png 150w, /wp-content/uploads/2010/01/stacktrace-of-exception-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Stack Trace of the exception\u003C/figcaption>\u003C/figure>\n\u003Cp>As can be seen in the stack trace the error occurs from a call by the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms565011(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ProfilePropertyImage\u003C/code> control\u003Cspan>\u003C/span>\u003C/a>, which is on the page by default.\u003C/p>\n\u003Ch3 id=\"the-cause\">The cause\u003C/h3>\n\u003Cp>This call was not present in the control prior to the august update, so let’s take a look at the \u003Cstrong>description of the update\u003C/strong> (KB973409).\u003C/p>\n\u003Cblockquote>\n\u003Cp>A Shared Services Provider administrator edits the \u003Cstrong>About me\u003C/strong> property or the \u003Cstrong>Picture\u003C/strong> property to make the property display “Only me”. However, these properties continue to be visible when the profile owner sets their \u003Cstrong>As Seen By\u003C/strong> option to “Everyone”, “My Colleagues”, “My Workgroup” or “My Manager” on their own Person.aspx page.\u003C/p>\n\u003C/blockquote>\n\u003Cp>So, this explains why the control was changed, it now looks if the image should be rendered for the current visitor of the page.\u003C/p>\n\u003Ch3 id=\"the-reason\">The reason\u003C/h3>\n\u003Cp>We already know the problem starts inside the ProfilePropertyImage which is calling the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms499526(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>MySitePublicWebPartPage.GetEffectivePrivacy\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>.\nThis method reads the value of the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms549073(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>MySitePublicWebPartPage.PrivacySelected\u003C/code> property\u003Cspan>\u003C/span>\u003C/a>.\nInside the getter of the property the following code is used:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:52ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">obj2\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ViewState\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"__PrivacySelected__\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">];\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Privacy\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">obj2\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"object obj2 = this.ViewState[&#x22;__PrivacySelected__&#x22;];return (Privacy) obj2;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>As we all know SharePoint’s code is never about defensive programming and so is the case here if there is no \u003Ccode>ViewState\u003C/code> Property available, it will return a \u003Ccode>null\u003C/code>.\nAnd of course, there is no check anywhere for that.\u003C/p>\n\u003Cp>But this code works for the default \u003Ccode>person.aspx\u003C/code> page, so the setter for this property has to be called somewhere.\nAnalysis of the code shows only the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/developer/sharepoint-2007/aa594189(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>AsSeenBy\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> ever calls the setter.\nAs this control is on the \u003Ccode>person.aspx\u003C/code> page by default, the property is set and that page works fine.\nAs we do not have this control on our page, we get a \u003Ccode>NullReferenceException\u003C/code>.\u003C/p>\n\u003Ch3 id=\"the-solution\">The solution\u003C/h3>\n\u003Cp>If you are bound to the August release the solution is simple: add the \u003Ccode>AsSeenBy\u003C/code> control to your page.\u003C/p>\n\u003Cp>But what if you do not want to have the control on your page?\nWe get lucky, because if you do not make it visible it will still work, so add:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:70ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">SPSWC:AsSeenBy\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">runat\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"server\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">id\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"ddlAsSeenBy\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SelectionMode\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Single\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">autopostback\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"True\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Visible\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"False\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003CSPSWC:AsSeenBy runat=&#x22;server&#x22; id=&#x22;ddlAsSeenBy&#x22; SelectionMode=&#x22;Single&#x22;                autopostback=&#x22;True&#x22; Visible=&#x22;False&#x22; />\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>If you are not bound to the August upgrade you can upgrade to the \u003Cstrong>October Cumulative Update\u003C/strong> or newer.\nMicrosoft has fixed the issue in those versions.\u003C/p>",{"headings":595,"imagePaths":602,"frontmatter":578},[596,597,598,601],{"depth":198,"slug":255,"text":256},{"depth":198,"slug":461,"text":462},{"depth":198,"slug":599,"text":600},"the-reason","The reason",{"depth":198,"slug":258,"text":259},[],"2010-03-22-localizing-the-microsoft-surface-shell",{"id":603,"data":605,"body":622,"filePath":623,"digest":624,"rendered":625},{"id":606,"title":607,"date":608,"updated":609,"author":15,"excerpt":610,"layout":17,"permalink":611,"image":612,"categories":613,"tags":615,"draft":26},123,"Localizing the Microsoft Surface Shell",["Date","2010-03-22T15:17:36.000Z"],["Date","2020-12-03T22:40:15.000Z"],"The Microsoft Surface is a Windows Vista computer running the Microsoft Surface Shell. This shell is by default localized for US English. It is possible to localize for other locales, but there is no configuration screen to set the desired localization. This post will summarize the different steps to localize the Surface shell.\n","/2010/03/22/localizing-the-microsoft-surface-shell/","/wp-content/uploads/2010/03/post-123-thumnail-1.png",[614],"Surface",[616,617,618,25,619,620,621,113,189],"Date","Formatting","Localization","Shell","Simulator","Time","The **Microsoft Surface** (the table, not the tablet) is a Windows Vista computer running the Microsoft Surface Shell.\r\nThis shell is by default localized for US English.\r\n\r\nIt is possible to localize for other locales, but there is no configuration screen to set the desired localization.\r\n\r\nThis article will summarize the different steps to localize the Surface shell.\r\n\r\n\u003C!--more-->\r\n\r\n### Microsoft Surface Device vs. Microsoft Surface Simulator\r\n\r\nThe settings work for both the Microsoft Surface device and the \"Surface Simulator\".\r\n\r\n#### Note for x64 machines (Running the SDK)\r\n\r\nIf you are running the Surface Simulator on a x64 machine (see my post about \"[Installing the Microsoft Surface SDK on Windows 7 x64](/2010/03/03/installing-the-microsoft-surface-sdk-on-windows-7-x64)\") the registry entries are slightly different.\r\n\r\nFor x86:\r\n\r\n```plain\r\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Surface\\v1.0\r\n```\r\n\r\nFor x64:\r\n\r\n```plain\r\nHKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Surface\\v1.0\r\n```\r\n\r\nAll my examples in this post will use the x86 path.\r\n\r\n### Setting the Surface Shell interface language\r\n\r\nWith service pack 1, the shell now supports 10 UI languages.\r\n\r\n| Language                | UILanguageName value |\r\n| ----------------------- | -------------------- |\r\n| Danish                  | da-DK                |\r\n| Dutch                   | nl-NL                |\r\n| English (United States) | en-US                |\r\n| French                  | fr-FR                |\r\n| German                  | de-DE                |\r\n| Italian                 | it-IT                |\r\n| Korean                  | ko-KR                |\r\n| Norwegian (Bokmål)      | nb-NO                |\r\n| Spanish                 | es-ES                |\r\n| Swedish                 | sv-SE                |\r\n\r\nTo set the required language you need to edit the registry.\r\n\r\n1. Look for the following key `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Surface\\v1.0\\InternationalSupport`\r\n2. Change the `UILanguageName` value into the desired language name you find in the table.\r\n   For example, to set the language to Dutch you enter `nl-NL`.\r\n3. Restart the shell\r\n\r\n![Screenshot displaying the modified registry entry to localize the language of the Shell.](/wp-content/uploads/2010/03/registry-localized-shell.png \"The modified registry entry to localize the Surface Shell language.\")\r\n\r\n![Surface button displaying \"Close everything\" (English) as caption.](/wp-content/uploads/2010/03/close-everything-button-english.png \"Close button with caption \u003Cq>Close everything\u003C/q> in English (default).\")\r\n\r\n![Surface button displaying \"Alles sluiten\" (Dutch) as caption.](/wp-content/uploads/2010/03/image5.png \"Close button with caption \u003Cq>Alles sluiten\u003C/q> in Dutch (localized).\")\r\n\r\n### Setting the Surface Keyboard mapping\r\n\r\nThere are 19 supported keyboard mappings.\r\n\r\n| Keyboard layout                | InputLanguageID value |\r\n| ------------------------------ | --------------------- |\r\n| Belgian (Comma)                | 0x1080c               |\r\n| Belgian French                 | 0x80c                 |\r\n| Canadian French                | 0x1009                |\r\n| Canadian Multilingual Standard | 0x11009               |\r\n| Danish                         | 0x406                 |\r\n| French                         | 0x40c                 |\r\n| German                         | 0x407                 |\r\n| Italian                        | 0x410                 |\r\n| Korean                         | 0x412                 |\r\n| Latin American                 | 0x80a                 |\r\n| Norwegian                      | 0x414                 |\r\n| Spanish                        | 0x40a                 |\r\n| Swedish                        | 0x41d                 |\r\n| Swiss French                   | 0x100c                |\r\n| Swiss German                   | 0x807                 |\r\n| United Kingdom                 | 0x809                 |\r\n| United Kingdom Extended        | 0x452                 |\r\n| US English                     | 0x409                 |\r\n| US-International               | 0x20409               |\r\n\r\nTo set the desired keyboard mapping you need to edit the registry.\r\n\r\n1. Look for the following key  \r\n   `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Surface\\v1.0\\InternationalSupport`\r\n2. Change the `InputLanguageID` value into the desired keyboard mapping you find in the table.\r\n   For example, to set the shell to Korean you enter `0x412` (Hexadecimal).\r\n3. Restart the shell\r\n\r\n![Screenshot displaying the modified registry entry to localize the mapping of the Surface Keyboard.](/wp-content/uploads/2010/03/registry-localize-keyboard.png \"The modified registry entry to localize the Surface Keyboard mapping.\")\r\n\r\n![Keyboard using US English mapping.](/wp-content/uploads/2010/03/image7.png \"Surface Keyboard with US English mapping (default).\")\r\n\r\n![Keyboard using Korean mapping.](/wp-content/uploads/2010/03/keyboard-localized-in-korean.png \"Surface Keyboard with Korean mapping (localized).\")\r\n\r\n### Setting the Surface Date and Number formatting\r\n\r\nFor date and number formatting you can use all locales supported by the .NET Framework. The complete list can be found on the [Language Identifier Constants and Strings](https://learn.microsoft.com/windows/win32/intl/language-identifier-constants-and-strings) MSDN page.\r\n\r\nJust combine the primary language, for example: Dutch (nl), with the sub-language, for example Netherlands (NL): `nl-NL`.\r\n\r\nTo set the desired date and number formatting you need to edit the registry.\r\n\r\n1. Look for the following key  \r\n   `HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Surface\\v1.0\\InternationalSupport`\r\n2. Change the `LocaleName` value into the desired formatting locale.\r\n   For example, to set the formatting to Dutch you enter `nl-NL`.\r\n3. Restart the shell\r\n\r\n![Screenshot displaying the modified registry entry to localize the formatting of date and time values.](/wp-content/uploads/2010/03/image9.png \"The modified registry entry to localize the date and number formatting.\")\r\n\r\n![Date and time formatted in US English: \"Monday, March 22, 2010 12:00:00 AM\".](/wp-content/uploads/2010/03/date-time-in-english-format.png \"Date formatting in US English (default).\")\r\n\r\n![Date and time formatted in Dutch: \"maandag 22 maart 2010 0:00:00\".](/wp-content/uploads/2010/03/image11.png \"Date formatting in Dutch (localized).\")","src/posts/2010-03-22-localizing-the-microsoft-surface-shell.md","cf2630321d272077",{"html":626,"metadata":627},"\u003Cp>The \u003Cstrong>Microsoft Surface\u003C/strong> (the table, not the tablet) is a Windows Vista computer running the Microsoft Surface Shell.\r\nThis shell is by default localized for US English.\u003C/p>\n\u003Cp>It is possible to localize for other locales, but there is no configuration screen to set the desired localization.\u003C/p>\n\u003Cp>This article will summarize the different steps to localize the Surface shell.\u003C/p>\n\u003C!--more-->\n\u003Ch3 id=\"microsoft-surface-device-vs-microsoft-surface-simulator\">Microsoft Surface Device vs. Microsoft Surface Simulator\u003C/h3>\n\u003Cp>The settings work for both the Microsoft Surface device and the “Surface Simulator”.\u003C/p>\n\u003Ch4 id=\"note-for-x64-machines-running-the-sdk\">Note for x64 machines (Running the \u003Cdfn>\u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/dfn>)\u003C/h4>\n\u003Cp>If you are running the Surface Simulator on a x64 machine (see my post about “\u003Ca href=\"/2010/03/03/installing-the-microsoft-surface-sdk-on-windows-7-x64\">Installing the Microsoft Surface \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr> on Windows 7 x64\u003C/a>”) the registry entries are slightly different.\u003C/p>\n\u003Cp>For x86:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:50ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Surface\\v1.0\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Surface\\v1.0\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>For x64:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:62ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Surface\\v1.0\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"HKEY_LOCAL_MACHINE\\SOFTWARE\\Wow6432Node\\Microsoft\\Surface\\v1.0\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>All my examples in this post will use the x86 path.\u003C/p>\n\u003Ch3 id=\"setting-the-surface-shell-interface-language\">Setting the Surface Shell interface language\u003C/h3>\n\u003Cp>With service pack 1, the shell now supports 10 \u003Cdfn>\u003Cabbr title=\"User Interface\">UI\u003C/abbr>\u003C/dfn> languages.\u003C/p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>Language\u003C/th>\u003Cth>UILanguageName value\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>Danish\u003C/td>\u003Ctd>da-DK\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Dutch\u003C/td>\u003Ctd>nl-NL\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>English (United States)\u003C/td>\u003Ctd>en-US\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>French\u003C/td>\u003Ctd>fr-FR\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>German\u003C/td>\u003Ctd>de-DE\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Italian\u003C/td>\u003Ctd>it-IT\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Korean\u003C/td>\u003Ctd>ko-KR\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Norwegian (Bokmål)\u003C/td>\u003Ctd>nb-NO\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Spanish\u003C/td>\u003Ctd>es-ES\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Swedish\u003C/td>\u003Ctd>sv-SE\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Cp>To set the required language you need to edit the registry.\u003C/p>\n\u003Col>\n\u003Cli>Look for the following key \u003Ccode>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Surface\\v1.0\\InternationalSupport\u003C/code>\u003C/li>\n\u003Cli>Change the \u003Ccode>UILanguageName\u003C/code> value into the desired language name you find in the table.\r\nFor example, to set the language to Dutch you enter \u003Ccode>nl-NL\u003C/code>.\u003C/li>\n\u003Cli>Restart the shell\u003C/li>\n\u003C/ol>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/03/registry-localized-shell.webp\" type=\"image/webp\" media=\"(max-width: 430px)\">\u003Cimg src=\"/wp-content/uploads/2010/03/registry-localized-shell.png\" alt=\"Screenshot displaying the modified registry entry to localize the language of the Shell.\" loading=\"lazy\" decoding=\"async\" width=\"430\" height=\"114\" srcset=\"/wp-content/uploads/2010/03/registry-localized-shell.png 430w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>The modified registry entry to localize the Surface Shell language.\u003C/figcaption>\u003C/figure>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/03/close-everything-button-english.webp\" type=\"image/webp\" media=\"(max-width: 115px)\">\u003Cimg src=\"/wp-content/uploads/2010/03/close-everything-button-english.png\" alt=\"Surface button displaying &#x22;Close everything&#x22; (English) as caption.\" loading=\"lazy\" decoding=\"async\" width=\"115\" height=\"111\" srcset=\"/wp-content/uploads/2010/03/close-everything-button-english.png 115w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Close button with caption &#x3C;q>Close everything&#x3C;/q> in English (default).\u003C/figcaption>\u003C/figure>\n\u003Cp>\u003Cimg src=\"/wp-content/uploads/2010/03/image5.png\" alt=\"Surface button displaying &#x22;Alles sluiten&#x22; (Dutch) as caption.\" title=\"Close button with caption \u003Cq>Alles sluiten\u003C/q> in Dutch (localized).\">\u003C/p>\n\u003Ch3 id=\"setting-the-surface-keyboard-mapping\">Setting the Surface Keyboard mapping\u003C/h3>\n\u003Cp>There are 19 supported keyboard mappings.\u003C/p>\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\u003Ctable>\u003Cthead>\u003Ctr>\u003Cth>Keyboard layout\u003C/th>\u003Cth>InputLanguageID value\u003C/th>\u003C/tr>\u003C/thead>\u003Ctbody>\u003Ctr>\u003Ctd>Belgian (Comma)\u003C/td>\u003Ctd>0x1080c\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Belgian French\u003C/td>\u003Ctd>0x80c\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Canadian French\u003C/td>\u003Ctd>0x1009\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Canadian Multilingual Standard\u003C/td>\u003Ctd>0x11009\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Danish\u003C/td>\u003Ctd>0x406\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>French\u003C/td>\u003Ctd>0x40c\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>German\u003C/td>\u003Ctd>0x407\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Italian\u003C/td>\u003Ctd>0x410\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Korean\u003C/td>\u003Ctd>0x412\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Latin American\u003C/td>\u003Ctd>0x80a\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Norwegian\u003C/td>\u003Ctd>0x414\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Spanish\u003C/td>\u003Ctd>0x40a\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Swedish\u003C/td>\u003Ctd>0x41d\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Swiss French\u003C/td>\u003Ctd>0x100c\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>Swiss German\u003C/td>\u003Ctd>0x807\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>United Kingdom\u003C/td>\u003Ctd>0x809\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>United Kingdom Extended\u003C/td>\u003Ctd>0x452\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>US English\u003C/td>\u003Ctd>0x409\u003C/td>\u003C/tr>\u003Ctr>\u003Ctd>US-International\u003C/td>\u003Ctd>0x20409\u003C/td>\u003C/tr>\u003C/tbody>\u003C/table>\n\u003Cp>To set the desired keyboard mapping you need to edit the registry.\u003C/p>\n\u003Col>\n\u003Cli>Look for the following key\u003Cbr>\n\u003Ccode>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Surface\\v1.0\\InternationalSupport\u003C/code>\u003C/li>\n\u003Cli>Change the \u003Ccode>InputLanguageID\u003C/code> value into the desired keyboard mapping you find in the table.\r\nFor example, to set the shell to Korean you enter \u003Ccode>0x412\u003C/code> (Hexadecimal).\u003C/li>\n\u003Cli>Restart the shell\u003C/li>\n\u003C/ol>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/03/registry-localize-keyboard.webp\" type=\"image/webp\" media=\"(max-width: 447px)\">\u003Cimg src=\"/wp-content/uploads/2010/03/registry-localize-keyboard.png\" alt=\"Screenshot displaying the modified registry entry to localize the mapping of the Surface Keyboard.\" loading=\"lazy\" decoding=\"async\" width=\"447\" height=\"112\" srcset=\"/wp-content/uploads/2010/03/registry-localize-keyboard.png 447w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>The modified registry entry to localize the Surface Keyboard mapping.\u003C/figcaption>\u003C/figure>\n\u003Cp>\u003Cimg src=\"/wp-content/uploads/2010/03/image7.png\" alt=\"Keyboard using US English mapping.\" title=\"Surface Keyboard with US English mapping (default).\">\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/03/keyboard-localized-in-korean.webp\" type=\"image/webp\" media=\"(max-width: 580px)\">\u003Csource srcset=\"/wp-content/uploads/2010/03/keyboard-localized-in-korean-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/03/keyboard-localized-in-korean-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/03/keyboard-localized-in-korean.png\" alt=\"Keyboard using Korean mapping.\" loading=\"lazy\" decoding=\"async\" width=\"580\" height=\"274\" srcset=\"/wp-content/uploads/2010/03/keyboard-localized-in-korean.png 580w, /wp-content/uploads/2010/03/keyboard-localized-in-korean-150x150.png 150w, /wp-content/uploads/2010/03/keyboard-localized-in-korean-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Surface Keyboard with Korean mapping (localized).\u003C/figcaption>\u003C/figure>\n\u003Ch3 id=\"setting-the-surface-date-and-number-formatting\">Setting the Surface Date and Number formatting\u003C/h3>\n\u003Cp>For date and number formatting you can use all locales supported by the .NET Framework. The complete list can be found on the \u003Ca href=\"https://learn.microsoft.com/windows/win32/intl/language-identifier-constants-and-strings?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Language Identifier Constants and Strings\u003Cspan>\u003C/span>\u003C/a> \u003Cdfn>\u003Cabbr title=\"Microsoft Developer Network\">MSDN\u003C/abbr>\u003C/dfn> page.\u003C/p>\n\u003Cp>Just combine the primary language, for example: Dutch (nl), with the sub-language, for example Netherlands (NL): \u003Ccode>nl-NL\u003C/code>.\u003C/p>\n\u003Cp>To set the desired date and number formatting you need to edit the registry.\u003C/p>\n\u003Col>\n\u003Cli>Look for the following key\u003Cbr>\n\u003Ccode>HKEY_LOCAL_MACHINE\\SOFTWARE\\Microsoft\\Surface\\v1.0\\InternationalSupport\u003C/code>\u003C/li>\n\u003Cli>Change the \u003Ccode>LocaleName\u003C/code> value into the desired formatting locale.\r\nFor example, to set the formatting to Dutch you enter \u003Ccode>nl-NL\u003C/code>.\u003C/li>\n\u003Cli>Restart the shell\u003C/li>\n\u003C/ol>\n\u003Cp>\u003Cimg src=\"/wp-content/uploads/2010/03/image9.png\" alt=\"Screenshot displaying the modified registry entry to localize the formatting of date and time values.\" title=\"The modified registry entry to localize the date and number formatting.\">\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/03/date-time-in-english-format.webp\" type=\"image/webp\" media=\"(max-width: 471px)\">\u003Csource srcset=\"/wp-content/uploads/2010/03/date-time-in-english-format-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Cimg src=\"/wp-content/uploads/2010/03/date-time-in-english-format.png\" alt=\"Date and time formatted in US English: &#x22;Monday, March 22, 2010 12:00:00 AM&#x22;.\" loading=\"lazy\" decoding=\"async\" width=\"471\" height=\"161\" srcset=\"/wp-content/uploads/2010/03/date-time-in-english-format.png 471w, /wp-content/uploads/2010/03/date-time-in-english-format-150x150.png 150w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Date formatting in US English (default).\u003C/figcaption>\u003C/figure>\n\u003Cp>\u003Cimg src=\"/wp-content/uploads/2010/03/image11.png\" alt=\"Date and time formatted in Dutch: &#x22;maandag 22 maart 2010 0:00:00&#x22;.\" title=\"Date formatting in Dutch (localized).\">\u003C/p>",{"headings":628,"imagePaths":645,"frontmatter":605},[629,632,636,639,642],{"depth":198,"slug":630,"text":631},"microsoft-surface-device-vs-microsoft-surface-simulator","Microsoft Surface Device vs. Microsoft Surface Simulator",{"depth":633,"slug":634,"text":635},4,"note-for-x64-machines-running-the-sdk","Note for x64 machines (Running the SDK)",{"depth":198,"slug":637,"text":638},"setting-the-surface-shell-interface-language","Setting the Surface Shell interface language",{"depth":198,"slug":640,"text":641},"setting-the-surface-keyboard-mapping","Setting the Surface Keyboard mapping",{"depth":198,"slug":643,"text":644},"setting-the-surface-date-and-number-formatting","Setting the Surface Date and Number formatting",[],"2010-01-27-calling-a-sharepoint-web-service-from-silverlight-over-http-and-https",{"id":646,"data":648,"body":664,"filePath":665,"digest":666,"rendered":667},{"id":649,"title":650,"date":651,"author":15,"excerpt":652,"layout":17,"permalink":653,"image":654,"categories":655,"tags":656,"draft":26},98,"Calling a SharePoint Web Service from Silverlight over HTTP and HTTPS",["Date","2010-01-27T10:52:58.000Z"],"The past couple of weeks I'm working with Silverlight controls embedded in SharePoint 2007. For one of the controls I need to retrieve the data using the Search Query Web Service. This was working perfectly in the development environment. But when deploying the control to the production environment it didn't work.\n","/2010/01/27/calling-a-sharepoint-web-service-from-silverlight-over-http-and-https/","/wp-content/uploads/2010/01/post-98-thumnail-1.png",[183,132],[657,658,659,660,138,139,661,662,663],"BasicHttpBinding","HTTP","HTTPS","Query","Silverlight","WCF","Web Service","The past couple of weeks I am working with Silverlight controls embedded in SharePoint 2007.  \nFor one of the controls, I need to retrieve the data using the [Search Query Web Service](https://learn.microsoft.com/previous-versions/office/developer/sharepoint-2007/ms543175(v=office.12)).\n\nThis was working perfectly in the development environment.\nBut when deploying the control to the production environment it did not work.\n\n\u003C!--more-->\n\nI was using the following code:\n\n```csharp\nprivate void Page_Loaded(object sender, RoutedEventArgs e)\n{\n    var endpoint = new EndpointAddress(GetParam(\"SharePointWeb\") + \"/_vti_bin/search.asmx\");\n    var binding = new BasicHttpBinding(BasicHttpSecurityMode.None)\n                      {\n                          Name = \"QueryServiceSoap\",\n                          MaxReceivedMessageSize = 2147483647,\n                          MaxBufferSize = 2147483647\n                      };\n\n    var client = new QueryServiceSoapClient(binding, endpoint);\n    client.QueryExCompleted += this.ClientQueryExCompleted;\n    client.QueryExAsync(GetParam(\"Query\"));\n}\n```\n\nAfter some digging, I found that the control did actually work, but only when the page was visited over an HTTP connection.\nAs visitors were accessing the page over an HTTPS connection, I was pointed in the direction of the connection between the control and the web service.\n\nAs can be seen in the code the WCF client is used and I remembered that the binding security mode is different if you want to work with HTTPS.\nSo, I changed the [BasicHttpSecurityMode](https://learn.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/ms586334(v=vs.95)) from `None` to `Transport`.\n\n```diff\n-var binding = new BasicHttpBinding(BasicHttpSecurityMode.None)\n+var binding = new BasicHttpBinding(BasicHttpSecurityMode.Transport)\n```\n\nAfter deploying the control again, it worked nicely over the HTTPS connection, so I knew what the source of my problem is.\nBut naturally I want a generic solution so the configuration of the access mapping is not influencing the functioning of the control.\n\nThe question is how to detect if the control is hosted on a page over an HTTP or HTTPS connection. This can be found in the [`SilverlightHost.Source` property](https://learn.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/cc190409(v=vs.95)) which can be compared against the [`Uri.UriSchemeHttp` field](https://learn.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/x3fzefx3(v=vs.95)) or the [`Uri.UriSchemeHttps` field](https://learn.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/3s8hx381(v=vs.95)).\n\nAs a result, this is my final code:\n\n```csharp\nprivate void Page_Loaded(object sender, RoutedEventArgs e)\n{\n    var basicHttpSecurityMode =\n        (Application.Current.Host.Source.Scheme == Uri.UriSchemeHttp)\n            ? BasicHttpSecurityMode.None\n            : BasicHttpSecurityMode.Transport;\n\n    var endPoint = new EndpointAddress(GetParam(\"SharePointWeb\") + \"/_vti_bin/search.asmx\");\n    var binding = new BasicHttpBinding(basicHttpSecurityMode)\n                      {\n                          Name = \"QueryServiceSoap\",\n                          MaxReceivedMessageSize = 2147483647,\n                          MaxBufferSize = 2147483647\n                      };\n\n    var client = new QueryServiceSoapClient(binding, endPoint);\n    client.QueryExCompleted += this.ClientQueryExCompleted;\n    client.QueryExAsync(GetParam(\"Query\"));\n}\n```\n\nWorks like a charm.","src/posts/2010-01-27-calling-a-sharepoint-web-service-from-silverlight-over-http-and-https.md","d583e060e4975689",{"html":668,"metadata":669},"\u003Cp>The past couple of weeks I am working with Silverlight controls embedded in SharePoint 2007.\u003Cbr>\nFor one of the controls, I need to retrieve the data using the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/developer/sharepoint-2007/ms543175(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Search Query Web Service\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>This was working perfectly in the development environment.\nBut when deploying the control to the production environment it did not work.\u003C/p>\n\u003C!--more-->\n\u003Cp>I was using the following code:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:92ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">private\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">void\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Page_Loaded\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">sender\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">RoutedEventArgs\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">e\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">endpoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">EndpointAddress\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetParam\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"SharePointWeb\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"/_vti_bin/search.asmx\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">binding\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">BasicHttpBinding\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">BasicHttpSecurityMode\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">None\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:22ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">                      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:26ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"QueryServiceSoap\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:26ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">MaxReceivedMessageSize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">2147483647\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:26ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">MaxBufferSize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">2147483647\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:22ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">                      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">client\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">QueryServiceSoapClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">binding\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">endpoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">client\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">QueryExCompleted\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ClientQueryExCompleted\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">client\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">QueryExAsync\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetParam\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Query\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"private void Page_Loaded(object sender, RoutedEventArgs e){    var endpoint = new EndpointAddress(GetParam(&#x22;SharePointWeb&#x22;) + &#x22;/_vti_bin/search.asmx&#x22;);    var binding = new BasicHttpBinding(BasicHttpSecurityMode.None)                      {                          Name = &#x22;QueryServiceSoap&#x22;,                          MaxReceivedMessageSize = 2147483647,                          MaxBufferSize = 2147483647                      };    var client = new QueryServiceSoapClient(binding, endpoint);    client.QueryExCompleted += this.ClientQueryExCompleted;    client.QueryExAsync(GetParam(&#x22;Query&#x22;));}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>After some digging, I found that the control did actually work, but only when the page was visited over an \u003Cdfn>\u003Cabbr title=\"HyperText Transfer Protocol\">HTTP\u003C/abbr>\u003C/dfn> connection.\nAs visitors were accessing the page over an HTTPS connection, I was pointed in the direction of the connection between the control and the web service.\u003C/p>\n\u003Cp>As can be seen in the code the WCF client is used and I remembered that the binding security mode is different if you want to work with HTTPS.\nSo, I changed the \u003Ca href=\"https://learn.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/ms586334(v=vs.95)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">BasicHttpSecurityMode\u003Cspan>\u003C/span>\u003C/a> from \u003Ccode>None\u003C/code> to \u003Ccode>Transport\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"diff\" class=\"wrap\" style=\"--ecMaxLine:67ch\">\u003Ccode>\u003Cdiv class=\"ec-line highlight del\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">var binding = new BasicHttpBinding(BasicHttpSecurityMode.None)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight ins\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">var binding = new BasicHttpBinding(BasicHttpSecurityMode.Transport)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var binding = new BasicHttpBinding(BasicHttpSecurityMode.None)var binding = new BasicHttpBinding(BasicHttpSecurityMode.Transport)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>After deploying the control again, it worked nicely over the HTTPS connection, so I knew what the source of my problem is.\nBut naturally I want a generic solution so the configuration of the access mapping is not influencing the functioning of the control.\u003C/p>\n\u003Cp>The question is how to detect if the control is hosted on a page over an \u003Cabbr title=\"HyperText Transfer Protocol\">HTTP\u003C/abbr> or HTTPS connection. This can be found in the \u003Ca href=\"https://learn.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/cc190409(v=vs.95)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SilverlightHost.Source\u003C/code> property\u003Cspan>\u003C/span>\u003C/a> which can be compared against the \u003Ca href=\"https://learn.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/x3fzefx3(v=vs.95)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Uri.UriSchemeHttp\u003C/code> field\u003Cspan>\u003C/span>\u003C/a> or the \u003Ca href=\"https://learn.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/3s8hx381(v=vs.95)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Uri.UriSchemeHttps\u003C/code> field\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>As a result, this is my final code:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:92ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">private\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">void\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Page_Loaded\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">sender\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">RoutedEventArgs\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">e\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">basicHttpSecurityMode\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Application\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Current\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Host\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Source\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Scheme\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">==\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Uri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">UriSchemeHttp\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">?\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">BasicHttpSecurityMode\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">None\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">BasicHttpSecurityMode\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Transport\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">endPoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">EndpointAddress\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetParam\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"SharePointWeb\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"/_vti_bin/search.asmx\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">binding\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">BasicHttpBinding\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">basicHttpSecurityMode\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:22ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">                      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:26ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"QueryServiceSoap\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:26ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">MaxReceivedMessageSize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">2147483647\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:26ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">MaxBufferSize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">2147483647\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:22ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">                      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">client\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">QueryServiceSoapClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">binding\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">endPoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">client\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">QueryExCompleted\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ClientQueryExCompleted\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">client\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">QueryExAsync\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetParam\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Query\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"private void Page_Loaded(object sender, RoutedEventArgs e){    var basicHttpSecurityMode =        (Application.Current.Host.Source.Scheme == Uri.UriSchemeHttp)            ? BasicHttpSecurityMode.None            : BasicHttpSecurityMode.Transport;    var endPoint = new EndpointAddress(GetParam(&#x22;SharePointWeb&#x22;) + &#x22;/_vti_bin/search.asmx&#x22;);    var binding = new BasicHttpBinding(basicHttpSecurityMode)                      {                          Name = &#x22;QueryServiceSoap&#x22;,                          MaxReceivedMessageSize = 2147483647,                          MaxBufferSize = 2147483647                      };    var client = new QueryServiceSoapClient(binding, endPoint);    client.QueryExCompleted += this.ClientQueryExCompleted;    client.QueryExAsync(GetParam(&#x22;Query&#x22;));}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Works like a charm.\u003C/p>",{"headings":670,"imagePaths":671,"frontmatter":648},[],[],"2009-03-09-working-with-urls-in-sharepoint",{"id":672,"data":674,"body":686,"filePath":687,"digest":688,"rendered":689},{"id":675,"title":676,"date":677,"author":15,"excerpt":678,"layout":17,"permalink":679,"image":680,"categories":681,"tags":682,"draft":26},16,"Working with URL’s in SharePoint",["Date","2009-03-09T18:58:04.000Z"],"While working on a project with some existing code I noticed the developer did write large portions of code to get from an URL to a SPList. He probably didn’t know some of the hidden gems in SharePoint.\n","/2009/03/09/working-with-urls-in-sharepoint/","/wp-content/uploads/2009/03/post-16-thumnail-1.png",[183,132],[139,683,684,685],"SPUrlUtility","SPUtility","URI","While working on a project with some existing code I noticed the developer did write large portions of code to get from an URL to a [SPList](https://learn.microsoft.com/en-us/previous-versions/office/developer/sharepoint2003/dd587308(v=office.11)).\nHe probably didn't know some of the hidden gems in SharePoint.\n\n\u003C!--more-->\n\n### Get the full URL\n\nSometimes you need the full URL and only have the relative one.\nFor example, when opening a new [`SPSite`](https://learn.microsoft.com/en-us/previous-versions/office/developer/sharepoint2003/dd587403(v=office.11)) or when writing code in a [`SPNavigationProvider`](https://learn.microsoft.com/en-us/previous-versions/office/developer/sharepoint-services/ms470908(v=office.12)).\nFor this you could use the [`SPUtility` class](https://learn.microsoft.com/en-us/previous-versions/office/developer/sharepoint2003/dd587669(v=office.11)):\n\n```csharp\nSPUtility.GetFullUrl(SPSite Site, string WebUrl)\n```\n\nFor example:\n\n```csharp\nstring webUrl = \"/sub/default.aspx\";\nSPUtility.GetFullUrl(SPContext.Current.Site, webUrl);\n// \"http://localhost/sub/default.aspx\"\n```\n\nThere is one catch:\n\n```csharp\nstring webUrl = \"http://localhost/sub/default.aspx\";\nSPUtility.GetFullUrl(SPContext.Current.Site, webUrl);\n// \"http://localhosthttp://localhost/sub/default.aspx\"\n```\n\n### Check the type of URL\n\nThe former example is nice, but you would still need to write code to check if the input already contains the full URL. Nope!\n\nFor this, two gems are found in the [`SPUrlUtility` class](https://learn.microsoft.com/en-us/previous-versions/office/developer/sharepoint-services/ms461295(v=office.12)).\n\n```csharp\nSPUrlUtility.IsUrlRelative(string url);\nSPUrlUtility.IsUrFull(string url);\n```\n\nThese methods do exactly what their names imply: check if the URL is relative or full. So, for example:\n\n```csharp\nstring fullUrl = \"http://localhost/sub/default.aspx\";\nstring relUrl = \"/sub/default.aspx\";\nSPUrlUtility.IsUrlRelative(fullUrl); // false\nSPUrlUtility.IsUrlRelative(relUrl);  // true\nSPUrlUtility.IsUrlFull(fullUrl);     // true\nSPUrlUtility.IsUrlFull(relUrl);      // false\n```\n\nGreat! Now we can combine the two:\n\n```csharp\nif (string.IsNullOrEmpty(webUrl) || SPUrlUtility.IsUrlRelative(webUrl))\n{\n    webUrl = SPUtility.GetFullUrl(SPContext.Current.Site, webUrl);\n}\n```\n\nNow `webUrl` will always be the full URL.\n\n### URL concatenation\n\nEver did `web.ServerRelativeUrl + \"/something\"` and found out it did work nicely except it start doing something really weird on your root web?\nOn the `rootweb` the relative URL is `/`, and this results in the URL `//something` which on its own turn gets translated to `http://something`, and that URL doesn't exist (most of the time).\n\nWhen working with file system locations, you should always use `Path.Combine()` instead of concatenating path's yourself.\nBut there is no `Uri.Combine().`\n\nYou could write an extension method. But the SharePoint team made it easier.\n\n```csharp\nSPUrlUtility.CombineUrl(string baseUrlPath, string additionalNodes)\n```\n\nThis method does the same thing like `Path.Combine()`. For example:\n\n```csharp\nstring root = \"/\";\nstring path = \"/sub\"\nstring doc = \"/sub/default.aspx\";\nSPUrlUtility.CombineUrl(root, path); // \"/sub\"\nSPUrlUtility.CombineUrl(root, doc);  // \"/sub/default.aspx\"\nSPUrlUtility.CombineUrl(path, doc);  // \"/sub/sub/default.aspx\"\n```\n\nThat's the final (hidden) gem for today.","src/posts/2009-03-09-working-with-urls-in-sharepoint.md","5ae7a01fcd46ffed",{"html":690,"metadata":691},"\u003Cp>While working on a project with some existing code I noticed the developer did write large portions of code to get from an \u003Cdfn>\u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>\u003C/dfn> to a \u003Ca href=\"https://learn.microsoft.com/en-us/previous-versions/office/developer/sharepoint2003/dd587308(v=office.11)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">SPList\u003Cspan>\u003C/span>\u003C/a>.\nHe probably didn’t know some of the hidden gems in SharePoint.\u003C/p>\n\u003C!--more-->\n\u003Ch3 id=\"get-the-full-url\">Get the full \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>\u003C/h3>\n\u003Cp>Sometimes you need the full \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr> and only have the relative one.\nFor example, when opening a new \u003Ca href=\"https://learn.microsoft.com/en-us/previous-versions/office/developer/sharepoint2003/dd587403(v=office.11)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPSite\u003C/code>\u003Cspan>\u003C/span>\u003C/a> or when writing code in a \u003Ca href=\"https://learn.microsoft.com/en-us/previous-versions/office/developer/sharepoint-services/ms470908(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPNavigationProvider\u003C/code>\u003Cspan>\u003C/span>\u003C/a>.\nFor this you could use the \u003Ca href=\"https://learn.microsoft.com/en-us/previous-versions/office/developer/sharepoint2003/dd587669(v=office.11)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPUtility\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:48ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetFullUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SPSite\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Site\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">WebUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"SPUtility.GetFullUrl(SPSite Site, string WebUrl)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>For example:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:53ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">webUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"/sub/default.aspx\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetFullUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SPContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Current\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Site\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">webUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// \"http://localhost/sub/default.aspx\"\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"string webUrl = &#x22;/sub/default.aspx&#x22;;SPUtility.GetFullUrl(SPContext.Current.Site, webUrl);// &#x22;http://localhost/sub/default.aspx&#x22;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>There is one catch:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:54ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">webUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"http://localhost/sub/default.aspx\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetFullUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SPContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Current\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Site\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">webUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// \"http://localhosthttp://localhost/sub/default.aspx\"\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"string webUrl = &#x22;http://localhost/sub/default.aspx&#x22;;SPUtility.GetFullUrl(SPContext.Current.Site, webUrl);// &#x22;http://localhosthttp://localhost/sub/default.aspx&#x22;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"check-the-type-of-url\">Check the type of \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>\u003C/h3>\n\u003Cp>The former example is nice, but you would still need to write code to check if the input already contains the full \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>. Nope!\u003C/p>\n\u003Cp>For this, two gems are found in the \u003Ca href=\"https://learn.microsoft.com/en-us/previous-versions/office/developer/sharepoint-services/ms461295(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPUrlUtility\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:39ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUrlUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsUrlRelative\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">url\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUrlUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsUrFull\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">url\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"SPUrlUtility.IsUrlRelative(string url);SPUrlUtility.IsUrFull(string url);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>These methods do exactly what their names imply: check if the \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr> is relative or full. So, for example:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:53ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">fullUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"http://localhost/sub/default.aspx\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">relUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"/sub/default.aspx\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUrlUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsUrlRelative\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">fullUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">); \u003C/span>\u003Cspan style=\"--0:#76A162\">// false\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUrlUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsUrlRelative\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">relUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);  \u003C/span>\u003Cspan style=\"--0:#76A162\">// true\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUrlUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsUrlFull\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">fullUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);     \u003C/span>\u003Cspan style=\"--0:#76A162\">// true\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUrlUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsUrlFull\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">relUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);      \u003C/span>\u003Cspan style=\"--0:#76A162\">// false\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"string fullUrl = &#x22;http://localhost/sub/default.aspx&#x22;;string relUrl = &#x22;/sub/default.aspx&#x22;;SPUrlUtility.IsUrlRelative(fullUrl); // falseSPUrlUtility.IsUrlRelative(relUrl);  // trueSPUrlUtility.IsUrlFull(fullUrl);     // trueSPUrlUtility.IsUrlFull(relUrl);      // false\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Great! Now we can combine the two:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:71ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsNullOrEmpty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">webUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">||\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SPUrlUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsUrlRelative\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">webUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">))\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">webUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SPUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetFullUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SPContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Current\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Site\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">webUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"if (string.IsNullOrEmpty(webUrl) || SPUrlUtility.IsUrlRelative(webUrl)){    webUrl = SPUtility.GetFullUrl(SPContext.Current.Site, webUrl);}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now \u003Ccode>webUrl\u003C/code> will always be the full \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>.\u003C/p>\n\u003Ch3 id=\"url-concatenation\">\u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr> concatenation\u003C/h3>\n\u003Cp>Ever did \u003Ccode>web.ServerRelativeUrl + \"/something\"\u003C/code> and found out it did work nicely except it start doing something really weird on your root web?\nOn the \u003Ccode>rootweb\u003C/code> the relative \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr> is \u003Ccode>/\u003C/code>, and this results in the \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr> \u003Ccode>//something\u003C/code> which on its own turn gets translated to \u003Ccode>http://something\u003C/code>, and that \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr> doesn’t exist (most of the time).\u003C/p>\n\u003Cp>When working with file system locations, you should always use \u003Ccode>Path.Combine()\u003C/code> instead of concatenating path’s yourself.\nBut there is no \u003Ccode>Uri.Combine().\u003C/code>\u003C/p>\n\u003Cp>You could write an extension method. But the SharePoint team made it easier.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:67ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUrlUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CombineUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">baseUrlPath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">additionalNodes\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"SPUrlUtility.CombineUrl(string baseUrlPath, string additionalNodes)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This method does the same thing like \u003Ccode>Path.Combine()\u003C/code>. For example:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:63ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">root\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"/\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">path\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"/sub\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">doc\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"/sub/default.aspx\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUrlUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CombineUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">root\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">path\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">); \u003C/span>\u003Cspan style=\"--0:#76A162\">// \"/sub\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUrlUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CombineUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">root\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">doc\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);  \u003C/span>\u003Cspan style=\"--0:#76A162\">// \"/sub/default.aspx\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">SPUrlUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CombineUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">path\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">doc\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);  \u003C/span>\u003Cspan style=\"--0:#76A162\">// \"/sub/sub/default.aspx\"\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"string root = &#x22;/&#x22;;string path = &#x22;/sub&#x22;string doc = &#x22;/sub/default.aspx&#x22;;SPUrlUtility.CombineUrl(root, path); // &#x22;/sub&#x22;SPUrlUtility.CombineUrl(root, doc);  // &#x22;/sub/default.aspx&#x22;SPUrlUtility.CombineUrl(path, doc);  // &#x22;/sub/sub/default.aspx&#x22;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>That’s the final (hidden) gem for today.\u003C/p>",{"headings":692,"imagePaths":702,"frontmatter":674},[693,696,699],{"depth":198,"slug":694,"text":695},"get-the-full-url","Get the full URL",{"depth":198,"slug":697,"text":698},"check-the-type-of-url","Check the type of URL",{"depth":198,"slug":700,"text":701},"url-concatenation","URL concatenation",[],"2010-03-03-installing-the-microsoft-surface-sdk-on-windows-7-x64",{"id":703,"data":705,"body":717,"filePath":718,"digest":719,"rendered":720},{"id":706,"title":707,"date":708,"author":15,"excerpt":709,"layout":17,"permalink":710,"image":711,"categories":712,"tags":713,"draft":26},122,"Installing the Microsoft Surface SDK on Windows 7 x64",["Date","2010-03-03T16:22:49.000Z"],"If you want to develop for the Microsoft Surface you need a Surface device, but using the device to develop is not always practical, specially when there are more developers than Surface devices. The solution for this is to install the Surface SDK on you local development machine. This post will address some limitations you have to work around.\n","/2010/03/03/installing-the-microsoft-surface-sdk-on-windows-7-x64/","/wp-content/uploads/2010/03/post-122-thumnail-1.png",[614],[714,715,25,716,111,113],"CorFlags","Orca","Vista","If you want to develop for the **Microsoft Surface** (the table, not the tablet) you need a Surface device.\nBut using the device to develop is not always practical, especially when there are more developers than Surface devices.\n\nThe solution for this is to install the Surface SDK Workstation Edition on your local development machine.\nThis article will address some limitations you have to work around.\n\n\u003C!--more-->\n\n### The Microsoft Surface SDK\n\nThe Microsoft Surface SDK was released to attendees of the PDC in 2008, making me one of the lucky few. You can still view the \"[Developing for Microsoft Surface](https://learn.microsoft.com/shows/pdc-pdc08/pc17)\" session on [Channel 9](https://channel9.msdn.com/).\n\nWith the PDC 2009 the **Microsoft Surface SDK 1.0 SP1 Workstation Edition** was publicly released.\n\n### Prerequisites\n\nBefore you can install the Surface SDK, there are some prerequisites:\n\n- Windows Vista (not Starter Edition) **x86**\n- Microsoft XNA Framework Redistributable 2.0\n- Microsoft Visual C# 2008 Express Edition or Microsoft Visual Studio 2008\n\n### When you are running Vista x86\n\nAssuming you are not running Windows Vista Starter Edition, you can install the Surface SDK without problems and can start developing immediately!\n\n### When you are _not_ running Vista, or x86\n\n![Error dialog displaying the message: \"Your system does not have the correct version of Windows Vista. You must install Microsoft Surface SDK 1.0 SP1, Workstation Edition on a 32-bit version of Windows Vista with Service Pack 1 (SP1). Microsoft Surface SDK 1.0 SP1, Workstation Edition also does not support Windows Vista Starter edition.\"](/wp-content/uploads/2010/03/error-dialog-not-correct-version-windows-vista.png 'Error dialog displaying the message: \"Your system does not have the correct version of Windows Vista. You must install Microsoft Surface SDK 1.0 SP1, Workstation Edition on a 32-bit version of Windows Vista with Service Pack 1 (SP1). Microsoft Surface SDK 1.0 SP1, Workstation Edition also does not support Windows Vista Starter edition.\"')\n\nLet's face it, Windows Vista is old and gone, and everybody is running Windows 7 nowadays.\nSo, does this mean no more Surface development?\n\nLucky enough [Brian Peek](https://brianpeek.com/) wrote [a great blog post](https://brianpeek.com/install-the-surface-sdk-sp1-workstation-edition-on-x64/) about this and I will summarize it here.\n\nNaturally this makes the installation not supported by Microsoft.\n\n### Extracting the installer\n\nThere are two installers on the web available at the moment. An executable if you download the SDK from the partner site and a MSI if you download the SDK from the public Microsoft download site.\n\nFor the MSI:\n\n```shell\nmsiexec /a SurfaceSDKWE.msi /qb TARGETDIR=c:\\surface\n```\n\nFor the executable:\n\n```shell\n\"Microsoft Surface SDK 1.0 SP1, Workstation Edition.exe\" /extract c:\\surface\n```\n\n### Patching the installer\n\nGet the [Orca](https://learn.microsoft.com/windows/win32/msi/orca-exe) tool from the [Windows SDK](https://www.microsoft.com/download/details.aspx?id=8279), or if you do not want to download 4GB for a tool not bigger than 2MB, try [a less supported site](https://www.softpedia.com/get/Authoring-tools/Setup-creators/Orca.shtml). 😉\n\n1. Open the extracted `SurfaceSDKWE.msi` file with Orca.\n2. Select the table `LaunchCondition`\n3. Select the row with `Installed OR NOT VersionNT64` and choose \u003Ckbd>Drop row\u003C/kbd>\n4. Save & Close Orca\n\n### Patching the Custom Actions\n\n> [!NOTE]\n> This is only needed on a x64 machine.\n\nGet the [CorFlags](https://learn.microsoft.com/dotnet/framework/tools/corflags-exe-corflags-conversion-tool) tool from the Windows SDK.\n\n1. Open a command prompt _with elevated privileges_ (Run as administrator).\n2. Go to the location of the extracted installer\n\n   ```shell\n   cd \"Microsoft Surface\\v1.0\"\n   CorFlags setupcustomaction.exe /32BIT+ /Force /nologo\n   ```\n\n   Ignore the warning with the code CF011 about strong named signing.\n\n   ![Command prompt showing the warning \"corflags : warning CF011 : The specified file is strong name signed. Using /Force will invalidate the signature of this image and will require the assembly to be resigned.\" after execution.](/wp-content/uploads/2010/03/corflags-warning-file-strong-name-signed.png)\n\n### Installing the SDK\n\nThis is pretty straightforward.\n\n![First screen of the Microsoft Surface SDK 1.0 SP1, Workstation Edition Setup](/wp-content/uploads/2010/03/installer-surface-sdk.png)\nIf you are running on a x86 system you can start developing!\n\n### Patching the executables\n\n> [!NOTE]\n> This is only needed on a x64 machine.\n\nTo make sure the Surface SDK executables are using the x86 CLR you have to patch them all.\n\n```shell\ncd \"C:\\Program Files (x86)\\Microsoft SDKs\\Surface\\v1.0\\Tools\\GenTag\"\nfor %i in (*.exe) do CorFlags %i /32BIT+ /Force /nologo /UpgradeCLRHeader\n\ncd \"C:\\Program Files (x86)\\Microsoft SDKs\\Surface\\v1.0\\Tools\\Simulator\"\nfor %i in (*.exe) do CorFlags %i /32BIT+ /Force /nologo /UpgradeCLRHeader\n\ncd \"C:\\Program Files (x86)\\Microsoft SDKs\\Surface\\v1.0\\Tools\\SurfaceStress\"\nfor %i in (*.exe) do CorFlags %i /32BIT+ /Force /nologo\n\ncd \"C:\\Program Files (x86)\\Microsoft Surface\\v1.0\"\nfor %i in (*.exe) do CorFlags %i /32BIT+ /Force /nologo\n```\n\n### Patching the Sample Applications\n\n> [!NOTE]\n> This is only needed on a x64 machine.\n\nModify all projects files (`*.csproj`) and change the build type from `Any CPU` to `x86`.\n\nFor example, add the following to the appropriate `PropertyGroup` tags:\n\n```xml\n\u003CPlatformTarget>x86\u003C/PlatformTarget>\n```","src/posts/2010-03-03-installing-the-microsoft-surface-sdk-on-windows-7-x64.md","1b2567cc7f9c9a20",{"html":721,"metadata":722},"\u003Cp>If you want to develop for the \u003Cstrong>Microsoft Surface\u003C/strong> (the table, not the tablet) you need a Surface device.\nBut using the device to develop is not always practical, especially when there are more developers than Surface devices.\u003C/p>\n\u003Cp>The solution for this is to install the Surface \u003Cdfn>\u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/dfn> Workstation Edition on your local development machine.\nThis article will address some limitations you have to work around.\u003C/p>\n\u003C!--more-->\n\u003Ch3 id=\"the-microsoft-surface-sdk\">The Microsoft Surface \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/h3>\n\u003Cp>The Microsoft Surface \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr> was released to attendees of the PDC in 2008, making me one of the lucky few. You can still view the “\u003Ca href=\"https://learn.microsoft.com/shows/pdc-pdc08/pc17?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Developing for Microsoft Surface\u003Cspan>\u003C/span>\u003C/a>” session on \u003Ca href=\"https://channel9.msdn.com/\" rel=\"noopener noreferrer external\" target=\"_blank\">Channel 9\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>With the PDC 2009 the \u003Cstrong>Microsoft Surface \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr> 1.0 \u003Cdfn>\u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr>\u003C/dfn> Workstation Edition\u003C/strong> was publicly released.\u003C/p>\n\u003Ch3 id=\"prerequisites\">Prerequisites\u003C/h3>\n\u003Cp>Before you can install the Surface \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>, there are some prerequisites:\u003C/p>\n\u003Cul>\n\u003Cli>Windows Vista (not Starter Edition) \u003Cstrong>x86\u003C/strong>\u003C/li>\n\u003Cli>Microsoft XNA Framework Redistributable 2.0\u003C/li>\n\u003Cli>Microsoft Visual C# 2008 Express Edition or Microsoft Visual Studio 2008\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"when-you-are-running-vista-x86\">When you are running Vista x86\u003C/h3>\n\u003Cp>Assuming you are not running Windows Vista Starter Edition, you can install the Surface \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr> without problems and can start developing immediately!\u003C/p>\n\u003Ch3 id=\"when-you-are-not-running-vista-or-x86\">When you are \u003Cem>not\u003C/em> running Vista, or x86\u003C/h3>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/03/error-dialog-not-correct-version-windows-vista.webp\" type=\"image/webp\" media=\"(max-width: 380px)\">\u003Csource srcset=\"/wp-content/uploads/2010/03/error-dialog-not-correct-version-windows-vista-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Cimg src=\"/wp-content/uploads/2010/03/error-dialog-not-correct-version-windows-vista.png\" alt=\"Error dialog displaying the message: &#x22;Your system does not have the correct version of Windows Vista. You must install Microsoft Surface SDK 1.0 SP1, Workstation Edition on a 32-bit version of Windows Vista with Service Pack 1 (SP1). Microsoft Surface SDK 1.0 SP1, Workstation Edition also does not support Windows Vista Starter edition.&#x22;\" loading=\"lazy\" decoding=\"async\" width=\"380\" height=\"182\" srcset=\"/wp-content/uploads/2010/03/error-dialog-not-correct-version-windows-vista.png 380w, /wp-content/uploads/2010/03/error-dialog-not-correct-version-windows-vista-150x150.png 150w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Error dialog displaying the message: \"Your system does not have the correct version of Windows Vista. You must install Microsoft Surface SDK 1.0 SP1, Workstation Edition on a 32-bit version of Windows Vista with Service Pack 1 (SP1). Microsoft Surface SDK 1.0 SP1, Workstation Edition also does not support Windows Vista Starter edition.\"\u003C/figcaption>\u003C/figure>\n\u003Cp>Let’s face it, Windows Vista is old and gone, and everybody is running Windows 7 nowadays.\nSo, does this mean no more Surface development?\u003C/p>\n\u003Cp>Lucky enough \u003Ca href=\"https://brianpeek.com/\" rel=\"noopener noreferrer external\" target=\"_blank\">Brian Peek\u003Cspan>\u003C/span>\u003C/a> wrote \u003Ca href=\"https://brianpeek.com/install-the-surface-sdk-sp1-workstation-edition-on-x64/\" rel=\"noopener noreferrer external\" target=\"_blank\">a great blog post\u003Cspan>\u003C/span>\u003C/a> about this and I will summarize it here.\u003C/p>\n\u003Cp>Naturally this makes the installation not supported by Microsoft.\u003C/p>\n\u003Ch3 id=\"extracting-the-installer\">Extracting the installer\u003C/h3>\n\u003Cp>There are two installers on the web available at the moment. An executable if you download the \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr> from the partner site and a \u003Cdfn>\u003Cabbr title=\"Microsoft Installer\">MSI\u003C/abbr>\u003C/dfn> if you download the \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr> from the public Microsoft download site.\u003C/p>\n\u003Cp>For the \u003Cabbr title=\"Microsoft Installer\">MSI\u003C/abbr>:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:52ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">msiexec\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/a\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">SurfaceSDKWE.msi\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/qb\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">TARGETDIR=c:\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\s\u003C/span>\u003Cspan style=\"--0:#CE9178\">urface\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"msiexec /a SurfaceSDKWE.msi /qb TARGETDIR=c:\\surface\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>For the executable:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:76ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">\"Microsoft Surface SDK 1.0 SP1, Workstation Edition.exe\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/extract\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">c:\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\s\u003C/span>\u003Cspan style=\"--0:#CE9178\">urface\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"&#x22;Microsoft Surface SDK 1.0 SP1, Workstation Edition.exe&#x22; /extract c:\\surface\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"patching-the-installer\">Patching the installer\u003C/h3>\n\u003Cp>Get the \u003Ca href=\"https://learn.microsoft.com/windows/win32/msi/orca-exe?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Orca\u003Cspan>\u003C/span>\u003C/a> tool from the \u003Ca href=\"https://www.microsoft.com/download/details.aspx?id=8279\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003Cspan>\u003C/span>\u003C/a>, or if you do not want to download 4GB for a tool not bigger than 2MB, try \u003Ca href=\"https://www.softpedia.com/get/Authoring-tools/Setup-creators/Orca.shtml\" rel=\"noopener noreferrer external\" target=\"_blank\">a less supported site\u003Cspan>\u003C/span>\u003C/a>. \u003Cspan role=\"img\" aria-label=\"winking face\">😉\u003C/span>\u003C/p>\n\u003Col>\n\u003Cli>Open the extracted \u003Ccode>SurfaceSDKWE.msi\u003C/code> file with Orca.\u003C/li>\n\u003Cli>Select the table \u003Ccode>LaunchCondition\u003C/code>\u003C/li>\n\u003Cli>Select the row with \u003Ccode>Installed OR NOT VersionNT64\u003C/code> and choose \u003Ckbd>Drop row\u003C/kbd>\u003C/li>\n\u003Cli>Save &#x26; Close Orca\u003C/li>\n\u003C/ol>\n\u003Ch3 id=\"patching-the-custom-actions\">Patching the Custom Actions\u003C/h3>\n\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\nThis is only needed on a x64 machine.\u003C/p>\n\u003C/div>\n\u003Cp>Get the \u003Ca href=\"https://learn.microsoft.com/dotnet/framework/tools/corflags-exe-corflags-conversion-tool?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">CorFlags\u003Cspan>\u003C/span>\u003C/a> tool from the Windows \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>.\u003C/p>\n\u003Col>\n\u003Cli>\n\u003Cp>Open a command prompt \u003Cem>with elevated privileges\u003C/em> (Run as administrator).\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Go to the location of the extracted installer\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:53ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">cd\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft Surface\\v1.0\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">CorFlags\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">setupcustomaction.exe\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/32BIT+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/Force\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/nologo\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"cd &#x22;Microsoft Surface\\v1.0&#x22;CorFlags setupcustomaction.exe /32BIT+ /Force /nologo\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Ignore the warning with the code CF011 about strong named signing.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/03/corflags-warning-file-strong-name-signed.webp\" type=\"image/webp\" media=\"(max-width: 604px)\">\u003Cimg src=\"/wp-content/uploads/2010/03/corflags-warning-file-strong-name-signed.png\" alt=\"Command prompt showing the warning &#x22;corflags : warning CF011 : The specified file is strong name signed. Using /Force will invalidate the signature of this image and will require the assembly to be resigned.&#x22; after execution.\" loading=\"lazy\" decoding=\"async\" width=\"604\" height=\"123\" srcset=\"/wp-content/uploads/2010/03/corflags-warning-file-strong-name-signed.png 604w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003C/li>\n\u003C/ol>\n\u003Ch3 id=\"installing-the-sdk\">Installing the \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/h3>\n\u003Cp>This is pretty straightforward.\u003C/p>\n\u003Cp>\u003C/p>\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/03/installer-surface-sdk.webp\" type=\"image/webp\" media=\"(max-width: 512px)\">\u003Csource srcset=\"/wp-content/uploads/2010/03/installer-surface-sdk-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/03/installer-surface-sdk-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/03/installer-surface-sdk.png\" alt=\"First screen of the Microsoft Surface SDK 1.0 SP1, Workstation Edition Setup\" loading=\"lazy\" decoding=\"async\" width=\"512\" height=\"400\" srcset=\"/wp-content/uploads/2010/03/installer-surface-sdk.png 512w, /wp-content/uploads/2010/03/installer-surface-sdk-150x150.png 150w, /wp-content/uploads/2010/03/installer-surface-sdk-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\nIf you are running on a x86 system you can start developing!\u003Cp>\u003C/p>\n\u003Ch3 id=\"patching-the-executables\">Patching the executables\u003C/h3>\n\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\nThis is only needed on a x64 machine.\u003C/p>\n\u003C/div>\n\u003Cp>To make sure the Surface \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr> executables are using the x86 CLR you have to patch them all.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:75ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">cd\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"C:\\Program Files (x86)\\Microsoft SDKs\\Surface\\v1.0\\Tools\\GenTag\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">for\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> %i in (\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">*\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.exe) \u003C/span>\u003Cspan style=\"--0:#C586C0\">do\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> CorFlags %i /32BIT+ /Force /nologo /UpgradeCLRHeader\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">cd\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"C:\\Program Files (x86)\\Microsoft SDKs\\Surface\\v1.0\\Tools\\Simulator\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">for\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> %i in (\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">*\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.exe) \u003C/span>\u003Cspan style=\"--0:#C586C0\">do\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> CorFlags %i /32BIT+ /Force /nologo /UpgradeCLRHeader\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">cd\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"C:\\Program Files (x86)\\Microsoft SDKs\\Surface\\v1.0\\Tools\\SurfaceStress\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">for\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> %i in (\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">*\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.exe) \u003C/span>\u003Cspan style=\"--0:#C586C0\">do\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> CorFlags %i /32BIT+ /Force /nologo\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">cd\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"C:\\Program Files (x86)\\Microsoft Surface\\v1.0\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">for\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> %i in (\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">*\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.exe) \u003C/span>\u003Cspan style=\"--0:#C586C0\">do\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> CorFlags %i /32BIT+ /Force /nologo\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"cd &#x22;C:\\Program Files (x86)\\Microsoft SDKs\\Surface\\v1.0\\Tools\\GenTag&#x22;for %i in (*.exe) do CorFlags %i /32BIT+ /Force /nologo /UpgradeCLRHeadercd &#x22;C:\\Program Files (x86)\\Microsoft SDKs\\Surface\\v1.0\\Tools\\Simulator&#x22;for %i in (*.exe) do CorFlags %i /32BIT+ /Force /nologo /UpgradeCLRHeadercd &#x22;C:\\Program Files (x86)\\Microsoft SDKs\\Surface\\v1.0\\Tools\\SurfaceStress&#x22;for %i in (*.exe) do CorFlags %i /32BIT+ /Force /nologocd &#x22;C:\\Program Files (x86)\\Microsoft Surface\\v1.0&#x22;for %i in (*.exe) do CorFlags %i /32BIT+ /Force /nologo\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"patching-the-sample-applications\">Patching the Sample Applications\u003C/h3>\n\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\nThis is only needed on a x64 machine.\u003C/p>\n\u003C/div>\n\u003Cp>Modify all projects files (\u003Ccode>*.csproj\u003C/code>) and change the build type from \u003Ccode>Any CPU\u003C/code> to \u003Ccode>x86\u003C/code>.\u003C/p>\n\u003Cp>For example, add the following to the appropriate \u003Ccode>PropertyGroup\u003C/code> tags:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:36ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">PlatformTarget\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">x86\u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">PlatformTarget\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003CPlatformTarget>x86\u003C/PlatformTarget>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>",{"headings":723,"imagePaths":754,"frontmatter":705},[724,727,730,733,736,739,742,745,748,751],{"depth":198,"slug":725,"text":726},"the-microsoft-surface-sdk","The Microsoft Surface SDK",{"depth":198,"slug":728,"text":729},"prerequisites","Prerequisites",{"depth":198,"slug":731,"text":732},"when-you-are-running-vista-x86","When you are running Vista x86",{"depth":198,"slug":734,"text":735},"when-you-are-not-running-vista-or-x86","When you are not running Vista, or x86",{"depth":198,"slug":737,"text":738},"extracting-the-installer","Extracting the installer",{"depth":198,"slug":740,"text":741},"patching-the-installer","Patching the installer",{"depth":198,"slug":743,"text":744},"patching-the-custom-actions","Patching the Custom Actions",{"depth":198,"slug":746,"text":747},"installing-the-sdk","Installing the SDK",{"depth":198,"slug":749,"text":750},"patching-the-executables","Patching the executables",{"depth":198,"slug":752,"text":753},"patching-the-sample-applications","Patching the Sample Applications",[],"2010-03-26-could-not-load-type-idataserviceupdateprovider-when-using-rest-with-sharepoint-2010",{"id":755,"data":757,"body":772,"filePath":773,"digest":774,"rendered":775},{"id":758,"title":759,"date":760,"updated":761,"author":15,"excerpt":762,"layout":17,"permalink":763,"image":764,"categories":765,"tags":766,"draft":26},140,"Could not load type IDataServiceUpdateProvider when using REST with SharePoint 2010",["Date","2010-03-26T10:00:06.000Z"],["Date","2020-12-03T22:45:31.000Z"],"I wanted to use the new REST services in SharePoint 2010.\nBut when I navigated to the ListData.svc service. I got the following error: “Could not load type 'System.Data.Services.Providers.IDataServiceUpdateProvider' from assembly 'System.Data.Services, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.”\n","/2010/03/26/could-not-load-type-idataserviceupdateprovider-when-using-rest-with-sharepoint-2010/","/wp-content/uploads/2010/03/post-140-thumnail-1.png",[132],[767,768,769,770,771,160,716,662,111,163,164],"ADO.NET","Atom","Data Services","OData","REST","I wanted to use the new REST services in SharePoint 2010. But when I navigated to the `ListData.svc` service.\r\nI got the following error:\r\n\r\n![Screenshot displaying SharePoint 2010 showing the following error: \"Could not load type 'System.Data.Services.Providers.IDataServiceUpdateProvider' from assembly 'System.Data.Services, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089'.\"](/wp-content/uploads/2010/03/error-load-type-idataserviceupdateprovider.png)\r\n\r\nFirst, I checked if there was a `System.Data.Services` entry in the GAC (Global Assembly Cache).\r\nThere was one with version 3.5.30729.1. So, it was not a missing file.\r\n\r\nSearching the web on the error...\r\n\r\n> Could not load type 'System.­Data.­Services.­Providers.­IDataServiceUpdateProvider'\r\n> from assembly 'System.­Data.­Services, Version=3.5.0.0, Culture=­neutral, PublicKeyToken=­b77a5c561934e089'\r\n\r\n...does not provide many hints to what is causing this error.  \r\nMost sites suggest to install **ADO.NET Data Services v1.5 CTP2**, but I already had.\r\n\r\nI finally found the page [REST and SharePoint 2010 Quick Start Guide](https://scottcurrier.wordpress.com/2010/02/20/rest-and-sharepoint-2010-quick-start-guide-table-of-contents/)\r\nby Scott Currier.\r\nHe suggests to install the [ADO.NET Data Services Update for .NET 3.5 SP1](https://learn.microsoft.com/archive/blogs/astoriateam/data-services-update-for-net-3-5-sp1-now-available-for-download).\r\nAs it turns out, this is _the final release_ of the ADO.NET Services v1.5!\r\n\r\nThe update comes in two flavors.\r\n\r\n## For Windows 7 AND Windows Server 2008 R2\r\n\r\n[Download the ADO.NET Data Services Update for .NET Framework 3.5 SP1 for Windows 7 and Windows Server 2008 R2](https://www.microsoft.com/en-us/download/details.aspx?id=2343).\r\n\r\nAfter installing the version of the `System.Data.Services.dll` file is `3.5.30729.5004`.\r\n\r\n## For Windows 2000, Windows XP, Windows Vista, Windows Server 2003 AND Windows Server 2008\r\n\r\n[Download the ADO.NET Data Services Update for .NET Framework 3.5 SP1 for Windows 2000, Windows Server 2003, Windows XP, Windows Vista and Windows Server 2008](http://www.microsoft.com/download/details.aspx?familyid=21f20103-551e-4501-89b3-e53fcac5cffd).\r\n\r\nAfter installing the version of the `System.Data.Services.dll` file is `3.5.30729.4466`.\r\n\r\n## Testing\r\n\r\nAfter I installed the update, I browsed to the `ListData.svc` service.\r\n\r\n![Screenshot displaying the service description of a SharePoint 2010 Team Site as an atom feed.](/wp-content/uploads/2010/03/sharepoint-atom-feed.png \"The service description of a SharePoint 2010 Team Site as an atom feed.\")","src/posts/2010-03-26-could-not-load-type-idataserviceupdateprovider-when-using-rest-with-sharepoint-2010.md","e28c11e0b3e7f30c",{"html":776,"metadata":777},"\u003Cp>I wanted to use the new \u003Cdfn>\u003Cabbr title=\"Representational State Transfer\">REST\u003C/abbr>\u003C/dfn> services in SharePoint 2010. But when I navigated to the \u003Ccode>ListData.svc\u003C/code> service.\r\nI got the following error:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/03/error-load-type-idataserviceupdateprovider.webp\" type=\"image/webp\" media=\"(max-width: 582px)\">\u003Csource srcset=\"/wp-content/uploads/2010/03/error-load-type-idataserviceupdateprovider-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/03/error-load-type-idataserviceupdateprovider-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/03/error-load-type-idataserviceupdateprovider.png\" alt=\"Screenshot displaying SharePoint 2010 showing the following error: &#x22;Could not load type &#x27;System.Data.Services.Providers.IDataServiceUpdateProvider&#x27; from assembly &#x27;System.Data.Services, Version=3.5.0.0, Culture=neutral, PublicKeyToken=b77a5c561934e089&#x27;.&#x22;\" loading=\"lazy\" decoding=\"async\" width=\"582\" height=\"300\" srcset=\"/wp-content/uploads/2010/03/error-load-type-idataserviceupdateprovider.png 582w, /wp-content/uploads/2010/03/error-load-type-idataserviceupdateprovider-150x150.png 150w, /wp-content/uploads/2010/03/error-load-type-idataserviceupdateprovider-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>First, I checked if there was a \u003Ccode>System.Data.Services\u003C/code> entry in the \u003Cdfn>\u003Cabbr title=\"Global Assembly Cache\">GAC\u003C/abbr>\u003C/dfn> (Global Assembly Cache).\r\nThere was one with version 3.5.30729.1. So, it was not a missing file.\u003C/p>\n\u003Cp>Searching the web on the error…\u003C/p>\n\u003Cblockquote>\n\u003Cp>Could not load type ‘System.­Data.­Services.­Providers.­IDataServiceUpdateProvider’\r\nfrom assembly ‘System.­Data.­Services, Version=3.5.0.0, Culture=­neutral, PublicKeyToken=­b77a5c561934e089’\u003C/p>\n\u003C/blockquote>\n\u003Cp>…does not provide many hints to what is causing this error.\u003Cbr>\nMost sites suggest to install \u003Cstrong>ADO.NET Data Services v1.5 CTP2\u003C/strong>, but I already had.\u003C/p>\n\u003Cp>I finally found the page \u003Ca href=\"https://scottcurrier.wordpress.com/2010/02/20/rest-and-sharepoint-2010-quick-start-guide-table-of-contents/\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Cabbr title=\"Representational State Transfer\">REST\u003C/abbr> and SharePoint 2010 Quick Start Guide\u003Cspan>\u003C/span>\u003C/a>\r\nby Scott Currier.\r\nHe suggests to install the \u003Ca href=\"https://learn.microsoft.com/archive/blogs/astoriateam/data-services-update-for-net-3-5-sp1-now-available-for-download?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">ADO.NET Data Services Update for .NET 3.5 \u003Cdfn>\u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr>\u003C/dfn>\u003Cspan>\u003C/span>\u003C/a>.\r\nAs it turns out, this is \u003Cem>the final release\u003C/em> of the ADO.NET Services v1.5!\u003C/p>\n\u003Cp>The update comes in two flavors.\u003C/p>\n\u003Ch2 id=\"for-windows-7-and-windows-server-2008-r2\">For Windows 7 AND Windows Server 2008 R2\u003C/h2>\n\u003Cp>\u003Ca href=\"https://www.microsoft.com/en-us/download/details.aspx?id=2343\" rel=\"noopener noreferrer external\" target=\"_blank\">Download the ADO.NET Data Services Update for .NET Framework 3.5 \u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr> for Windows 7 and Windows Server 2008 R2\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>After installing the version of the \u003Ccode>System.Data.Services.dll\u003C/code> file is \u003Ccode>3.5.30729.5004\u003C/code>.\u003C/p>\n\u003Ch2 id=\"for-windows-2000-windows-xp-windows-vista-windows-server-2003-and-windows-server-2008\">For Windows 2000, Windows XP, Windows Vista, Windows Server 2003 AND Windows Server 2008\u003C/h2>\n\u003Cp>\u003Ca href=\"http://www.microsoft.com/download/details.aspx?familyid=21f20103-551e-4501-89b3-e53fcac5cffd\" rel=\"noopener noreferrer external\" target=\"_blank\">Download the ADO.NET Data Services Update for .NET Framework 3.5 \u003Cabbr title=\"Service Pack 1\">SP1\u003C/abbr> for Windows 2000, Windows Server 2003, Windows XP, Windows Vista and Windows Server 2008\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>After installing the version of the \u003Ccode>System.Data.Services.dll\u003C/code> file is \u003Ccode>3.5.30729.4466\u003C/code>.\u003C/p>\n\u003Ch2 id=\"testing\">Testing\u003C/h2>\n\u003Cp>After I installed the update, I browsed to the \u003Ccode>ListData.svc\u003C/code> service.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/03/sharepoint-atom-feed.webp\" type=\"image/webp\" media=\"(max-width: 594px)\">\u003Csource srcset=\"/wp-content/uploads/2010/03/sharepoint-atom-feed-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/03/sharepoint-atom-feed-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/03/sharepoint-atom-feed.png\" alt=\"Screenshot displaying the service description of a SharePoint 2010 Team Site as an atom feed.\" loading=\"lazy\" decoding=\"async\" width=\"594\" height=\"494\" srcset=\"/wp-content/uploads/2010/03/sharepoint-atom-feed.png 594w, /wp-content/uploads/2010/03/sharepoint-atom-feed-150x150.png 150w, /wp-content/uploads/2010/03/sharepoint-atom-feed-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>The service description of a SharePoint 2010 Team Site as an atom feed.\u003C/figcaption>\u003C/figure>",{"headings":778,"imagePaths":789,"frontmatter":757},[779,783,786],{"depth":780,"slug":781,"text":782},2,"for-windows-7-and-windows-server-2008-r2","For Windows 7 AND Windows Server 2008 R2",{"depth":780,"slug":784,"text":785},"for-windows-2000-windows-xp-windows-vista-windows-server-2003-and-windows-server-2008","For Windows 2000, Windows XP, Windows Vista, Windows Server 2003 AND Windows Server 2008",{"depth":780,"slug":787,"text":788},"testing","Testing",[],"2010-04-01-microsoft-releases-linux-integration-services-for-hyper-v-2-1-beta",{"id":790,"data":792,"body":802,"filePath":803,"digest":804,"rendered":805},{"id":793,"title":794,"date":795,"updated":796,"author":15,"excerpt":797,"layout":17,"permalink":798,"image":799,"categories":800,"tags":801,"draft":26},154,"Microsoft releases Linux Integration Services for Hyper-V 2.1 Beta",["Date","2010-04-01T14:20:32.000Z"],["Date","2020-12-06T16:11:39.000Z"],"Today the Microsoft Virtualization Team announced the availability of the new beta version of the Linux Integration Services for Hyper-V.\nIn this post I will try the new features.\n","/2010/04/01/microsoft-releases-linux-integration-services-for-hyper-v-2-1-beta/","/wp-content/uploads/2010/04/post-154-thumnail-1.png",[293],[295,296,293,518,298],"Today the Microsoft Virtualization Team [announced the availability of the new beta version of the Linux Integration Services for Hyper-V](https://techcommunity.microsoft.com/blog/virtualization/announcing-the-availability-of-the-beta-version-of-linux-integration-services-fo/381715). There are three big changes in this version:\r\n\r\n- Virtual machines will be able to use up to 4 virtual CPUs.\r\n- Virtual machines will be able to synchronize their time with the parent partition.\r\n- Virtual machines will be able to shutdown gracefully from the Hyper-V manager.\r\n\r\nIn this post I will try the new features.\r\n\r\n## Linux Integration Services for Hyper-V 2.0\r\n\r\nFirst, I got a Virtual Machine (VM) installed as described in my previous post \"[Running CentOS 5.x on Hyper-V](/2010/01/07/running-centos-5-x-on-hyper-v)\".\r\nI used the current released stable version of the Linux Integration Services (LIS): Version 2.0.\r\n\r\n![Screenshot displaying the VMBUS information on booting the virtual machine. Build Date=Jun 29 2009 and Build Description=Version 2.0.](/wp-content/uploads/2010/04/vmbus-boot-version-2-0.png \"On boot time, VMBUS displays 'Version 2.0'\")\r\n\r\nMy Hyper-V host only has a dual-core CPU.\r\nSo, it is impossible for me to test the 4 CPU support. I could not find any differences with 2 CPUs.\r\n\r\n### Shutdown from Hyper-V Console\r\n\r\nWith the current version of the LIS when I press the shutdown button, I get the following error:\r\n\r\n![Screenshot displaying the Hyper-V console showing the error text: \"The application encountered an error while attempting to change the state of 'BlogDemo'. Failed to shut down the virtual machine.\".](/wp-content/uploads/2010/04/shutdown-error-console.png \"Hyper-V Console shows the error 'Failed to shut down the virtual machine'.\")\r\n\r\n### Time synchronization\r\n\r\nWith the current version of the LIS I had a lot of trouble with the clock of the VM getting out of sync very fast.\r\nI did a post to fix this: \"[Correcting time drift with CentOS on Hyper-V](/2010/01/08/correcting-time-drift-with-centos-on-hyper-v)\".\r\n\r\nI did not implement the mentioned fix on the VM I created for this post, to demonstrate the problem:\r\n\r\n![Screenshot displaying the Hyper-V console showing the VM gets a time difference of multiple=](/wp-content/uploads/2010/04/time-sync-issue.png \"The VM gets an offset of multiple seconds within minutes.\")\r\n\r\n## Linux Integration Services for Hyper-V 2.1 Beta\r\n\r\nTo get the beta drivers you need to download them from the **Microsoft Connect** website.\r\n\r\nI installed the new drivers in exact the same way as the 2.0.\r\n\r\n![Screenshot displaying the VMBUS information on booting the virtual machine. Build Date=Mar 23 2010 and Build Description=Version 2.1.2.](/wp-content/uploads/2010/04/vmbus-boot-version-2-1-2.png \"On boot time, VMBUS displays Version 2.1.2\")\r\n\r\nNot only the new version number is displayed, also the new Shutdown and Timesync channels are mentioned!\r\n\r\n### Shutdown from Hyper-V Console\r\n\r\nPressing the shutdown button now gives a more expected result:\r\n\r\n![Screenshot displaying the virtual machine has received the shutdown command and starts the power-off sequence.](/wp-content/uploads/2010/04/shutdown-halt.png \"The VM receives the signal to shut down and calls `/sbin/poweroff`\")\r\n\r\n![Screenshot displaying the Hyper-V console with the message: \"The virtual machine is turned off\".](/wp-content/uploads/2010/04/no-shutdown-error-console..png \"The VM is gracefully turned off.\")\r\n\r\n### Time synchronization\r\n\r\nWith the new LIS the time is pretty much stable, nothing the NTP service cannot handle.\r\nThere is no need to change the boot command in grub anymore.\r\n\r\n![Screenshot displaying the Hyper-V console showing the VM shows minimal time difference over the course of minutes.](/wp-content/uploads/2010/04/time-sync-stable.png \"The VM only shows a minimal time difference over the course of minutes.\")","src/posts/2010-04-01-microsoft-releases-linux-integration-services-for-hyper-v-2-1-beta.md","bdff8695976c9528",{"html":806,"metadata":807},"\u003Cp>Today the Microsoft Virtualization Team \u003Ca href=\"https://techcommunity.microsoft.com/blog/virtualization/announcing-the-availability-of-the-beta-version-of-linux-integration-services-fo/381715?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">announced the availability of the new beta version of the Linux Integration Services for Hyper-V\u003Cspan>\u003C/span>\u003C/a>. There are three big changes in this version:\u003C/p>\n\u003Cul>\n\u003Cli>Virtual machines will be able to use up to 4 virtual CPUs.\u003C/li>\n\u003Cli>Virtual machines will be able to synchronize their time with the parent partition.\u003C/li>\n\u003Cli>Virtual machines will be able to shutdown gracefully from the Hyper-V manager.\u003C/li>\n\u003C/ul>\n\u003Cp>In this post I will try the new features.\u003C/p>\n\u003Ch2 id=\"linux-integration-services-for-hyper-v-20\">Linux Integration Services for Hyper-V 2.0\u003C/h2>\n\u003Cp>First, I got a Virtual Machine (\u003Cdfn>\u003Cabbr title=\"Virtual Machine\">VM\u003C/abbr>\u003C/dfn>) installed as described in my previous post “\u003Ca href=\"/2010/01/07/running-centos-5-x-on-hyper-v\">Running CentOS 5.x on Hyper-V\u003C/a>”.\r\nI used the current released stable version of the Linux Integration Services (\u003Cdfn>\u003Cabbr title=\"Linux Integration Services\">LIS\u003C/abbr>\u003C/dfn>): Version 2.0.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/vmbus-boot-version-2-0.webp\" type=\"image/webp\" media=\"(max-width: 484px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/vmbus-boot-version-2-0-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/vmbus-boot-version-2-0.png\" alt=\"Screenshot displaying the VMBUS information on booting the virtual machine. Build Date=Jun 29 2009 and Build Description=Version 2.0.\" loading=\"lazy\" decoding=\"async\" width=\"484\" height=\"181\" srcset=\"/wp-content/uploads/2010/04/vmbus-boot-version-2-0.png 484w, /wp-content/uploads/2010/04/vmbus-boot-version-2-0-150x150.png 150w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>On boot time, VMBUS displays 'Version 2.0'\u003C/figcaption>\u003C/figure>\n\u003Cp>My Hyper-V host only has a dual-core \u003Cdfn>\u003Cabbr title=\"Central Processing Unit\">CPU\u003C/abbr>\u003C/dfn>.\r\nSo, it is impossible for me to test the 4 \u003Cabbr title=\"Central Processing Unit\">CPU\u003C/abbr> support. I could not find any differences with 2 CPUs.\u003C/p>\n\u003Ch3 id=\"shutdown-from-hyper-v-console\">Shutdown from Hyper-V Console\u003C/h3>\n\u003Cp>With the current version of the \u003Cabbr title=\"Linux Integration Services\">LIS\u003C/abbr> when I press the shutdown button, I get the following error:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/shutdown-error-console.webp\" type=\"image/webp\" media=\"(max-width: 594px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/shutdown-error-console-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/shutdown-error-console-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/shutdown-error-console.png\" alt=\"Screenshot displaying the Hyper-V console showing the error text: &#x22;The application encountered an error while attempting to change the state of &#x27;BlogDemo&#x27;. Failed to shut down the virtual machine.&#x22;.\" loading=\"lazy\" decoding=\"async\" width=\"594\" height=\"397\" srcset=\"/wp-content/uploads/2010/04/shutdown-error-console.png 594w, /wp-content/uploads/2010/04/shutdown-error-console-150x150.png 150w, /wp-content/uploads/2010/04/shutdown-error-console-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Hyper-V Console shows the error 'Failed to shut down the virtual machine'.\u003C/figcaption>\u003C/figure>\n\u003Ch3 id=\"time-synchronization\">Time synchronization\u003C/h3>\n\u003Cp>With the current version of the \u003Cabbr title=\"Linux Integration Services\">LIS\u003C/abbr> I had a lot of trouble with the clock of the \u003Cabbr title=\"Virtual Machine\">VM\u003C/abbr> getting out of sync very fast.\r\nI did a post to fix this: “\u003Ca href=\"/2010/01/08/correcting-time-drift-with-centos-on-hyper-v\">Correcting time drift with CentOS on Hyper-V\u003C/a>”.\u003C/p>\n\u003Cp>I did not implement the mentioned fix on the \u003Cabbr title=\"Virtual Machine\">VM\u003C/abbr> I created for this post, to demonstrate the problem:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/time-sync-issue.webp\" type=\"image/webp\" media=\"(max-width: 595px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/time-sync-issue-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/time-sync-issue-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/time-sync-issue.png\" alt=\"Screenshot displaying the Hyper-V console showing the VM gets a time difference of multiple=\" loading=\"lazy\" decoding=\"async\" width=\"595\" height=\"285\" srcset=\"/wp-content/uploads/2010/04/time-sync-issue.png 595w, /wp-content/uploads/2010/04/time-sync-issue-150x150.png 150w, /wp-content/uploads/2010/04/time-sync-issue-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>The VM gets an offset of multiple seconds within minutes.\u003C/figcaption>\u003C/figure>\n\u003Ch2 id=\"linux-integration-services-for-hyper-v-21-beta\">Linux Integration Services for Hyper-V 2.1 Beta\u003C/h2>\n\u003Cp>To get the beta drivers you need to download them from the \u003Cstrong>Microsoft Connect\u003C/strong> website.\u003C/p>\n\u003Cp>I installed the new drivers in exact the same way as the 2.0.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/vmbus-boot-version-2-1-2.webp\" type=\"image/webp\" media=\"(max-width: 501px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/vmbus-boot-version-2-1-2-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/vmbus-boot-version-2-1-2-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/vmbus-boot-version-2-1-2.png\" alt=\"Screenshot displaying the VMBUS information on booting the virtual machine. Build Date=Mar 23 2010 and Build Description=Version 2.1.2.\" loading=\"lazy\" decoding=\"async\" width=\"501\" height=\"259\" srcset=\"/wp-content/uploads/2010/04/vmbus-boot-version-2-1-2.png 501w, /wp-content/uploads/2010/04/vmbus-boot-version-2-1-2-150x150.png 150w, /wp-content/uploads/2010/04/vmbus-boot-version-2-1-2-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>On boot time, VMBUS displays Version 2.1.2\u003C/figcaption>\u003C/figure>\n\u003Cp>Not only the new version number is displayed, also the new Shutdown and Timesync channels are mentioned!\u003C/p>\n\u003Ch3 id=\"shutdown-from-hyper-v-console-1\">Shutdown from Hyper-V Console\u003C/h3>\n\u003Cp>Pressing the shutdown button now gives a more expected result:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/shutdown-halt.webp\" type=\"image/webp\" media=\"(max-width: 588px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/shutdown-halt-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/shutdown-halt-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/shutdown-halt.png\" alt=\"Screenshot displaying the virtual machine has received the shutdown command and starts the power-off sequence.\" loading=\"lazy\" decoding=\"async\" width=\"588\" height=\"220\" srcset=\"/wp-content/uploads/2010/04/shutdown-halt.png 588w, /wp-content/uploads/2010/04/shutdown-halt-150x150.png 150w, /wp-content/uploads/2010/04/shutdown-halt-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>The VM receives the signal to shut down and calls `/sbin/poweroff`\u003C/figcaption>\u003C/figure>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/no-shutdown-error-console..webp\" type=\"image/webp\" media=\"(max-width: 588px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/no-shutdown-error-console.-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/no-shutdown-error-console.-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/no-shutdown-error-console..png\" alt=\"Screenshot displaying the Hyper-V console with the message: &#x22;The virtual machine is turned off&#x22;.\" loading=\"lazy\" decoding=\"async\" width=\"588\" height=\"495\" srcset=\"/wp-content/uploads/2010/04/no-shutdown-error-console..png 588w, /wp-content/uploads/2010/04/no-shutdown-error-console.-150x150.png 150w, /wp-content/uploads/2010/04/no-shutdown-error-console.-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>The VM is gracefully turned off.\u003C/figcaption>\u003C/figure>\n\u003Ch3 id=\"time-synchronization-1\">Time synchronization\u003C/h3>\n\u003Cp>With the new \u003Cabbr title=\"Linux Integration Services\">LIS\u003C/abbr> the time is pretty much stable, nothing the \u003Cdfn>\u003Cabbr title=\"Network Time Protocol\">NTP\u003C/abbr>\u003C/dfn> service cannot handle.\r\nThere is no need to change the boot command in grub anymore.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/time-sync-stable.webp\" type=\"image/webp\" media=\"(max-width: 594px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/time-sync-stable-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/time-sync-stable-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/time-sync-stable.png\" alt=\"Screenshot displaying the Hyper-V console showing the VM shows minimal time difference over the course of minutes.\" loading=\"lazy\" decoding=\"async\" width=\"594\" height=\"268\" srcset=\"/wp-content/uploads/2010/04/time-sync-stable.png 594w, /wp-content/uploads/2010/04/time-sync-stable-150x150.png 150w, /wp-content/uploads/2010/04/time-sync-stable-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>The VM only shows a minimal time difference over the course of minutes.\u003C/figcaption>\u003C/figure>",{"headings":808,"imagePaths":825,"frontmatter":792},[809,812,815,818,821,823],{"depth":780,"slug":810,"text":811},"linux-integration-services-for-hyper-v-20","Linux Integration Services for Hyper-V 2.0",{"depth":198,"slug":813,"text":814},"shutdown-from-hyper-v-console","Shutdown from Hyper-V Console",{"depth":198,"slug":816,"text":817},"time-synchronization","Time synchronization",{"depth":780,"slug":819,"text":820},"linux-integration-services-for-hyper-v-21-beta","Linux Integration Services for Hyper-V 2.1 Beta",{"depth":198,"slug":822,"text":814},"shutdown-from-hyper-v-console-1",{"depth":198,"slug":824,"text":817},"time-synchronization-1",[],"2010-04-14-using-the-surface-sdk-with-visual-studio-2010",{"id":826,"data":828,"body":839,"filePath":840,"digest":841,"rendered":842},{"id":829,"title":830,"date":831,"author":15,"excerpt":832,"layout":17,"permalink":833,"image":834,"categories":835,"tags":836,"draft":26},158,"Using the Surface SDK with Visual Studio 2010",["Date","2010-04-14T12:45:34.000Z"],"With the launch of Visual Studio 2010 this week a lot of people will start upgrading to the new version. After the installation was complete I noticed the Surface project and item templates were not available.\nIn this post I explain how to get the entries in Visual Studio 2010.\n","/2010/04/14/using-the-surface-sdk-with-visual-studio-2010/","/wp-content/uploads/2010/04/post-158-thumnail-1.png",[614,271],[273,716,837,838,111,113,189],"Visual Studio 2008","Visual Studio 2010","With the launch of Visual Studio 2010 this week a lot of people will start upgrading to the new version.\r\nAfter the installation was complete, I noticed the Surface project and item templates were not available.\r\n\r\nIn this article I explain how to get the entries in Visual Studio 2010.\r\n\r\n\u003C!--more-->\r\n\r\nFirst of all, you need to realize that the templates are part of the Microsoft Surface SDK.\r\nIf you have it installed, skip the next paragraph.\r\n\r\n## Installing the Surface SDK\r\n\r\n> [!NOTE]\r\n> If you are running Windows 7 or a Windows Vista x64, you need to apply the changes described in a previous post:\r\n> \"[Installing the Microsoft Surface SDK on Windows 7 x64](/2010/03/03/installing-the-microsoft-surface-sdk-on-windows-7-x64)\".  \r\n> If you do not have Visual Studio 2008 on your system and want to start with Visual Studio 2010 from scratch some additional steps are needed patching the Surface SDK Installer.\r\n> For details on the patch process see the earlier referenced post.\r\n\r\n### Patching the installer\r\n\r\nWhen you’re patching the MSI with the [Orca tool](https://docs.microsoft.com/en-us/windows/win32/msi/orca-exe?) remove also the following conditions:\r\n\r\n1. Select the row with  \r\n   `Installed OR (VS2008SPLEVEL AND VS2008CSPROJSUPPORT) OR VCSEXP2008SPLEVEL`  \r\n   and choose \u003Ckbd>Drop row\u003C/kbd>\r\n2. Select the row with  \r\n   `Installed OR (VS2008SPLEVEL AND VS2008SPLEVEL >= \"#0\") OR` `(VCSEXP2008SPLEVEL AND VCSEXP2008SPLEVEL >= \"#0\")`  \r\n   and choose \u003Ckbd>Drop row\u003C/kbd>\r\n3. Select the row with  \r\n   `Installed OR DEXPLORE`  \r\n   and choose \u003Ckbd>Drop row\u003C/kbd>\r\n4. Select the row with  \r\n   `Installed OR VS90DEVENV OR NOT VS2008SPLEVEL`  \r\n   and choose \u003Ckbd>Drop row\u003C/kbd>\r\n5. Select the row with  \r\n   `Installed OR VCSHARP90EXPRESS OR NOT VCSEXP2008SPLEVEL`  \r\n   and choose \u003Ckbd>Drop row\u003C/kbd>\r\n\r\n## Copying the Templates from the SDK\r\n\r\nNow that you have installed the Surface SDK the subsequent steps are quite simple.\r\n\r\nThe following lines are for x64 systems.\r\nIf you are running on x86 change `Program Files (x86)` into `Program Files`.\r\n\r\n```shell\r\nxcopy /s \"C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\ItemTemplates\\CSharp\\Surface\\v1.0\" \"C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\ItemTemplates\\CSharp\\Surface\\1033\"\r\n\r\nxcopy /s \"C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\ProjectTemplates\\CSharp\\Surface\\v1.0\" \"C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\ProjectTemplates\\CSharp\\Surface\\1033\"\r\n\r\ncd \"C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\"\r\n\r\ndevenv /setup\r\n```\r\n\r\nAfter this is finished launch Visual Studio 2010.\r\n\r\n![Screenshot with the \"New Project\" dialog displaying the Surface Application templates.](/wp-content/uploads/2010/04/new-project-dialog.png \"The “New Project” dialog with the Surface Application templates listed.\")\r\n_(Remember to select .NET Framework 3.5)_\r\n\r\n![Screenshot with the \"Add New Item\" dialog displaying the Surface Control templates.](/wp-content/uploads/2010/04/add-new-item-dialog.png \"The “Add New Item” dialog with the Surface Control templates listed.\")","src/posts/2010-04-14-using-the-surface-sdk-with-visual-studio-2010.md","f507bc8bf5d66970",{"html":843,"metadata":844},"\u003Cp>With the launch of Visual Studio 2010 this week a lot of people will start upgrading to the new version.\r\nAfter the installation was complete, I noticed the Surface project and item templates were not available.\u003C/p>\n\u003Cp>In this article I explain how to get the entries in Visual Studio 2010.\u003C/p>\n\u003C!--more-->\n\u003Cp>First of all, you need to realize that the templates are part of the Microsoft Surface \u003Cdfn>\u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/dfn>.\r\nIf you have it installed, skip the next paragraph.\u003C/p>\n\u003Ch2 id=\"installing-the-surface-sdk\">Installing the Surface \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/h2>\n\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\r\nIf you are running Windows 7 or a Windows Vista x64, you need to apply the changes described in a previous post:\r\n“\u003Ca href=\"/2010/03/03/installing-the-microsoft-surface-sdk-on-windows-7-x64\">Installing the Microsoft Surface \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr> on Windows 7 x64\u003C/a>”.\u003Cbr>\nIf you do not have Visual Studio 2008 on your system and want to start with Visual Studio 2010 from scratch some additional steps are needed patching the Surface \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr> Installer.\r\nFor details on the patch process see the earlier referenced post.\u003C/p>\n\u003C/div>\n\u003Ch3 id=\"patching-the-installer\">Patching the installer\u003C/h3>\n\u003Cp>When you’re patching the \u003Cdfn>\u003Cabbr title=\"Microsoft Installer\">MSI\u003C/abbr>\u003C/dfn> with the \u003Ca href=\"https://docs.microsoft.com/en-us/windows/win32/msi/orca-exe?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Orca tool\u003Cspan>\u003C/span>\u003C/a> remove also the following conditions:\u003C/p>\n\u003Col>\n\u003Cli>Select the row with\u003Cbr>\n\u003Ccode>Installed OR (VS2008SPLEVEL AND VS2008CSPROJSUPPORT) OR VCSEXP2008SPLEVEL\u003C/code>\u003Cbr>\nand choose \u003Ckbd>Drop row\u003C/kbd>\u003C/li>\n\u003Cli>Select the row with\u003Cbr>\n\u003Ccode>Installed OR (VS2008SPLEVEL AND VS2008SPLEVEL >= \"#0\") OR\u003C/code> \u003Ccode>(VCSEXP2008SPLEVEL AND VCSEXP2008SPLEVEL >= \"#0\")\u003C/code>\u003Cbr>\nand choose \u003Ckbd>Drop row\u003C/kbd>\u003C/li>\n\u003Cli>Select the row with\u003Cbr>\n\u003Ccode>Installed OR DEXPLORE\u003C/code>\u003Cbr>\nand choose \u003Ckbd>Drop row\u003C/kbd>\u003C/li>\n\u003Cli>Select the row with\u003Cbr>\n\u003Ccode>Installed OR VS90DEVENV OR NOT VS2008SPLEVEL\u003C/code>\u003Cbr>\nand choose \u003Ckbd>Drop row\u003C/kbd>\u003C/li>\n\u003Cli>Select the row with\u003Cbr>\n\u003Ccode>Installed OR VCSHARP90EXPRESS OR NOT VCSEXP2008SPLEVEL\u003C/code>\u003Cbr>\nand choose \u003Ckbd>Drop row\u003C/kbd>\u003C/li>\n\u003C/ol>\n\u003Ch2 id=\"copying-the-templates-from-the-sdk\">Copying the Templates from the \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/h2>\n\u003Cp>Now that you have installed the Surface \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr> the subsequent steps are quite simple.\u003C/p>\n\u003Cp>The following lines are for x64 systems.\r\nIf you are running on x86 change \u003Ccode>Program Files (x86)\u003C/code> into \u003Ccode>Program Files\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:213ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">xcopy\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/s\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\ItemTemplates\\CSharp\\Surface\\v1.0\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\ItemTemplates\\CSharp\\Surface\\1033\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">xcopy\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/s\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\ProjectTemplates\\CSharp\\Surface\\v1.0\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\ProjectTemplates\\CSharp\\Surface\\1033\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">cd\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">devenv\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">/setup\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"xcopy /s &#x22;C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\ItemTemplates\\CSharp\\Surface\\v1.0&#x22; &#x22;C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\ItemTemplates\\CSharp\\Surface\\1033&#x22;xcopy /s &#x22;C:\\Program Files (x86)\\Microsoft Visual Studio 9.0\\Common7\\IDE\\ProjectTemplates\\CSharp\\Surface\\v1.0&#x22; &#x22;C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE\\ProjectTemplates\\CSharp\\Surface\\1033&#x22;cd &#x22;C:\\Program Files (x86)\\Microsoft Visual Studio 10.0\\Common7\\IDE&#x22;devenv /setup\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>After this is finished launch Visual Studio 2010.\u003C/p>\n\u003Cp>\u003C/p>\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/new-project-dialog.webp\" type=\"image/webp\" media=\"(max-width: 604px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/new-project-dialog-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/new-project-dialog-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/new-project-dialog.png\" alt=\"Screenshot with the &#x22;New Project&#x22; dialog displaying the Surface Application templates.\" loading=\"lazy\" decoding=\"async\" width=\"604\" height=\"343\" srcset=\"/wp-content/uploads/2010/04/new-project-dialog.png 604w, /wp-content/uploads/2010/04/new-project-dialog-150x150.png 150w, /wp-content/uploads/2010/04/new-project-dialog-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>The “New Project” dialog with the Surface Application templates listed.\u003C/figcaption>\u003C/figure>\r\n\u003Cem>(Remember to select .NET Framework 3.5)\u003C/em>\u003Cp>\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/add-new-item-dialog.webp\" type=\"image/webp\" media=\"(max-width: 604px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/add-new-item-dialog-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/add-new-item-dialog-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/add-new-item-dialog.png\" alt=\"Screenshot with the &#x22;Add New Item&#x22; dialog displaying the Surface Control templates.\" loading=\"lazy\" decoding=\"async\" width=\"604\" height=\"342\" srcset=\"/wp-content/uploads/2010/04/add-new-item-dialog.png 604w, /wp-content/uploads/2010/04/add-new-item-dialog-150x150.png 150w, /wp-content/uploads/2010/04/add-new-item-dialog-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>The “Add New Item” dialog with the Surface Control templates listed.\u003C/figcaption>\u003C/figure>",{"headings":845,"imagePaths":853,"frontmatter":828},[846,849,850],{"depth":780,"slug":847,"text":848},"installing-the-surface-sdk","Installing the Surface SDK",{"depth":198,"slug":740,"text":741},{"depth":780,"slug":851,"text":852},"copying-the-templates-from-the-sdk","Copying the Templates from the SDK",[],"2010-04-16-make-your-powerpoint-presentation-look-good-on-a-wide-screen-projector",{"id":854,"data":856,"body":875,"filePath":876,"digest":877,"rendered":878},{"id":857,"title":858,"date":859,"author":15,"excerpt":860,"layout":17,"permalink":861,"image":862,"categories":863,"tags":864,"draft":26},167,"Make your PowerPoint Presentation look good on a wide screen projector",["Date","2010-04-16T09:33:48.000Z"],"The other day I attended a meeting where the presenter switched from a PowerPoint slide to demonstrate an application. When he made the switch it was quite obvious the beamer was setup to only display the 4:3 slides to the maximum of the white screen. Since his desktop was in a 16:10 resolution the application was falling of the screen on both sides.\nWhile I was preparing a presentation myself I wanted to be sure my presentation would be in the same resolution as my desktop as I would be switching between my slides and Visual Studio.\n","/2010/04/16/make-your-powerpoint-presentation-look-good-on-a-wide-screen-projector/","/wp-content/uploads/2010/04/post-167-thumnail-1.png",[106],[865,866,867,868,869,870,871,872,873,874],"16:10","16:9","4:3","Aspect Ratio","Beamer","Black bars","HD","PowerPoint","Presenting","Slide","The other day I attended a meeting where the presenter switched from a PowerPoint slide to demonstrate an application.\r\nWhen he made the switch, it was quite obvious the beamer was setup to only display the 4:3 slides to the maximum of the white screen.\r\nSince his desktop was in a 16:10 resolution the application was falling off the screen on both sides. Which was quite a distraction.\r\n\r\nWhen I was preparing a presentation myself, I wanted to be sure my presentation would be in the same resolution as my desktop as I would be switching between my slides and Visual Studio.\r\n\r\n\u003C!--more-->\r\n\r\n## Choosing your Aspect Ratio\r\n\r\nFor presentations on a beamer or screen there are 3 common [aspect ratio's](\u003Chttps://en.wikipedia.org/wiki/Aspect_ratio_(image)>) at the moment: 4:3, 16:9 and 16:10.\r\nIf you don't know the ratio you can use the maximum resolution to determine the required ratio.\r\n\r\n## 4:3\r\n\r\nThis is the classic resolution for computer screens.\r\nThis is also the default for PowerPoint.\r\n800x600, 1024x768, 1152x864 and 1280x960 are common resolutions used with the ratio.\r\n\r\nIf you show a slide on wide screen you will get black bars on the side.\r\n\r\n![A PowerPoint slide with a 4:3 ratio shows black bars on the side using a 16:10 screen.](/wp-content/uploads/2010/04/4-3-slide-on-16-10.png \"A 4:3 slide on a 16:10 screen. Showing black bars on the side.\")\r\n\r\n## 16:9\r\n\r\nThis ratio is commonly used by HD screens and beamers.\r\n1366x768, 1280x720, 1600x900 and 1920x1080 are common resolutions used with this ratio.\r\n\r\nIf you show a slide in this ratio on a 4:3 or 16:10 screen you will get black bars on the top and bottom.\r\n\r\n![A PowerPoint slide with a 16:9 ratio shows black bars on the top and bottom using a 16:10 screen.](/wp-content/uploads/2010/04/16-9-slide-on-16-10.png \"A 16:9 slide on a 16:10 screen. Showing black bars on the top and bottom.\")\r\n\r\n## 16:10\r\n\r\nThis ratio was commonly used by modern screen and beamers, but is now disappearing.\r\n1280x800, 1440x900 and 1920x1200 are common resolutions used with the ratio.\r\n\r\nIf you show a slide in this ratio on a 4:3 screen you will get black bars on the top and bottom.\r\nOn a 16:9 screen you will get black bars on the side.\r\n\r\n![A PowerPoint slide with a 16:10 ratio shows no black bars on a 16:10 screen.](/wp-content/uploads/2010/04/16-10-slide-on-16-10.png \"A 16:10 slide on a 16:10 screen. No black bars showing.\")\r\n\r\n## Setting the aspect ratio in PowerPoint\r\n\r\nIt's easy to set the required aspect ratio:\r\n\r\n1. In PowerPoint go the \u003Ckbd>Design\u003C/kbd> tab on the ribbon.\r\n2. Click on \u003Ckbd>Page Setup\u003C/kbd>.\r\n\r\n   ![The PowerPoint application with the \"Design\" tab selected on the ribbon.](/wp-content/uploads/2010/04/powerpoint-design-tab.png)\r\n\r\n3. At \u003Ckbd>Slides sized for\u003C/kbd> set the desired ratio.\r\n\r\n   ![The \"Page Setup\" dialog with the ratio dropdown box displaying several ratio's including 4:3, 16:9 and 16:10.](/wp-content/uploads/2010/04/image12.png)\r\n\r\n4. Press the \u003Ckbd>OK\u003C/kbd> button and you are set.","src/posts/2010-04-16-make-your-powerpoint-presentation-look-good-on-a-wide-screen-projector.md","36a82488a09423ae",{"html":879,"metadata":880},"\u003Cp>The other day I attended a meeting where the presenter switched from a PowerPoint slide to demonstrate an application.\r\nWhen he made the switch, it was quite obvious the beamer was setup to only display the 4:3 slides to the maximum of the white screen.\r\nSince his desktop was in a 16:10 resolution the application was falling off the screen on both sides. Which was quite a distraction.\u003C/p>\n\u003Cp>When I was preparing a presentation myself, I wanted to be sure my presentation would be in the same resolution as my desktop as I would be switching between my slides and Visual Studio.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"choosing-your-aspect-ratio\">Choosing your Aspect Ratio\u003C/h2>\n\u003Cp>For presentations on a beamer or screen there are 3 common \u003Ca href=\"https://en.wikipedia.org/wiki/Aspect_ratio_(image)\" rel=\"noopener noreferrer external\" target=\"_blank\">aspect ratio’s\u003Cspan>\u003C/span>\u003C/a> at the moment: 4:3, 16:9 and 16:10.\r\nIf you don’t know the ratio you can use the maximum resolution to determine the required ratio.\u003C/p>\n\u003Ch2 id=\"43\">4:3\u003C/h2>\n\u003Cp>This is the classic resolution for computer screens.\r\nThis is also the default for PowerPoint.\r\n800x600, 1024x768, 1152x864 and 1280x960 are common resolutions used with the ratio.\u003C/p>\n\u003Cp>If you show a slide on wide screen you will get black bars on the side.\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2010/04/4-3-slide-on-16-10.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/4-3-slide-on-16-10.webp\" type=\"image/webp\" media=\"(max-width: 640px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/4-3-slide-on-16-10-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/4-3-slide-on-16-10-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/4-3-slide-on-16-10-636x398.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/4-3-slide-on-16-10-636x398.png\" alt=\"A PowerPoint slide with a 4:3 ratio shows black bars on the side using a 16:10 screen.\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"398\" srcset=\"/wp-content/uploads/2010/04/4-3-slide-on-16-10.png 640w, /wp-content/uploads/2010/04/4-3-slide-on-16-10-150x150.png 150w, /wp-content/uploads/2010/04/4-3-slide-on-16-10-185x185.png 185w, /wp-content/uploads/2010/04/4-3-slide-on-16-10-636x398.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003Cfigcaption>A 4:3 slide on a 16:10 screen. Showing black bars on the side.\u003C/figcaption>\u003C/figure>\n\u003Ch2 id=\"169\">16:9\u003C/h2>\n\u003Cp>This ratio is commonly used by \u003Cdfn>\u003Cabbr title=\"High-definition\">HD\u003C/abbr>\u003C/dfn> screens and beamers.\r\n1366x768, 1280x720, 1600x900 and 1920x1080 are common resolutions used with this ratio.\u003C/p>\n\u003Cp>If you show a slide in this ratio on a 4:3 or 16:10 screen you will get black bars on the top and bottom.\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2010/04/16-9-slide-on-16-10.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/16-9-slide-on-16-10.webp\" type=\"image/webp\" media=\"(max-width: 640px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/16-9-slide-on-16-10-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/16-9-slide-on-16-10-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/16-9-slide-on-16-10-636x398.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/16-9-slide-on-16-10-636x398.png\" alt=\"A PowerPoint slide with a 16:9 ratio shows black bars on the top and bottom using a 16:10 screen.\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"398\" srcset=\"/wp-content/uploads/2010/04/16-9-slide-on-16-10.png 640w, /wp-content/uploads/2010/04/16-9-slide-on-16-10-150x150.png 150w, /wp-content/uploads/2010/04/16-9-slide-on-16-10-185x185.png 185w, /wp-content/uploads/2010/04/16-9-slide-on-16-10-636x398.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003Cfigcaption>A 16:9 slide on a 16:10 screen. Showing black bars on the top and bottom.\u003C/figcaption>\u003C/figure>\n\u003Ch2 id=\"1610\">16:10\u003C/h2>\n\u003Cp>This ratio was commonly used by modern screen and beamers, but is now disappearing.\r\n1280x800, 1440x900 and 1920x1200 are common resolutions used with the ratio.\u003C/p>\n\u003Cp>If you show a slide in this ratio on a 4:3 screen you will get black bars on the top and bottom.\r\nOn a 16:9 screen you will get black bars on the side.\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2010/04/16-10-slide-on-16-10.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/16-10-slide-on-16-10.webp\" type=\"image/webp\" media=\"(max-width: 640px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/16-10-slide-on-16-10-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/16-10-slide-on-16-10-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/16-10-slide-on-16-10-636x398.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/16-10-slide-on-16-10-636x398.png\" alt=\"A PowerPoint slide with a 16:10 ratio shows no black bars on a 16:10 screen.\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"398\" srcset=\"/wp-content/uploads/2010/04/16-10-slide-on-16-10.png 640w, /wp-content/uploads/2010/04/16-10-slide-on-16-10-150x150.png 150w, /wp-content/uploads/2010/04/16-10-slide-on-16-10-185x185.png 185w, /wp-content/uploads/2010/04/16-10-slide-on-16-10-636x398.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003Cfigcaption>A 16:10 slide on a 16:10 screen. No black bars showing.\u003C/figcaption>\u003C/figure>\n\u003Ch2 id=\"setting-the-aspect-ratio-in-powerpoint\">Setting the aspect ratio in PowerPoint\u003C/h2>\n\u003Cp>It’s easy to set the required aspect ratio:\u003C/p>\n\u003Col>\n\u003Cli>\n\u003Cp>In PowerPoint go the \u003Ckbd>Design\u003C/kbd> tab on the ribbon.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Click on \u003Ckbd>Page Setup\u003C/kbd>.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/04/powerpoint-design-tab.webp\" type=\"image/webp\" media=\"(max-width: 360px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/powerpoint-design-tab-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/04/powerpoint-design-tab-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/04/powerpoint-design-tab.png\" alt=\"The PowerPoint application with the &#x22;Design&#x22; tab selected on the ribbon.\" loading=\"lazy\" decoding=\"async\" width=\"360\" height=\"325\" srcset=\"/wp-content/uploads/2010/04/powerpoint-design-tab.png 360w, /wp-content/uploads/2010/04/powerpoint-design-tab-150x150.png 150w, /wp-content/uploads/2010/04/powerpoint-design-tab-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003C/li>\n\u003Cli>\n\u003Cp>At \u003Ckbd>Slides sized for\u003C/kbd> set the desired ratio.\u003C/p>\n\u003Cp>\u003Cimg src=\"/wp-content/uploads/2010/04/image12.png\" alt=\"The &#x22;Page Setup&#x22; dialog with the ratio dropdown box displaying several ratio&#x27;s including 4:3, 16:9 and 16:10.\">\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Press the \u003Ckbd>OK\u003C/kbd> button and you are set.\u003C/p>\n\u003C/li>\n\u003C/ol>",{"headings":881,"imagePaths":894,"frontmatter":856},[882,885,887,889,891],{"depth":780,"slug":883,"text":884},"choosing-your-aspect-ratio","Choosing your Aspect Ratio",{"depth":780,"slug":886,"text":867},"43",{"depth":780,"slug":888,"text":866},"169",{"depth":780,"slug":890,"text":865},"1610",{"depth":780,"slug":892,"text":893},"setting-the-aspect-ratio-in-powerpoint","Setting the aspect ratio in PowerPoint",[],"2013-02-25-dotned-podcast-michael-hompus-over-serious-request-en-windows-azure",{"id":895,"data":897,"body":912,"filePath":913,"digest":914,"rendered":915},{"id":898,"title":899,"date":900,"updated":901,"author":15,"excerpt":902,"layout":17,"permalink":903,"image":904,"categories":905,"tags":907,"draft":26},288,"DotNed Podcast: “Michaël Hompus over Serious Request en Windows Azure”",["Date","2013-02-25T16:49:07.000Z"],["Date","2020-12-06T17:31:20.000Z"],"dotNed is the Dutch .NET user group and organizes several meetings each year for the .NET community. Maurice de Beijer interviewed me about my experiences using Windows Azure to build a high available and scaling platform for 3FM Serious Request.\n","/2013/02/25/dotned-podcast-michael-hompus-over-serious-request-en-windows-azure/","/wp-content/uploads/2013/02/post-288-thumbnail.png",[906],"Azure",[908,909,910,911],"dotNed","podcast","Serious Request","Speaking","[DotNed](https://www.dotned.nl/) is the Dutch .NET user group and organizes several meetings each year for the .NET community.\r\nThey also run a regular podcast covering several .NET development related topics like Visual Studio, Mono, ASP.NET MVC, Windows Phone and Windows Azure.\r\n\r\nTriggered by my scheduled [TechDays 2013 presentation](/2013/03/12/speaking-at-the-dutch-techdays-2013),\r\nI was interviewed a few weeks ago by [Maurice de Beijer](https://www.linkedin.com/in/mauricedebeijer/) about my experiences using Windows Azure to build a high available and scaling platform for the various applications used during \"[3FM Serious Request](https://nl.wikipedia.org/wiki/3FM_Serious_Request)\".","src/posts/2013-02-25-dotned-podcast-michael-hompus-over-serious-request-en-windows-azure.md","3e932d4ec2a93260",{"html":916,"metadata":917},"\u003Cp>\u003Ca href=\"https://www.dotned.nl/\" rel=\"noopener noreferrer external\" target=\"_blank\">DotNed\u003Cspan>\u003C/span>\u003C/a> is the Dutch .NET user group and organizes several meetings each year for the .NET community.\r\nThey also run a regular podcast covering several .NET development related topics like Visual Studio, Mono, \u003Cdfn>\u003Cabbr title=\"Active Server Pages\">ASP\u003C/abbr>\u003C/dfn>.NET \u003Cdfn>\u003Cabbr title=\"Model-View-Controller\">MVC\u003C/abbr>\u003C/dfn>, Windows Phone and Windows Azure.\u003C/p>\n\u003Cp>Triggered by my scheduled \u003Ca href=\"/2013/03/12/speaking-at-the-dutch-techdays-2013\">TechDays 2013 presentation\u003C/a>,\r\nI was interviewed a few weeks ago by \u003Ca href=\"https://www.linkedin.com/in/mauricedebeijer/\">Maurice de Beijer\u003C/a> about my experiences using Windows Azure to build a high available and scaling platform for the various applications used during “\u003Ca href=\"https://nl.wikipedia.org/wiki/3FM_Serious_Request\" rel=\"noopener noreferrer external\" target=\"_blank\">3FM Serious Request\u003Cspan>\u003C/span>\u003C/a>”.\u003C/p>",{"headings":918,"imagePaths":919,"frontmatter":897},[],[],"2013-03-12-speaking-at-the-dutch-techdays-2013",{"id":920,"data":922,"body":934,"filePath":935,"digest":936,"rendered":937},{"id":923,"title":924,"date":925,"updated":926,"author":15,"excerpt":927,"layout":17,"permalink":928,"image":929,"categories":930,"tags":931,"draft":26},275,"Speaking at the Dutch Techdays 2013",["Date","2013-03-12T06:55:31.000Z"],["Date","2020-12-06T17:40:29.000Z"],"I am invited to speak at the Techdays 2013 in the Netherlands. The event is held on the 7th & 8th of March at the World Forum in Den Haag.\n","/2013/03/12/speaking-at-the-dutch-techdays-2013/","/wp-content/uploads/2013/03/post-275-thumbnail.png",[906],[873,910,932,911,933],"Slides","TechDays","![Techdays 2013 Netherlands](/wp-content/uploads/2013/02/techdays-2013-logo.jpg)\r\n\r\nI am invited to speak at the [Techdays 2013](https://web.archive.org/web/20130313051947/http://www.microsoft.com/netherlands/techdays/home.aspx) in the Netherlands.\r\nThe event is held on the 7\u003Csup>th\u003C/sup> & 8\u003Csup>th\u003C/sup> of March at the World Forum in Den Haag.\r\n\r\nMy session, in Dutch, is called \"**Serious Request met Windows Azure**\" and I will be talking about my experiences using Windows Azure to build a high available and scaling platform for the various applications used during \"[3FM Serious Request](https://nl.wikipedia.org/wiki/3FM_Serious_Request)\",\r\nthe annual charity event organized by the Dutch radio station 3FM for the [Dutch Red Cross](https://www.rodekruis.nl/).\r\n\r\nIf the schedule does not change, I will be speaking in the Africa Room on Friday between 13:15 - 14:30.\r\n\r\n## Update\r\n\r\nI have uploaded my [slides for this session](https://hompus.nl/presentations/Techdays%202013%20-%20Serious%20Request%20met%20Windows%20Azure.pptx) (PowerPoint PPTX, 6,83MB).  \r\nYou can also view my presentation on SlideShare (but the fonts get messed up):\r\n\r\n\u003Ciframe height=\"387\" loading=\"lazy\" src=\"https://www.slideshare.net/slideshow/embed_code/17098972?rel=0\" width=\"625\">\u003C/iframe>","src/posts/2013-03-12-speaking-at-the-dutch-techdays-2013.md","02cdcddc0bfd7ded",{"html":938,"metadata":939},"\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2013/03/techdays-2013-logo.webp\" type=\"image/webp\" media=\"(max-width: 489px)\">\u003Csource srcset=\"/wp-content/uploads/2013/03/techdays-2013-logo-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2013/03/techdays-2013-logo-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2013/03/techdays-2013-logo.jpg\" alt=\"Techdays 2013 Netherlands\" loading=\"lazy\" decoding=\"async\" width=\"489\" height=\"191\" srcset=\"/wp-content/uploads/2013/03/techdays-2013-logo.jpg 489w, /wp-content/uploads/2013/03/techdays-2013-logo-150x150.jpg 150w, /wp-content/uploads/2013/03/techdays-2013-logo-185x185.jpg 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>I am invited to speak at the \u003Ca href=\"https://web.archive.org/web/20130313051947/http://www.microsoft.com/netherlands/techdays/home.aspx\" rel=\"noopener noreferrer external\" target=\"_blank\">Techdays 2013\u003Cspan>\u003C/span>\u003C/a> in the Netherlands.\r\nThe event is held on the 7\u003Csup>th\u003C/sup> &#x26; 8\u003Csup>th\u003C/sup> of March at the World Forum in Den Haag.\u003C/p>\n\u003Cp>My session, in Dutch, is called “\u003Cstrong>Serious Request met Windows Azure\u003C/strong>” and I will be talking about my experiences using Windows Azure to build a high available and scaling platform for the various applications used during “\u003Ca href=\"https://nl.wikipedia.org/wiki/3FM_Serious_Request\" rel=\"noopener noreferrer external\" target=\"_blank\">3FM Serious Request\u003Cspan>\u003C/span>\u003C/a>”,\r\nthe annual charity event organized by the Dutch radio station 3FM for the \u003Ca href=\"https://www.rodekruis.nl/\" rel=\"noopener noreferrer external\" target=\"_blank\">Dutch Red Cross\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>If the schedule does not change, I will be speaking in the Africa Room on Friday between 13:15 - 14:30.\u003C/p>\n\u003Ch2 id=\"update\">Update\u003C/h2>\n\u003Cp>I have uploaded my \u003Ca href=\"https://hompus.nl/presentations/Techdays%202013%20-%20Serious%20Request%20met%20Windows%20Azure.pptx\" rel=\"noopener noreferrer external\" target=\"_blank\">slides for this session\u003Cspan>\u003C/span>\u003C/a> (PowerPoint PPTX, 6,83MB).\u003Cbr>\nYou can also view my presentation on SlideShare (but the fonts get messed up):\u003C/p>\n\u003Ciframe height=\"387\" loading=\"lazy\" src=\"https://www.slideshare.net/slideshow/embed_code/17098972?rel=0\" width=\"625\">\u003C/iframe>",{"headings":940,"imagePaths":944,"frontmatter":922},[941],{"depth":780,"slug":942,"text":943},"update","Update",[],"2011-02-23-translating-urls-using-the-alternate-access-mappings",{"id":945,"data":947,"body":959,"filePath":960,"digest":961,"rendered":962},{"id":948,"title":949,"date":950,"updated":951,"author":15,"excerpt":952,"layout":17,"permalink":953,"image":954,"categories":955,"tags":956,"draft":26},218,"Translating URLs using Alternate Access Mappings from code",["Date","2011-02-23T16:48:22.000Z"],["Date","2020-12-06T16:44:48.000Z"],"With SharePoint it's easy to configure multiple zones for your SharePoint Web Application. For example you have a Publishing Web Site with two zones.\nAfter the content is published it'll also be available on the anonymous site and most of the URLs will be automatically translated to corresponding zone URL.\nThere are however some places this is not the case.\n","/2011/02/23/translating-urls-using-the-alternate-access-mappings/","/wp-content/uploads/2011/02/post-218-thumnail-1.png",[132],[957,958,139,160,685,66],"Alternate Access Mapping","Anonymous","With SharePoint it is easy to configure multiple zones for your SharePoint Web Application.\r\nFor example, you have a Publishing Web Site with two zones.\r\n\r\n1. The authenticated CMS where editors can manage content: `https://cms.int`\r\n2. The anonymous website where everybody can view the content: `http://www.ext`\r\n\r\nWhen the editors link to sites, pages, documents and images the URL will start with `https://cms.int`.\r\nAfter the content is published it'll also be available on the anonymous site.\r\nNow most of the URLs will be automatically translated to corresponding zone URL and start with `http://www.ext`.\r\n\r\nHowever, there are some places where this is not the case. You could try to use relative URLs but even that will not fix every scenario.\r\n\r\n## Translate the URL using code\r\n\r\nFacing this issue, I had to translate the URLs myself.\r\nBut I want to write minimal code. Luckily, Microsoft has done most of the work for me.\r\n\r\nOn the [`SPFarm` class](\u003Chttps://learn.microsoft.com/previous-versions/office/sharepoint-server/ms429183(v=office.15)>) you will find the\r\n[`AlternateUrlCollections` property](\u003Chttps://learn.microsoft.com/previous-versions/office/sharepoint-server/ms411962(v=office.15)>).\r\nThis \"collection\" is actually an instance of the\r\n[`SPAlternateUrlCollectionManager` class](\u003Chttps://learn.microsoft.com/previous-versions/office/sharepoint-server/ms428661(v=office.15)>)\r\nand provides the [`RebaseUriWithAlternateUri` method](\u003Chttps://learn.microsoft.com/previous-versions/office/sharepoint-server/ms467849(v=office.15)>).\r\n\r\nAnd this is where the magic happens.\r\n\r\nThis method has an overload where you supply a `Uri` and a `SPUrlZone`.\r\nYou can provide one of the values of the [`SPUrlZone` enumeration](\u003Chttps://learn.microsoft.com/previous-versions/office/sharepoint-server/ms474875(v=office.15)>)\r\nor you can provide the current zone.\r\n\r\nTo get your current zone you can use the static\r\n[`Lookup` method](\u003Chttps://learn.microsoft.com/previous-versions/office/sharepoint-server/ms480335(v=office.15)>)\r\nof the [`SPAlternateUrl` class](\u003Chttps://learn.microsoft.com/previous-versions/office/sharepoint-server/ms464482(v=office.15)>).\r\nThis method requires a Uri so we provide the current one using the\r\n[`ContextUri` property](\u003Chttps://learn.microsoft.com/previous-versions/office/sharepoint-server/ms476291(v=office.15)>) from the same class.\r\n\r\nTo wrap it all up I give you the code:\r\n\r\n```csharp\r\nvar originalUri = new Uri(\"https://cms.int/pages/default.aspx\");\r\n\r\nvar zone = SPAlternateUrl.Lookup(SPAlternateUrl.ContextUri).UrlZone;\r\n\r\nvar translateUri = SPFarm.Local.AlternateUrlCollections\r\n                               .RebaseUriWithAlternateUri(originalUri, zone);\r\n\r\n// When accessing from the authenticated zone\r\n// translateUri == \"https://cms.int/pages/default.aspx\"\r\n\r\n// When accessing from the anonymous zone\r\n// translateUri == http://www.ext/pages/default.aspx\r\n```\r\n\r\n## \"Other\" URLs\r\n\r\nIf you pass a URL which is not listed as an Alternate Access Mapping the method will return the original URL.","src/posts/2011-02-23-translating-urls-using-the-alternate-access-mappings.md","10b52349d0e121b9",{"html":963,"metadata":964},"\u003Cp>With SharePoint it is easy to configure multiple zones for your SharePoint Web Application.\r\nFor example, you have a Publishing Web Site with two zones.\u003C/p>\n\u003Col>\n\u003Cli>The authenticated \u003Cdfn>\u003Cabbr title=\"Content Management System\">CMS\u003C/abbr>\u003C/dfn> where editors can manage content: \u003Ccode>https://cms.int\u003C/code>\u003C/li>\n\u003Cli>The anonymous website where everybody can view the content: \u003Ccode>http://www.ext\u003C/code>\u003C/li>\n\u003C/ol>\n\u003Cp>When the editors link to sites, pages, documents and images the \u003Cdfn>\u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>\u003C/dfn> will start with \u003Ccode>https://cms.int\u003C/code>.\r\nAfter the content is published it’ll also be available on the anonymous site.\r\nNow most of the URLs will be automatically translated to corresponding zone \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr> and start with \u003Ccode>http://www.ext\u003C/code>.\u003C/p>\n\u003Cp>However, there are some places where this is not the case. You could try to use relative URLs but even that will not fix every scenario.\u003C/p>\n\u003Ch2 id=\"translate-the-url-using-code\">Translate the \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr> using code\u003C/h2>\n\u003Cp>Facing this issue, I had to translate the URLs myself.\r\nBut I want to write minimal code. Luckily, Microsoft has done most of the work for me.\u003C/p>\n\u003Cp>On the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms429183(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPFarm\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> you will find the\r\n\u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms411962(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>AlternateUrlCollections\u003C/code> property\u003Cspan>\u003C/span>\u003C/a>.\r\nThis “collection” is actually an instance of the\r\n\u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms428661(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPAlternateUrlCollectionManager\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>\r\nand provides the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms467849(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>RebaseUriWithAlternateUri\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>And this is where the magic happens.\u003C/p>\n\u003Cp>This method has an overload where you supply a \u003Ccode>Uri\u003C/code> and a \u003Ccode>SPUrlZone\u003C/code>.\r\nYou can provide one of the values of the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms474875(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPUrlZone\u003C/code> enumeration\u003Cspan>\u003C/span>\u003C/a>\r\nor you can provide the current zone.\u003C/p>\n\u003Cp>To get your current zone you can use the static\r\n\u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms480335(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Lookup\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>\r\nof the \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms464482(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SPAlternateUrl\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>.\r\nThis method requires a Uri so we provide the current one using the\r\n\u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms476291(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ContextUri\u003C/code> property\u003Cspan>\u003C/span>\u003C/a> from the same class.\u003C/p>\n\u003Cp>To wrap it all up I give you the code:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:77ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">originalUri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Uri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"https://cms.int/pages/default.aspx\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">zone\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SPAlternateUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Lookup\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SPAlternateUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ContextUri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">).\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">UrlZone\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">translateUri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SPFarm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Local\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">AlternateUrlCollections\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:31ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">                               \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">RebaseUriWithAlternateUri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">originalUri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">zone\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// When accessing from the authenticated zone\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// translateUri == \"https://cms.int/pages/default.aspx\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// When accessing from the anonymous zone\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// translateUri == http://www.ext/pages/default.aspx\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var originalUri = new Uri(&#x22;https://cms.int/pages/default.aspx&#x22;);var zone = SPAlternateUrl.Lookup(SPAlternateUrl.ContextUri).UrlZone;var translateUri = SPFarm.Local.AlternateUrlCollections                               .RebaseUriWithAlternateUri(originalUri, zone);// When accessing from the authenticated zone// translateUri == &#x22;https://cms.int/pages/default.aspx&#x22;// When accessing from the anonymous zone// translateUri == http://www.ext/pages/default.aspx\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"other-urls\">“Other” URLs\u003C/h2>\n\u003Cp>If you pass a \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr> which is not listed as an Alternate Access Mapping the method will return the original \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>.\u003C/p>",{"headings":965,"imagePaths":972,"frontmatter":947},[966,969],{"depth":780,"slug":967,"text":968},"translate-the-url-using-code","Translate the URL using code",{"depth":780,"slug":970,"text":971},"other-urls","“Other” URLs",[],"2010-06-22-keeping-your-sharepoint-2010-development-databases-small",{"id":973,"data":975,"body":989,"filePath":990,"digest":991,"rendered":992},{"id":976,"title":977,"date":978,"updated":979,"author":15,"excerpt":980,"layout":17,"permalink":981,"image":982,"categories":983,"tags":985,"draft":26},186,"Keeping your SharePoint 2010 development databases small",["Date","2010-06-22T12:55:40.000Z"],["Date","2020-12-06T16:22:52.000Z"],"With SharePoint 2010 the amount of databases on your SQL server has grown quite a bit. By default most of these databases have their recovery model set to 'FULL'. After some time you will discover you're running out of space.\n","/2010/06/22/keeping-your-sharepoint-2010-development-databases-small/","/wp-content/uploads/2010/06/post-186-thumnail-1.png",[132,984],"SQL",[139,160,986,984,987,988],"Shrink","Transaction Log","TSQL","With SharePoint 2010 the number of databases on your SQL Server has grown quite a bit.\r\nBy default, most of these databases have their recovery model set to `FULL`.\r\nAfter some time, you will discover you’re running out of space.\r\n\r\n\u003C!--more-->\r\n\r\n## The problem\r\n\r\nMost likely, the problem lies with the transaction logs of your databases.\r\nWith the recovery model set to `FULL` they will keep storing every transaction until you make a backup.\r\nChances are you do not configure a backup plan for your development environment as most development\r\ndatabases do not need a backup as your sources will be stored in a source control system.\r\n\r\n## The (manual) solution\r\n\r\nTo solve this problem, you can change the recovery model of each database by hand.\r\nFor this you can open SQL Server Management Studio (SMSS),\r\nopen the properties screen for a database and navigate to the options tab.\r\nThere you will find the recovery model option.\r\n\r\n![Database Properties screen with the Recovery model set to 'Simple'](/wp-content/uploads/2010/06/database-properties-recovery-model-shrink.png \"Database Properties screen with the Recovery model set to `Simple`.\")\r\n\r\nSaving this change will empty your transaction log.\r\nBut it will not shrink the physical file on disk.\r\nTo shrink this file, you can look at the `Shrink` task.\r\n\r\n![The context menu's to shrink the size of the log files](/wp-content/uploads/2010/06/context-menu-shrink-log-files.png \"The context menus to shrink the size of the log files.\")\r\n\r\n## The (automated) solution\r\n\r\nExecuting this step for every database manually is quite some work. So, you want the easy solution.\r\n\r\nThe following TSQL script will change the recovery model for every database to `Simple` and shrinks the database.\r\n\r\n```sql\r\nUSE [master]\r\nGO\r\n\r\nDECLARE @dbname SYSNAME\r\nDECLARE @altercmd NVARCHAR(1000)\r\nDECLARE @shrinkcmd NVARCHAR(1000)\r\n\r\nDECLARE [dbcursor] CURSOR FOR SELECT [name] FROM sysdatabases\r\n\r\nOPEN [dbcursor]\r\nFETCH NEXT FROM [dbcursor] INTO @dbname\r\n\r\nWHILE\r\n  @@FETCH_STATUS = 0\r\nBEGIN\r\n  IF\r\n    (SELECT DATABASEPROPERTYEX(@dbname, 'RECOVERY')) != 'SIMPLE'\r\n    AND\r\n    @dbname != 'tempdb'\r\n  BEGIN\r\n    SET @altercmd = 'ALTER DATABASE \"' + @dbname + '\" SET RECOVERY SIMPLE'\r\n      EXEC (@altercmd)\r\n\r\n      SET @shrinkcmd = 'DBCC SHRINKDATABASE (\"' + @dbname + '\")'\r\n      EXEC (@shrinkcmd)\r\n\r\n      PRINT @dbname\r\n  END\r\n\r\n  FETCH NEXT FROM [dbcursor] INTO @dbname\r\nEND\r\n\r\nCLOSE [dbcursor]\r\nDEALLOCATE [dbcursor]\r\n```","src/posts/2010-06-22-keeping-your-sharepoint-2010-development-databases-small.md","12e7a50207fe7e6b",{"html":993,"metadata":994},"\u003Cp>With SharePoint 2010 the number of databases on your \u003Cdfn>\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr>\u003C/dfn> Server has grown quite a bit.\r\nBy default, most of these databases have their recovery model set to \u003Ccode>FULL\u003C/code>.\r\nAfter some time, you will discover you’re running out of space.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"the-problem\">The problem\u003C/h2>\n\u003Cp>Most likely, the problem lies with the transaction logs of your databases.\r\nWith the recovery model set to \u003Ccode>FULL\u003C/code> they will keep storing every transaction until you make a backup.\r\nChances are you do not configure a backup plan for your development environment as most development\r\ndatabases do not need a backup as your sources will be stored in a source control system.\u003C/p>\n\u003Ch2 id=\"the-manual-solution\">The (manual) solution\u003C/h2>\n\u003Cp>To solve this problem, you can change the recovery model of each database by hand.\r\nFor this you can open \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Server Management Studio (\u003Cdfn>\u003Cabbr title=\"SQL Server Management Studio\">SMSS\u003C/abbr>\u003C/dfn>),\r\nopen the properties screen for a database and navigate to the options tab.\r\nThere you will find the recovery model option.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/06/database-properties-recovery-model-shrink.webp\" type=\"image/webp\" media=\"(max-width: 593px)\">\u003Csource srcset=\"/wp-content/uploads/2010/06/database-properties-recovery-model-shrink-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/06/database-properties-recovery-model-shrink-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/06/database-properties-recovery-model-shrink.png\" alt=\"Database Properties screen with the Recovery model set to &#x27;Simple&#x27;\" loading=\"lazy\" decoding=\"async\" width=\"593\" height=\"200\" srcset=\"/wp-content/uploads/2010/06/database-properties-recovery-model-shrink.png 593w, /wp-content/uploads/2010/06/database-properties-recovery-model-shrink-150x150.png 150w, /wp-content/uploads/2010/06/database-properties-recovery-model-shrink-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Database Properties screen with the Recovery model set to `Simple`.\u003C/figcaption>\u003C/figure>\n\u003Cp>Saving this change will empty your transaction log.\r\nBut it will not shrink the physical file on disk.\r\nTo shrink this file, you can look at the \u003Ccode>Shrink\u003C/code> task.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/06/context-menu-shrink-log-files.webp\" type=\"image/webp\" media=\"(max-width: 560px)\">\u003Csource srcset=\"/wp-content/uploads/2010/06/context-menu-shrink-log-files-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/06/context-menu-shrink-log-files-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/06/context-menu-shrink-log-files.png\" alt=\"The context menu&#x27;s to shrink the size of the log files\" loading=\"lazy\" decoding=\"async\" width=\"560\" height=\"492\" srcset=\"/wp-content/uploads/2010/06/context-menu-shrink-log-files.png 560w, /wp-content/uploads/2010/06/context-menu-shrink-log-files-150x150.png 150w, /wp-content/uploads/2010/06/context-menu-shrink-log-files-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>The context menus to shrink the size of the log files.\u003C/figcaption>\u003C/figure>\n\u003Ch2 id=\"the-automated-solution\">The (automated) solution\u003C/h2>\n\u003Cp>Executing this step for every database manually is quite some work. So, you want the easy solution.\u003C/p>\n\u003Cp>The following \u003Cdfn>\u003Cabbr title=\"Transact-SQL\">TSQL\u003C/abbr>\u003C/dfn> script will change the recovery model for every database to \u003Ccode>Simple\u003C/code> and shrinks the database.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"sql\" class=\"wrap\" style=\"--ecMaxLine:74ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">USE\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [master]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">GO\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">DECLARE\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> @dbname \u003C/span>\u003Cspan style=\"--0:#569CD6\">SYSNAME\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">DECLARE\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> @altercmd \u003C/span>\u003Cspan style=\"--0:#569CD6\">NVARCHAR\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1000\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">DECLARE\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> @shrinkcmd \u003C/span>\u003Cspan style=\"--0:#569CD6\">NVARCHAR\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1000\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">DECLARE\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [dbcursor] \u003C/span>\u003Cspan style=\"--0:#569CD6\">CURSOR\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">FOR\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [name] \u003C/span>\u003Cspan style=\"--0:#569CD6\">FROM\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> sysdatabases\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">OPEN\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [dbcursor]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">FETCH\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">NEXT\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">FROM\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [dbcursor] \u003C/span>\u003Cspan style=\"--0:#569CD6\">INTO\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> @dbname\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">WHILE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">@@FETCH_STATUS \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">BEGIN\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">IF\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">DATABASEPROPERTYEX\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(@dbname, \u003C/span>\u003Cspan style=\"--0:#CE9178\">'RECOVERY'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">'SIMPLE'\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">AND\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">@dbname \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">'tempdb'\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">BEGIN\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">SET\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> @altercmd \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">'ALTER DATABASE \"'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> @dbname \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">'\" SET RECOVERY SIMPLE'\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">EXEC\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (@altercmd)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">SET\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> @shrinkcmd \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">'DBCC SHRINKDATABASE (\"'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> @dbname \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">'\")'\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">EXEC\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (@shrinkcmd)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">PRINT\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> @dbname\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">END\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">FETCH\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">NEXT\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">FROM\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [dbcursor] \u003C/span>\u003Cspan style=\"--0:#569CD6\">INTO\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> @dbname\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">END\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">CLOSE\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [dbcursor]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">DEALLOCATE\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [dbcursor]\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"USE [master]GODECLARE @dbname SYSNAMEDECLARE @altercmd NVARCHAR(1000)DECLARE @shrinkcmd NVARCHAR(1000)DECLARE [dbcursor] CURSOR FOR SELECT [name] FROM sysdatabasesOPEN [dbcursor]FETCH NEXT FROM [dbcursor] INTO @dbnameWHILE  @@FETCH_STATUS = 0BEGIN  IF    (SELECT DATABASEPROPERTYEX(@dbname, &#x27;RECOVERY&#x27;)) != &#x27;SIMPLE&#x27;    AND    @dbname != &#x27;tempdb&#x27;  BEGIN    SET @altercmd = &#x27;ALTER DATABASE &#x22;&#x27; + @dbname + &#x27;&#x22; SET RECOVERY SIMPLE&#x27;      EXEC (@altercmd)      SET @shrinkcmd = &#x27;DBCC SHRINKDATABASE (&#x22;&#x27; + @dbname + &#x27;&#x22;)&#x27;      EXEC (@shrinkcmd)      PRINT @dbname  END  FETCH NEXT FROM [dbcursor] INTO @dbnameENDCLOSE [dbcursor]DEALLOCATE [dbcursor]\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>",{"headings":995,"imagePaths":1003,"frontmatter":975},[996,997,1000],{"depth":780,"slug":255,"text":256},{"depth":780,"slug":998,"text":999},"the-manual-solution","The (manual) solution",{"depth":780,"slug":1001,"text":1002},"the-automated-solution","The (automated) solution",[],"2010-06-01-using-the-people-picker-over-a-one-way-trust",{"id":1004,"data":1006,"body":1019,"filePath":1020,"digest":1021,"rendered":1022},{"id":1007,"title":1008,"date":1009,"updated":1010,"author":15,"excerpt":1011,"layout":17,"permalink":1012,"image":1013,"categories":1014,"tags":1015,"draft":26},181,"Using the people picker over a one-way trust",["Date","2010-06-01T13:04:56.000Z"],["Date","2020-12-06T16:20:46.000Z"],"When you have a SharePoint farm and you want to use accounts from another domain you need a partial (one-way) or a full (two-way) trust between those domain.\nA full trust is not always desirable and there your problem begins. After setting up the one-way trust you can authenticate with an account from the trusted domain, but the SharePoint People Picker doesn't show any accounts from this domain.\nIt has been documented by others before, but as I ran into this recently I'll give my summary how I fixed this.\n","/2010/06/01/using-the-people-picker-over-a-one-way-trust/","/wp-content/uploads/2010/06/post-181-thumnail-1.png",[132],[1016,1017,139,160,1018,66],"Domain","People Picker","Trust","When you have a SharePoint farm and you want to use accounts from another domain you need a partial (one-way) or a full (two-way) trust between those domains.\r\n\r\nA full trust is not always desirable and there your problem begins.\r\nAfter setting up the one-way trust you can authenticate with an account from the trusted domain,\r\nbut the SharePoint People Picker won't show any accounts from this domain.\r\n\r\nIt has been documented by others before, but as I ran into this recently, I will give my summary how I fixed this.  \r\nThis solution is the same for WSS 3.0/SharePoint 2007 as SharePoint 2010.\r\n\r\n## The problem\r\n\r\nWhen using a one-way trust, you do not see any accounts from the other domain in the people picker.\r\n\r\n![SharePoint People Picker not showing any accounts.](/wp-content/uploads/2010/06/people-picker-no-results.png \"People picker not showing accounts from the other domain.\")\r\n\r\n## The reason\r\n\r\nThis is an example of how you could use a partial trust.\r\n\r\n![Architecture with a company and a development domain setup with a partial trust.](/wp-content/uploads/2010/06/one-way-trust-architecture.png \"Example of a one-way trust architecture.\")\r\n\r\nYou want to allow employees to authenticate in a development farm, but you do not want to allow any test or service account from the development domain to authenticate in the company domain.\r\n\r\nAs the application pool account is based in the development domain it doesn’t have the right to query the company domain.\r\n\r\n## The solution\r\n\r\nUsing [STSADM](https://learn.microsoft.com/previous-versions/office/sharepoint-2007-products-and-technologies/cc261956(v=office.12))\r\nwe can configure which forests and domains are searched for accounts by setting the `peoplepicker-searchadforests` property.\r\nThe best part is that we can supply a username and password for a trusted domain.\r\n\r\nSharePoint does not allow you to store this username and password in plain text on the server.\r\nSo, you will have to configure a _secure store_.\r\nIf you skip this step, configuring the search account for trusted domains will always fail with the following message.\r\n\r\n> \"Cannot retrieve the information for application credential key.\"\r\n\r\nTo create a credential key, you will have to use the following command.\r\n\r\n```shell\r\nstsadm -o setapppassword\r\n       -password \u003Cpassword>\r\n```\r\n\r\nThis command has to be executed on _every_ server in the farm.\r\n\r\nNow you can configure the forests and domains you want to search using the following command.\r\n\r\n```shell\r\nstsadm -o setproperty\r\n       -url \u003Cweb application url>\r\n       -pn peoplepicker-searchadforests\r\n       -pv forest:\u003Csource forest>;domain:\u003Ctrusted domain>,\u003Ctrusted domain>\\\u003Caccount>,\u003Cpassword>\r\n```\r\n\r\nYou can combine any number of forests and domains, but you need to specify at least one.  \r\nYou also need to include all forests and domains in one statement because every time you execute this command it will reset the current settings.\r\n\r\nAlso note this setting is per web application, and even per zone.\r\n\r\n![SharePoint People Picker showing an account from the one-way trusted domain.](/wp-content/uploads/2010/06/people-picker-with-results.png \"People picker showing accounts from the other domain.\")","src/posts/2010-06-01-using-the-people-picker-over-a-one-way-trust.md","7f8e673998986a8e",{"html":1023,"metadata":1024},"\u003Cp>When you have a SharePoint farm and you want to use accounts from another domain you need a partial (one-way) or a full (two-way) trust between those domains.\u003C/p>\n\u003Cp>A full trust is not always desirable and there your problem begins.\r\nAfter setting up the one-way trust you can authenticate with an account from the trusted domain,\r\nbut the SharePoint People Picker won’t show any accounts from this domain.\u003C/p>\n\u003Cp>It has been documented by others before, but as I ran into this recently, I will give my summary how I fixed this.\u003Cbr>\nThis solution is the same for \u003Cdfn>\u003Cabbr title=\"Windows SharePoint Services\">WSS\u003C/abbr>\u003C/dfn> 3.0/SharePoint 2007 as SharePoint 2010.\u003C/p>\n\u003Ch2 id=\"the-problem\">The problem\u003C/h2>\n\u003Cp>When using a one-way trust, you do not see any accounts from the other domain in the people picker.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/06/people-picker-no-results.webp\" type=\"image/webp\" media=\"(max-width: 586px)\">\u003Csource srcset=\"/wp-content/uploads/2010/06/people-picker-no-results-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Cimg src=\"/wp-content/uploads/2010/06/people-picker-no-results.png\" alt=\"SharePoint People Picker not showing any accounts.\" loading=\"lazy\" decoding=\"async\" width=\"586\" height=\"182\" srcset=\"/wp-content/uploads/2010/06/people-picker-no-results.png 586w, /wp-content/uploads/2010/06/people-picker-no-results-150x150.png 150w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>People picker not showing accounts from the other domain.\u003C/figcaption>\u003C/figure>\n\u003Ch2 id=\"the-reason\">The reason\u003C/h2>\n\u003Cp>This is an example of how you could use a partial trust.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/06/one-way-trust-architecture.webp\" type=\"image/webp\" media=\"(max-width: 591px)\">\u003Csource srcset=\"/wp-content/uploads/2010/06/one-way-trust-architecture-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Cimg src=\"/wp-content/uploads/2010/06/one-way-trust-architecture.png\" alt=\"Architecture with a company and a development domain setup with a partial trust.\" loading=\"lazy\" decoding=\"async\" width=\"591\" height=\"170\" srcset=\"/wp-content/uploads/2010/06/one-way-trust-architecture.png 591w, /wp-content/uploads/2010/06/one-way-trust-architecture-150x150.png 150w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Example of a one-way trust architecture.\u003C/figcaption>\u003C/figure>\n\u003Cp>You want to allow employees to authenticate in a development farm, but you do not want to allow any test or service account from the development domain to authenticate in the company domain.\u003C/p>\n\u003Cp>As the application pool account is based in the development domain it doesn’t have the right to query the company domain.\u003C/p>\n\u003Ch2 id=\"the-solution\">The solution\u003C/h2>\n\u003Cp>Using \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-2007-products-and-technologies/cc261956(v=office.12)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Cdfn>\u003Cabbr title=\"SharePoint Team Services Administration\">STSADM\u003C/abbr>\u003C/dfn>\u003Cspan>\u003C/span>\u003C/a>\r\nwe can configure which forests and domains are searched for accounts by setting the \u003Ccode>peoplepicker-searchadforests\u003C/code> property.\r\nThe best part is that we can supply a username and password for a trusted domain.\u003C/p>\n\u003Cp>SharePoint does not allow you to store this username and password in plain text on the server.\r\nSo, you will have to configure a \u003Cem>secure store\u003C/em>.\r\nIf you skip this step, configuring the search account for trusted domains will always fail with the following message.\u003C/p>\n\u003Cblockquote>\n\u003Cp>“Cannot retrieve the information for application credential key.”\u003C/p>\n\u003C/blockquote>\n\u003Cp>To create a credential key, you will have to use the following command.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:27ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">stsadm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-o\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">setapppassword\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:7ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">       \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">-password\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;password>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"stsadm -o setapppassword       -password \u003Cpassword>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This command has to be executed on \u003Cem>every\u003C/em> server in the farm.\u003C/p>\n\u003Cp>Now you can configure the forests and domains you want to search using the following command.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:95ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">stsadm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-o\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">setproperty\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:7ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">       \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">-url\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;web\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">application\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">url>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:7ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">       \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">-pn\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">peoplepicker-searchadforests\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:7ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">       \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">-pv\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">forest:&#x3C;source\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">forest>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">domain:&#x3C;trusted\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">domain>,&#x3C;trusted\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">domain>\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\&#x3C;\u003C/span>\u003Cspan style=\"--0:#CE9178\">account>,&#x3C;password>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"stsadm -o setproperty       -url \u003Cweb application url>       -pn peoplepicker-searchadforests       -pv forest:\u003Csource forest>;domain:\u003Ctrusted domain>,\u003Ctrusted domain>\\\u003Caccount>,\u003Cpassword>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>You can combine any number of forests and domains, but you need to specify at least one.\u003Cbr>\nYou also need to include all forests and domains in one statement because every time you execute this command it will reset the current settings.\u003C/p>\n\u003Cp>Also note this setting is per web application, and even per zone.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/06/people-picker-with-results.webp\" type=\"image/webp\" media=\"(max-width: 586px)\">\u003Csource srcset=\"/wp-content/uploads/2010/06/people-picker-with-results-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Cimg src=\"/wp-content/uploads/2010/06/people-picker-with-results.png\" alt=\"SharePoint People Picker showing an account from the one-way trusted domain.\" loading=\"lazy\" decoding=\"async\" width=\"586\" height=\"180\" srcset=\"/wp-content/uploads/2010/06/people-picker-with-results.png 586w, /wp-content/uploads/2010/06/people-picker-with-results-150x150.png 150w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>People picker showing accounts from the other domain.\u003C/figcaption>\u003C/figure>",{"headings":1025,"imagePaths":1029,"frontmatter":1006},[1026,1027,1028],{"depth":780,"slug":255,"text":256},{"depth":780,"slug":599,"text":600},{"depth":780,"slug":258,"text":259},[],"2015-06-18-updated-pull-down-to-refresh-panel-to-work-after-navigating",{"id":1030,"data":1032,"body":1048,"filePath":1049,"digest":1050,"rendered":1051},{"id":1033,"title":1034,"date":1035,"updated":1036,"author":15,"excerpt":1037,"layout":17,"permalink":1038,"image":1039,"categories":1040,"tags":1042,"draft":26},495,"Updated pull-down-to-refresh panel to work after navigating",["Date","2015-06-18T12:32:06.000Z"],["Date","2021-07-16T20:53:08.000Z"],"I received a couple of comments on my article about making the pull-down-to-refresh work with a Windows Phone virtualizing list control. The problem was that the functionality stopped working after navigating away from the page containing the ItemsControl. Today I committed the code to GitHub to fix this issue.\n","/2015/06/18/updated-pull-down-to-refresh-panel-to-work-after-navigating/","/wp-content/uploads/2015/06/post-2015-06-18-thumbnail.png",[183,1041],"Windows Phone",[1043,137,1044,661,1045,1046,1047],"ListBox","ScrollViewer","WP8","WP8.1","Xaml","I received a couple of comments on my article about\r\n\"[making the pull-down-to-refresh work with a Windows Phone virtualizing list control](/2015/02/04/make-pull-down-to-refresh-work-with-a-windows-phone-virtualizing-list-control)\".\r\n\r\nThe problem was that the functionality stopped working after navigating away from the page containing the [`ItemsControl` control](https://learn.microsoft.com/dotnet/api/system.windows.controls.itemscontrol?view=netframework-4.7).\r\n\r\n\u003C!--more-->\r\n\r\nTo prevent events from triggering when the list is not in view, I deregistered all events.\r\nBut when the list came back in view, I did not start monitoring these events again.\r\n\r\nToday I committed the code to GitHub to fix this issue.\r\n\r\n## Source code\r\n\r\nYou can download my [Windows Phone 8 example project](https://github.com/eNeRGy164/PullDownToRefreshPanelDemo) on GitHub.","src/posts/2015-06-18-updated-pull-down-to-refresh-panel-to-work-after-navigating.md","39236e74574528c3",{"html":1052,"metadata":1053},"\u003Cp>I received a couple of comments on my article about\r\n“\u003Ca href=\"/2015/02/04/make-pull-down-to-refresh-work-with-a-windows-phone-virtualizing-list-control\">making the pull-down-to-refresh work with a Windows Phone virtualizing list control\u003C/a>”.\u003C/p>\n\u003Cp>The problem was that the functionality stopped working after navigating away from the page containing the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.windows.controls.itemscontrol?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ItemsControl\u003C/code> control\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003C!--more-->\n\u003Cp>To prevent events from triggering when the list is not in view, I deregistered all events.\r\nBut when the list came back in view, I did not start monitoring these events again.\u003C/p>\n\u003Cp>Today I committed the code to GitHub to fix this issue.\u003C/p>\n\u003Ch2 id=\"source-code\">Source code\u003C/h2>\n\u003Cp>You can download my \u003Ca href=\"https://github.com/eNeRGy164/PullDownToRefreshPanelDemo\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows Phone 8 example project\u003Cspan>\u003C/span>\u003C/a> on GitHub.\u003C/p>",{"headings":1054,"imagePaths":1058,"frontmatter":1032},[1055],{"depth":780,"slug":1056,"text":1057},"source-code","Source code",[],"2013-03-13-backup-your-azure-sql-database-to-blob-storage-using-code",{"id":1059,"data":1061,"body":1075,"filePath":1076,"digest":1077,"rendered":1078},{"id":1062,"title":1063,"date":1064,"updated":1065,"author":15,"excerpt":1066,"layout":17,"permalink":1067,"image":1068,"categories":1069,"tags":1070,"draft":26},336,"Backup your Azure SQL Database to Blob Storage using code",["Date","2013-03-13T15:11:30.000Z"],["Date","2021-07-16T20:56:05.000Z"],"With Windows Azure we can use Windows Azure SQL Database service (formerly known as SQL Azure) when we need a Relational Database. Microsoft offers a 99.9% monthly SLA for this service. But Microsoft doesn't provide you with the service to restore your data to a moment back in time when you (accidentally) delete of corrupt data.\nTo have a backup in time I wrote some code to allow a Worker Role to backup my Windows Azure SQL Database every hour. Most solutions you find online are relying on the REST Endpoints but the address of the endpoint is different depending on which datacenter your database is hosted. I found a different solution where you only need the connection string to your database using the DacServices.\n","/2013/03/13/backup-your-azure-sql-database-to-blob-storage-using-code/","/wp-content/uploads/2013/03/post-336-thumbnail.jpg",[906,984],[906,1071,1072,1073,984,1074],"Backup","DAC","Database","Worker Role","With Windows Azure we can use [Azure SQL Database](https://learn.microsoft.com/azure/azure-sql/database/sql-database-paas-overview) service (formerly known as SQL Azure) when we need a Relational Database.\r\nMicrosoft offers a 99.9% monthly SLA for this service.\r\n\r\nBut Microsoft does not provide you with the service to restore your data to a moment back in time when you (accidentally) delete of corrupt data.\r\n\r\n\u003C!--more-->\r\n\r\nWith an \"on-premises\" Microsoft SQL Server installation you would solve this by configuring and scheduling (transactional log) backups.\r\nBut this is not possible for the Azure service.\r\n\r\nYou could replicate a copy of your database using [SQL Data Sync](https://learn.microsoft.com/azure/azure-sql/database/sql-data-sync-sql-server-configure) with a delay.\r\nBut if you fail to discover the issue in time for the next scheduled sync your copy won't make a difference.\r\n\r\nTo have a backup in time I wrote some code to allow a Worker Role to back up my Azure SQL Database every hour.\r\nMost solutions you find online are relying on the _REST Endpoints_ but the address of the endpoint is different depending on which datacenter your database is hosted.\r\nI found a different solution where you only need the connection string to your database using the DacServices.\r\n\r\n## Pre-requisites\r\n\r\nTo make a backup I use the **Microsoft SQL Server 2012 Data-Tier Application Framework**.\r\nThis framework provides the [`DacServices` class](https://learn.microsoft.com/dotnet/api/microsoft.sqlserver.dac.dacservices?view=sql-dacfx-140).\r\n\r\nYou need to configure **Local Storage** to store the backup temporary and you need a [Storage Account](https://learn.microsoft.com/azure/storage/common/storage-account-create) to store the backup file permanently.\r\n\r\n## The solution\r\n\r\n```csharp\r\n// Get the Storage Account\r\nvar backupStorageAccount =\r\n    CloudStorageAccount.FromConfigurationSetting(\"StorageAccount\");\r\n\r\n// The container to store backups\r\nvar backupBlobClient = backupStorageAccount.CreateCloudBlobClient();\r\nbackupContainer = backupBlobClient.GetContainerReference(\"backups\");\r\nbackupContainer.CreateIfNotExist();\r\n\r\n// The backup file on blob storage\r\nvar storageName =\r\n    string.Format(\"Backup_{0}.bacpac\", DateTime.Now.ToString(\"yyyyMMdd-HHmmss\"));\r\nvar backupFile = backupContainer.GetBlobReference(storageName);\r\n\r\n// Get a reference to the temporary files\r\nvar localResource = RoleEnvironment.GetLocalResource(\"TempFiles\");\r\nvar file = string.Format(\"{0}{1}\", localResource.RootPath, backupFile.Name);\r\n\r\n// Connect to the DacServices\r\nvar services = new DacServices(\r\n    ConfigurationManager.ConnectionStrings[\"DatabaseName\"].ConnectionString);\r\n\r\nservices.Message += (sender, e) =>\r\n    {\r\n        // If you use a lock file,\r\n        // this would be a good location to extend the lease\r\n    };\r\n\r\n// Export the database to the local disc\r\nservices.ExportBacpac(file, \"DatabaseName\");\r\n\r\n// Upload the file to Blob Storage\r\nbackupFile.Properties.ContentType = \"binary/octet-stream\";\r\nbackupFile.UploadFile(file);\r\n\r\n// Remove the temporary file\r\nFile.Delete(file);\r\n```\r\n\r\n## Explanation\r\n\r\nThe code does the following:\r\n\r\n1. Connect to the Storage Account\r\n2. Get a reference to the container and file where you want to store the backup\r\n3. Get a reference to the local storage location\r\n4. Connect to the DacService using the database connection string\r\n5. Export the database to a `.bacpac` file\r\n6. Upload the file to blob storage\r\n7. Delete the local file\r\n\r\n## A Catch\r\n\r\nBefore you deploy your Worker Role, you will have to make sure each of the listed assemblies are referenced and the property `Copy Local` is set to `True` otherwise you will run into trouble.\r\n\r\n- `Microsoft.Data.Tools.Schema.Sql`\r\n- `Microsoft.Data.Tools.Utilities`\r\n- `Microsoft.SqlServer.Dac`\r\n- `Microsoft.SqlServer.TransactSql`\r\n- `Microsoft.SqlServer.TransactSql.ScriptDom`\r\n- `Microsoft.SqlServer.Types`","src/posts/2013-03-13-backup-your-azure-sql-database-to-blob-storage-using-code.md","a806d3669969e22d",{"html":1079,"metadata":1080},"\u003Cp>With Windows Azure we can use \u003Ca href=\"https://learn.microsoft.com/azure/azure-sql/database/sql-database-paas-overview?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Azure \u003Cdfn>\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr>\u003C/dfn> Database\u003Cspan>\u003C/span>\u003C/a> service (formerly known as \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Azure) when we need a Relational Database.\r\nMicrosoft offers a 99.9% monthly \u003Cdfn>\u003Cabbr title=\"Service Level Agreement\">SLA\u003C/abbr>\u003C/dfn> for this service.\u003C/p>\n\u003Cp>But Microsoft does not provide you with the service to restore your data to a moment back in time when you (accidentally) delete of corrupt data.\u003C/p>\n\u003C!--more-->\n\u003Cp>With an “on-premises” Microsoft \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Server installation you would solve this by configuring and scheduling (transactional log) backups.\r\nBut this is not possible for the Azure service.\u003C/p>\n\u003Cp>You could replicate a copy of your database using \u003Ca href=\"https://learn.microsoft.com/azure/azure-sql/database/sql-data-sync-sql-server-configure?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Data Sync\u003Cspan>\u003C/span>\u003C/a> with a delay.\r\nBut if you fail to discover the issue in time for the next scheduled sync your copy won’t make a difference.\u003C/p>\n\u003Cp>To have a backup in time I wrote some code to allow a Worker Role to back up my Azure \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Database every hour.\r\nMost solutions you find online are relying on the \u003Cem>\u003Cdfn>\u003Cabbr title=\"Representational State Transfer\">REST\u003C/abbr>\u003C/dfn> Endpoints\u003C/em> but the address of the endpoint is different depending on which datacenter your database is hosted.\r\nI found a different solution where you only need the connection string to your database using the DacServices.\u003C/p>\n\u003Ch2 id=\"pre-requisites\">Pre-requisites\u003C/h2>\n\u003Cp>To make a backup I use the \u003Cstrong>Microsoft \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Server 2012 Data-Tier Application Framework\u003C/strong>.\r\nThis framework provides the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.sqlserver.dac.dacservices?view=sql-dacfx-140&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>DacServices\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>You need to configure \u003Cstrong>Local Storage\u003C/strong> to store the backup temporary and you need a \u003Ca href=\"https://learn.microsoft.com/azure/storage/common/storage-account-create?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Storage Account\u003Cspan>\u003C/span>\u003C/a> to store the backup file permanently.\u003C/p>\n\u003Ch2 id=\"the-solution\">The solution\u003C/h2>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:81ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// Get the Storage Account\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">backupStorageAccount\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">CloudStorageAccount\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">FromConfigurationSetting\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"StorageAccount\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// The container to store backups\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">backupBlobClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">backupStorageAccount\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CreateCloudBlobClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">backupContainer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">backupBlobClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetContainerReference\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"backups\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">backupContainer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CreateIfNotExist\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// The backup file on blob storage\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">storageName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Format\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Backup_{0}.bacpac\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DateTime\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Now\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"yyyyMMdd-HHmmss\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">backupFile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">backupContainer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetBlobReference\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">storageName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// Get a reference to the temporary files\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">localResource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">RoleEnvironment\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetLocalResource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"TempFiles\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">file\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Format\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"{0}{1}\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">localResource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">RootPath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">backupFile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// Connect to the DacServices\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">services\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">DacServices\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ConfigurationManager\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ConnectionStrings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"DatabaseName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">].\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ConnectionString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">services\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Message\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">sender\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">e\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#76A162\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#76A162\">// If you use a lock file,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#76A162\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#76A162\">// this would be a good location to extend the lease\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// Export the database to the local disc\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">services\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ExportBacpac\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">file\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"DatabaseName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// Upload the file to Blob Storage\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">backupFile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Properties\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ContentType\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"binary/octet-stream\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">backupFile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">UploadFile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">file\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// Remove the temporary file\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">File\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Delete\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">file\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"// Get the Storage Accountvar backupStorageAccount =    CloudStorageAccount.FromConfigurationSetting(&#x22;StorageAccount&#x22;);// The container to store backupsvar backupBlobClient = backupStorageAccount.CreateCloudBlobClient();backupContainer = backupBlobClient.GetContainerReference(&#x22;backups&#x22;);backupContainer.CreateIfNotExist();// The backup file on blob storagevar storageName =    string.Format(&#x22;Backup_{0}.bacpac&#x22;, DateTime.Now.ToString(&#x22;yyyyMMdd-HHmmss&#x22;));var backupFile = backupContainer.GetBlobReference(storageName);// Get a reference to the temporary filesvar localResource = RoleEnvironment.GetLocalResource(&#x22;TempFiles&#x22;);var file = string.Format(&#x22;{0}{1}&#x22;, localResource.RootPath, backupFile.Name);// Connect to the DacServicesvar services = new DacServices(    ConfigurationManager.ConnectionStrings[&#x22;DatabaseName&#x22;].ConnectionString);services.Message += (sender, e) =>    {        // If you use a lock file,        // this would be a good location to extend the lease    };// Export the database to the local discservices.ExportBacpac(file, &#x22;DatabaseName&#x22;);// Upload the file to Blob StoragebackupFile.Properties.ContentType = &#x22;binary/octet-stream&#x22;;backupFile.UploadFile(file);// Remove the temporary fileFile.Delete(file);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"explanation\">Explanation\u003C/h2>\n\u003Cp>The code does the following:\u003C/p>\n\u003Col>\n\u003Cli>Connect to the Storage Account\u003C/li>\n\u003Cli>Get a reference to the container and file where you want to store the backup\u003C/li>\n\u003Cli>Get a reference to the local storage location\u003C/li>\n\u003Cli>Connect to the DacService using the database connection string\u003C/li>\n\u003Cli>Export the database to a \u003Ccode>.bacpac\u003C/code> file\u003C/li>\n\u003Cli>Upload the file to blob storage\u003C/li>\n\u003Cli>Delete the local file\u003C/li>\n\u003C/ol>\n\u003Ch2 id=\"a-catch\">A Catch\u003C/h2>\n\u003Cp>Before you deploy your Worker Role, you will have to make sure each of the listed assemblies are referenced and the property \u003Ccode>Copy Local\u003C/code> is set to \u003Ccode>True\u003C/code> otherwise you will run into trouble.\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>Microsoft.Data.Tools.Schema.Sql\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Microsoft.Data.Tools.Utilities\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Microsoft.SqlServer.Dac\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Microsoft.SqlServer.TransactSql\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Microsoft.SqlServer.TransactSql.ScriptDom\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Microsoft.SqlServer.Types\u003C/code>\u003C/li>\n\u003C/ul>",{"headings":1081,"imagePaths":1092,"frontmatter":1061},[1082,1085,1086,1089],{"depth":780,"slug":1083,"text":1084},"pre-requisites","Pre-requisites",{"depth":780,"slug":258,"text":259},{"depth":780,"slug":1087,"text":1088},"explanation","Explanation",{"depth":780,"slug":1090,"text":1091},"a-catch","A Catch",[],"2012-06-07-provisioning-a-default-layout-and-content-when-adding-a-wiki-page",{"id":1093,"data":1095,"body":1107,"filePath":1108,"digest":1109,"rendered":1110},{"id":1096,"title":1097,"date":1098,"updated":1099,"author":15,"excerpt":1100,"layout":17,"permalink":1101,"image":1102,"categories":1103,"tags":1104,"draft":26},255,"Provisioning a default layout and content when adding a wiki page",["Date","2012-06-07T13:07:58.000Z"],["Date","2020-12-06T17:12:52.000Z"],"Recently I was challenged with the task to set the layout and content of a wiki page when a new page is added to a team site. As I'm used to work with SharePoint publishing the task sounded easy, but I was wrong.\n","/2012/06/07/provisioning-a-default-layout-and-content-when-adding-a-wiki-page/","/wp-content/uploads/2012/06/post-255-thumnail-1.png",[132],[342,160,1105,1106],"SharePoint Foundation","Wiki","Recently I was challenged with the task to set the layout and content of a wiki page when a new page is added to a team site.\r\nAs I am used to work with SharePoint publishing, the task sounded easy, but I was wrong.\r\n\r\n## Text Layout\r\n\r\n![Image showing the Text Layout option in the SharePoint ribbon](/wp-content/uploads/2012/06/sharepoint-text-layout-ribbon.png)\r\n\r\nMy first path was to figure out where SharePoint puts the wiki \"text layouts\".\r\nI discovered this is not how it works. The layouts available for wiki's are not configurable anywhere.\r\n\r\nBut using some PowerShell it was easy to get and set the layout as it is the HTML content of the \"Wiki Field\" column in the list.\r\n\r\n```powershell\r\n$web = Get-SPWeb http://server/teamsite\r\n$list = $web.Lists[\"Site Pages\"]\r\n$listItem = $list.Items[2] # My test page\r\n$listItem[\"Wiki Content\"] # Returns HTML\r\n```\r\n\r\nThe HTML content consists of two parts.\r\nThe layout table and the layout data.\r\n\r\n```html\r\n\u003Ctable id=\"layoutsTable\" style=\"width: 100%\">\r\n  \u003Ctbody>\r\n    \u003Ctr style=\"vertical-align: top\">\r\n      \u003Ctd style=\"width: 100%\">\r\n        \u003Cdiv class=\"ms-rte-layoutszone-outer\" style=\"width: 100%\">\r\n          \u003Cdiv class=\"ms-rte-layoutszone-inner\">\u003C/div>\r\n        \u003C/div>\r\n      \u003C/td>\r\n    \u003C/tr>\r\n  \u003C/tbody>\r\n\u003C/table>\r\n\u003Cspan id=\"layoutsData\" style=\"display: none\">false,false,1\u003C/span>\r\n```\r\n\r\nThe layout data describes visibility of the header and footer and the number of columns.\r\n\r\n## Event receiver\r\n\r\nTo set the content the first thing in my mind was to add an\r\n[`ItemAdding` event receiver](\u003Chttps://learn.microsoft.com/previous-versions/office/sharepoint-server/ms414997(v=office.15)>),\r\nassociated with `ListTemplateId 119` (WebPageLibrary).\r\n\r\nI deployed the solution and added a page and 🎉: no content!\r\n\r\nUsing the debugger to verify my event receiver was triggered, I went to the next option:\r\nadding an [`ItemAdded` event receiver](\u003Chttps://learn.microsoft.com/previous-versions/office/sharepoint-server/ms461317(v=office.15)>).\r\nThis time I got an exception the page was already modified by another user.\r\nRefreshing the page gave me the default content.\r\n\r\nSo, this told me 2 things:\r\n\r\n1. It is possible to set default content\r\n2. I forgot to set the `Synchronize` property\r\n\r\nSo, after fixing the second thing, I deployed once again and got: no content!\r\n\r\nAs I used [`ListItem.Update` method](\u003Chttps://learn.microsoft.com/previous-versions/office/sharepoint-server/ms431008(v=office.15)>) in my receiver,\r\nI got a version history where it showed the content was set, but the final version still ended up empty.\r\n\r\nWhen faced with utter desperation, working with SharePoint has taught me you always have an escape:\r\nlaunch [Reflector](https://www.red-gate.com/products/reflector/).\r\n\r\nThere I found this gem of code in the `SubmitBtn_Click` method of the `CreateWebPage Class`:\r\n\r\n```csharp\r\nSPFile file = SPUtility.CreateNewWikiPage(wikiList, serverRelativeUrl);\r\nSPListItem item = file.Item;\r\nitem[\"WikiField\"] = \"\";\r\nitem.UpdateOverwriteVersion();\r\n```\r\n\r\nSo, no matter what I do in `ItemAdding` or `ItemAdded`, the content always ends up empty!\r\n\r\nAfter this discovery, the fix was removing the code from the `ItemAdding` and `ItemAdded` events and moving it to the\r\n[`ItemUpdated` method](\u003Chttps://learn.microsoft.com/previous-versions/office/sharepoint-server/ms456015(v=office.15)>)\r\n(synchronous) and added a check if the WikiField content is an empty string.\r\n\r\n```csharp\r\npublic override void ItemUpdated(SPItemEventProperties properties)\r\n{\r\n    base.ItemUpdated(properties);\r\n\r\n    var listItem = properties.ListItem;\r\n\r\n    if (!string.IsNullOrEmpty(listItem[\"WikiField\"] as string))\r\n    {\r\n        return;\r\n    }\r\n\r\n    this.EventFiringEnabled = false;\r\n\r\n    listItem[\"WikiField\"] = html;\r\n    listItem.UpdateOverwriteVersion();\r\n\r\n    this.EventFiringEnabled = true;\r\n}\r\n```\r\n\r\nNow every wiki page I add to the team site contains the correct text layout and contains the default HTML.","src/posts/2012-06-07-provisioning-a-default-layout-and-content-when-adding-a-wiki-page.md","cef233753c5b337a",{"html":1111,"metadata":1112},"\u003Cp>Recently I was challenged with the task to set the layout and content of a wiki page when a new page is added to a team site.\r\nAs I am used to work with SharePoint publishing, the task sounded easy, but I was wrong.\u003C/p>\n\u003Ch2 id=\"text-layout\">Text Layout\u003C/h2>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2012/06/sharepoint-text-layout-ribbon.webp\" type=\"image/webp\" media=\"(max-width: 252px)\">\u003Csource srcset=\"/wp-content/uploads/2012/06/sharepoint-text-layout-ribbon-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2012/06/sharepoint-text-layout-ribbon-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2012/06/sharepoint-text-layout-ribbon.png\" alt=\"Image showing the Text Layout option in the SharePoint ribbon\" loading=\"lazy\" decoding=\"async\" width=\"252\" height=\"418\" srcset=\"/wp-content/uploads/2012/06/sharepoint-text-layout-ribbon.png 252w, /wp-content/uploads/2012/06/sharepoint-text-layout-ribbon-150x150.png 150w, /wp-content/uploads/2012/06/sharepoint-text-layout-ribbon-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>My first path was to figure out where SharePoint puts the wiki “text layouts”.\r\nI discovered this is not how it works. The layouts available for wiki’s are not configurable anywhere.\u003C/p>\n\u003Cp>But using some PowerShell it was easy to get and set the layout as it is the \u003Cdfn>\u003Cabbr title=\"HyperText Markup Language\">HTML\u003C/abbr>\u003C/dfn> content of the “Wiki Field” column in the list.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:41ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$web\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Get-SPWeb\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> http:\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">//\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">server\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">/\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">teamsite\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$list\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$web\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Lists\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Site Pages\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$listItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$list\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Items\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">2\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#76A162\"># My test page\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$listItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Wiki Content\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#76A162\"># Returns HTML\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"$web = Get-SPWeb http://server/teamsite$list = $web.Lists[&#x22;Site Pages&#x22;]$listItem = $list.Items[2] # My test page$listItem[&#x22;Wiki Content&#x22;] # Returns HTML\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>The \u003Cabbr title=\"HyperText Markup Language\">HTML\u003C/abbr> content consists of two parts.\r\nThe layout table and the layout data.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"html\" class=\"wrap\" style=\"--ecMaxLine:66ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">table\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">id\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"layoutsTable\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">style\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"width: 100%\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">tbody\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">tr\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">style\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"vertical-align: top\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">td\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">style\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"width: 100%\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">div\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">class\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"ms-rte-layoutszone-outer\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">style\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"width: 100%\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">div\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">class\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"ms-rte-layoutszone-inner\"\u003C/span>\u003Cspan style=\"--0:#959595\">>&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">div\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">div\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">td\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">tr\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">tbody\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">table\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">span\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">id\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"layoutsData\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">style\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"display: none\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">false,false,1\u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">span\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003Ctable id=&#x22;layoutsTable&#x22; style=&#x22;width: 100%&#x22;>  \u003Ctbody>    \u003Ctr style=&#x22;vertical-align: top&#x22;>      \u003Ctd style=&#x22;width: 100%&#x22;>        \u003Cdiv class=&#x22;ms-rte-layoutszone-outer&#x22; style=&#x22;width: 100%&#x22;>          \u003Cdiv class=&#x22;ms-rte-layoutszone-inner&#x22;>\u003C/div>        \u003C/div>      \u003C/td>    \u003C/tr>  \u003C/tbody>\u003C/table>\u003Cspan id=&#x22;layoutsData&#x22; style=&#x22;display: none&#x22;>false,false,1\u003C/span>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>The layout data describes visibility of the header and footer and the number of columns.\u003C/p>\n\u003Ch2 id=\"event-receiver\">Event receiver\u003C/h2>\n\u003Cp>To set the content the first thing in my mind was to add an\r\n\u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms414997(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ItemAdding\u003C/code> event receiver\u003Cspan>\u003C/span>\u003C/a>,\r\nassociated with \u003Ccode>ListTemplateId 119\u003C/code> (WebPageLibrary).\u003C/p>\n\u003Cp>I deployed the solution and added a page and \u003Cspan role=\"img\" aria-label=\"party popper\">🎉\u003C/span>: no content!\u003C/p>\n\u003Cp>Using the debugger to verify my event receiver was triggered, I went to the next option:\r\nadding an \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms461317(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ItemAdded\u003C/code> event receiver\u003Cspan>\u003C/span>\u003C/a>.\r\nThis time I got an exception the page was already modified by another user.\r\nRefreshing the page gave me the default content.\u003C/p>\n\u003Cp>So, this told me 2 things:\u003C/p>\n\u003Col>\n\u003Cli>It is possible to set default content\u003C/li>\n\u003Cli>I forgot to set the \u003Ccode>Synchronize\u003C/code> property\u003C/li>\n\u003C/ol>\n\u003Cp>So, after fixing the second thing, I deployed once again and got: no content!\u003C/p>\n\u003Cp>As I used \u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms431008(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ListItem.Update\u003C/code> method\u003Cspan>\u003C/span>\u003C/a> in my receiver,\r\nI got a version history where it showed the content was set, but the final version still ended up empty.\u003C/p>\n\u003Cp>When faced with utter desperation, working with SharePoint has taught me you always have an escape:\r\nlaunch \u003Ca href=\"https://www.red-gate.com/products/reflector/\" rel=\"noopener noreferrer external\" target=\"_blank\">Reflector\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>There I found this gem of code in the \u003Ccode>SubmitBtn_Click\u003C/code> method of the \u003Ccode>CreateWebPage Class\u003C/code>:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:71ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">SPFile\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">file\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SPUtility\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CreateNewWikiPage\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">wikiList\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">serverRelativeUrl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">SPListItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">item\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">file\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Item\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">item\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"WikiField\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">item\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">UpdateOverwriteVersion\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"SPFile file = SPUtility.CreateNewWikiPage(wikiList, serverRelativeUrl);SPListItem item = file.Item;item[&#x22;WikiField&#x22;] = &#x22;&#x22;;item.UpdateOverwriteVersion();\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>So, no matter what I do in \u003Ccode>ItemAdding\u003C/code> or \u003Ccode>ItemAdded\u003C/code>, the content always ends up empty!\u003C/p>\n\u003Cp>After this discovery, the fix was removing the code from the \u003Ccode>ItemAdding\u003C/code> and \u003Ccode>ItemAdded\u003C/code> events and moving it to the\r\n\u003Ca href=\"https://learn.microsoft.com/previous-versions/office/sharepoint-server/ms456015(v=office.15)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ItemUpdated\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>\r\n(synchronous) and added a check if the WikiField content is an empty string.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:66ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">override\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">void\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ItemUpdated\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">SPItemEventProperties\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">properties\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">base\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ItemUpdated\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">properties\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">listItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">properties\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ListItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsNullOrEmpty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">listItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"WikiField\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#569CD6\">as\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">))\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#C586C0\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EventFiringEnabled\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">false\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">listItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"WikiField\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">html\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">listItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">UpdateOverwriteVersion\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EventFiringEnabled\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">true\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"public override void ItemUpdated(SPItemEventProperties properties){    base.ItemUpdated(properties);    var listItem = properties.ListItem;    if (!string.IsNullOrEmpty(listItem[&#x22;WikiField&#x22;] as string))    {        return;    }    this.EventFiringEnabled = false;    listItem[&#x22;WikiField&#x22;] = html;    listItem.UpdateOverwriteVersion();    this.EventFiringEnabled = true;}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now every wiki page I add to the team site contains the correct text layout and contains the default \u003Cabbr title=\"HyperText Markup Language\">HTML\u003C/abbr>.\u003C/p>",{"headings":1113,"imagePaths":1120,"frontmatter":1095},[1114,1117],{"depth":780,"slug":1115,"text":1116},"text-layout","Text Layout",{"depth":780,"slug":1118,"text":1119},"event-receiver","Event receiver",[],"2013-01-21-filtering-on-a-tinyint-with-entity-framework",{"id":1121,"data":1123,"body":1136,"filePath":1137,"digest":1138,"rendered":1139},{"id":1124,"title":1125,"date":1126,"updated":1127,"author":15,"excerpt":1128,"layout":17,"permalink":1129,"image":1130,"categories":1131,"tags":1132,"draft":26},257,"Filtering on a tinyint with Entity Framework",["Date","2013-01-21T13:57:32.000Z"],["Date","2021-07-16T20:58:49.000Z"],"When writing .NET code to access a SQL database we often rely on the Entity Framework (EF). The EF makes it very easy to retrieve data from the database by generating a SQL Query for us. But we should not trust it blindly, as the EF can also generate a bad query.\nIt will return the correct data yes, but at what performance cost?\n","/2013/01/21/filtering-on-a-tinyint-with-entity-framework/","/wp-content/uploads/2013/01/post-257-thumbnail.png",[183,984],[1133,1134,320,1135],"CAST","Contains","tinyint","When writing .NET code to access a SQL database we often rely on the Entity Framework (EF).\r\nThe EF makes it very easy to retrieve data from the database by generating a SQL Query for us.\r\nBut we should not trust it blindly, as the EF can also generate a bad query.\r\n\r\nIt will return the correct data yes, but at what performance cost?\r\n\r\n\u003C!--more-->\r\n\r\nI have a table with lots of data, and to keep the table as small as possible on disk and in memory I want to optimize the columns.\r\nThis can be done by using _varchar_ instead of _nvarchar_, _date_ instead of _datetime_ and using _tinyint_ instead of _int_.\r\nOf course, you only can do this if your data allows this.\r\n\r\n## The problem\r\n\r\nChanging a column in my table from `int` to `tinyint` gave me a storage and memory space win, but it also gave me a performance loss!\r\n\r\nIn my case the SQL column `HasSong` is a [`tinyint`](https://learn.microsoft.com/sql/t-sql/data-types/int-bigint-smallint-and-tinyint-transact-sql).\r\nEF translates this to a [Byte structure](https://learn.microsoft.com/dotnet/api/system.byte) in the .NET model.\r\n\r\nThe following code:\r\n\r\n```csharp\r\nvar query = from d in dataEntities.Donations\r\n            where d.HasSong == 1\r\n            select d.DonationId;\r\n```\r\n\r\nproduces this SQL Query:\r\n\r\n```sql\r\nSELECT\r\n    [Extent1].[DonationId] AS [DonationId]\r\nFROM\r\n    [dbo].[Donations] AS [Extent1]\r\nWHERE\r\n    1 = CAST([Extent1].[HasSong] AS int)\r\n```\r\n\r\nWhen SQL encounters this [CAST](https://learn.microsoft.com/sql/t-sql/functions/cast-and-convert-transact-sql) it will skip all Indexes that are on the `HasSong` column resulting in the query engine using non-optimized indexes or even worse: full table scans.\r\n\r\nSo, this explains my performance loss, but how do we convince EF not to cast my `byte` to an `int`?\r\n\r\n## The familiar \"Contains\"\r\n\r\nBrowsing the internet gave me my first idea: using the familiar contains method I encountered on an earlier post about the EF: [Joining an IQueryable with an IEnumerable](/2010/08/26/joining-an-iqueryable-with-an-ienumerable).  \r\nI just have to add an [Array](https://learn.microsoft.com/dotnet/csharp/language-reference/builtin-types/arrays#single-dimensional-arrays) with a single value.\r\n\r\nSo, trying this:\r\n\r\n```csharp\r\nvar tinyintComparison = new byte[] { 1 };\r\n\r\nvar query = from d in dataEntities.Donations\r\n            where tinyintComparison.Contains(d.HasSong)\r\n            selectd.DonationId;\r\n```\r\n\r\nwas not such a good idea as it throws an [`ArgumentException`](https://learn.microsoft.com/dotnet/api/system.argumentexception):\r\n\r\n![Screenshot showing Visual Studio debugger with the message \"ArgumentException: DbExpressionBinding requires an input expression with a collection ResultType\"](/wp-content/uploads/2013/01/argument-exception-dbexpressionbinding.png)\r\n\r\nIt did work for [other people using a SMALLINT](https://stackoverflow.com/questions/9016265/generated-query-for-tinyint-column-introduces-a-cast-to-int/9667696#9667696),\r\nso I guess an array of bytes is a special case reserved for working with binary data in your database.\r\n\r\n## The solution\r\n\r\nLucky enough we are close to a solution, changing the array to a [`List\u003CT>` class](https://learn.microsoft.com/dotnet/api/system.collections.generic.list-1):\r\n\r\n```csharp\r\nvar tinyintComparison = new List\u003Cbyte> { 1 };\r\n\r\nvar query = from d in dataEntities.Donations\r\n            where tinyintComparison.Contains(d.HasSong)\r\n            select d.DonationId;\r\n```\r\n\r\nresults in the following query:\r\n\r\n```sql\r\nSELECT\r\n    [Extent1].[DonationId] AS [DonationId]\r\nFROM\r\n    [dbo].[Donations] AS [Extent1]\r\nWHERE\r\n    1 = [Extent1].[HasSong]\r\n```\r\n\r\nThere we are! No more casting.\r\nThe SQL query engine can use the correct indexes again and we still won disk and memory space.\r\n\r\n## Conclusion\r\n\r\nIf you don't want a CAST in your SQL query when using a `tinyint`, use the\r\n[`ICollection\u003CT>.Contains` method](https://learn.microsoft.com/dotnet/api/system.collections.generic.icollection-1.contains).","src/posts/2013-01-21-filtering-on-a-tinyint-with-entity-framework.md","d4ddbf44b2f195de",{"html":1140,"metadata":1141},"\u003Cp>When writing .NET code to access a \u003Cdfn>\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr>\u003C/dfn> database we often rely on the Entity Framework (EF).\r\nThe EF makes it very easy to retrieve data from the database by generating a \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Query for us.\r\nBut we should not trust it blindly, as the EF can also generate a bad query.\u003C/p>\n\u003Cp>It will return the correct data yes, but at what performance cost?\u003C/p>\n\u003C!--more-->\n\u003Cp>I have a table with lots of data, and to keep the table as small as possible on disk and in memory I want to optimize the columns.\r\nThis can be done by using \u003Cem>varchar\u003C/em> instead of \u003Cem>nvarchar\u003C/em>, \u003Cem>date\u003C/em> instead of \u003Cem>datetime\u003C/em> and using \u003Cem>tinyint\u003C/em> instead of \u003Cem>int\u003C/em>.\r\nOf course, you only can do this if your data allows this.\u003C/p>\n\u003Ch2 id=\"the-problem\">The problem\u003C/h2>\n\u003Cp>Changing a column in my table from \u003Ccode>int\u003C/code> to \u003Ccode>tinyint\u003C/code> gave me a storage and memory space win, but it also gave me a performance loss!\u003C/p>\n\u003Cp>In my case the \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> column \u003Ccode>HasSong\u003C/code> is a \u003Ca href=\"https://learn.microsoft.com/sql/t-sql/data-types/int-bigint-smallint-and-tinyint-transact-sql?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>tinyint\u003C/code>\u003Cspan>\u003C/span>\u003C/a>.\r\nEF translates this to a \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.byte?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Byte structure\u003Cspan>\u003C/span>\u003C/a> in the .NET model.\u003C/p>\n\u003Cp>The following code:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:44ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">query\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">from\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">d\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">in\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">dataEntities\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Donations\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">where\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">d\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">HasSong\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">==\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">select\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">d\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DonationId\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var query = from d in dataEntities.Donations            where d.HasSong == 1            select d.DonationId;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>produces this \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Query:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"sql\" class=\"wrap\" style=\"--ecMaxLine:42ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[Extent1].[DonationId] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [DonationId]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">FROM\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[dbo].[Donations] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent1]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">WHERE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CAST\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">([Extent1].[HasSong] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">int\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"SELECT    [Extent1].[DonationId] AS [DonationId]FROM    [dbo].[Donations] AS [Extent1]WHERE    1 = CAST([Extent1].[HasSong] AS int)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>When \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> encounters this \u003Ca href=\"https://learn.microsoft.com/sql/t-sql/functions/cast-and-convert-transact-sql?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">CAST\u003Cspan>\u003C/span>\u003C/a> it will skip all Indexes that are on the \u003Ccode>HasSong\u003C/code> column resulting in the query engine using non-optimized indexes or even worse: full table scans.\u003C/p>\n\u003Cp>So, this explains my performance loss, but how do we convince EF not to cast my \u003Ccode>byte\u003C/code> to an \u003Ccode>int\u003C/code>?\u003C/p>\n\u003Ch2 id=\"the-familiar-contains\">The familiar “Contains”\u003C/h2>\n\u003Cp>Browsing the internet gave me my first idea: using the familiar contains method I encountered on an earlier post about the EF: \u003Ca href=\"/2010/08/26/joining-an-iqueryable-with-an-ienumerable\">Joining an IQueryable with an IEnumerable\u003C/a>.\u003Cbr>\nI just have to add an \u003Ca href=\"https://learn.microsoft.com/dotnet/csharp/language-reference/builtin-types/arrays?wt.mc_id=AZ-MVP-5004268#single-dimensional-arrays\" rel=\"noopener noreferrer external\" target=\"_blank\">Array\u003Cspan>\u003C/span>\u003C/a> with a single value.\u003C/p>\n\u003Cp>So, trying this:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:55ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">tinyintComparison\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">byte\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[] { \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> };\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">query\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">from\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">d\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">in\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">dataEntities\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Donations\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">where\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">tinyintComparison\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Contains\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">d\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">HasSong\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">selectd\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DonationId\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var tinyintComparison = new byte[] { 1 };var query = from d in dataEntities.Donations            where tinyintComparison.Contains(d.HasSong)            selectd.DonationId;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>was not such a good idea as it throws an \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.argumentexception?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ArgumentException\u003C/code>\u003Cspan>\u003C/span>\u003C/a>:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2013/01/argument-exception-dbexpressionbinding.webp\" type=\"image/webp\" media=\"(max-width: 449px)\">\u003Csource srcset=\"/wp-content/uploads/2013/01/argument-exception-dbexpressionbinding-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2013/01/argument-exception-dbexpressionbinding-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2013/01/argument-exception-dbexpressionbinding.png\" alt=\"Screenshot showing Visual Studio debugger with the message &#x22;ArgumentException: DbExpressionBinding requires an input expression with a collection ResultType&#x22;\" loading=\"lazy\" decoding=\"async\" width=\"449\" height=\"321\" srcset=\"/wp-content/uploads/2013/01/argument-exception-dbexpressionbinding.png 449w, /wp-content/uploads/2013/01/argument-exception-dbexpressionbinding-150x150.png 150w, /wp-content/uploads/2013/01/argument-exception-dbexpressionbinding-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>It did work for \u003Ca href=\"https://stackoverflow.com/questions/9016265/generated-query-for-tinyint-column-introduces-a-cast-to-int/9667696#9667696\" rel=\"noopener noreferrer external\" target=\"_blank\">other people using a SMALLINT\u003Cspan>\u003C/span>\u003C/a>,\r\nso I guess an array of bytes is a special case reserved for working with binary data in your database.\u003C/p>\n\u003Ch2 id=\"the-solution\">The solution\u003C/h2>\n\u003Cp>Lucky enough we are close to a solution, changing the array to a \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.collections.generic.list-1?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>List&#x3C;T>\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:55ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">tinyintComparison\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">List\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">byte\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">> { \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> };\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">query\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">from\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">d\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">in\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">dataEntities\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Donations\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">where\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">tinyintComparison\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Contains\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">d\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">HasSong\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">select\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">d\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DonationId\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var tinyintComparison = new List\u003Cbyte> { 1 };var query = from d in dataEntities.Donations            where tinyintComparison.Contains(d.HasSong)            select d.DonationId;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>results in the following query:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"sql\" class=\"wrap\" style=\"--ecMaxLine:42ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[Extent1].[DonationId] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [DonationId]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">FROM\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[dbo].[Donations] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent1]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">WHERE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent1].[HasSong]\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"SELECT    [Extent1].[DonationId] AS [DonationId]FROM    [dbo].[Donations] AS [Extent1]WHERE    1 = [Extent1].[HasSong]\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>There we are! No more casting.\r\nThe \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> query engine can use the correct indexes again and we still won disk and memory space.\u003C/p>\n\u003Ch2 id=\"conclusion\">Conclusion\u003C/h2>\n\u003Cp>If you don’t want a CAST in your \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> query when using a \u003Ccode>tinyint\u003C/code>, use the\r\n\u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.collections.generic.icollection-1.contains?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ICollection&#x3C;T>.Contains\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>",{"headings":1142,"imagePaths":1151,"frontmatter":1123},[1143,1144,1147,1148],{"depth":780,"slug":255,"text":256},{"depth":780,"slug":1145,"text":1146},"the-familiar-contains","The familiar “Contains”",{"depth":780,"slug":258,"text":259},{"depth":780,"slug":1149,"text":1150},"conclusion","Conclusion",[],"2015-02-04-make-pull-down-to-refresh-work-with-a-windows-phone-virtualizing-list-control",{"id":1152,"data":1154,"body":1164,"filePath":1165,"digest":1166,"rendered":1167},{"id":1155,"title":1156,"date":1157,"updated":1158,"author":15,"excerpt":1159,"layout":17,"permalink":1160,"image":1161,"categories":1162,"tags":1163,"draft":26},392,"Make pull-down-to-refresh work with a Windows Phone virtualizing list control",["Date","2015-02-04T18:30:31.000Z"],["Date","2021-07-16T20:55:09.000Z"],"The other day I was working on a Windows Phone app. I wanted to add a \"pull down to refresh\" panel to a large list of images. Just like the Facebook and Twitter apps have.\nAs Microsoft does not provide this functionality in their default controls I started searching the web if somebody else has build something like this already.\nI found a blog post by Jason Ginchereau where he provided this functionality for Windows Phone 7.\nIn my app I use an ItemsControl with a VirtualizingStackPanel to prevent memory issues. After I added the PullDownToRefreshPanel control to my list and started testing it on my phone, I ran into some issues.\nIn this blog post I will describe my contributions to fix these 2 issues and I will supply the source code for you to use.\n","/2015/02/04/make-pull-down-to-refresh-work-with-a-windows-phone-virtualizing-list-control/","/wp-content/uploads/2015/02/post-2015-02-04-thumnail-1.png",[183,1041],[1043,137,1044,1045,1046,1047],"The other day I was working on a Windows Phone app.\r\nI wanted to add a \"pull down to refresh\" panel to a large list of images.\r\nJust like the Facebook and Twitter apps have.\r\n\r\n![Pull-to-refresh in the Twitter app animation. Showing a text to encourage the user pull down further to refresh the list. When pulled down far enough the text changes to let the user know the list will be refreshed after the user releases his finger from the screen.](/wp-content/uploads/2015/01/twitter1.gif \"Pull-to-refresh in the Twitter app. Image by David Washington\")\r\n\r\nAs Microsoft does not provide this functionality in their default controls,\r\nI started searching the web if somebody else has built something like this already.\r\n\r\nI found a blog post by Jason Ginchereau where he provided this functionality for Windows Phone 7.\r\n\r\nIn my app I use an [`ItemsControl` control](https://learn.microsoft.com/dotnet/api/system.windows.controls.itemscontrol?view=netframework-4.7) with a [`VirtualizingStackPanel` control](https://learn.microsoft.com/dotnet/api/system.windows.controls.virtualizingstackpanel?view=netframework-4.7) to prevent memory issues.\r\nAfter I added the PullDownToRefreshPanel control to my list and started testing it on my phone,\r\nI ran into some issues.\r\n\r\n\u003C!--more-->\r\n\r\n## The issues\r\n\r\nAdding the control to my page was easy. But I noticed two things.\r\n\r\n1. Performance, it is taking up a lot of processing power, resulting in visual lag.\r\n   Especially when using a low powered phone.\r\n2. Scrolling, when scrolling through the list with a quick flicking motion the same images kept scrolling by,\r\n   making the list scroll endlessly until I stopped flicking.\r\n\r\nIn this blog post I will describe my contributions to fix these 2 issues and I will [supply the source code](#source-code) for you to use.\r\n\r\n## 1. Improving performance\r\n\r\nLooking at the code, the first thing I noticed was that the control subscribes to the LayoutUpdated event.\r\nThe code in the event handler tries to find the [`ScrollViewer` control](https://learn.microsoft.com/dotnet/api/system.windows.controls.scrollviewer?view=netframework-4.7) control to attach to.\r\nAfter the ScrollViewer is successfully found, the event is never unsubscribed and keeps firing quite often.\r\nWhen you add a debug message to the method, you will see the event fires constantly during the actual scrolling, but also fires when the control is not even on the screen.\r\nSo, the first fix was to unregister the event if the ScrollViewer is found. There is no need to fire unnecessary code.\r\n\r\n```csharp {10} title=\"PullDownToRefreshPanel.cs\"\r\nprivate void PullDownToRefreshPanel_LayoutUpdated(object sender, EventArgs e)\r\n{\r\n  if (this.targetScrollViewer == null)\r\n  {\r\n    this.targetScrollViewer =\r\n        FindVisualElement\u003CScrollViewer>(VisualTreeHelper.GetParent(this));\r\n\r\n    if (this.targetScrollViewer != null)\r\n    {\r\n      this.LayoutUpdated -= PullDownToRefreshPanel_LayoutUpdated;\r\n      // *snip*\r\n    }\r\n  }\r\n}\r\n```\r\n\r\nThe second thing I observed were the NegativeValueConverters.\r\nThe [`ValueConvertor`](https://learn.microsoft.com/dotnet/api/system.windows.data.ivalueconverter?view=netframework-4.7) adds negative space at the bottom to keep the ScrollViewer positioned on the same location if the PullDownToRefreshPanel was growing in height.\r\n\r\nInside the convertor there is an unnecessary [`Convert.ToDouble` method](https://learn.microsoft.com/dotnet/api/system.convert.todouble?view=netframework-4.7#System_Convert_ToDouble_System_Object_).\r\nWhen resizing the control this conversion was called a lot of times.\r\n\r\nSo, this could be written a bit simpler as the value is already of the type Double.\r\n\r\n```diff title=\"NegativeValueConverter.cs\" \r\n-double doubleValue = -System.Convert.ToDouble(value);\r\n+double doubleValue = -(double)value; // No System.Convert needed\r\n```\r\n\r\nWhen looking at the original example project by Jason,\r\nthe negative space was needed because the control and the list are in separate rows in a grid.\r\nBy changing the XAML to put both controls in the same grid cell there is no need for this negative space because the controls are now floating on top of each other.\r\nEliminating the ValueConvertors all together made the process much lighter.\r\n\r\nMy XAML looks a bit like this:\r\n\r\n```xml title=\"MainPage.xaml\"\r\n\u003CGrid>\r\n  \u003Crlb:PullDownToRefreshPanel x:Name=\"refreshPanel\"\r\n                              RefreshRequested=\"refreshPanel_RefreshRequested\"\r\n                              VerticalAlignment=\"Top\" />\r\n  \u003CItemsControl x:Name=\"listBox\" ItemsSource=\"{Binding}\">\r\n      \u003CItemsControl.ItemsPanel>\r\n        \u003CItemsPanelTemplate>\r\n          \u003CVirtualizingStackPanel Orientation=\"Vertical\" />\r\n        \u003C/ItemsPanelTemplate>\r\n      \u003C/ItemsControl.ItemsPanel>\r\n      \u003CItemsControl.Template>\r\n        \u003CControlTemplate TargetType=\"ItemsControl\">\r\n          \u003CScrollViewer ManipulationMode=\"Control\">\r\n            \u003CItemsPresenter/>\r\n          \u003C/ScrollViewer>\r\n        \u003C/ControlTemplate>\r\n    \u003C/ItemsControl.Template>\r\n  \u003C/ItemsControl>\r\n\u003C/Grid>\r\n```\r\n\r\n## 2. Fixing the scrolling\r\n\r\nTo make the pull-to-refresh list work, it is mandatory to [change](https://learn.microsoft.com/dotnet/api/system.windows.input.manipulation.setmanipulationmode?view=netframework-4.7) the [`ManipulationMode`](\u003Chttps://learn.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/gg986872(v=vs.95)>) property of the ScrollViewer to `Control`.\r\nThis allows you to catch the [`MouseMove` event](https://learn.microsoft.com/dotnet/api/system.windows.uielement.mousemove?view=netframework-4.7) and the [`MouseLeftButtonUp` event](https://learn.microsoft.com/dotnet/api/system.windows.uielement.mouseleftbuttonup?view=netframework-4.7).\r\nWith these events you can detect the change of the position of the content inside the ScrollViewer by monitoring the [`TranslateY` property](\u003Chttps://learn.microsoft.com/previous-versions/windows/apps/ee653034(v=vs.105)>) which changes when the compression happens.\r\n\r\nBecause I noticed the same images kept scrolling by, I was suspecting the VirtualizingStackPanel was not receiving the correct signals and was recycling the same placeholders (and images) over and over without getting fresh data as it should.\r\n\r\nSearching the web again I came across [a blog post by Matthijs Krempel](https://thewp7dev.wordpress.com/2012/04/20/pulltorefreshpanel/) describing that the Mango update added some new candy that would allow you to detect the compression using [VisualStates](https://learn.microsoft.com/dotnet/api/system.windows.visualstate?view=netframework-4.7) and therefore you can leave the ManipulationMode on `System`.\r\nResulting in a better performance and in a correctly functioning VirtualizingStackPanel.\r\nThis does not work out-of-the-box, you need to add a specific template to the ScrollViewer.\r\n\r\nMatthijs added this to [his own \"PullToRefreshPanel\" control](https://web.archive.org/web/20200816071155/https://krempelwp7.codeplex.com/).\r\n\r\nHowever, the VisualStates let you only know if compression has started or ended. It doesn’t let you know how much compression is applied. Without the mouse events I needed another way to detect the amount of compression. Which led me to build my own version of the control.\r\n\r\n## Building a new Pull-Down-To-Refresh Panel\r\n\r\nWindows Phone provides the [`Touch` class](https://learn.microsoft.com/dotnet/api/system.windows.input.touch?view=netframework-4.7) which is an application-level service that processes touch input from the operating system and raises the [`FrameReported` event](https://learn.microsoft.com/dotnet/api/system.windows.input.touch.framereported?view=netframework-4.7) event.\r\nInside this event you can read what kind of interaction is happening between the fingers and the screen.\r\n\r\n```csharp title=\"PullDownToRefreshPanel.cs\"\r\nprivate void TouchFrameReported(object sender, TouchFrameEventArgs e)\r\n{\r\n    var primaryTouchPoint = e.GetPrimaryTouchPoint(this);\r\n\r\n    switch (primaryTouchPoint.Action)\r\n    {\r\n        case TouchAction.Down:\r\n            this.initialPoint = primaryTouchPoint.Position;\r\n\r\n            if (this.isCompressed)\r\n            {\r\n                this.StartMeasuring();\r\n            }\r\n\r\n            break;\r\n\r\n        case TouchAction.Move:\r\n            if (this.isMeasuring)\r\n            {\r\n                // Only update if the finger moves up/down the screen\r\n                if (this.currentPosition.Y != primaryTouchPoint.Position.Y)\r\n                {\r\n                    this.currentPosition = primaryTouchPoint.Position;\r\n                    this.UpdateControl();\r\n                }\r\n            }\r\n            else\r\n            {\r\n                this.initialPoint = primaryTouchPoint.Position;\r\n            }\r\n\r\n            break;\r\n\r\n        case TouchAction.Up:\r\n            this.StopMeasuring();\r\n\r\n            break;\r\n    }\r\n}\r\n```\r\n\r\nSo, I combined the control Jason originally wrote with the extensions Matthijs made to detect compression.\r\nThen I replaced the mouse events with touch actions.\r\nResulting in a faster control that also works with virtualized controls like an `ItemsControl` with a `VirtualizingStackPanel` or the `ListBox`.\r\n\r\nI will have to note that the `PullDownToRefreshPanel` control will not work with the `LongListSelector` as that control does not expose a `ScrollViewer`.\r\n\r\n## Source code\r\n\r\nYou can download my [Windows Phone 8 example project](https://github.com/eNeRGy164/PullDownToRefreshPanelDemo) on GitHub.","src/posts/2015-02-04-make-pull-down-to-refresh-work-with-a-windows-phone-virtualizing-list-control.md","2651788bb433d0bd",{"html":1168,"metadata":1169},"\u003Cp>The other day I was working on a Windows Phone app.\r\nI wanted to add a “pull down to refresh” panel to a large list of images.\r\nJust like the Facebook and Twitter apps have.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2015/01/twitter1.webp\" type=\"image/webp\" media=\"(max-width: 367px)\">\u003Csource srcset=\"/wp-content/uploads/2015/01/twitter1-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2015/01/twitter1-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2015/01/twitter1.gif\" alt=\"Pull-to-refresh in the Twitter app animation. Showing a text to encourage the user pull down further to refresh the list. When pulled down far enough the text changes to let the user know the list will be refreshed after the user releases his finger from the screen.\" loading=\"lazy\" decoding=\"async\" width=\"367\" height=\"376\" srcset=\"/wp-content/uploads/2015/01/twitter1.gif 367w, /wp-content/uploads/2015/01/twitter1-150x150.gif 150w, /wp-content/uploads/2015/01/twitter1-185x185.gif 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Pull-to-refresh in the Twitter app. Image by David Washington\u003C/figcaption>\u003C/figure>\n\u003Cp>As Microsoft does not provide this functionality in their default controls,\r\nI started searching the web if somebody else has built something like this already.\u003C/p>\n\u003Cp>I found a blog post by Jason Ginchereau where he provided this functionality for Windows Phone 7.\u003C/p>\n\u003Cp>In my app I use an \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.windows.controls.itemscontrol?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ItemsControl\u003C/code> control\u003Cspan>\u003C/span>\u003C/a> with a \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.windows.controls.virtualizingstackpanel?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>VirtualizingStackPanel\u003C/code> control\u003Cspan>\u003C/span>\u003C/a> to prevent memory issues.\r\nAfter I added the PullDownToRefreshPanel control to my list and started testing it on my phone,\r\nI ran into some issues.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"the-issues\">The issues\u003C/h2>\n\u003Cp>Adding the control to my page was easy. But I noticed two things.\u003C/p>\n\u003Col>\n\u003Cli>Performance, it is taking up a lot of processing power, resulting in visual lag.\r\nEspecially when using a low powered phone.\u003C/li>\n\u003Cli>Scrolling, when scrolling through the list with a quick flicking motion the same images kept scrolling by,\r\nmaking the list scroll endlessly until I stopped flicking.\u003C/li>\n\u003C/ol>\n\u003Cp>In this blog post I will describe my contributions to fix these 2 issues and I will \u003Ca href=\"#source-code\">supply the source code\u003C/a> for you to use.\u003C/p>\n\u003Ch2 id=\"1-improving-performance\">1. Improving performance\u003C/h2>\n\u003Cp>Looking at the code, the first thing I noticed was that the control subscribes to the LayoutUpdated event.\r\nThe code in the event handler tries to find the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.windows.controls.scrollviewer?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ScrollViewer\u003C/code> control\u003Cspan>\u003C/span>\u003C/a> control to attach to.\r\nAfter the ScrollViewer is successfully found, the event is never unsubscribed and keeps firing quite often.\r\nWhen you add a debug message to the method, you will see the event fires constantly during the actual scrolling, but also fires when the control is not even on the screen.\r\nSo, the first fix was to unregister the event if the ScrollViewer is found. There is no need to fire unnecessary code.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PullDownToRefreshPanel.cs\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:77ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">private\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">void\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">PullDownToRefreshPanel_LayoutUpdated\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">sender\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">EventArgs\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">e\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">targetScrollViewer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">==\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">targetScrollViewer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">FindVisualElement\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ScrollViewer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">>(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">VisualTreeHelper\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetParent\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">targetScrollViewer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#7eb3e0\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LayoutUpdated\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">PullDownToRefreshPanel_LayoutUpdated\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#76A162\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#76A162\">// *snip*\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"private void PullDownToRefreshPanel_LayoutUpdated(object sender, EventArgs e){  if (this.targetScrollViewer == null)  {    this.targetScrollViewer =        FindVisualElement\u003CScrollViewer>(VisualTreeHelper.GetParent(this));    if (this.targetScrollViewer != null)    {      this.LayoutUpdated -= PullDownToRefreshPanel_LayoutUpdated;      // *snip*    }  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>The second thing I observed were the NegativeValueConverters.\r\nThe \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.windows.data.ivalueconverter?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ValueConvertor\u003C/code>\u003Cspan>\u003C/span>\u003C/a> adds negative space at the bottom to keep the ScrollViewer positioned on the same location if the PullDownToRefreshPanel was growing in height.\u003C/p>\n\u003Cp>Inside the convertor there is an unnecessary \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.convert.todouble?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268#System_Convert_ToDouble_System_Object_\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Convert.ToDouble\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>.\r\nWhen resizing the control this conversion was called a lot of times.\u003C/p>\n\u003Cp>So, this could be written a bit simpler as the value is already of the type Double.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">NegativeValueConverter.cs\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"diff\" class=\"wrap\" style=\"--ecMaxLine:64ch\">\u003Ccode>\u003Cdiv class=\"ec-line highlight del\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">double doubleValue = -System.Convert.ToDouble(value);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight ins\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">double doubleValue = -(double)value; // No System.Convert needed\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"double doubleValue = -System.Convert.ToDouble(value);double doubleValue = -(double)value; // No System.Convert needed\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>When looking at the original example project by Jason,\r\nthe negative space was needed because the control and the list are in separate rows in a grid.\r\nBy changing the XAML to put both controls in the same grid cell there is no need for this negative space because the controls are now floating on top of each other.\r\nEliminating the ValueConvertors all together made the process much lighter.\u003C/p>\n\u003Cp>My XAML looks a bit like this:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">MainPage.xaml\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:78ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Grid\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">rlb:PullDownToRefreshPanel\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"refreshPanel\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:30ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                              \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">RefreshRequested\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"refreshPanel_RefreshRequested\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:30ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                              \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">VerticalAlignment\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Top\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ItemsControl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"listBox\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ItemsSource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"{Binding}\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ItemsControl.ItemsPanel\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ItemsPanelTemplate\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VirtualizingStackPanel\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Orientation\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Vertical\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">ItemsPanelTemplate\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">ItemsControl.ItemsPanel\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ItemsControl.Template\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ControlTemplate\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">TargetType\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"ItemsControl\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ScrollViewer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ManipulationMode\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Control\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ItemsPresenter\u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">ScrollViewer\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">ControlTemplate\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">ItemsControl.Template\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">ItemsControl\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">Grid\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003CGrid>  \u003Crlb:PullDownToRefreshPanel x:Name=&#x22;refreshPanel&#x22;                              RefreshRequested=&#x22;refreshPanel_RefreshRequested&#x22;                              VerticalAlignment=&#x22;Top&#x22; />  \u003CItemsControl x:Name=&#x22;listBox&#x22; ItemsSource=&#x22;{Binding}&#x22;>      \u003CItemsControl.ItemsPanel>        \u003CItemsPanelTemplate>          \u003CVirtualizingStackPanel Orientation=&#x22;Vertical&#x22; />        \u003C/ItemsPanelTemplate>      \u003C/ItemsControl.ItemsPanel>      \u003CItemsControl.Template>        \u003CControlTemplate TargetType=&#x22;ItemsControl&#x22;>          \u003CScrollViewer ManipulationMode=&#x22;Control&#x22;>            \u003CItemsPresenter/>          \u003C/ScrollViewer>        \u003C/ControlTemplate>    \u003C/ItemsControl.Template>  \u003C/ItemsControl>\u003C/Grid>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"2-fixing-the-scrolling\">2. Fixing the scrolling\u003C/h2>\n\u003Cp>To make the pull-to-refresh list work, it is mandatory to \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.windows.input.manipulation.setmanipulationmode?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">change\u003Cspan>\u003C/span>\u003C/a> the \u003Ca href=\"https://learn.microsoft.com/previous-versions/windows/silverlight/dotnet-windows-silverlight/gg986872(v=vs.95)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ManipulationMode\u003C/code>\u003Cspan>\u003C/span>\u003C/a> property of the ScrollViewer to \u003Ccode>Control\u003C/code>.\r\nThis allows you to catch the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.windows.uielement.mousemove?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>MouseMove\u003C/code> event\u003Cspan>\u003C/span>\u003C/a> and the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.windows.uielement.mouseleftbuttonup?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>MouseLeftButtonUp\u003C/code> event\u003Cspan>\u003C/span>\u003C/a>.\r\nWith these events you can detect the change of the position of the content inside the ScrollViewer by monitoring the \u003Ca href=\"https://learn.microsoft.com/previous-versions/windows/apps/ee653034(v=vs.105)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>TranslateY\u003C/code> property\u003Cspan>\u003C/span>\u003C/a> which changes when the compression happens.\u003C/p>\n\u003Cp>Because I noticed the same images kept scrolling by, I was suspecting the VirtualizingStackPanel was not receiving the correct signals and was recycling the same placeholders (and images) over and over without getting fresh data as it should.\u003C/p>\n\u003Cp>Searching the web again I came across \u003Ca href=\"https://thewp7dev.wordpress.com/2012/04/20/pulltorefreshpanel/\" rel=\"noopener noreferrer external\" target=\"_blank\">a blog post by Matthijs Krempel\u003Cspan>\u003C/span>\u003C/a> describing that the Mango update added some new candy that would allow you to detect the compression using \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.windows.visualstate?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">VisualStates\u003Cspan>\u003C/span>\u003C/a> and therefore you can leave the ManipulationMode on \u003Ccode>System\u003C/code>.\r\nResulting in a better performance and in a correctly functioning VirtualizingStackPanel.\r\nThis does not work out-of-the-box, you need to add a specific template to the ScrollViewer.\u003C/p>\n\u003Cp>Matthijs added this to \u003Ca href=\"https://web.archive.org/web/20200816071155/https://krempelwp7.codeplex.com/\" rel=\"noopener noreferrer external\" target=\"_blank\">his own “PullToRefreshPanel” control\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>However, the VisualStates let you only know if compression has started or ended. It doesn’t let you know how much compression is applied. Without the mouse events I needed another way to detect the amount of compression. Which led me to build my own version of the control.\u003C/p>\n\u003Ch2 id=\"building-a-new-pull-down-to-refresh-panel\">Building a new Pull-Down-To-Refresh Panel\u003C/h2>\n\u003Cp>Windows Phone provides the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.windows.input.touch?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Touch\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> which is an application-level service that processes touch input from the operating system and raises the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.windows.input.touch.framereported?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>FrameReported\u003C/code> event\u003Cspan>\u003C/span>\u003C/a> event.\r\nInside this event you can read what kind of interaction is happening between the fingers and the screen.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PullDownToRefreshPanel.cs\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:75ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">private\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">void\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">TouchFrameReported\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">sender\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">TouchFrameEventArgs\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">e\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">primaryTouchPoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">e\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetPrimaryTouchPoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#C586C0\">switch\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">primaryTouchPoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Action\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#C586C0\">case\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">TouchAction\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Down\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">initialPoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">primaryTouchPoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Position\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">isCompressed\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">            \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">StartMeasuring\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">            \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#C586C0\">break\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#C586C0\">case\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">TouchAction\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Move\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">isMeasuring\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">            \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#76A162\">                \u003C/span>\u003C/span>\u003Cspan style=\"--0:#76A162\">// Only update if the finger moves up/down the screen\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">currentPosition\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Y\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">primaryTouchPoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Position\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Y\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">                \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:20ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                    \u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">currentPosition\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">primaryTouchPoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Position\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:20ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                    \u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">UpdateControl\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">                \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">            \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#C586C0\">else\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">            \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">initialPoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">primaryTouchPoint\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Position\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">            \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#C586C0\">break\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#C586C0\">case\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">TouchAction\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Up\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">StopMeasuring\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#C586C0\">break\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"private void TouchFrameReported(object sender, TouchFrameEventArgs e){    var primaryTouchPoint = e.GetPrimaryTouchPoint(this);    switch (primaryTouchPoint.Action)    {        case TouchAction.Down:            this.initialPoint = primaryTouchPoint.Position;            if (this.isCompressed)            {                this.StartMeasuring();            }            break;        case TouchAction.Move:            if (this.isMeasuring)            {                // Only update if the finger moves up/down the screen                if (this.currentPosition.Y != primaryTouchPoint.Position.Y)                {                    this.currentPosition = primaryTouchPoint.Position;                    this.UpdateControl();                }            }            else            {                this.initialPoint = primaryTouchPoint.Position;            }            break;        case TouchAction.Up:            this.StopMeasuring();            break;    }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>So, I combined the control Jason originally wrote with the extensions Matthijs made to detect compression.\r\nThen I replaced the mouse events with touch actions.\r\nResulting in a faster control that also works with virtualized controls like an \u003Ccode>ItemsControl\u003C/code> with a \u003Ccode>VirtualizingStackPanel\u003C/code> or the \u003Ccode>ListBox\u003C/code>.\u003C/p>\n\u003Cp>I will have to note that the \u003Ccode>PullDownToRefreshPanel\u003C/code> control will not work with the \u003Ccode>LongListSelector\u003C/code> as that control does not expose a \u003Ccode>ScrollViewer\u003C/code>.\u003C/p>\n\u003Ch2 id=\"source-code\">Source code\u003C/h2>\n\u003Cp>You can download my \u003Ca href=\"https://github.com/eNeRGy164/PullDownToRefreshPanelDemo\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows Phone 8 example project\u003Cspan>\u003C/span>\u003C/a> on GitHub.\u003C/p>",{"headings":1170,"imagePaths":1184,"frontmatter":1154},[1171,1174,1177,1180,1183],{"depth":780,"slug":1172,"text":1173},"the-issues","The issues",{"depth":780,"slug":1175,"text":1176},"1-improving-performance","1. Improving performance",{"depth":780,"slug":1178,"text":1179},"2-fixing-the-scrolling","2. Fixing the scrolling",{"depth":780,"slug":1181,"text":1182},"building-a-new-pull-down-to-refresh-panel","Building a new Pull-Down-To-Refresh Panel",{"depth":780,"slug":1056,"text":1057},[],"2012-05-18-migrating-a-catch-all-maildir-to-office-365",{"id":1185,"data":1187,"body":1201,"filePath":1202,"digest":1203,"rendered":1204},{"id":1188,"title":1189,"date":1190,"updated":1191,"author":15,"excerpt":1192,"layout":17,"permalink":1193,"image":1194,"categories":1195,"tags":1197,"draft":26},246,"Migrating a catch-all maildir to Office 365",["Date","2012-05-18T15:49:12.000Z"],["Date","2021-07-16T20:59:42.000Z"],"I've been running my own mail server at home for years. But it requires a reliable connection and some maintenance once in a while. And of course it always breaks when I'm on the other side of the world.\nTo free myself of that burden I decided to make the move to Office 365. However I discovered there is no way to set my account as a catch-all account. This is not possible at all!\nSo I made my own scripts to add all email addresses I used in the past as an alias on my mailbox.\n","/2012/05/18/migrating-a-catch-all-maildir-to-office-365/","/wp-content/uploads/2012/05/post-246-thumnail-1.png",[106,1196],"PowerShell",[1198,1199,1200],"Catch-All","Maildir","Office 365","I have been running my own mail server at home for years using [Postfix](https://www.postfix.org/), [dovecot](https://www.dovecot.org/), [amavisd-new](https://amavis.org/), [ClamAV](https://www.clamav.net/) and [SpamAssassin](https://spamassassin.apache.org/).\r\nBut it requires a reliable connection and some maintenance occasionally.\r\nAnd of course, it always breaks when I am on the other side of the world.\r\n\r\nTo free myself of that burden, I decided to make the move to [Office 365](https://www.microsoft.com/microsoft-365).\r\nI got myself a P1 subscription and started to browse through the configuration screens.\r\nThe migration of an account from IMAP to Exchange Online was amazingly fast and easy.\r\n\r\nHappy with how everything looked, felt, and connected, I was ready to make the switch.\r\n\r\nJust before I wanted to change the MX record to point to Office 365, I double checked the configuration of my account. I discovered I could not find any way to set my account as a catch-all account. After some research I found out this is not possible at all!\r\n\r\n\u003C!--more-->\r\n\r\n> Catch-all Mailbox\r\n>\r\n> A catch-all mailbox receives messages sent to email addresses in a domain that do not exist.\r\n> Exchange Online anti-spam filters use recipient filtering to reject messages sent to mailboxes that don’t exist, \r\n> so catch-all mailboxes are not supported.\r\n\r\nThat left me 2 options:\r\n\r\n1. Stop the migration to Office 365 and leave things as they were.\r\n2. Make every email address I used in the past an alias.\r\n\r\nI started searching if anyone has done this before.\r\nIt looks like this is not the case, so seeing this as a challenge,\r\nI started working on my own solution.\r\n\r\n### Extracting all used addresses\r\n\r\nFirst you need to get every email address ever used by others as a recipient.\r\n\r\nAs my bash scripting is a bit rusty,\r\nI found this [script to convert mdir to mbox format](https://www.linuxquestions.org/questions/linux-general-1/a-script-to-convert-maildir-to-mailbox-format-381568-print/) by Joerg Reinhardt which I have used as base for my own script: [getting email recipient addresses from maildir](https://gist.github.com/eNeRGy164/edd3becb0b3acd6c0f634fca3b108a5e).\r\n\r\nThe script needs 2 parameters, the `maildir` directory and the `email domain` you want to get the aliases for.\r\n\r\n```bash\r\n./maildir-dump.sh \u003CMaildir directory> \u003CEmail domain>\r\n```\r\n\r\nSo, for me:\r\n\r\n```bash\r\n./maildir-dump.sh Maildir hompus.nl\r\n```\r\n\r\nThis results in a long file with a lot of email addresses. To aggregate this list into a CSV file you can use the following command:\r\n\r\n```bash\r\nsort Maildir.dump | uniq -c | sort -k1nr | awk 'BEGIN {OFS = \";\";} {print $1,$2}' > Maildir.csv\r\n```\r\n\r\nThis allows you to open the file using Excel and remove all entries you don’t want to be an alias.  \r\nI counted 385 unique email addresses, too many to add manually.\r\n\r\n### Adding the aliases to a mailbox\r\n\r\nFirst, I configured and connected to Exchange Online using the \"[Windows PowerShell to the Service](https://learn.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell?view=exchange-ps)\" article.\r\n\r\nThen, read the generated and authored CSV file.\r\n\r\n```powershell\r\n$csv = Import-Csv D:\\Maildir.csv -Delimiter ';' -Header Count, Email\r\n```\r\n\r\nGet a reference to the mailbox you want to add the aliases.\r\n\r\n```powershell\r\n$temp = Get-Mailbox -Identity michael\r\n```\r\n\r\nAdd all the email addresses to the `EmailAddress` property, but I discovered the last email address will become the default address.\r\nSo, make sure the primary SMTP address is added last.\r\n\r\n```powershell\r\n$temp.EmailAddresses = $temp.EmailAddresses | ? { $_ -ne \"SMTP:\" + $temp.PrimarySmtpAddress }\r\n$csv | % { $temp.EmailAddresses += (\"SMTP:\" + $_.Email) }\r\n$temp.EmailAddresses += \"SMTP:\" + $temp.PrimarySmtpAddress\r\n```\r\n\r\nNow set the `EmailAddress` property on the actual mailbox\r\n\r\n```powershell\r\nSet-Mailbox -Identity michael -EmailAddresses $temp.EmailAddresses\r\n```\r\n\r\nAnd done!","src/posts/2012-05-18-migrating-a-catch-all-maildir-to-office-365.md","ce99c6933b400e09",{"html":1205,"metadata":1206},"\u003Cp>I have been running my own mail server at home for years using \u003Ca href=\"https://www.postfix.org/\" rel=\"noopener noreferrer external\" target=\"_blank\">Postfix\u003Cspan>\u003C/span>\u003C/a>, \u003Ca href=\"https://www.dovecot.org/\" rel=\"noopener noreferrer external\" target=\"_blank\">dovecot\u003Cspan>\u003C/span>\u003C/a>, \u003Ca href=\"https://amavis.org/\" rel=\"noopener noreferrer external\" target=\"_blank\">amavisd-new\u003Cspan>\u003C/span>\u003C/a>, \u003Ca href=\"https://www.clamav.net/\" rel=\"noopener noreferrer external\" target=\"_blank\">ClamAV\u003Cspan>\u003C/span>\u003C/a> and \u003Ca href=\"https://spamassassin.apache.org/\" rel=\"noopener noreferrer external\" target=\"_blank\">SpamAssassin\u003Cspan>\u003C/span>\u003C/a>.\r\nBut it requires a reliable connection and some maintenance occasionally.\r\nAnd of course, it always breaks when I am on the other side of the world.\u003C/p>\n\u003Cp>To free myself of that burden, I decided to make the move to \u003Ca href=\"https://www.microsoft.com/microsoft-365\" rel=\"noopener noreferrer external\" target=\"_blank\">Office 365\u003Cspan>\u003C/span>\u003C/a>.\r\nI got myself a P1 subscription and started to browse through the configuration screens.\r\nThe migration of an account from \u003Cdfn>\u003Cabbr title=\"Internet Message Access Protocol\">IMAP\u003C/abbr>\u003C/dfn> to Exchange Online was amazingly fast and easy.\u003C/p>\n\u003Cp>Happy with how everything looked, felt, and connected, I was ready to make the switch.\u003C/p>\n\u003Cp>Just before I wanted to change the \u003Cdfn>\u003Cabbr title=\"Mail Exchanger\">MX\u003C/abbr>\u003C/dfn> record to point to Office 365, I double checked the configuration of my account. I discovered I could not find any way to set my account as a catch-all account. After some research I found out this is not possible at all!\u003C/p>\n\u003C!--more-->\n\u003Cblockquote>\n\u003Cp>Catch-all Mailbox\u003C/p>\n\u003Cp>A catch-all mailbox receives messages sent to email addresses in a domain that do not exist.\r\nExchange Online anti-spam filters use recipient filtering to reject messages sent to mailboxes that don’t exist,\r\nso catch-all mailboxes are not supported.\u003C/p>\n\u003C/blockquote>\n\u003Cp>That left me 2 options:\u003C/p>\n\u003Col>\n\u003Cli>Stop the migration to Office 365 and leave things as they were.\u003C/li>\n\u003Cli>Make every email address I used in the past an alias.\u003C/li>\n\u003C/ol>\n\u003Cp>I started searching if anyone has done this before.\r\nIt looks like this is not the case, so seeing this as a challenge,\r\nI started working on my own solution.\u003C/p>\n\u003Ch3 id=\"extracting-all-used-addresses\">Extracting all used addresses\u003C/h3>\n\u003Cp>First you need to get every email address ever used by others as a recipient.\u003C/p>\n\u003Cp>As my bash scripting is a bit rusty,\r\nI found this \u003Ca href=\"https://www.linuxquestions.org/questions/linux-general-1/a-script-to-convert-maildir-to-mailbox-format-381568-print/\" rel=\"noopener noreferrer external\" target=\"_blank\">script to convert mdir to mbox format\u003Cspan>\u003C/span>\u003C/a> by Joerg Reinhardt which I have used as base for my own script: \u003Ca href=\"https://gist.github.com/eNeRGy164/edd3becb0b3acd6c0f634fca3b108a5e\" rel=\"noopener noreferrer external\" target=\"_blank\">getting email recipient addresses from maildir\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>The script needs 2 parameters, the \u003Ccode>maildir\u003C/code> directory and the \u003Ccode>email domain\u003C/code> you want to get the aliases for.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:52ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">./maildir-dump.sh\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;Maildir\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">directory>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;Email\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">domain>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"./maildir-dump.sh \u003CMaildir directory> \u003CEmail domain>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>So, for me:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:35ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">./maildir-dump.sh\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Maildir\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">hompus.nl\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"./maildir-dump.sh Maildir hompus.nl\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This results in a long file with a lot of email addresses. To aggregate this list into a \u003Cdfn>\u003Cabbr title=\"Comma-separated Values\">CSV\u003C/abbr>\u003C/dfn> file you can use the following command:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"bash\" class=\"wrap\" style=\"--ecMaxLine:95ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">sort\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Maildir.dump\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">uniq\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-c\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">sort\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-k1nr\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">awk\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">'BEGIN {OFS = \";\";} {print $1,$2}'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Maildir.csv\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"sort Maildir.dump | uniq -c | sort -k1nr | awk &#x27;BEGIN {OFS = &#x22;;&#x22;;} {print $1,$2}&#x27; > Maildir.csv\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This allows you to open the file using Excel and remove all entries you don’t want to be an alias.\u003Cbr>\nI counted 385 unique email addresses, too many to add manually.\u003C/p>\n\u003Ch3 id=\"adding-the-aliases-to-a-mailbox\">Adding the aliases to a mailbox\u003C/h3>\n\u003Cp>First, I configured and connected to Exchange Online using the “\u003Ca href=\"https://learn.microsoft.com/powershell/exchange/connect-to-exchange-online-powershell?view=exchange-ps&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows PowerShell to the Service\u003Cspan>\u003C/span>\u003C/a>” article.\u003C/p>\n\u003Cp>Then, read the generated and authored \u003Cabbr title=\"Comma-separated Values\">CSV\u003C/abbr> file.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:68ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$csv\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Import-Csv\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> D:\\Maildir.csv \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Delimiter \u003C/span>\u003Cspan style=\"--0:#CE9178\">';'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Header Count\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> Email\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"$csv = Import-Csv D:\\Maildir.csv -Delimiter &#x27;;&#x27; -Header Count, Email\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Get a reference to the mailbox you want to add the aliases.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:37ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$temp\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Get-Mailbox\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Identity michael\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"$temp = Get-Mailbox -Identity michael\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Add all the email addresses to the \u003Ccode>EmailAddress\u003C/code> property, but I discovered the last email address will become the default address.\r\nSo, make sure the primary \u003Cdfn>\u003Cabbr title=\"Simple Mail Transfer Protocol\">SMTP\u003C/abbr>\u003C/dfn> address is added last.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:93ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$temp\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.EmailAddresses\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$temp\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.EmailAddresses\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#C586C0\">?\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$_\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-ne\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"SMTP:\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$temp\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.PrimarySmtpAddress\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$csv\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#C586C0\">%\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$temp\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.EmailAddresses\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"SMTP:\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$_\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Email\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$temp\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.EmailAddresses\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"SMTP:\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$temp\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.PrimarySmtpAddress\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"$temp.EmailAddresses = $temp.EmailAddresses | ? { $_ -ne &#x22;SMTP:&#x22; + $temp.PrimarySmtpAddress }$csv | % { $temp.EmailAddresses += (&#x22;SMTP:&#x22; + $_.Email) }$temp.EmailAddresses += &#x22;SMTP:&#x22; + $temp.PrimarySmtpAddress\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now set the \u003Ccode>EmailAddress\u003C/code> property on the actual mailbox\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:66ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">Set-Mailbox\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Identity michael \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">EmailAddresses \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$temp\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.EmailAddresses\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Set-Mailbox -Identity michael -EmailAddresses $temp.EmailAddresses\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>And done!\u003C/p>",{"headings":1207,"imagePaths":1214,"frontmatter":1187},[1208,1211],{"depth":198,"slug":1209,"text":1210},"extracting-all-used-addresses","Extracting all used addresses",{"depth":198,"slug":1212,"text":1213},"adding-the-aliases-to-a-mailbox","Adding the aliases to a mailbox",[],"2010-08-26-joining-an-iqueryable-with-an-ienumerable",{"id":1215,"data":1217,"body":1229,"filePath":1230,"digest":1231,"rendered":1232},{"id":1218,"title":1219,"date":1220,"updated":1221,"author":15,"excerpt":1222,"layout":17,"permalink":1223,"image":1224,"categories":1225,"tags":1226,"draft":26},194,"Joining an IQueryable with an IEnumerable",["Date","2010-08-26T15:33:55.000Z"],["Date","2021-07-16T21:03:08.000Z"],"With the introduction of LINQ the difference between writing code for accessing a lists of objects in memory and accessing a list of data in an external data source like SQL is vanishing. Combining a in memory with a external list in a single query was not yet possible. With the introduction of .NET Framework 4.0 this has changed.\n","/2010/08/26/joining-an-iqueryable-with-an-ienumerable/","/wp-content/uploads/2010/08/post-194-thumnail-1.png",[183,984],[1134,407,1227,1228,320],"IQueryable","Join","With the introduction of LINQ, the difference between writing code for accessing a list of objects in memory and accessing a list of data in an external data source like SQL Server is vanishing.\r\n\r\nCombining an \"in memory\" list with an external list in a single query was not yet possible.\r\nWith the introduction of .NET Framework 4.0 this has changed.\r\n\r\nIn this article, I want to filter my SQL data using a list of integers I have stored in memory.\r\n\r\n\u003C!--more-->\r\n\r\n## Data model\r\n\r\nI have created a small data model as illustration. This will be used for the examples.\r\nFollow the link on the image below for a larger version.\r\nThe model is part of [the sample code](/wp-content/uploads/2010/08/IQueryableIEnumerableDemo.zip).\r\n\r\n![Visual representation of the data model as described above.](/wp-content/uploads/2010/08/data-model.png \"Data model\")\r\n\r\n## IQueryable.Join\r\n\r\nThe first option you can use is to use the [`Queryable.Join` method](https://learn.microsoft.com/dotnet/api/system.linq.queryable.join?view=netframework-4.0#overloads).\r\n\r\n```csharp\r\nvar entities = new DemoModelContainer();\r\nvar countryIds = Enumerable.Range(1, 3);\r\n\r\nvar query = from i in entities.Items\r\n            from c in i.Countries\r\n            join cid in countryIds on c.Id equals cid\r\n            select i;\r\n\r\nvar items = query.ToList();\r\n```\r\n\r\nWhen you look at the generated SQL Statement (I love IntelliTrace!) you can see a temporary table is created by using the [`UNION ALL` statement](https://learn.microsoft.com/sql/t-sql/language-elements/set-operators-union-transact-sql?view=sql-server-2016).\r\n\r\n```sql\r\nSELECT\r\n    [Extent1].[Id] AS [Id],\r\n    [Extent1].[Name] AS [Name]\r\nFROM\r\n    [dbo].[Items] AS [Extent1]\r\n    INNER JOIN [dbo].[CountryItem] AS [Extent2]\r\n                               ON [Extent1].[Id] = [Extent2].[Items_Id]\r\n    INNER JOIN (\r\n        SELECT\r\n            [UnionAll1].[C1] AS [C1]\r\n        FROM (\r\n            SELECT 1 AS [C1] FROM (SELECT 1 AS X) AS [SingleRowTable1]\r\n            UNION ALL\r\n            SELECT 2 AS [C1] FROM (SELECT 1 AS X) AS [SingleRowTable2]\r\n        ) AS [UnionAll1]\r\n        UNION ALL\r\n        SELECT 3 AS [C1] FROM (SELECT 1 AS X) AS [SingleRowTable3]\r\n    ) AS [UnionAll2] ON [Extent2].[Countries_Id] = [UnionAll2].[C1]\r\n```\r\n\r\nWhat happens is that 2 values are combined in a set, this set is extended with the next value,\r\nthis set is extended with another value, and so on, and so on, until all values are present.\r\n\r\nThis works nicely, but as you can imagine, the SQL query will grow rapidly when the `IEnumerable` list gets larger.\r\n\r\nWhen you change the following:\r\n\r\n```diff\r\n-var countryIds = Enumerable.Range(1, 3);\r\n+var countryIds = Enumerable.Range(1, 50);\r\n```\r\n\r\nyou will run into a [`SqlException`](https://learn.microsoft.com/dotnet/api/system.data.sqlclient.sqlexception?view=netframework-4.0):\r\n\r\n> \"Some part of your SQL statement is nested too deeply. Rewrite the query or break it up into smaller queries.\"\r\n\r\nSQL Server has a hard-coded limit of nesting queries; it doesn't matter which version or edition of SQL Server you use.\r\n\r\n## IEnumerable Contains\r\n\r\nJoining tables is one way of filtering data, an alternative is to use the [`WHERE` statement](https://learn.microsoft.com/sql/t-sql/queries/where-transact-sql?view=sql-server-2016).\r\nThis can be done by using the [`Queryable.Where` method](https://learn.microsoft.com/dotnet/api/system.linq.queryable.where?view=netframework-4.0#overloads).\r\n\r\n```csharp\r\nvar entities = new DemoModelContainer();\r\nvar countryIds = Enumerable.Range(1, 3);\r\n\r\nvar query = from i in entities.Items\r\n            from c in i.Countries\r\n            where countryIds.Contains(c.Id)\r\n            select i;\r\n\r\nvar items = query.ToList();\r\n```\r\n\r\nWhen you look at the generated SQL Statement (Still loving IntelliTrace!) you can see now the [`IN` statement](https://learn.microsoft.com/sql/t-sql/language-elements/in-transact-sqlview=sql-server-2016) is used.\r\n\r\n```sql\r\nSELECT\r\n    [Extent1].[Id] AS [Id],\r\n    [Extent1].[Name] AS [Name]\r\nFROM\r\n    [dbo].[Items] AS [Extent1]\r\n    INNER JOIN [dbo].[CountryItem] AS [Extent2]\r\n                               ON [Extent1].[Id] = [Extent2].[Items_Id]\r\nWHERE\r\n    [Extent2].[Countries_Id] IN (1,2,3)\r\n```\r\n\r\nThis SQL Query is much smaller and filtering against a larger set will not give you the exception.\r\n\r\nThis is how the `WHERE` statement looks when filtering on 50 values:\r\n\r\n```sql\r\nWHERE [Extent2].[Countries_Id] IN (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,\r\n                                   16,17,18,19,20,21,22,23,24,25,26,27,\r\n                                   28,29,30,31,32,33,34,35,36,37,38,39,\r\n                                   40,41,42,43,44,45,46,47,48,49,50)\r\n```\r\n\r\n## Conclusion\r\n\r\nYou can use both methods to filter SQL data with a list in memory.\r\nBut when choosing for the `join` method you should be sure your query will not reach the maximum level of nesting.\r\n\r\nI prefer to use `Contains` method.\r\n\r\nAlthough I used a many-to-many relation in this example, the same applies for a one-to-many scenario.\r\n\r\n## Sample code\r\n\r\nI have added a small Visual Studio 2010 project so you can see the SQL statements for yourself.\r\n\r\nYou will need SQL Server Express 2008 R2 installed on your machine to run the code.\r\n\r\n[IQueryableIEnumerableDemo.zip](/wp-content/uploads/2010/08/IQueryableIEnumerableDemo.zip)","src/posts/2010-08-26-joining-an-iqueryable-with-an-ienumerable.md","a60c60785b85d7c2",{"html":1233,"metadata":1234},"\u003Cp>With the introduction of LINQ, the difference between writing code for accessing a list of objects in memory and accessing a list of data in an external data source like \u003Cdfn>\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr>\u003C/dfn> Server is vanishing.\u003C/p>\n\u003Cp>Combining an “in memory” list with an external list in a single query was not yet possible.\r\nWith the introduction of .NET Framework 4.0 this has changed.\u003C/p>\n\u003Cp>In this article, I want to filter my \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> data using a list of integers I have stored in memory.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"data-model\">Data model\u003C/h2>\n\u003Cp>I have created a small data model as illustration. This will be used for the examples.\r\nFollow the link on the image below for a larger version.\r\nThe model is part of \u003Ca href=\"/wp-content/uploads/2010/08/IQueryableIEnumerableDemo.zip\">the sample code\u003C/a>.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2010/08/data-model.webp\" type=\"image/webp\" media=\"(max-width: 572px)\">\u003Csource srcset=\"/wp-content/uploads/2010/08/data-model-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2010/08/data-model-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2010/08/data-model.png\" alt=\"Visual representation of the data model as described above.\" loading=\"lazy\" decoding=\"async\" width=\"572\" height=\"223\" srcset=\"/wp-content/uploads/2010/08/data-model.png 572w, /wp-content/uploads/2010/08/data-model-150x150.png 150w, /wp-content/uploads/2010/08/data-model-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Data model\u003C/figcaption>\u003C/figure>\n\u003Ch2 id=\"iqueryablejoin\">IQueryable.Join\u003C/h2>\n\u003Cp>The first option you can use is to use the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.linq.queryable.join?view=netframework-4.0&#x26;wt.mc_id=AZ-MVP-5004268#overloads\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Queryable.Join\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:53ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entities\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">DemoModelContainer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">countryIds\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Enumerable\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Range\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">3\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">query\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">from\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">in\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entities\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Items\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">from\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">c\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">in\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Countries\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">join\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">cid\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">in\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">countryIds\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">on\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">c\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Id\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">equals\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">cid\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">select\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">items\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">query\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToList\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var entities = new DemoModelContainer();var countryIds = Enumerable.Range(1, 3);var query = from i in entities.Items            from c in i.Countries            join cid in countryIds on c.Id equals cid            select i;var items = query.ToList();\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>When you look at the generated \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Statement (I love IntelliTrace!) you can see a temporary table is created by using the \u003Ca href=\"https://learn.microsoft.com/sql/t-sql/language-elements/set-operators-union-transact-sql?view=sql-server-2016&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>UNION ALL\u003C/code> statement\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"sql\" class=\"wrap\" style=\"--ecMaxLine:71ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[Extent1].[Id] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Id],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[Extent1].[Name] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Name]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">FROM\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[dbo].[Items] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent1]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">INNER JOIN\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [dbo].[CountryItem] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent2]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:31ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                               \u003C/span>\u003Cspan style=\"--0:#569CD6\">ON\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent1].[Id] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent2].[Items_Id]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">INNER JOIN\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">            \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[UnionAll1].[C1] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [C1]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#569CD6\">FROM\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [C1] \u003C/span>\u003Cspan style=\"--0:#569CD6\">FROM\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> X) \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [SingleRowTable1]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">UNION ALL\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">2\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [C1] \u003C/span>\u003Cspan style=\"--0:#569CD6\">FROM\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> X) \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [SingleRowTable2]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [UnionAll1]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#569CD6\">UNION ALL\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">3\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [C1] \u003C/span>\u003Cspan style=\"--0:#569CD6\">FROM\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> X) \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [SingleRowTable3]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [UnionAll2] \u003C/span>\u003Cspan style=\"--0:#569CD6\">ON\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent2].[Countries_Id] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [UnionAll2].[C1]\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"SELECT    [Extent1].[Id] AS [Id],    [Extent1].[Name] AS [Name]FROM    [dbo].[Items] AS [Extent1]    INNER JOIN [dbo].[CountryItem] AS [Extent2]                               ON [Extent1].[Id] = [Extent2].[Items_Id]    INNER JOIN (        SELECT            [UnionAll1].[C1] AS [C1]        FROM (            SELECT 1 AS [C1] FROM (SELECT 1 AS X) AS [SingleRowTable1]            UNION ALL            SELECT 2 AS [C1] FROM (SELECT 1 AS X) AS [SingleRowTable2]        ) AS [UnionAll1]        UNION ALL        SELECT 3 AS [C1] FROM (SELECT 1 AS X) AS [SingleRowTable3]    ) AS [UnionAll2] ON [Extent2].[Countries_Id] = [UnionAll2].[C1]\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>What happens is that 2 values are combined in a set, this set is extended with the next value,\r\nthis set is extended with another value, and so on, and so on, until all values are present.\u003C/p>\n\u003Cp>This works nicely, but as you can imagine, the \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> query will grow rapidly when the \u003Ccode>IEnumerable\u003C/code> list gets larger.\u003C/p>\n\u003Cp>When you change the following:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"diff\" class=\"wrap\" style=\"--ecMaxLine:41ch\">\u003Ccode>\u003Cdiv class=\"ec-line highlight del\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">var countryIds = Enumerable.Range(1, 3);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight ins\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">var countryIds = Enumerable.Range(1, 50);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var countryIds = Enumerable.Range(1, 3);var countryIds = Enumerable.Range(1, 50);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>you will run into a \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.data.sqlclient.sqlexception?view=netframework-4.0&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SqlException\u003C/code>\u003Cspan>\u003C/span>\u003C/a>:\u003C/p>\n\u003Cblockquote>\n\u003Cp>“Some part of your \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> statement is nested too deeply. Rewrite the query or break it up into smaller queries.”\u003C/p>\n\u003C/blockquote>\n\u003Cp>\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Server has a hard-coded limit of nesting queries; it doesn’t matter which version or edition of \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Server you use.\u003C/p>\n\u003Ch2 id=\"ienumerable-contains\">IEnumerable Contains\u003C/h2>\n\u003Cp>Joining tables is one way of filtering data, an alternative is to use the \u003Ca href=\"https://learn.microsoft.com/sql/t-sql/queries/where-transact-sql?view=sql-server-2016&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>WHERE\u003C/code> statement\u003Cspan>\u003C/span>\u003C/a>.\r\nThis can be done by using the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.linq.queryable.where?view=netframework-4.0&#x26;wt.mc_id=AZ-MVP-5004268#overloads\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Queryable.Where\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:43ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entities\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">DemoModelContainer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">countryIds\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Enumerable\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Range\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">3\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">query\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">from\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">in\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entities\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Items\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">from\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">c\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">in\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Countries\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">where\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">countryIds\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Contains\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">c\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Id\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#569CD6\">select\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">i\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">items\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">query\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToList\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var entities = new DemoModelContainer();var countryIds = Enumerable.Range(1, 3);var query = from i in entities.Items            from c in i.Countries            where countryIds.Contains(c.Id)            select i;var items = query.ToList();\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>When you look at the generated \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Statement (Still loving IntelliTrace!) you can see now the \u003Ca href=\"https://learn.microsoft.com/sql/t-sql/language-elements/in-transact-sqlview=sql-server-2016?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>IN\u003C/code> statement\u003Cspan>\u003C/span>\u003C/a> is used.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"sql\" class=\"wrap\" style=\"--ecMaxLine:71ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">SELECT\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[Extent1].[Id] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Id],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[Extent1].[Name] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Name]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">FROM\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[dbo].[Items] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent1]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">INNER JOIN\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [dbo].[CountryItem] \u003C/span>\u003Cspan style=\"--0:#569CD6\">AS\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent2]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:31ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                               \u003C/span>\u003Cspan style=\"--0:#569CD6\">ON\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent1].[Id] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent2].[Items_Id]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">WHERE\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[Extent2].[Countries_Id] \u003C/span>\u003Cspan style=\"--0:#569CD6\">IN\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">2\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">3\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"SELECT    [Extent1].[Id] AS [Id],    [Extent1].[Name] AS [Name]FROM    [dbo].[Items] AS [Extent1]    INNER JOIN [dbo].[CountryItem] AS [Extent2]                               ON [Extent1].[Id] = [Extent2].[Items_Id]WHERE    [Extent2].[Countries_Id] IN (1,2,3)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Query is much smaller and filtering against a larger set will not give you the exception.\u003C/p>\n\u003Cp>This is how the \u003Ccode>WHERE\u003C/code> statement looks when filtering on 50 values:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"sql\" class=\"wrap\" style=\"--ecMaxLine:71ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">WHERE\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [Extent2].[Countries_Id] \u003C/span>\u003Cspan style=\"--0:#569CD6\">IN\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">2\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">3\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">4\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">5\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">6\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">7\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">8\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">9\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">10\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">11\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">12\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">13\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">14\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">15\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:35ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                                   \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">16\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">17\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">18\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">19\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">20\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">21\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">22\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">23\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">24\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">25\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">26\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">27\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:35ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                                   \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">28\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">29\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">30\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">31\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">32\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">33\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">34\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">35\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">36\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">37\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">38\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">39\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:35ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                                   \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">40\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">41\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">42\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">43\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">44\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">45\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">46\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">47\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">48\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">49\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">50\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"WHERE [Extent2].[Countries_Id] IN (1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,                                   16,17,18,19,20,21,22,23,24,25,26,27,                                   28,29,30,31,32,33,34,35,36,37,38,39,                                   40,41,42,43,44,45,46,47,48,49,50)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"conclusion\">Conclusion\u003C/h2>\n\u003Cp>You can use both methods to filter \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> data with a list in memory.\r\nBut when choosing for the \u003Ccode>join\u003C/code> method you should be sure your query will not reach the maximum level of nesting.\u003C/p>\n\u003Cp>I prefer to use \u003Ccode>Contains\u003C/code> method.\u003C/p>\n\u003Cp>Although I used a many-to-many relation in this example, the same applies for a one-to-many scenario.\u003C/p>\n\u003Ch2 id=\"sample-code\">Sample code\u003C/h2>\n\u003Cp>I have added a small Visual Studio 2010 project so you can see the \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> statements for yourself.\u003C/p>\n\u003Cp>You will need \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Server Express 2008 R2 installed on your machine to run the code.\u003C/p>\n\u003Cp>\u003Ca href=\"/wp-content/uploads/2010/08/IQueryableIEnumerableDemo.zip\">IQueryableIEnumerableDemo.zip\u003C/a>\u003C/p>",{"headings":1235,"imagePaths":1249,"frontmatter":1217},[1236,1239,1242,1245,1246],{"depth":780,"slug":1237,"text":1238},"data-model","Data model",{"depth":780,"slug":1240,"text":1241},"iqueryablejoin","IQueryable.Join",{"depth":780,"slug":1243,"text":1244},"ienumerable-contains","IEnumerable Contains",{"depth":780,"slug":1149,"text":1150},{"depth":780,"slug":1247,"text":1248},"sample-code","Sample code",[],"2011-01-17-configure-people-picker-over-a-one-way-trust-using-powershell",{"id":1250,"data":1252,"body":1263,"filePath":1264,"digest":1265,"rendered":1266},{"id":1253,"title":1254,"date":1255,"updated":1256,"author":15,"excerpt":1257,"layout":17,"permalink":1258,"image":1259,"categories":1260,"tags":1261,"draft":26},201,"Configure people picker over a one-way trust using PowerShell",["Date","2011-01-17T18:16:47.000Z"],["Date","2021-07-16T21:01:51.000Z"],"In a previous post I have written about Using the people picker over a one-way trust. In this post I use STSADM commands as there are no other ways to configure this. A downside of the STSADM command is your domain password being visible on the command prompt in clear text for everybody to read, or to retrieve from the command line history.\nSharePoint 2010 introduces several cmdlets to replace the “old” STSADM commands. Microsoft has posted an overview of the STSADM to Windows PowerShell mapping. However the commands for configuring the people picker are not available.\n","/2011/01/17/configure-people-picker-over-a-one-way-trust-using-powershell/","/wp-content/uploads/2011/01/post-201-thumnail-1.png",[1196,132],[1262,1017,160,363,1018],"cmdlet","In a previous article, I have written about\r\n\"[Using the people picker over a one-way trust](/2010/06/01/using-the-people-picker-over-a-one-way-trust)\".\r\nIn that post I use [STSADM](https://learn.microsoft.com/SharePoint/technical-reference/stsadm-to-microsoft-powershell-mapping)\r\ncommands as there are no other ways to configure this.\r\n\r\nA downside of the STSADM command is your domain password being visible on the command prompt in plain text for everybody to read.\r\n\r\nWith SharePoint 2010 Microsoft introduces several cmdlets to replace the \"old\" STSADM commands. But looking at the\r\n[STSADM to Windows PowerShell mapping](https://learn.microsoft.com/SharePoint/technical-reference/stsadm-to-microsoft-powershell-mapping)\r\nyou will see the commands for configuring the people picker are not present.\r\n\r\n## Creating my own script\r\n\r\nPowerShell contains the [`Get-Credential` cmdlet](\u003Chttps://learn.microsoft.com/previous-versions/dd315327(v=technet.10)>)\r\nwhich uses a dialog to request credentials from the user and stores the password in a\r\n[`SecureString`](https://learn.microsoft.com/dotnet/api/system.security.securestring?view=netframework-4.0).\r\n\r\nThis triggered me to write a PowerShell script which will work the same as \"`STSADM -o setproperty -pn peoplepicker-searchadforests`\",\r\nbut instead of typing the credentials on the command line it will use the credential dialog for every trusted domain.\r\n\r\nAs written in my previous post the configuration is done in two steps.\r\n\r\n## SetAppPassword\r\n\r\nFirst you need to create a secure store for the credentials.\r\nThis is done by executing the `SetAppPassword` command on every server in your SharePoint Farm with the same password.\r\n\r\n### STSADM\r\n\r\n```shell\r\nstsadm -o setapppassword\r\n       -password \u003Cpassword>\r\n```\r\n\r\n### PowerShell\r\n\r\n```powershell\r\nSet-AppPassword \"\u003Cpassword>\"\r\n```\r\n\r\n```powershell\r\nfunction Set-AppPassword([String]$password) {\r\n  $type =\r\n      [Microsoft.SharePoint.Utilities.SPPropertyBag].Assembly.GetType(\"Microsoft.SharePoint.Utilities.SPSecureString\")\r\n\r\n  $method =\r\n      $type.GetMethod(\"FromString\", \"Static, NonPublic\", $null, @([String]), $null)\r\n\r\n  $secureString = $method.Invoke($null, @($password))\r\n\r\n  [Microsoft.SharePoint.SPSecurity]::SetApplicationCredentialKey($secureString)\r\n}\r\n```\r\n\r\n## PeoplePickerSearchADForests\r\n\r\nThe second step is to register the (trusted) domains to be visible in the people picker.\r\nRemember this setting is per web application and zone.\r\n\r\n### STSADM\r\n\r\n```shell\r\nstsadm -o setproperty\r\n       -url \u003Curl>\r\n       -pn \"peoplepicker-searchadforests\"\r\n       -pv \"forest:\u003Csource forest>;domain:\u003Ctrusted domain>,\u003Ctrusted domain>\\\u003Caccount>,\u003Cpassword>\"\r\n```\r\n\r\n### PowerShell\r\n\r\n```powershell\r\nSet-PeoplePickerSearchADForests \"\u003Curl>\"\r\n                                \"forest:\u003Csource forest>;domain:\u003Ctrusted domain>\"\r\n```\r\n\r\n```powershell\r\nfunction Set-PeoplePickerSearchADForests([String] $webApplicationUrl, [String] $value) {\r\n  $webApplication = Get-SPWebApplication $webApplicationUrl\r\n\r\n  $searchActiveDirectoryDomains = $webApplication.PeoplePickerSettings.SearchActiveDirectoryDomains\r\n  $searchActiveDirectoryDomains.Clear()\r\n\r\n  $currentDomain = (Get-WmiObject -Class Win32_ComputerSystem).Domain\r\n\r\n  if (![String]::IsNullOrEmpty($value)) {\r\n    $value.Split(@(';'), \"RemoveEmptyEntries\") | ForEach {\r\n        $strArray = $_.Split(@(';'))\r\n\r\n        $item = New-Object Microsoft.SharePoint.Administration.SPPeoplePickerSearchActiveDirectoryDomain\r\n\r\n        [String]$value = $strArray[0]\r\n\r\n        $index = $value.IndexOf(':');\r\n        if ($index -ge 0) {\r\n            $item.DomainName = $value.Substring($index + 1);\r\n        } else {\r\n            $item.DomainName = $value;\r\n        }\r\n\r\n        if ([Globalization.CultureInfo]::InvariantCulture.CompareInfo.IsPrefix($value, \"domain:\",\"IgnoreCase\")) {\r\n            $item.IsForest = $false;\r\n        } else {\r\n            $item.IsForest = $true;\r\n        }\r\n\r\n        if ($item.DomainName -ne $currentDomain) {\r\n            $credentials = $host.ui.PromptForCredential(\"Foreign domain trust\"\r\n              + \" credentials\", \"Please enter the trust credentials to\"\r\n              + \" connect to the \" + $item.DomainName + \" domain\", \"\", \"\")\r\n\r\n            $item.LoginName = $credentials.UserName;\r\n            $item.SetPassword($credentials.Password);\r\n        }\r\n\r\n        $searchActiveDirectoryDomains.Add($item);\r\n    }\r\n\r\n    $webApplication.Update()\r\n  }\r\n}\r\n```\r\n\r\n## Using the script\r\n\r\nI have attached the script so you can use it in any way you want.\r\nYou can put the commands in your own `.ps1` file,\r\nor load the script in your current session using the following syntax:\r\n\r\n```powershell\r\n. .\\\u003Cpath to file>PeoplePickerSearchADForests.ps1\r\n```\r\n\r\n_(Yes, that is a \u003Ckbd>**dot**\u003C/kbd>, then a \u003Ckbd>**space**\u003C/kbd>, then the **path** to the script)_\r\n\r\n[PeoplePickerSearchADForests.zip](/wp-content/uploads/2011/01/PeoplePickerSearchADForests.zip)","src/posts/2011-01-17-configure-people-picker-over-a-one-way-trust-using-powershell.md","403596557c79e7bf",{"html":1267,"metadata":1268},"\u003Cp>In a previous article, I have written about\r\n“\u003Ca href=\"/2010/06/01/using-the-people-picker-over-a-one-way-trust\">Using the people picker over a one-way trust\u003C/a>”.\r\nIn that post I use \u003Ca href=\"https://learn.microsoft.com/SharePoint/technical-reference/stsadm-to-microsoft-powershell-mapping?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Cdfn>\u003Cabbr title=\"SharePoint Team Services Administration\">STSADM\u003C/abbr>\u003C/dfn>\u003Cspan>\u003C/span>\u003C/a>\r\ncommands as there are no other ways to configure this.\u003C/p>\n\u003Cp>A downside of the \u003Cabbr title=\"SharePoint Team Services Administration\">STSADM\u003C/abbr> command is your domain password being visible on the command prompt in plain text for everybody to read.\u003C/p>\n\u003Cp>With SharePoint 2010 Microsoft introduces several cmdlets to replace the “old” \u003Cabbr title=\"SharePoint Team Services Administration\">STSADM\u003C/abbr> commands. But looking at the\r\n\u003Ca href=\"https://learn.microsoft.com/SharePoint/technical-reference/stsadm-to-microsoft-powershell-mapping?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Cabbr title=\"SharePoint Team Services Administration\">STSADM\u003C/abbr> to Windows PowerShell mapping\u003Cspan>\u003C/span>\u003C/a>\r\nyou will see the commands for configuring the people picker are not present.\u003C/p>\n\u003Ch2 id=\"creating-my-own-script\">Creating my own script\u003C/h2>\n\u003Cp>PowerShell contains the \u003Ca href=\"https://learn.microsoft.com/previous-versions/dd315327(v=technet.10)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Get-Credential\u003C/code> cmdlet\u003Cspan>\u003C/span>\u003C/a>\r\nwhich uses a dialog to request credentials from the user and stores the password in a\r\n\u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.security.securestring?view=netframework-4.0&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>SecureString\u003C/code>\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>This triggered me to write a PowerShell script which will work the same as “\u003Ccode>STSADM -o setproperty -pn peoplepicker-searchadforests\u003C/code>”,\r\nbut instead of typing the credentials on the command line it will use the credential dialog for every trusted domain.\u003C/p>\n\u003Cp>As written in my previous post the configuration is done in two steps.\u003C/p>\n\u003Ch2 id=\"setapppassword\">SetAppPassword\u003C/h2>\n\u003Cp>First you need to create a secure store for the credentials.\r\nThis is done by executing the \u003Ccode>SetAppPassword\u003C/code> command on every server in your SharePoint Farm with the same password.\u003C/p>\n\u003Ch3 id=\"stsadm\">\u003Cabbr title=\"SharePoint Team Services Administration\">STSADM\u003C/abbr>\u003C/h3>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:27ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">stsadm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-o\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">setapppassword\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:7ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">       \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">-password\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;password>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"stsadm -o setapppassword       -password \u003Cpassword>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"powershell\">PowerShell\u003C/h3>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:28ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">Set-AppPassword\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"&#x3C;password>\"\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Set-AppPassword &#x22;\u003Cpassword>&#x22;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:118ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">function\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Set-AppPassword\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">([\u003C/span>\u003Cspan style=\"--0:#569CD6\">String\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$password\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$type\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#569CD6\">Microsoft.SharePoint.Utilities.SPPropertyBag\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">].Assembly.GetType(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.SharePoint.Utilities.SPSecureString\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$method\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$type\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.GetMethod\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"FromString\"\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Static, NonPublic\"\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">$null\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">@\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">([\u003C/span>\u003Cspan style=\"--0:#569CD6\">String\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">])\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">$null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$secureString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$method\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Invoke\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">$null\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">@\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$password\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">))\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#569CD6\">Microsoft.SharePoint.SPSecurity\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]::SetApplicationCredentialKey(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$secureString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"function Set-AppPassword([String]$password) {  $type =      [Microsoft.SharePoint.Utilities.SPPropertyBag].Assembly.GetType(&#x22;Microsoft.SharePoint.Utilities.SPSecureString&#x22;)  $method =      $type.GetMethod(&#x22;FromString&#x22;, &#x22;Static, NonPublic&#x22;, $null, @([String]), $null)  $secureString = $method.Invoke($null, @($password))  [Microsoft.SharePoint.SPSecurity]::SetApplicationCredentialKey($secureString)}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"peoplepickersearchadforests\">PeoplePickerSearchADForests\u003C/h2>\n\u003Cp>The second step is to register the (trusted) domains to be visible in the people picker.\r\nRemember this setting is per web application and zone.\u003C/p>\n\u003Ch3 id=\"stsadm-1\">\u003Cabbr title=\"SharePoint Team Services Administration\">STSADM\u003C/abbr>\u003C/h3>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:97ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">stsadm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">-o\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">setproperty\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:7ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">       \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">-url\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;url>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:7ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">       \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">-pn\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"peoplepicker-searchadforests\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:7ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">       \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">-pv\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"forest:&#x3C;source forest>;domain:&#x3C;trusted domain>,&#x3C;trusted domain>\\&#x3C;account>,&#x3C;password>\"\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"stsadm -o setproperty       -url \u003Curl>       -pn &#x22;peoplepicker-searchadforests&#x22;       -pv &#x22;forest:\u003Csource forest>;domain:\u003Ctrusted domain>,\u003Ctrusted domain>\\\u003Caccount>,\u003Cpassword>&#x22;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"powershell-1\">PowerShell\u003C/h3>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:80ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">Set-PeoplePickerSearchADForests\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"&#x3C;url>\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:32ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                                \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"forest:&#x3C;source forest>;domain:&#x3C;trusted domain>\"\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Set-PeoplePickerSearchADForests &#x22;\u003Curl>&#x22;                                &#x22;forest:\u003Csource forest>;domain:\u003Ctrusted domain>&#x22;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:113ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">function\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Set-PeoplePickerSearchADForests\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">([\u003C/span>\u003Cspan style=\"--0:#569CD6\">String\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$webApplicationUrl\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [\u003C/span>\u003Cspan style=\"--0:#569CD6\">String\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$webApplication\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Get-SPWebApplication\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$webApplicationUrl\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$searchActiveDirectoryDomains\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$webApplication\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.PeoplePickerSettings.SearchActiveDirectoryDomains\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$searchActiveDirectoryDomains\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Clear\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">()\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$currentDomain\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Get-WmiObject\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Class Win32_ComputerSystem).Domain\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#569CD6\">String\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]::IsNullOrEmpty(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$value\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Split\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">@\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">';'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"RemoveEmptyEntries\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#C586C0\">ForEach\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$strArray\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$_\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Split\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">@\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">';'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">))\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$item\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">New-Object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> Microsoft.SharePoint.Administration.SPPeoplePickerSearchActiveDirectoryDomain\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#569CD6\">String\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$strArray\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$index\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$value\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.IndexOf\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">':'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$index\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-ge\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$item\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.DomainName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$value\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Substring\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$index\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">} \u003C/span>\u003Cspan style=\"--0:#C586C0\">else\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$item\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.DomainName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> ([\u003C/span>\u003Cspan style=\"--0:#569CD6\">Globalization.CultureInfo\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]::InvariantCulture.CompareInfo.IsPrefix(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$value\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"domain:\"\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"IgnoreCase\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$item\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.IsForest\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">$false\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">} \u003C/span>\u003Cspan style=\"--0:#C586C0\">else\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$item\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.IsForest\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">$true\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$item\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.DomainName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-ne\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$currentDomain\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$credentials\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> $host\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.ui.PromptForCredential\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Foreign domain trust\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:14ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">              \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\" credentials\"\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Please enter the trust credentials to\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:14ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">              \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\" connect to the \"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$item\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.DomainName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\" domain\"\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\"\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$item\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.LoginName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$credentials\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.UserName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$item\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.SetPassword\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$credentials\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Password\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$searchActiveDirectoryDomains\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Add\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$item\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$webApplication\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Update\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">()\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"function Set-PeoplePickerSearchADForests([String] $webApplicationUrl, [String] $value) {  $webApplication = Get-SPWebApplication $webApplicationUrl  $searchActiveDirectoryDomains = $webApplication.PeoplePickerSettings.SearchActiveDirectoryDomains  $searchActiveDirectoryDomains.Clear()  $currentDomain = (Get-WmiObject -Class Win32_ComputerSystem).Domain  if (![String]::IsNullOrEmpty($value)) {    $value.Split(@(&#x27;;&#x27;), &#x22;RemoveEmptyEntries&#x22;) | ForEach {        $strArray = $_.Split(@(&#x27;;&#x27;))        $item = New-Object Microsoft.SharePoint.Administration.SPPeoplePickerSearchActiveDirectoryDomain        [String]$value = $strArray[0]        $index = $value.IndexOf(&#x27;:&#x27;);        if ($index -ge 0) {            $item.DomainName = $value.Substring($index + 1);        } else {            $item.DomainName = $value;        }        if ([Globalization.CultureInfo]::InvariantCulture.CompareInfo.IsPrefix($value, &#x22;domain:&#x22;,&#x22;IgnoreCase&#x22;)) {            $item.IsForest = $false;        } else {            $item.IsForest = $true;        }        if ($item.DomainName -ne $currentDomain) {            $credentials = $host.ui.PromptForCredential(&#x22;Foreign domain trust&#x22;              + &#x22; credentials&#x22;, &#x22;Please enter the trust credentials to&#x22;              + &#x22; connect to the &#x22; + $item.DomainName + &#x22; domain&#x22;, &#x22;&#x22;, &#x22;&#x22;)            $item.LoginName = $credentials.UserName;            $item.SetPassword($credentials.Password);        }        $searchActiveDirectoryDomains.Add($item);    }    $webApplication.Update()  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"using-the-script\">Using the script\u003C/h2>\n\u003Cp>I have attached the script so you can use it in any way you want.\r\nYou can put the commands in your own \u003Ccode>.ps1\u003C/code> file,\r\nor load the script in your current session using the following syntax:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:49ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#D4D4D4\">.\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> .\\\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">path to file\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">PeoplePickerSearchADForests.ps1\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\". .\\\u003Cpath to file>PeoplePickerSearchADForests.ps1\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Cem>(Yes, that is a \u003Ckbd>\u003Cstrong>dot\u003C/strong>\u003C/kbd>, then a \u003Ckbd>\u003Cstrong>space\u003C/strong>\u003C/kbd>, then the \u003Cstrong>path\u003C/strong> to the script)\u003C/em>\u003C/p>\n\u003Cp>\u003Ca href=\"/wp-content/uploads/2011/01/PeoplePickerSearchADForests.zip\">PeoplePickerSearchADForests.zip\u003C/a>\u003C/p>",{"headings":1269,"imagePaths":1290,"frontmatter":1252},[1270,1273,1276,1278,1280,1283,1285,1287],{"depth":780,"slug":1271,"text":1272},"creating-my-own-script","Creating my own script",{"depth":780,"slug":1274,"text":1275},"setapppassword","SetAppPassword",{"depth":198,"slug":363,"text":1277},"STSADM",{"depth":198,"slug":1279,"text":1196},"powershell",{"depth":780,"slug":1281,"text":1282},"peoplepickersearchadforests","PeoplePickerSearchADForests",{"depth":198,"slug":1284,"text":1277},"stsadm-1",{"depth":198,"slug":1286,"text":1196},"powershell-1",{"depth":780,"slug":1288,"text":1289},"using-the-script","Using the script",[],"2015-05-28-entity-type-code-using-javascript-only",{"id":1291,"data":1293,"body":1309,"filePath":1310,"digest":1311,"rendered":1312},{"id":1294,"title":1295,"date":1296,"updated":1297,"author":15,"excerpt":1298,"layout":17,"permalink":1299,"image":1300,"categories":1301,"tags":1303,"draft":26},481,"Get the Entity Type Code using JavaScript only (not using remote services)",["Date","2015-05-28T07:12:15.000Z"],["Date","2020-12-06T18:11:57.000Z"],"Every Microsoft Dynamics CRM developer has faced this problem: How to get the entity type code for your custom entity in JavaScript. If you need the entity type code for the current form there are several supported ways to get it. But when you want the entity type code for a different custom entity, you are in trouble. The SDK has no real solution for this, and hard-coding is no option as the numbers can change per deployment.\nDigging through the client side object model I found a nice, although still unsupported, treasure which works with CRM 2011 and up, including the latest installment: 2015 update 1.\n","/2015/05/28/entity-type-code-using-javascript-only/","/wp-content/uploads/2015/05/post-2015-05-28-thumbnail.png",[1302],"Dynamics CRM",[1304,1305,1306,1307,1308],"CRM","Dynamics","Entity Type Code","Entity Type Name","JavaScript","Every Microsoft Dynamics CRM developer has faced this problem:\r\nHow to get the entity type code for your custom entity in JavaScript.\r\nIf you need the entity type code for the current form there are several supported ways to get it.\r\nBut when you want the entity type code for a different custom entity, you are in trouble.\r\n\r\nThe SDK has no real solution for this,\r\nand hard-coding is no option as the numbers can change per deployment.\r\n\r\n\u003C!--more-->\r\n\r\nSo how do most people solve this?\r\nA popular choice is the unsupported \"Remote Command and Lookup service\".  \r\nBecause of the asynchronous nature the use of a service adds a performance penalty and complexity to your code.\r\nIt also seems this will [break in CRM 2015 Update 1](https://community.dynamics.com/forums/thread/details/?threadid=7fe08fe0-0c1c-48cc-9911-0d9f23a24bc5).\r\n\r\nDigging through the client-side object model I found a nice, although still unsupported,\r\ntreasure which works with CRM 2011 and up, including the latest installment: 2015 update 1.\r\n\r\n```js\r\nMscrm.EntityPropUtil.EntityTypeName2CodeMap;\r\n```\r\n\r\nThis class contains a dictionary of all out-of-the-box entities but also all custom entities.\r\nAnd as it's already loaded in memory there is no performance loss.\r\n\r\n## Form JavaScript\r\n\r\nWhen using JavaScript in a form the goodies are readily available:\r\n\r\n```js\r\nMscrm.EntityPropUtil.EntityTypeName2CodeMap.account;\r\n// 1\r\n\r\nMscrm.EntityPropUtil.EntityTypeName2CodeMap[\"account\"];\r\n// 1\r\n\r\nMscrm.EntityPropUtil.EntityTypeName2CodeMap.wv_country;\r\n// 10025\r\n```\r\n\r\n## Web Resource\r\n\r\nFrom a web resource just target the parent `window`:\r\n\r\n```js\r\nwindow.parent.Mscrm.EntityPropUtil.EntityTypeName2CodeMap;\r\n```\r\n\r\nOr, if you have included the `ClientGlobalContext.js.aspx`,\r\nyou can also use the class directly:\r\n\r\n```js\r\nMscrm.EntityPropUtil.EntityTypeName2CodeMap;\r\n```\r\n\r\n## Turbo Forms\r\n\r\nWith the introduction of the turbo forms in CRM 2015 update 1 you need an additional line of code to make the mapping work:\r\n\r\n```js\r\nif (Mscrm.EntityPropUtil == null) {\r\n  Mscrm.EntityPropUtil = parent.Mscrm.EntityPropUtil;\r\n}\r\n```\r\n\r\n## From entity type code to entity type name\r\n\r\nIf you want to use this map to get the entity type name from the entity type code you can use the following line of JavaScript:\r\n\r\n```js\r\nObject.keys(Mscrm.EntityPropUtil.EntityTypeName2CodeMap).filter(function (key) {\r\n  return Mscrm.EntityPropUtil.EntityTypeName2CodeMap[key] === 10025;\r\n})[0];\r\n// \"wv_country\"\r\n```\r\n\r\nIt is that easy!","src/posts/2015-05-28-entity-type-code-using-javascript-only.md","08e59222a225fd8a",{"html":1313,"metadata":1314},"\u003Cp>Every Microsoft Dynamics \u003Cdfn>\u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr>\u003C/dfn> developer has faced this problem:\r\nHow to get the entity type code for your custom entity in JavaScript.\r\nIf you need the entity type code for the current form there are several supported ways to get it.\r\nBut when you want the entity type code for a different custom entity, you are in trouble.\u003C/p>\n\u003Cp>The \u003Cdfn>\u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/dfn> has no real solution for this,\r\nand hard-coding is no option as the numbers can change per deployment.\u003C/p>\n\u003C!--more-->\n\u003Cp>So how do most people solve this?\r\nA popular choice is the unsupported “Remote Command and Lookup service”.\u003Cbr>\nBecause of the asynchronous nature the use of a service adds a performance penalty and complexity to your code.\r\nIt also seems this will \u003Ca href=\"https://community.dynamics.com/forums/thread/details/?threadid=7fe08fe0-0c1c-48cc-9911-0d9f23a24bc5\" rel=\"noopener noreferrer external\" target=\"_blank\">break in \u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr> 2015 Update 1\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>Digging through the client-side object model I found a nice, although still unsupported,\r\ntreasure which works with \u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr> 2011 and up, including the latest installment: 2015 update 1.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"js\" class=\"wrap\" style=\"--ecMaxLine:44ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">Mscrm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityPropUtil\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityTypeName2CodeMap\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Mscrm.EntityPropUtil.EntityTypeName2CodeMap;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This class contains a dictionary of all out-of-the-box entities but also all custom entities.\r\nAnd as it’s already loaded in memory there is no performance loss.\u003C/p>\n\u003Ch2 id=\"form-javascript\">Form JavaScript\u003C/h2>\n\u003Cp>When using JavaScript in a form the goodies are readily available:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"js\" class=\"wrap\" style=\"--ecMaxLine:55ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">Mscrm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityPropUtil\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityTypeName2CodeMap\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">account\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// 1\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">Mscrm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityPropUtil\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityTypeName2CodeMap\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"account\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">];\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// 1\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">Mscrm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityPropUtil\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityTypeName2CodeMap\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">wv_country\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// 10025\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Mscrm.EntityPropUtil.EntityTypeName2CodeMap.account;// 1Mscrm.EntityPropUtil.EntityTypeName2CodeMap[&#x22;account&#x22;];// 1Mscrm.EntityPropUtil.EntityTypeName2CodeMap.wv_country;// 10025\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"web-resource\">Web Resource\u003C/h2>\n\u003Cp>From a web resource just target the parent \u003Ccode>window\u003C/code>:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"js\" class=\"wrap\" style=\"--ecMaxLine:58ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">window\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">parent\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Mscrm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityPropUtil\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityTypeName2CodeMap\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"window.parent.Mscrm.EntityPropUtil.EntityTypeName2CodeMap;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Or, if you have included the \u003Ccode>ClientGlobalContext.js.aspx\u003C/code>,\r\nyou can also use the class directly:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"js\" class=\"wrap\" style=\"--ecMaxLine:44ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">Mscrm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityPropUtil\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityTypeName2CodeMap\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Mscrm.EntityPropUtil.EntityTypeName2CodeMap;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"turbo-forms\">Turbo Forms\u003C/h2>\n\u003Cp>With the introduction of the turbo forms in \u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr> 2015 update 1 you need an additional line of code to make the mapping work:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"js\" class=\"wrap\" style=\"--ecMaxLine:53ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Mscrm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityPropUtil\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">==\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Mscrm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityPropUtil\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">parent\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Mscrm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityPropUtil\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"if (Mscrm.EntityPropUtil == null) {  Mscrm.EntityPropUtil = parent.Mscrm.EntityPropUtil;}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"from-entity-type-code-to-entity-type-name\">From entity type code to entity type name\u003C/h2>\n\u003Cp>If you want to use this map to get the entity type name from the entity type code you can use the following line of JavaScript:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"js\" class=\"wrap\" style=\"--ecMaxLine:80ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">Object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">keys\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Mscrm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityPropUtil\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityTypeName2CodeMap\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">).\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">filter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">function\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">key\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#C586C0\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Mscrm\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityPropUtil\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">EntityTypeName2CodeMap\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">key\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">===\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">10025\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">})[\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">];\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#76A162\">// \"wv_country\"\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Object.keys(Mscrm.EntityPropUtil.EntityTypeName2CodeMap).filter(function (key) {  return Mscrm.EntityPropUtil.EntityTypeName2CodeMap[key] === 10025;})[0];// &#x22;wv_country&#x22;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>It is that easy!\u003C/p>",{"headings":1315,"imagePaths":1328,"frontmatter":1293},[1316,1319,1322,1325],{"depth":780,"slug":1317,"text":1318},"form-javascript","Form JavaScript",{"depth":780,"slug":1320,"text":1321},"web-resource","Web Resource",{"depth":780,"slug":1323,"text":1324},"turbo-forms","Turbo Forms",{"depth":780,"slug":1326,"text":1327},"from-entity-type-code-to-entity-type-name","From entity type code to entity type name",[],"2015-09-04-responsive-pivot-headers-in-universal-windows-platform-apps",{"id":1329,"data":1331,"body":1345,"filePath":1346,"digest":1347,"rendered":1348},{"id":1332,"title":1333,"date":1334,"updated":1335,"author":15,"excerpt":1336,"layout":17,"permalink":1337,"image":1338,"categories":1339,"tags":1340,"draft":26},504,"Responsive Pivot Headers in Universal Windows Platform apps",["Date","2015-09-04T16:31:48.000Z"],["Date","2021-07-16T20:52:38.000Z"],"For a Universal Windows App I wanted to implement a Pivot. Reading the guidelines for tabs and pivots by Microsoft I got inspired by the examples given. However, no code samples are supplied so there is no indication how to actually create this in your own Xaml app.\nIn this blogpost I will show the different steps to get the basics done and I will supply the source code for you to use.\n","/2015/09/04/responsive-pivot-headers-in-universal-windows-platform-apps/","/wp-content/uploads/2015/09/post-2015-09-04-thumbnail.png",[183,240],[1341,1342,1343,1344,1047],"AdaptiveTrigger","RelativePanel","Responsive","UWP","For a Universal Windows App I wanted to implement a Pivot.\r\nReading the [guidelines for tabs and pivots](https://learn.microsoft.com/windows/apps/design/controls/tab-view) by Microsoft, I got inspired by the examples given.\r\n\r\nHowever, no code samples are supplied so there is no indication how to create this in your own Xaml app.\r\n\r\n\u003C!--more-->\r\n\r\nIn this article I will show the different steps to get the basics done and I will [supply the source code](#source-code) for you to use.\r\n\r\n## The examples\r\n\r\n### For mobile\r\n\r\n![Example design from pivot guidelines by Microsoft](/wp-content/uploads/2015/09/microsoft-guidelines-example.png)\r\n\r\n### For desktop\r\n\r\n![Example design for desktop from pivot guidelines by Microsoft](/wp-content/uploads/2015/09/microsoft-guidelines-example-wide.png)\r\n\r\n## The default Pivot\r\n\r\nThe default [`Pivot` control](https://learn.microsoft.com/uwp/api/Windows.UI.Xaml.Controls.Pivot?view=winrt-10240) looks just like the pivot we know from Windows Phone.\r\n\r\n```xml title=\"MainPage.xaml\"\r\n\u003CPivotItem Header=\"item 1\">\r\n    \u003CTextBlock>Content 1\u003C/TextBlock>\r\n\u003C/PivotItem>\r\n```\r\n\r\n![Default Pivot in a UWP app](/wp-content/uploads/2010/06/responsive-header-default.png)\r\n\r\n## Adding an icon to the header\r\n\r\nSo, the first step is to add an icon and do some styling. A bit lazy I used the [Pivot sample](https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/XamlPivot) from the Windows Universal Samples as a starting point.\r\n\r\n```xml title=\"MainPage.xaml\"\r\n\u003CPivotItem>\r\n    \u003CPivotItem.Header>\r\n        \u003Clocal:TabHeader Label=\"item 1\" Glyph=\"&#xE716;\" />\r\n    \u003C/PivotItem.Header>\r\n    \u003CTextBlock>Content 1\u003C/TextBlock>\r\n\u003C/PivotItem>\r\n```\r\n\r\n![Icon in Pivot Header with problem](/wp-content/uploads/2010/06/responsive-header-icon.png)\r\n\r\nImmediately we spot a problem. It seems the Pivot Header has a fixed height.\r\n\r\nBrowsing around I found a [MSDN forum post](https://web.archive.org/web/20230330110717/https://social.msdn.microsoft.com/Forums/en-US/8c123ae3-2884-4d40-a5d1-0a22355fcd5f/uwpxamlhow-to-increase-pivot-header-height-in-uwp?forum=wpdevelop&WT.mc_id=DT-MVP-5004268) and a [Stack Overflow question](https://stackoverflow.com/questions/31426175/how-to-increase-pivot-header-height-in-uwp) about this.\r\nBoth are resolved using code to adjust the height of the items.\r\n\r\nBecause we want a responsive solution where the height is not known beforehand, code is not the best option.\r\nLucky for us, Microsoft has added the Live Visual Tree tool in Visual Studio 2015 making it possible to debug what is happening in the app at runtime.\r\nThis shows that the [`PivotHeaderItem` control](https://learn.microsoft.com/uwp/api/Windows.UI.Xaml.Controls.Primitives.PivotHeaderItem?view=winrt-10240) has a default Style with a fixed height.\r\n\r\n![Visual Studio 2015 Live Visual Tree showing the fixed height from the default template](/wp-content/uploads/2015/09/visual-studio-2015-live-visual-tree.png)\r\n\r\nThe problem is that Visual Studio does not have any option to edit (a copy of) this template.\r\nSo, we have to get it the hard way.\r\n\r\nTo find the default template of every control and style in UWP apps we have to go to the following file:\r\n\r\n```plain frame=terminal\r\n%ProgramFiles(x86)%\\Windows Kits\\10\\DesignTime\\CommonConfiguration\\Neutral\\UAP\\\r\n10.0.10240.0\\Generic\\generic.xaml\r\n```\r\n\r\nLook for the PivotHeaderItem template and copy it to the Resources Dictionary for your preferred scope.  \r\nIn the Style we change the Height to `Auto`.\r\n\r\n```xml title=\"MainPage.xaml\"\r\n\u003CSetter Property=\"Height\" Value=\"Auto\" />\r\n```\r\n\r\nIf the height of your pivot header can be less than 36 you will also need the modify the height of the _Previous_ and _Next_ buttons in the Pivot Header as these have a fixed height too.\r\nThese changes are made in the Pivot Style.\r\n\r\n```xml title=\"MainPage.xaml\"\r\n\u003CButton x:Name=\"PreviousButton\" ... Height=\"Auto\" ... />\r\n\u003CButton x:Name=\"NextButton\" ... Height=\"Auto\"  ... />\r\n```\r\n\r\n### Create a copy of the Pivot Style\r\n\r\nIf you don’t know how to edit a copy of a Style, here are the 3 steps to follow:\r\n\r\n1. Select the Pivot in the \u003Ckbd>Document Outline\u003C/kbd>\r\n2. Right Click and select \u003Ckbd>Edit Template\u003C/kbd>\r\n3. Choose \u003Ckbd>Edit a Copy...\u003C/kbd>\r\n\r\n## Make the Pivot Header Item responsive\r\n\r\nFirst, I will list how I want the header items to respond:\r\n\r\n- If the app is narrow, the icon is centered above the label\r\n- If the app is wide, the label is on the right side of the icon\r\n- The transition from narrow to wide is at `500`\r\n\r\nGetting this working is quite easy in UWP apps without writing any code at all.  \r\nFor this we use the new [`AdaptiveTrigger` class](https://learn.microsoft.com/uwp/api/Windows.UI.Xaml.AdaptiveTrigger?view=winrt-10240) and the [`RelativePanel` control](https://learn.microsoft.com/uwp/api/Windows.UI.Xaml.Controls.RelativePanel?view=winrt-10240).\r\n\r\nWe alter the `TabHeader.xaml` adding a `RelativePanel` for layout and `VisualStates` for the transition. Something like this:\r\n\r\n```xml title=\"TabHeader.xaml\"\r\n\u003CVisualStateManager.VisualStateGroups>\r\n  \u003CVisualStateGroup>\r\n    \u003CVisualState x:Name=\"Narrow\">\r\n      \u003CVisualState.StateTriggers>\r\n        \u003CAdaptiveTrigger MinWindowWidth=\"0\" />\r\n      \u003C/VisualState.StateTriggers>\r\n      \u003CVisualState.Setters>\r\n        \u003CSetter Target=\"Icon.(RelativePanel.AlignHorizontalCenterWithPanel)\"\r\n                Value=\"True\" />\r\n        \u003CSetter Target=\"LabelText.(RelativePanel.Below)\"\r\n                Value=\"Icon\" />\r\n        \u003CSetter Target=\"LabelText.(RelativePanel.AlignHorizontalCenterWith)\"\r\n                Value=\"Icon\" />\r\n      \u003C/VisualState.Setters>\r\n    \u003C/VisualState>\r\n    \u003CVisualState x:Name=\"Wide\">\r\n      \u003CVisualState.StateTriggers>\r\n        \u003CAdaptiveTrigger MinWindowWidth=\"500\" />\r\n      \u003C/VisualState.StateTriggers>\r\n      \u003CVisualState.Setters>\r\n        \u003CSetter Target=\"Icon.(RelativePanel.AlignVerticalCenterWithPanel)\"\r\n                Value=\"True\" />\r\n        \u003CSetter Target=\"LabelText.(RelativePanel.RightOf)\"\r\n                Value=\"Icon\" />\r\n        \u003CSetter Target=\"LabelText.(RelativePanel.AlignVerticalCenterWith)\"\r\n                Value=\"Icon\" />\r\n        \u003CSetter Target=\"RelativePanel.Margin\"\r\n                Value=\"0,0,12,0\"/>\r\n        \u003CSetter Target=\"Icon.Margin\"\r\n                Value=\"0,0,0,0\"/>\r\n      \u003C/VisualState.Setters>\r\n    \u003C/VisualState>\r\n  \u003C/VisualStateGroup>\r\n\u003C/VisualStateManager.VisualStateGroups>\r\n\u003CRelativePanel x:Name=\"RelativePanel\">\r\n  \u003CFontIcon x:Name=\"Icon\"\r\n            HorizontalAlignment=\"Center\"\r\n            Margin=\"0,12,0,0\"\r\n            Glyph=\"{Binding Glyph}\"\r\n            FontSize=\"16\" />\r\n  \u003CTextBlock x:Name=\"LabelText\"\r\n             Text=\"{Binding Label}\"\r\n             Style=\"{StaticResource CaptionTextBlockStyle}\"\r\n             Margin=\"2,4,2,4\" />\r\n\u003C/RelativePanel>\r\n```\r\n\r\nRun the app and resize it so we see the pivot items change when it's wide enough.\r\n\r\n![Responsive Pivot Header Items](/wp-content/uploads/2015/09/responsive-header-wide.png)\r\n\r\n## Aligning the Pivot Header Items\r\n\r\nI like it when the pivot items are centered in the mobile layout.\r\nTo achieve this, we need to add the visual states to the pivot style.\r\n\r\nIf you do not have a pivot style already, look in the previous section how to create a copy of the style.\r\n\r\nWe add the Visual State Group the existing `VisualStateManager.VisualStateGroups` in the `RootElement` of the pivot `ControlTemplate`:\r\n\r\n```xml title=\"MainPage.xaml\"\r\n\u003CVisualStateGroup>\r\n  \u003CVisualState x:Name=\"Narrow\">\r\n    \u003CVisualState.StateTriggers>\r\n      \u003CAdaptiveTrigger MinWindowWidth=\"0\" />\r\n    \u003C/VisualState.StateTriggers>\r\n    \u003CVisualState.Setters>\r\n      \u003CSetter Target=\"HeaderClipper.HorizontalContentAlignment\"\r\n              Value=\"Center\" />\r\n    \u003C/VisualState.Setters>\r\n  \u003C/VisualState>\r\n  \u003CVisualState x:Name=\"Wide\">\r\n    \u003CVisualState.StateTriggers>\r\n      \u003CAdaptiveTrigger MinWindowWidth=\"500\" />\r\n    \u003C/VisualState.StateTriggers>\r\n    \u003CVisualState.Setters>\r\n      \u003CSetter Target=\"HeaderClipper.HorizontalContentAlignment\"\r\n              Value=\"Stretch\" />\r\n    \u003C/VisualState.Setters>\r\n  \u003C/VisualState>\r\n\u003C/VisualStateGroup>\r\n```\r\n\r\nNow the items are **centered** when the app is _narrow_; and **left-aligned** when the app is _wide_.\r\n\r\n![The Pivot Header Items centered](/wp-content/uploads/2015/09/responsive-header-aligned.png)\r\n\r\n## Source code\r\n\r\nYou can download my [Universal Windows Platform App sample project](https://github.com/eNeRGy164/DynamicPivot) on GitHub.","src/posts/2015-09-04-responsive-pivot-headers-in-universal-windows-platform-apps.md","ca2ea821ad2f376a",{"html":1349,"metadata":1350},"\u003Cp>For a Universal Windows App I wanted to implement a Pivot.\r\nReading the \u003Ca href=\"https://learn.microsoft.com/windows/apps/design/controls/tab-view?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">guidelines for tabs and pivots\u003Cspan>\u003C/span>\u003C/a> by Microsoft, I got inspired by the examples given.\u003C/p>\n\u003Cp>However, no code samples are supplied so there is no indication how to create this in your own Xaml app.\u003C/p>\n\u003C!--more-->\n\u003Cp>In this article I will show the different steps to get the basics done and I will \u003Ca href=\"#source-code\">supply the source code\u003C/a> for you to use.\u003C/p>\n\u003Ch2 id=\"the-examples\">The examples\u003C/h2>\n\u003Ch3 id=\"for-mobile\">For mobile\u003C/h3>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2015/09/microsoft-guidelines-example.webp\" type=\"image/webp\" media=\"(max-width: 240px)\">\u003Csource srcset=\"/wp-content/uploads/2015/09/microsoft-guidelines-example-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2015/09/microsoft-guidelines-example-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2015/09/microsoft-guidelines-example.png\" alt=\"Example design from pivot guidelines by Microsoft\" loading=\"lazy\" decoding=\"async\" width=\"240\" height=\"427\" srcset=\"/wp-content/uploads/2015/09/microsoft-guidelines-example.png 240w, /wp-content/uploads/2015/09/microsoft-guidelines-example-150x150.png 150w, /wp-content/uploads/2015/09/microsoft-guidelines-example-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Ch3 id=\"for-desktop\">For desktop\u003C/h3>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2015/09/microsoft-guidelines-example-wide.webp\" type=\"image/webp\" media=\"(max-width: 500px)\">\u003Csource srcset=\"/wp-content/uploads/2015/09/microsoft-guidelines-example-wide-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2015/09/microsoft-guidelines-example-wide-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2015/09/microsoft-guidelines-example-wide.png\" alt=\"Example design for desktop from pivot guidelines by Microsoft\" loading=\"lazy\" decoding=\"async\" width=\"500\" height=\"250\" srcset=\"/wp-content/uploads/2015/09/microsoft-guidelines-example-wide.png 500w, /wp-content/uploads/2015/09/microsoft-guidelines-example-wide-150x150.png 150w, /wp-content/uploads/2015/09/microsoft-guidelines-example-wide-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Ch2 id=\"the-default-pivot\">The default Pivot\u003C/h2>\n\u003Cp>The default \u003Ca href=\"https://learn.microsoft.com/uwp/api/Windows.UI.Xaml.Controls.Pivot?view=winrt-10240&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Pivot\u003C/code> control\u003Cspan>\u003C/span>\u003C/a> looks just like the pivot we know from Windows Phone.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">MainPage.xaml\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:36ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">PivotItem\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Header\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"item 1\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">TextBlock\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Content 1\u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">TextBlock\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">PivotItem\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003CPivotItem Header=&#x22;item 1&#x22;>    \u003CTextBlock>Content 1\u003C/TextBlock>\u003C/PivotItem>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2015/09/responsive-header-default.webp\" type=\"image/webp\" media=\"(max-width: 383px)\">\u003Cimg src=\"/wp-content/uploads/2015/09/responsive-header-default.png\" alt=\"Default Pivot in a UWP app\" loading=\"lazy\" decoding=\"async\" width=\"383\" height=\"111\" srcset=\"/wp-content/uploads/2015/09/responsive-header-default.png 383w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Ch2 id=\"adding-an-icon-to-the-header\">Adding an icon to the header\u003C/h2>\n\u003Cp>So, the first step is to add an icon and do some styling. A bit lazy I used the \u003Ca href=\"https://github.com/Microsoft/Windows-universal-samples/tree/master/Samples/XamlPivot\" rel=\"noopener noreferrer external\" target=\"_blank\">Pivot sample\u003Cspan>\u003C/span>\u003C/a> from the Windows Universal Samples as a starting point.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">MainPage.xaml\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:59ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">PivotItem\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">PivotItem.Header\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">local:TabHeader\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Label\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"item 1\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Glyph\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\u003C/span>\u003Cspan style=\"--0:#569CD6\">&#x26;#xE716;\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">PivotItem.Header\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">TextBlock\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Content 1\u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">TextBlock\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">PivotItem\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003CPivotItem>    \u003CPivotItem.Header>        \u003Clocal:TabHeader Label=&#x22;item 1&#x22; Glyph=&#x22;&#x26;#xE716;&#x22; />    \u003C/PivotItem.Header>    \u003CTextBlock>Content 1\u003C/TextBlock>\u003C/PivotItem>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2015/09/responsive-header-icon.webp\" type=\"image/webp\" media=\"(max-width: 383px)\">\u003Cimg src=\"/wp-content/uploads/2015/09/responsive-header-icon.png\" alt=\"Icon in Pivot Header with problem\" loading=\"lazy\" decoding=\"async\" width=\"383\" height=\"132\" srcset=\"/wp-content/uploads/2015/09/responsive-header-icon.png 383w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>Immediately we spot a problem. It seems the Pivot Header has a fixed height.\u003C/p>\n\u003Cp>Browsing around I found a \u003Ca href=\"https://web.archive.org/web/20230330110717/https://social.msdn.microsoft.com/Forums/en-US/8c123ae3-2884-4d40-a5d1-0a22355fcd5f/uwpxamlhow-to-increase-pivot-header-height-in-uwp?forum=wpdevelop&#x26;WT.mc_id=DT-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Cdfn>\u003Cabbr title=\"Microsoft Developer Network\">MSDN\u003C/abbr>\u003C/dfn> forum post\u003Cspan>\u003C/span>\u003C/a> and a \u003Ca href=\"https://stackoverflow.com/questions/31426175/how-to-increase-pivot-header-height-in-uwp\" rel=\"noopener noreferrer external\" target=\"_blank\">Stack Overflow question\u003Cspan>\u003C/span>\u003C/a> about this.\r\nBoth are resolved using code to adjust the height of the items.\u003C/p>\n\u003Cp>Because we want a responsive solution where the height is not known beforehand, code is not the best option.\r\nLucky for us, Microsoft has added the Live Visual Tree tool in Visual Studio 2015 making it possible to debug what is happening in the app at runtime.\r\nThis shows that the \u003Ca href=\"https://learn.microsoft.com/uwp/api/Windows.UI.Xaml.Controls.Primitives.PivotHeaderItem?view=winrt-10240&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>PivotHeaderItem\u003C/code> control\u003Cspan>\u003C/span>\u003C/a> has a default Style with a fixed height.\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2015/09/visual-studio-2015-live-visual-tree.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2015/09/visual-studio-2015-live-visual-tree.webp\" type=\"image/webp\" media=\"(max-width: 756px)\">\u003Csource srcset=\"/wp-content/uploads/2015/09/visual-studio-2015-live-visual-tree-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2015/09/visual-studio-2015-live-visual-tree-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2015/09/visual-studio-2015-live-visual-tree-636x453.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2015/09/visual-studio-2015-live-visual-tree-636x453.png\" alt=\"Visual Studio 2015 Live Visual Tree showing the fixed height from the default template\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"453\" srcset=\"/wp-content/uploads/2015/09/visual-studio-2015-live-visual-tree.png 756w, /wp-content/uploads/2015/09/visual-studio-2015-live-visual-tree-150x150.png 150w, /wp-content/uploads/2015/09/visual-studio-2015-live-visual-tree-185x185.png 185w, /wp-content/uploads/2015/09/visual-studio-2015-live-visual-tree-636x453.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003C/figure>\n\u003Cp>The problem is that Visual Studio does not have any option to edit (a copy of) this template.\r\nSo, we have to get it the hard way.\u003C/p>\n\u003Cp>To find the default template of every control and style in \u003Cdfn>\u003Cabbr title=\"Universal Windows Platform\">UWP\u003C/abbr>\u003C/dfn> apps we have to go to the following file:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:79ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">%ProgramFiles(x86)%\\Windows Kits\\10\\DesignTime\\CommonConfiguration\\Neutral\\UAP\\\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">10.0.10240.0\\Generic\\generic.xaml\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"%ProgramFiles(x86)%\\Windows Kits\\10\\DesignTime\\CommonConfiguration\\Neutral\\UAP\\10.0.10240.0\\Generic\\generic.xaml\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Look for the PivotHeaderItem template and copy it to the Resources Dictionary for your preferred scope.\u003Cbr>\nIn the Style we change the Height to \u003Ccode>Auto\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">MainPage.xaml\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:41ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Property\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Height\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Auto\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003CSetter Property=&#x22;Height&#x22; Value=&#x22;Auto&#x22; />\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>If the height of your pivot header can be less than 36 you will also need the modify the height of the \u003Cem>Previous\u003C/em> and \u003Cem>Next\u003C/em> buttons in the Pivot Header as these have a fixed height too.\r\nThese changes are made in the Pivot Style.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">MainPage.xaml\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:56ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Button\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"PreviousButton\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> ... \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Height\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Auto\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> ... \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Button\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"NextButton\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> ... \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Height\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Auto\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">  ... \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003CButton x:Name=&#x22;PreviousButton&#x22; ... Height=&#x22;Auto&#x22; ... />\u003CButton x:Name=&#x22;NextButton&#x22; ... Height=&#x22;Auto&#x22;  ... />\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"create-a-copy-of-the-pivot-style\">Create a copy of the Pivot Style\u003C/h3>\n\u003Cp>If you don’t know how to edit a copy of a Style, here are the 3 steps to follow:\u003C/p>\n\u003Col>\n\u003Cli>Select the Pivot in the \u003Ckbd>Document Outline\u003C/kbd>\u003C/li>\n\u003Cli>Right Click and select \u003Ckbd>Edit Template\u003C/kbd>\u003C/li>\n\u003Cli>Choose \u003Ckbd>Edit a Copy…\u003C/kbd>\u003C/li>\n\u003C/ol>\n\u003Ch2 id=\"make-the-pivot-header-item-responsive\">Make the Pivot Header Item responsive\u003C/h2>\n\u003Cp>First, I will list how I want the header items to respond:\u003C/p>\n\u003Cul>\n\u003Cli>If the app is narrow, the icon is centered above the label\u003C/li>\n\u003Cli>If the app is wide, the label is on the right side of the icon\u003C/li>\n\u003Cli>The transition from narrow to wide is at \u003Ccode>500\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Cp>Getting this working is quite easy in \u003Cabbr title=\"Universal Windows Platform\">UWP\u003C/abbr> apps without writing any code at all.\u003Cbr>\nFor this we use the new \u003Ca href=\"https://learn.microsoft.com/uwp/api/Windows.UI.Xaml.AdaptiveTrigger?view=winrt-10240&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>AdaptiveTrigger\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> and the \u003Ca href=\"https://learn.microsoft.com/uwp/api/Windows.UI.Xaml.Controls.RelativePanel?view=winrt-10240&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>RelativePanel\u003C/code> control\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>We alter the \u003Ccode>TabHeader.xaml\u003C/code> adding a \u003Ccode>RelativePanel\u003C/code> for layout and \u003Ccode>VisualStates\u003C/code> for the transition. Something like this:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">TabHeader.xaml\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:76ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualStateManager.VisualStateGroups\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualStateGroup\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Narrow\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.StateTriggers\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">AdaptiveTrigger\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">MinWindowWidth\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"0\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.StateTriggers\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.Setters\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Target\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Icon.(RelativePanel.AlignHorizontalCenterWithPanel)\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"True\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Target\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LabelText.(RelativePanel.Below)\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Icon\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Target\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LabelText.(RelativePanel.AlignHorizontalCenterWith)\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Icon\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.Setters\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Wide\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.StateTriggers\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">AdaptiveTrigger\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">MinWindowWidth\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"500\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.StateTriggers\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.Setters\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Target\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Icon.(RelativePanel.AlignVerticalCenterWithPanel)\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"True\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Target\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LabelText.(RelativePanel.RightOf)\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Icon\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Target\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LabelText.(RelativePanel.AlignVerticalCenterWith)\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Icon\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Target\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"RelativePanel.Margin\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"0,0,12,0\"\u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Target\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Icon.Margin\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"0,0,0,0\"\u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.Setters\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualStateGroup\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualStateManager.VisualStateGroups\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">RelativePanel\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"RelativePanel\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">FontIcon\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Icon\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">HorizontalAlignment\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Center\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Margin\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"0,12,0,0\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Glyph\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"{Binding Glyph}\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">FontSize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"16\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">TextBlock\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LabelText\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:13ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">             \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Text\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"{Binding Label}\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:13ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">             \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Style\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"{StaticResource CaptionTextBlockStyle}\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:13ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">             \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Margin\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2,4,2,4\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">RelativePanel\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003CVisualStateManager.VisualStateGroups>  \u003CVisualStateGroup>    \u003CVisualState x:Name=&#x22;Narrow&#x22;>      \u003CVisualState.StateTriggers>        \u003CAdaptiveTrigger MinWindowWidth=&#x22;0&#x22; />      \u003C/VisualState.StateTriggers>      \u003CVisualState.Setters>        \u003CSetter Target=&#x22;Icon.(RelativePanel.AlignHorizontalCenterWithPanel)&#x22;                Value=&#x22;True&#x22; />        \u003CSetter Target=&#x22;LabelText.(RelativePanel.Below)&#x22;                Value=&#x22;Icon&#x22; />        \u003CSetter Target=&#x22;LabelText.(RelativePanel.AlignHorizontalCenterWith)&#x22;                Value=&#x22;Icon&#x22; />      \u003C/VisualState.Setters>    \u003C/VisualState>    \u003CVisualState x:Name=&#x22;Wide&#x22;>      \u003CVisualState.StateTriggers>        \u003CAdaptiveTrigger MinWindowWidth=&#x22;500&#x22; />      \u003C/VisualState.StateTriggers>      \u003CVisualState.Setters>        \u003CSetter Target=&#x22;Icon.(RelativePanel.AlignVerticalCenterWithPanel)&#x22;                Value=&#x22;True&#x22; />        \u003CSetter Target=&#x22;LabelText.(RelativePanel.RightOf)&#x22;                Value=&#x22;Icon&#x22; />        \u003CSetter Target=&#x22;LabelText.(RelativePanel.AlignVerticalCenterWith)&#x22;                Value=&#x22;Icon&#x22; />        \u003CSetter Target=&#x22;RelativePanel.Margin&#x22;                Value=&#x22;0,0,12,0&#x22;/>        \u003CSetter Target=&#x22;Icon.Margin&#x22;                Value=&#x22;0,0,0,0&#x22;/>      \u003C/VisualState.Setters>    \u003C/VisualState>  \u003C/VisualStateGroup>\u003C/VisualStateManager.VisualStateGroups>\u003CRelativePanel x:Name=&#x22;RelativePanel&#x22;>  \u003CFontIcon x:Name=&#x22;Icon&#x22;            HorizontalAlignment=&#x22;Center&#x22;            Margin=&#x22;0,12,0,0&#x22;            Glyph=&#x22;{Binding Glyph}&#x22;            FontSize=&#x22;16&#x22; />  \u003CTextBlock x:Name=&#x22;LabelText&#x22;             Text=&#x22;{Binding Label}&#x22;             Style=&#x22;{StaticResource CaptionTextBlockStyle}&#x22;             Margin=&#x22;2,4,2,4&#x22; />\u003C/RelativePanel>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Run the app and resize it so we see the pivot items change when it’s wide enough.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2015/09/responsive-header-wide.webp\" type=\"image/webp\" media=\"(max-width: 500px)\">\u003Cimg src=\"/wp-content/uploads/2015/09/responsive-header-wide.png\" alt=\"Responsive Pivot Header Items\" loading=\"lazy\" decoding=\"async\" width=\"500\" height=\"99\" srcset=\"/wp-content/uploads/2015/09/responsive-header-wide.png 500w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Ch2 id=\"aligning-the-pivot-header-items\">Aligning the Pivot Header Items\u003C/h2>\n\u003Cp>I like it when the pivot items are centered in the mobile layout.\r\nTo achieve this, we need to add the visual states to the pivot style.\u003C/p>\n\u003Cp>If you do not have a pivot style already, look in the previous section how to create a copy of the style.\u003C/p>\n\u003Cp>We add the Visual State Group the existing \u003Ccode>VisualStateManager.VisualStateGroups\u003C/code> in the \u003Ccode>RootElement\u003C/code> of the pivot \u003Ccode>ControlTemplate\u003C/code>:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">MainPage.xaml\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:63ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualStateGroup\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Narrow\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.StateTriggers\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">AdaptiveTrigger\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">MinWindowWidth\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"0\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.StateTriggers\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.Setters\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Target\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"HeaderClipper.HorizontalContentAlignment\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:14ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">              \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Center\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.Setters\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Wide\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.StateTriggers\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">AdaptiveTrigger\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">MinWindowWidth\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"500\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.StateTriggers\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.Setters\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Target\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"HeaderClipper.HorizontalContentAlignment\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:14ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">              \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Stretch\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState.Setters\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualStateGroup\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003CVisualStateGroup>  \u003CVisualState x:Name=&#x22;Narrow&#x22;>    \u003CVisualState.StateTriggers>      \u003CAdaptiveTrigger MinWindowWidth=&#x22;0&#x22; />    \u003C/VisualState.StateTriggers>    \u003CVisualState.Setters>      \u003CSetter Target=&#x22;HeaderClipper.HorizontalContentAlignment&#x22;              Value=&#x22;Center&#x22; />    \u003C/VisualState.Setters>  \u003C/VisualState>  \u003CVisualState x:Name=&#x22;Wide&#x22;>    \u003CVisualState.StateTriggers>      \u003CAdaptiveTrigger MinWindowWidth=&#x22;500&#x22; />    \u003C/VisualState.StateTriggers>    \u003CVisualState.Setters>      \u003CSetter Target=&#x22;HeaderClipper.HorizontalContentAlignment&#x22;              Value=&#x22;Stretch&#x22; />    \u003C/VisualState.Setters>  \u003C/VisualState>\u003C/VisualStateGroup>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now the items are \u003Cstrong>centered\u003C/strong> when the app is \u003Cem>narrow\u003C/em>; and \u003Cstrong>left-aligned\u003C/strong> when the app is \u003Cem>wide\u003C/em>.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2015/09/responsive-header-aligned.webp\" type=\"image/webp\" media=\"(max-width: 492px)\">\u003Cimg src=\"/wp-content/uploads/2015/09/responsive-header-aligned.png\" alt=\"The Pivot Header Items centered\" loading=\"lazy\" decoding=\"async\" width=\"492\" height=\"143\" srcset=\"/wp-content/uploads/2015/09/responsive-header-aligned.png 492w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Ch2 id=\"source-code\">Source code\u003C/h2>\n\u003Cp>You can download my \u003Ca href=\"https://github.com/eNeRGy164/DynamicPivot\" rel=\"noopener noreferrer external\" target=\"_blank\">Universal Windows Platform App sample project\u003Cspan>\u003C/span>\u003C/a> on GitHub.\u003C/p>",{"headings":1351,"imagePaths":1377,"frontmatter":1331},[1352,1355,1358,1361,1364,1367,1370,1373,1376],{"depth":780,"slug":1353,"text":1354},"the-examples","The examples",{"depth":198,"slug":1356,"text":1357},"for-mobile","For mobile",{"depth":198,"slug":1359,"text":1360},"for-desktop","For desktop",{"depth":780,"slug":1362,"text":1363},"the-default-pivot","The default Pivot",{"depth":780,"slug":1365,"text":1366},"adding-an-icon-to-the-header","Adding an icon to the header",{"depth":198,"slug":1368,"text":1369},"create-a-copy-of-the-pivot-style","Create a copy of the Pivot Style",{"depth":780,"slug":1371,"text":1372},"make-the-pivot-header-item-responsive","Make the Pivot Header Item responsive",{"depth":780,"slug":1374,"text":1375},"aligning-the-pivot-header-items","Aligning the Pivot Header Items",{"depth":780,"slug":1056,"text":1057},[],"2011-03-11-make-your-browser-cache-the-output-of-an-httphandler",{"id":1378,"data":1380,"body":1395,"filePath":1396,"digest":1397,"rendered":1398},{"id":1381,"title":1382,"date":1383,"author":15,"excerpt":1384,"layout":17,"permalink":1385,"image":1386,"categories":1387,"tags":1388,"draft":26},230,"Make your browser cache the output of an HttpHandler",["Date","2011-03-11T13:30:36.000Z"],"Recently I worked on an HttpHandler implementation that is serving images from a backend system. Although everything seemed to work as expected it was discovered images were requested by the browser on every page refresh instead of caching the browser them locally. Together with my colleague Bert-Jan I investigated and solved the problem which will be explained in this post.\n","/2011/03/11/make-your-browser-cache-the-output-of-an-httphandler/","/wp-content/uploads/2011/03/post-230-thumnail-1.png",[183],[1389,1390,1391,658,1392,1393,1394],"200","304","Cache","HttpHandler","If-Modified-Since","Last-Modified","Recently I worked on an [`HttpHandler` implementation](https://learn.microsoft.com/dotnet/api/system.web.ihttphandler?view=netframework-4.0) that is serving images from a backend system.\r\nAlthough everything seemed to work as expected it was discovered images were requested by the browser on every page refresh instead of the browser caching them locally.\r\n\r\nTogether with [Bert-Jan](https://www.linkedin.com/in/bruuteuzius/),\r\nI investigated and solved the problem which will be explained in this article.\r\n\r\n\u003C!--more-->\r\n\r\n## The problem\r\n\r\nLet’s start with the original (simplified) code. This code gets the image from the backend system (in this case Content Management Server 2002) and serves it to the browser, or in case the resource is not available it will return \"[404 Not Found](https://en.wikipedia.org/wiki/HTTP_404)\".\r\n\r\n```csharp\r\npublic class ResourceHandler : IHttpHandler\r\n{\r\n  public void ProcessRequest(HttpContext context)\r\n  {\r\n    context.Response.Cache.SetCacheability(HttpCacheability.Public);\r\n    context.Response.Cache.SetMaxAge(new TimeSpan(1, 0, 0));\r\n\r\n    string imagePath = \"some path\";\r\n\r\n    Resource resource = CmsHttpContext.Current.RootResourceGallery\r\n                                    .GetByRelativePath(imagePath) as Resource;\r\n\r\n    if (resource == null)\r\n    {\r\n      // Resource not found\r\n      context.Response.StatusCode = 404;\r\n      return;\r\n    }\r\n\r\n    using (Stream stream = resource.OpenReadStream())\r\n    {\r\n      byte[] buffer = new byte[32];\r\n      while (stream.Read(buffer, 0, 32) &amp;gt; 0)\r\n      {\r\n        context.Response.BinaryWrite(buffer);\r\n      }\r\n    }\r\n  }\r\n\r\n  public bool IsReusable\r\n  {\r\n    get { return true; }\r\n  }\r\n}\r\n```\r\n\r\nEvery time the browser requested a resource it responded with the following headers and included the full image.\r\n\r\n```http\r\nHTTP/1.1 200 OK\r\nCache-Control: public\r\nContent-Length: 3488\r\nContent-Type: image/gif\r\nServer: Microsoft-IIS/6.0\r\nX-AspNet-Version: 2.0.50727\r\nCOMMERCE-SERVER-SOFTWARE: Microsoft Commerce Server, Enterprise Edition\r\nX-Powered-By: ASP.NET\r\nDate: Fri, 11 Mar 2011 10:51:08 GMT\r\n\r\nGIF89a... (the raw image)\r\n```\r\n\r\n## The cause\r\n\r\nFor some reason, the local browser cache was omitted.\r\nWe fired up [Fiddler](https://www.telerik.com/fiddler) and started comparing the headers to another source where an image was getting cached locally.\r\n\r\nOn the first request we discovered an additional header `Last Modified`:\r\n\r\n```http\r\nLast-Modified: Tue, 05 Jun 2007 15:19:48 GMT\r\n```\r\n\r\nThe second response we got to the same image resulted not in a `200 OK` but a `304 Not Modified` message.\r\n\r\n```http\r\nHTTP/1.1 304 Not Modified\r\nConnection: close\r\nDate: Fri, 11 Mar 2011 12:21:55 GMT\r\nServer: Microsoft-IIS/6.0\r\nX-Powered-By: ASP.NET\r\nX-AspNet-Version: 2.0.50727\r\nCache-Control: public\r\nLast-Modified: Tue, 05 Jun 2007 15:19:48 GMT\r\n```\r\n\r\n## The solution\r\n\r\nSo, the first thing missing was the `Last Modified` entry in our first response.\r\nWe added code to include this property.\r\n\r\n```csharp\r\ncontext.Response.Cache.SetLastModified(resource.LastModifiedDate);\r\n```\r\n\r\nBy adding the `Last Modified` date, the browser added a new entry to the second request of the image:\r\n\r\n```http\r\nIf-Modified-Since: Tue, 05 Jun 2007 15:19:48 GMT\r\n```\r\n\r\nBut the response was still the same \u003Csamp>200 OK\u003C/samp> with the complete image.\r\nAs it turned out you need to handle the `If-Modified-Since` yourself.\r\nWe added the following code to handle this.\r\n\r\n```csharp\r\nstring rawIfModifiedSince \r\n    = context.Request.Headers.Get(\"If-Modified-Since\");\r\n\r\nif (string.IsNullOrEmpty(rawIfModifiedSince))\r\n{\r\n  // Set Last Modified time\r\n  context.Response.Cache.SetLastModified(res.LastModifiedDate);\r\n}\r\nelse\r\n{\r\n  DateTime ifModifiedSince = DateTime.Parse(rawIfModifiedSince);\r\n\r\n  if (resource.LastModifiedDate == ifModifiedSince)\r\n  {\r\n    // The requested file has not changed\r\n    context.Response.StatusCode = 304;\r\n    return;\r\n  }\r\n}\r\n```\r\n\r\nAfter testing this again the image was still transmitted every time it was requested.\r\nA quick debug of the date compare revealed that the HTTP request date time does not contain milliseconds.\r\nThe following fix was applied.\r\n\r\n```csharp\r\nif (resource.LastModifiedDate.AddMilliseconds(\r\n                  -resource.LastModifiedDate.Millisecond) == ifModifiedSince)\r\n```\r\n\r\nNow every following request returned a \u003Csamp>304 Not Modified\u003C/samp> and saves us a lot of traffic and loading time!\r\n\r\n## Summary\r\n\r\nTo conclude this article, I give you the complete code:\r\n\r\n```csharp\r\nusing System;\r\n\r\npublic class ResourceHandler : IHttpHandler\r\n{\r\n  public void ProcessRequest(HttpContext context)\r\n  {\r\n    context.Response.Cache.SetCacheability(HttpCacheability.Public);\r\n    context.Response.Cache.SetMaxAge(new TimeSpan(1, 0, 0));\r\n\r\n    string imageName = \"some path\"\r\n\r\n    Resource resource = CmsHttpContext.Current.RootResourceGallery\r\n                                  .GetByRelativePath(imageName) as Resource;\r\n\r\n    if (resource == null)\r\n    {\r\n      // Resource not found\r\n      context.Response.StatusCode = 404;\r\n      return;\r\n    }\r\n\r\n    string rawIfModifiedSince = \r\n        context.Request.Headers.Get(\"If-Modified-Since\");\r\n    if (string.IsNullOrEmpty(rawIfModifiedSince))\r\n    {\r\n      // Set Last Modified time\r\n      context.Response.Cache.SetLastModified(resource.LastModifiedDate);\r\n    }\r\n    else\r\n    {\r\n      DateTime ifModifiedSince = DateTime.Parse(rawIfModifiedSince);\r\n\r\n      // HTTP does not provide milliseconds, so remove it from the comparison\r\n      if (resource.LastModifiedDate.AddMilliseconds(\r\n                  -resource.LastModifiedDate.Millisecond) == ifModifiedSince)\r\n      {\r\n          // The requested file has not changed\r\n          context.Response.StatusCode = 304;\r\n          return;\r\n      }\r\n    }\r\n\r\n    using (Stream stream = resource.OpenReadStream())\r\n    {\r\n      byte[] buffer = new byte[32];\r\n      while (stream.Read(buffer, 0, 32) &amp;gt; 0)\r\n      {\r\n          context.Response.BinaryWrite(buffer);\r\n      }\r\n    }\r\n  }\r\n\r\n  public bool IsReusable\r\n  {\r\n    get { return true; }\r\n  }\r\n}\r\n```","src/posts/2011-03-11-make-your-browser-cache-the-output-of-an-httphandler.md","e2db1934b05c959b",{"html":1399,"metadata":1400},"\u003Cp>Recently I worked on an \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.web.ihttphandler?view=netframework-4.0&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>HttpHandler\u003C/code> implementation\u003Cspan>\u003C/span>\u003C/a> that is serving images from a backend system.\r\nAlthough everything seemed to work as expected it was discovered images were requested by the browser on every page refresh instead of the browser caching them locally.\u003C/p>\n\u003Cp>Together with \u003Ca href=\"https://www.linkedin.com/in/bruuteuzius/\">Bert-Jan\u003C/a>,\r\nI investigated and solved the problem which will be explained in this article.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"the-problem\">The problem\u003C/h2>\n\u003Cp>Let’s start with the original (simplified) code. This code gets the image from the backend system (in this case Content Management Server 2002) and serves it to the browser, or in case the resource is not available it will return “\u003Ca href=\"https://en.wikipedia.org/wiki/HTTP_404\" rel=\"noopener noreferrer external\" target=\"_blank\">404 Not Found\u003Cspan>\u003C/span>\u003C/a>”.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:78ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">class\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ResourceHandler\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> : \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">IHttpHandler\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">void\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ProcessRequest\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">HttpContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Cache\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">SetCacheability\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">HttpCacheability\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Cache\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">SetMaxAge\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">TimeSpan\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">imagePath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"some path\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">CmsHttpContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Current\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">RootResourceGallery\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:36ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">                                    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetByRelativePath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">imagePath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#569CD6\">as\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">==\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#76A162\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#76A162\">// Resource not found\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">StatusCode\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">404\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#C586C0\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#C586C0\">using\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Stream\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">stream\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">OpenReadStream\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">())\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">byte\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[] \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">buffer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">byte\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">32\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">];\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#C586C0\">while\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">stream\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Read\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">buffer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">32\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">&#x26;\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">amp\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">gt\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">BinaryWrite\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">buffer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">bool\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">IsReusable\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#C586C0\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">true\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"public class ResourceHandler : IHttpHandler{  public void ProcessRequest(HttpContext context)  {    context.Response.Cache.SetCacheability(HttpCacheability.Public);    context.Response.Cache.SetMaxAge(new TimeSpan(1, 0, 0));    string imagePath = &#x22;some path&#x22;;    Resource resource = CmsHttpContext.Current.RootResourceGallery                                    .GetByRelativePath(imagePath) as Resource;    if (resource == null)    {      // Resource not found      context.Response.StatusCode = 404;      return;    }    using (Stream stream = resource.OpenReadStream())    {      byte[] buffer = new byte[32];      while (stream.Read(buffer, 0, 32) &#x26;amp;gt; 0)      {        context.Response.BinaryWrite(buffer);      }    }  }  public bool IsReusable  {    get { return true; }  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Every time the browser requested a resource it responded with the following headers and included the full image.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"http\" class=\"wrap\" style=\"--ecMaxLine:71ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">HTTP\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">/\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1.1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">200\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">OK\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">Cache-Control:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">public\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">Content-Length:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">3488\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">Content-Type:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">image/gif\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">Server:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Microsoft-IIS/6.0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">X-AspNet-Version:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">2.0.50727\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">COMMERCE-SERVER-SOFTWARE:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Microsoft Commerce Server, Enterprise Edition\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">X-Powered-By:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">ASP.NET\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">Date:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Fri, 11 Mar 2011 10:51:08 GMT\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">GIF89a... (the raw image)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"HTTP/1.1 200 OKCache-Control: publicContent-Length: 3488Content-Type: image/gifServer: Microsoft-IIS/6.0X-AspNet-Version: 2.0.50727COMMERCE-SERVER-SOFTWARE: Microsoft Commerce Server, Enterprise EditionX-Powered-By: ASP.NETDate: Fri, 11 Mar 2011 10:51:08 GMTGIF89a... (the raw image)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"the-cause\">The cause\u003C/h2>\n\u003Cp>For some reason, the local browser cache was omitted.\r\nWe fired up \u003Ca href=\"https://www.telerik.com/fiddler\" rel=\"noopener noreferrer external\" target=\"_blank\">Fiddler\u003Cspan>\u003C/span>\u003C/a> and started comparing the headers to another source where an image was getting cached locally.\u003C/p>\n\u003Cp>On the first request we discovered an additional header \u003Ccode>Last Modified\u003C/code>:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"http\" class=\"wrap\" style=\"--ecMaxLine:44ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">Last-Modified:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Tue, 05 Jun 2007 15:19:48 GMT\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Last-Modified: Tue, 05 Jun 2007 15:19:48 GMT\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>The second response we got to the same image resulted not in a \u003Ccode>200 OK\u003C/code> but a \u003Ccode>304 Not Modified\u003C/code> message.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"http\" class=\"wrap\" style=\"--ecMaxLine:44ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">HTTP\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">/\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1.1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">304\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Not Modified\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">Connection:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">close\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">Date:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Fri, 11 Mar 2011 12:21:55 GMT\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">Server:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Microsoft-IIS/6.0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">X-Powered-By:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">ASP.NET\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">X-AspNet-Version:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">2.0.50727\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">Cache-Control:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">public\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">Last-Modified:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Tue, 05 Jun 2007 15:19:48 GMT\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"HTTP/1.1 304 Not ModifiedConnection: closeDate: Fri, 11 Mar 2011 12:21:55 GMTServer: Microsoft-IIS/6.0X-Powered-By: ASP.NETX-AspNet-Version: 2.0.50727Cache-Control: publicLast-Modified: Tue, 05 Jun 2007 15:19:48 GMT\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"the-solution\">The solution\u003C/h2>\n\u003Cp>So, the first thing missing was the \u003Ccode>Last Modified\u003C/code> entry in our first response.\r\nWe added code to include this property.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:66ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Cache\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">SetLastModified\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LastModifiedDate\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"context.Response.Cache.SetLastModified(resource.LastModifiedDate);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>By adding the \u003Ccode>Last Modified\u003C/code> date, the browser added a new entry to the second request of the image:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"http\" class=\"wrap\" style=\"--ecMaxLine:48ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">If-Modified-Since:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Tue, 05 Jun 2007 15:19:48 GMT\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"If-Modified-Since: Tue, 05 Jun 2007 15:19:48 GMT\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>But the response was still the same \u003Csamp>200 OK\u003C/samp> with the complete image.\r\nAs it turned out you need to handle the \u003Ccode>If-Modified-Since\u003C/code> yourself.\r\nWe added the following code to handle this.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:64ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">rawIfModifiedSince\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Request\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Headers\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"If-Modified-Since\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsNullOrEmpty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">rawIfModifiedSince\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">))\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#76A162\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#76A162\">// Set Last Modified time\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Cache\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">SetLastModified\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">res\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LastModifiedDate\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">else\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">DateTime\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ifModifiedSince\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DateTime\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Parse\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">rawIfModifiedSince\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LastModifiedDate\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">==\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ifModifiedSince\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#76A162\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#76A162\">// The requested file has not changed\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">StatusCode\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">304\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#C586C0\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"string rawIfModifiedSince    = context.Request.Headers.Get(&#x22;If-Modified-Since&#x22;);if (string.IsNullOrEmpty(rawIfModifiedSince)){  // Set Last Modified time  context.Response.Cache.SetLastModified(res.LastModifiedDate);}else{  DateTime ifModifiedSince = DateTime.Parse(rawIfModifiedSince);  if (resource.LastModifiedDate == ifModifiedSince)  {    // The requested file has not changed    context.Response.StatusCode = 304;    return;  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>After testing this again the image was still transmitted every time it was requested.\r\nA quick debug of the date compare revealed that the \u003Cdfn>\u003Cabbr title=\"HyperText Transfer Protocol\">HTTP\u003C/abbr>\u003C/dfn> request date time does not contain milliseconds.\r\nThe following fix was applied.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:77ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LastModifiedDate\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">AddMilliseconds\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:18ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                  \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LastModifiedDate\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Millisecond\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">==\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ifModifiedSince\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"if (resource.LastModifiedDate.AddMilliseconds(                  -resource.LastModifiedDate.Millisecond) == ifModifiedSince)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now every following request returned a \u003Csamp>304 Not Modified\u003C/samp> and saves us a lot of traffic and loading time!\u003C/p>\n\u003Ch2 id=\"summary\">Summary\u003C/h2>\n\u003Cp>To conclude this article, I give you the complete code:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:77ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">using\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">System\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">class\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ResourceHandler\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> : \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">IHttpHandler\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">void\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ProcessRequest\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">HttpContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Cache\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">SetCacheability\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">HttpCacheability\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Cache\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">SetMaxAge\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">TimeSpan\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">imageName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"some path\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">CmsHttpContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Current\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">RootResourceGallery\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:34ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">                                  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetByRelativePath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">imageName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#569CD6\">as\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">==\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#76A162\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#76A162\">// Resource not found\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">StatusCode\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">404\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#C586C0\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">rawIfModifiedSince\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Request\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Headers\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"If-Modified-Since\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsNullOrEmpty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">rawIfModifiedSince\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">))\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#76A162\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#76A162\">// Set Last Modified time\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Cache\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">SetLastModified\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LastModifiedDate\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#C586C0\">else\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">DateTime\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ifModifiedSince\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DateTime\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Parse\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">rawIfModifiedSince\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#76A162\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#76A162\">// HTTP does not provide milliseconds, so remove it from the comparison\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LastModifiedDate\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">AddMilliseconds\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:18ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                  \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LastModifiedDate\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Millisecond\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">==\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ifModifiedSince\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#76A162\">          \u003C/span>\u003C/span>\u003Cspan style=\"--0:#76A162\">// The requested file has not changed\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">StatusCode\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">304\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#C586C0\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#C586C0\">using\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Stream\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">stream\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">resource\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">OpenReadStream\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">())\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">byte\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[] \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">buffer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">byte\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">32\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">];\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#C586C0\">while\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">stream\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Read\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">buffer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">32\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">&#x26;\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">amp\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">gt\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">BinaryWrite\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">buffer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">bool\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">IsReusable\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#C586C0\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">true\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"using System;public class ResourceHandler : IHttpHandler{  public void ProcessRequest(HttpContext context)  {    context.Response.Cache.SetCacheability(HttpCacheability.Public);    context.Response.Cache.SetMaxAge(new TimeSpan(1, 0, 0));    string imageName = &#x22;some path&#x22;    Resource resource = CmsHttpContext.Current.RootResourceGallery                                  .GetByRelativePath(imageName) as Resource;    if (resource == null)    {      // Resource not found      context.Response.StatusCode = 404;      return;    }    string rawIfModifiedSince =        context.Request.Headers.Get(&#x22;If-Modified-Since&#x22;);    if (string.IsNullOrEmpty(rawIfModifiedSince))    {      // Set Last Modified time      context.Response.Cache.SetLastModified(resource.LastModifiedDate);    }    else    {      DateTime ifModifiedSince = DateTime.Parse(rawIfModifiedSince);      // HTTP does not provide milliseconds, so remove it from the comparison      if (resource.LastModifiedDate.AddMilliseconds(                  -resource.LastModifiedDate.Millisecond) == ifModifiedSince)      {          // The requested file has not changed          context.Response.StatusCode = 304;          return;      }    }    using (Stream stream = resource.OpenReadStream())    {      byte[] buffer = new byte[32];      while (stream.Read(buffer, 0, 32) &#x26;amp;gt; 0)      {          context.Response.BinaryWrite(buffer);      }    }  }  public bool IsReusable  {    get { return true; }  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>",{"headings":1401,"imagePaths":1408,"frontmatter":1380},[1402,1403,1404,1405],{"depth":780,"slug":255,"text":256},{"depth":780,"slug":461,"text":462},{"depth":780,"slug":258,"text":259},{"depth":780,"slug":1406,"text":1407},"summary","Summary",[],"2015-10-20-hyper-v-vms-missing-in-windows-10-insiders-build-slow-ring",{"id":1409,"data":1411,"body":1422,"filePath":1423,"digest":1424,"rendered":1425},{"id":1412,"title":1413,"date":1414,"updated":1415,"author":15,"excerpt":1416,"layout":17,"permalink":1417,"image":1418,"categories":1419,"tags":1420,"draft":26},534,"Hyper-V VM’s missing in Windows 10 (Insiders Build, Slow Ring)",["Date","2015-10-20T07:03:15.000Z"],["Date","2020-12-06T18:31:49.000Z"],"My PC just got upgraded to the latest Windows 10 Insiders build (slow ring, build 10565) and suddenly a couple of VMs were missing from the Hyper-V Manager.\nI first suspected the security settings on the directories were the problem, but my changes didn't fix anything. After browsing around the internet, I found a couple of fixes that might help you if you have the same problem.\n","/2015/10/20/hyper-v-vms-missing-in-windows-10-insiders-build-slow-ring/","/wp-content/uploads/2015/10/post-2015-10-20-thumbnail.png",[293,1196],[1421],"Registry","My PC just got upgraded to the latest Windows 10 Insiders build (slow ring, build 10565) and suddenly a couple of VMs were missing from the Hyper-V Manager.\r\n\r\nI first suspected the security settings on the directories were the problem, but my changes didn't fix anything.\r\nAfter browsing around the internet, I found a couple of fixes that might help you if you have the same problem.\r\n\r\n\u003C!--more-->\r\n\r\n## Save your machine\r\n\r\nThe post [Windows 10 Preview - VMs Missing In Hyper-V Manager](https://blog.rmilne.ca/2014/10/16/windows-10-preview-vms-missing-in-hyper-v-manager/) by Rhoderick Milne shows he was still able to see the Virtual Machines using PowerShell.  \r\nHe got the Virtual Machines to show up again after saving them from the command line:\r\n\r\n```powershell\r\nGet-VM | Where { $_.State –eq \"Running\" }  | Save-VM\r\n```\r\n\r\n## Get a heartbeat\r\n\r\nAlthough he could see them again in the Hyper-V Manager, some were stuck when starting up.  \r\nThe problem is the integration service is reporting a corrupt heartbeat.\r\nHe fixed this by disabling the heartbeat service for these machines.\r\n\r\n```powershell\r\nGet-VM\r\n    | Where { $_.Heartbeat -eq \"OkApplicationsUnknown\" }\r\n    | Disable-VMIntegrationService Heartbeat\r\n```\r\n\r\n## Adjust the registry\r\n\r\nThe command was not sufficient for my situation.\r\nThe VMs were still missing.\r\n\r\nThen I ran across the article **PSA: Missing Hyper-V VMs on Windows 10 - Build 10547** by Ben Armstrong.  \r\nHe indicates that it's a registry problem in this build of Windows.\r\n\r\n```powershell\r\nSet-ItemProperty\r\n    -Path \"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Virtualization\"\r\n    -Name \"CurrentVmVersion\"\r\n    -Value \"6.2\"\r\n\r\nRestart-Service VMMS\r\n```\r\n\r\n## Conclusion\r\n\r\nThis fixed it for me.\r\n\r\nThree Simple PowerShell statements can rescue your VMs from oblivion on the Windows 10 preview.","src/posts/2015-10-20-hyper-v-vms-missing-in-windows-10-insiders-build-slow-ring.md","0584c4cf323c01d4",{"html":1426,"metadata":1427},"\u003Cp>My PC just got upgraded to the latest Windows 10 Insiders build (slow ring, build 10565) and suddenly a couple of VMs were missing from the Hyper-V Manager.\u003C/p>\n\u003Cp>I first suspected the security settings on the directories were the problem, but my changes didn’t fix anything.\r\nAfter browsing around the internet, I found a couple of fixes that might help you if you have the same problem.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"save-your-machine\">Save your machine\u003C/h2>\n\u003Cp>The post \u003Ca href=\"https://blog.rmilne.ca/2014/10/16/windows-10-preview-vms-missing-in-hyper-v-manager/\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows 10 Preview - VMs Missing In Hyper-V Manager\u003Cspan>\u003C/span>\u003C/a> by Rhoderick Milne shows he was still able to see the Virtual Machines using PowerShell.\u003Cbr>\nHe got the Virtual Machines to show up again after saving them from the command line:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:52ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">Get-VM\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#C586C0\">Where\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$_\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.State\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> –eq \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Running\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> }  \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Save-VM\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Get-VM | Where { $_.State –eq &#x22;Running&#x22; }  | Save-VM\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"get-a-heartbeat\">Get a heartbeat\u003C/h2>\n\u003Cp>Although he could see them again in the Hyper-V Manager, some were stuck when starting up.\u003Cbr>\nThe problem is the integration service is reporting a corrupt heartbeat.\r\nHe fixed this by disabling the heartbeat service for these machines.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:56ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">Get-VM\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#C586C0\">Where\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$_\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Heartbeat\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-eq\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"OkApplicationsUnknown\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Disable-VMIntegrationService\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> Heartbeat\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Get-VM    | Where { $_.Heartbeat -eq &#x22;OkApplicationsUnknown&#x22; }    | Disable-VMIntegrationService Heartbeat\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"adjust-the-registry\">Adjust the registry\u003C/h2>\n\u003Cp>The command was not sufficient for my situation.\r\nThe VMs were still missing.\u003C/p>\n\u003Cp>Then I ran across the article \u003Cstrong>PSA: Missing Hyper-V VMs on Windows 10 - Build 10547\u003C/strong> by Ben Armstrong.\u003Cbr>\nHe indicates that it’s a registry problem in this build of Windows.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:77ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">Set-ItemProperty\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Path \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Virtualization\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Name \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"CurrentVmVersion\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Value \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"6.2\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">Restart-Service\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> VMMS\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Set-ItemProperty    -Path &#x22;HKLM:\\SOFTWARE\\Microsoft\\Windows NT\\CurrentVersion\\Virtualization&#x22;    -Name &#x22;CurrentVmVersion&#x22;    -Value &#x22;6.2&#x22;Restart-Service VMMS\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"conclusion\">Conclusion\u003C/h2>\n\u003Cp>This fixed it for me.\u003C/p>\n\u003Cp>Three Simple PowerShell statements can rescue your VMs from oblivion on the Windows 10 preview.\u003C/p>",{"headings":1428,"imagePaths":1439,"frontmatter":1411},[1429,1432,1435,1438],{"depth":780,"slug":1430,"text":1431},"save-your-machine","Save your machine",{"depth":780,"slug":1433,"text":1434},"get-a-heartbeat","Get a heartbeat",{"depth":780,"slug":1436,"text":1437},"adjust-the-registry","Adjust the registry",{"depth":780,"slug":1149,"text":1150},[],"2016-02-11-my-road-to-mcsd-universal-windows-platform",{"id":1440,"data":1442,"body":1454,"filePath":1455,"digest":1456,"rendered":1457},{"id":1443,"title":1444,"date":1445,"updated":1446,"author":15,"excerpt":1447,"layout":17,"permalink":1448,"image":1449,"categories":1450,"tags":1451,"draft":26},863,"My road to MCSD: Universal Windows Platform",["Date","2016-02-11T15:36:59.000Z"],["Date","2021-07-16T20:49:52.000Z"],"Recently I got certified by Microsoft as Solutions Developer for the Windows Universal Platform by taking two exams that are currently in beta. Because the exams are in beta there is not much guidance to be found online. I noticed during the exams I was being tested on skills not mentioned on the Microsoft Learning web site.\nIn this post I’ll cover these differences and how I prepared for the exams so it’ll be easier for you to get certified.\n","/2016/02/11/my-road-to-mcsd-universal-windows-platform/","/wp-content/uploads/2016/02/post-863-thumbnail.png",[183,240],[86,1452,1453,1344],"Exam","MCSD","![MCSD Universal Windows Platform](/wp-content/uploads/2016/02/MCSD-UniversalWindowsPlatform-smaller-logo.png)\r\n\r\nRecently I got certified by Microsoft as Solutions Developer for the Windows Universal Platform by taking two exams that are currently in beta.\r\nBecause the exams are in beta there is not much guidance to be found online.\r\nI noticed during the exams I was being tested on skills not mentioned on the [Microsoft Learn](https://learn.microsoft.com/en-us/credentials/) web site.\r\n\r\nIn this article I will cover these differences and how I prepared for the exams so it will be easier for you to get certified.\r\n\r\n\u003C!--more-->\r\n\r\n> [!IMPORTANT] > **Disclaimer**  \r\n> Microsoft is constantly changing the exams, so my experience can differ from yours.\r\n> As UWP exams were in beta, the exams I took might not represent the exams in the future.  \r\n> Also, I will not go into detail about the actual questions in the exam.\r\n> This is prohibited by the [NDA](https://learn.microsoft.com/credentials/support/certification-exam-candidate-agreement) we all sign at the start of an exam.\r\n\r\n## MCSD: Universal Windows Platform\r\n\r\nAccording to the certification website with this certification you:\r\n\r\n> Demonstrate your expertise at planning the designing and implementing of Universal Windows Platform apps that offer a compelling user experience, leverage other services and devices, and use best coding practices to enhance maintainability.\r\n\r\nThe certification covers a total of three exams. One exam that has been around for a couple of years and the two beta exams I mentioned earlier.\r\n\r\n## Exam 70-483: Programming in C#\r\n\r\n![Microsoft Specialist Programming in C-Sharp](/wp-content/uploads/2016/02/MS-CSharp-smaller-logo.png)\r\n\r\nPassing this exam will give you the Microsoft Specialist certification.\r\n\r\nThis certification will count towards other MCSA and MCSD certification:\r\n\r\n- Microsoft Certified Solutions Associate: SQL Server 2012\r\n- Microsoft Certified Solutions Developer: SharePoint Applications\r\n- Microsoft Certified Solutions Developer: Web Applications\r\n- Microsoft Certified Solutions Developer: Windows Store Apps Using C#\r\n\r\nAs I passed this exam back in december 2013 I can't offer you any actual insights into additional measured skills.\r\nSo, I will only give you the link to [the skills measured for exam 70-483](https://learn.microsoft.com/credentials/certifications/exams/70-483/).\r\n\r\n## Exam 70-354: Universal Windows Platform – App Architecture and UX/UI\r\n\r\n> This exam validates a candidate’s knowledge and skills for planning the development of Universal Windows Platform apps and designing and implementing a compelling user experience.\r\n\r\nThis exam is quite broad. As it covers everything from designing the app to the application lifecycle management of your app.  \r\nThe skills measured for exam 70-354 are listed on the website.\r\n\r\nAdditional skills that can be tested:\r\n\r\n- Choose between version control systems.\r\n  For example, Team Foundation Server, Visual Studio Team Services and GitHub\r\n- Implement optimistic concurrency in your data layer\r\n- Enable beta testing of your app\r\n- Publish the app to the store\r\n\r\n## Exam 70-355: Universal Windows Platform – App Data, Services, and Coding Patterns\r\n\r\n> This exam validates a candidate’s knowledge and skills for implementing apps that leverage other services and devices and that use best coding practices to enhance maintainability.\r\n\r\nThis exam is more limited to the developer role.\r\nIt covers everything related to developing code, but not limited only to application development.  \r\nThe skills measured for exam 70-355 are listed on the website.\r\n\r\nAdditional skills that can be tested:\r\n\r\n- Execute code reviews\r\n\r\n## Preparation\r\n\r\nTo prepare for the exam I used the free online training provided at the [Microsoft Virtual Academy](https://mva.microsoft.com).  \r\nThe courses I followed were:\r\n\r\n- [Windows 10 Development for Absolute Beginners](https://mva.microsoft.com/en-US/training-courses/windows-10-development-for-absolute-beginners-14541)\r\n- [Windows 10: Getting Started with UWP](https://mva.microsoft.com/en-US/training-courses/windows-10-getting-started-with-uwp-14431)\r\n- [Windows 10: App Patterns and Navigation](https://mva.microsoft.com/en-US/training-courses/windows-10-app-patterns-and-navigation-14577)\r\n- [Windows 10: Managing the App Lifecycle](https://mva.microsoft.com/en-US/training-courses/windows-10-managing-the-app-lifecycle-14578)\r\n- [Windows 10: Data Binding](https://mva.microsoft.com/en-US/training-courses/windows-10-data-binding-14579)\r\n- [Windows 10: Developing Responsive and Adaptive UIs](https://mva.microsoft.com/en-US/training-courses/windows-10-developing-responsive-and-adaptive-uis-14584)\r\n- [Windows 10: Live Tiles and Notifications](https://mva.microsoft.com/en-US/training-courses/windows-10-live-tiles-and-notifications-14585)\r\n- [Windows 10: Inking and the InkCanvas](https://mva.microsoft.com/en-US/training-courses/windows-10-inking-and-the-inkcanvas-14586)\r\n- [Windows 10: Speech Recognition and Cortana Integration](https://mva.microsoft.com/en-US/training-courses/windows-10-speech-recognition-and-cortana-integration-14587)\r\n- [XAML for Windows 10: Layout](https://mva.microsoft.com/en-US/training-courses/xaml-for-windows-10-layout-14328)\r\n- [XAML for Windows 10: Controls](https://mva.microsoft.com/en-US/training-courses/xaml-for-windows-10-controls-14482)\r\n- [XAML for Windows 10: Items Controls](https://mva.microsoft.com/en-US/training-courses/xaml-for-windows-10-items-controls-14483)\r\n\r\n## Conclusion\r\n\r\nWhat I found surprising was that a lot of questions were not about UWP app development itself but focusing on the surrounding challenges and technologies.\r\nLike:\r\n\r\n- Working in a team\r\n- Sharing and reviewing code\r\n- Using back-end services like Azure\r\n- Using and connecting with technologies not owned by Microsoft like GitHub, SQLite and MongoDB\r\n\r\nSo, passing the exams will show that you are not only able to write an app.\r\nBut also, that you can do with a team, an appropriate lifecycle and utilizing external data sources.\r\n\r\n## Beta bonus: Charter member\r\n\r\nIf you do the exams while they are beta you will find a bonus notation in the certification title on your transcript:\r\n\r\n![MCSD Charter notation](/wp-content/uploads/2016/02/MCSD-Charter.png)\r\n\r\nThis is explained at the end of the transcript.\r\n\r\n> \\*Charter - Certification that was achieved within six months following the retail release date of the certification.\r\n> Charter Members are recognized by being given the Charter version of the certificate acknowledging their early adoption of the technology solution.","src/posts/2016-02-11-my-road-to-mcsd-universal-windows-platform.md","f285a0379ebaa837",{"html":1458,"metadata":1459},"\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2016/02/MCSD-UniversalWindowsPlatform-smaller-logo.webp\" type=\"image/webp\" media=\"(max-width: 112px)\">\u003Cimg src=\"/wp-content/uploads/2016/02/MCSD-UniversalWindowsPlatform-smaller-logo.png\" alt=\"MCSD Universal Windows Platform\" loading=\"lazy\" decoding=\"async\" width=\"112\" height=\"95\" srcset=\"/wp-content/uploads/2016/02/MCSD-UniversalWindowsPlatform-smaller-logo.png 112w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>Recently I got certified by Microsoft as Solutions Developer for the Windows Universal Platform by taking two exams that are currently in beta.\r\nBecause the exams are in beta there is not much guidance to be found online.\r\nI noticed during the exams I was being tested on skills not mentioned on the \u003Ca href=\"https://learn.microsoft.com/en-us/credentials/?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Microsoft Learn\u003Cspan>\u003C/span>\u003C/a> web site.\u003C/p>\n\u003Cp>In this article I will cover these differences and how I prepared for the exams so it will be easier for you to get certified.\u003C/p>\n\u003C!--more-->\n\u003Cblockquote>\n\u003Cp>[!IMPORTANT] > \u003Cstrong>Disclaimer\u003C/strong>\u003Cbr>\nMicrosoft is constantly changing the exams, so my experience can differ from yours.\r\nAs \u003Cdfn>\u003Cabbr title=\"Universal Windows Platform\">UWP\u003C/abbr>\u003C/dfn> exams were in beta, the exams I took might not represent the exams in the future.\u003Cbr>\nAlso, I will not go into detail about the actual questions in the exam.\r\nThis is prohibited by the \u003Ca href=\"https://learn.microsoft.com/credentials/support/certification-exam-candidate-agreement?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Cdfn>\u003Cabbr title=\"Non-Disclosure Agreement\">NDA\u003C/abbr>\u003C/dfn>\u003Cspan>\u003C/span>\u003C/a> we all sign at the start of an exam.\u003C/p>\n\u003C/blockquote>\n\u003Ch2 id=\"mcsd-universal-windows-platform\">\u003Cdfn>\u003Cabbr title=\"Microsoft Certified Solutions Developer\">MCSD\u003C/abbr>\u003C/dfn>: Universal Windows Platform\u003C/h2>\n\u003Cp>According to the certification website with this certification you:\u003C/p>\n\u003Cblockquote>\n\u003Cp>Demonstrate your expertise at planning the designing and implementing of Universal Windows Platform apps that offer a compelling user experience, leverage other services and devices, and use best coding practices to enhance maintainability.\u003C/p>\n\u003C/blockquote>\n\u003Cp>The certification covers a total of three exams. One exam that has been around for a couple of years and the two beta exams I mentioned earlier.\u003C/p>\n\u003Ch2 id=\"exam-70-483-programming-in-c\">Exam 70-483: Programming in C#\u003C/h2>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2016/02/MS-CSharp-smaller-logo.webp\" type=\"image/webp\" media=\"(max-width: 112px)\">\u003Cimg src=\"/wp-content/uploads/2016/02/MS-CSharp-smaller-logo.png\" alt=\"Microsoft Specialist Programming in C-Sharp\" loading=\"lazy\" decoding=\"async\" width=\"112\" height=\"71\" srcset=\"/wp-content/uploads/2016/02/MS-CSharp-smaller-logo.png 112w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>Passing this exam will give you the Microsoft Specialist certification.\u003C/p>\n\u003Cp>This certification will count towards other \u003Cdfn>\u003Cabbr title=\"Microsoft Certified Solutions Associate\">MCSA\u003C/abbr>\u003C/dfn> and \u003Cabbr title=\"Microsoft Certified Solutions Developer\">MCSD\u003C/abbr> certification:\u003C/p>\n\u003Cul>\n\u003Cli>Microsoft Certified Solutions Associate: \u003Cdfn>\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr>\u003C/dfn> Server 2012\u003C/li>\n\u003Cli>Microsoft Certified Solutions Developer: SharePoint Applications\u003C/li>\n\u003Cli>Microsoft Certified Solutions Developer: Web Applications\u003C/li>\n\u003Cli>Microsoft Certified Solutions Developer: Windows Store Apps Using C#\u003C/li>\n\u003C/ul>\n\u003Cp>As I passed this exam back in december 2013 I can’t offer you any actual insights into additional measured skills.\r\nSo, I will only give you the link to \u003Ca href=\"https://learn.microsoft.com/credentials/certifications/exams/70-483/?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">the skills measured for exam 70-483\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Ch2 id=\"exam-70-354-universal-windows-platform--app-architecture-and-uxui\">Exam 70-354: Universal Windows Platform – App Architecture and \u003Cdfn>\u003Cabbr title=\"User Experience\">UX\u003C/abbr>\u003C/dfn>/\u003Cdfn>\u003Cabbr title=\"User Interface\">UI\u003C/abbr>\u003C/dfn>\u003C/h2>\n\u003Cblockquote>\n\u003Cp>This exam validates a candidate’s knowledge and skills for planning the development of Universal Windows Platform apps and designing and implementing a compelling user experience.\u003C/p>\n\u003C/blockquote>\n\u003Cp>This exam is quite broad. As it covers everything from designing the app to the application lifecycle management of your app.\u003Cbr>\nThe skills measured for exam 70-354 are listed on the website.\u003C/p>\n\u003Cp>Additional skills that can be tested:\u003C/p>\n\u003Cul>\n\u003Cli>Choose between version control systems.\r\nFor example, Team Foundation Server, Visual Studio Team Services and GitHub\u003C/li>\n\u003Cli>Implement optimistic concurrency in your data layer\u003C/li>\n\u003Cli>Enable beta testing of your app\u003C/li>\n\u003Cli>Publish the app to the store\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"exam-70-355-universal-windows-platform--app-data-services-and-coding-patterns\">Exam 70-355: Universal Windows Platform – App Data, Services, and Coding Patterns\u003C/h2>\n\u003Cblockquote>\n\u003Cp>This exam validates a candidate’s knowledge and skills for implementing apps that leverage other services and devices and that use best coding practices to enhance maintainability.\u003C/p>\n\u003C/blockquote>\n\u003Cp>This exam is more limited to the developer role.\r\nIt covers everything related to developing code, but not limited only to application development.\u003Cbr>\nThe skills measured for exam 70-355 are listed on the website.\u003C/p>\n\u003Cp>Additional skills that can be tested:\u003C/p>\n\u003Cul>\n\u003Cli>Execute code reviews\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"preparation\">Preparation\u003C/h2>\n\u003Cp>To prepare for the exam I used the free online training provided at the \u003Ca href=\"https://mva.microsoft.com\" rel=\"noopener noreferrer external\" target=\"_blank\">Microsoft Virtual Academy\u003Cspan>\u003C/span>\u003C/a>.\u003Cbr>\nThe courses I followed were:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ca href=\"https://mva.microsoft.com/en-US/training-courses/windows-10-development-for-absolute-beginners-14541\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows 10 Development for Absolute Beginners\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://mva.microsoft.com/en-US/training-courses/windows-10-getting-started-with-uwp-14431\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows 10: Getting Started with \u003Cabbr title=\"Universal Windows Platform\">UWP\u003C/abbr>\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://mva.microsoft.com/en-US/training-courses/windows-10-app-patterns-and-navigation-14577\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows 10: App Patterns and Navigation\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://mva.microsoft.com/en-US/training-courses/windows-10-managing-the-app-lifecycle-14578\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows 10: Managing the App Lifecycle\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://mva.microsoft.com/en-US/training-courses/windows-10-data-binding-14579\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows 10: Data Binding\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://mva.microsoft.com/en-US/training-courses/windows-10-developing-responsive-and-adaptive-uis-14584\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows 10: Developing Responsive and Adaptive UIs\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://mva.microsoft.com/en-US/training-courses/windows-10-live-tiles-and-notifications-14585\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows 10: Live Tiles and Notifications\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://mva.microsoft.com/en-US/training-courses/windows-10-inking-and-the-inkcanvas-14586\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows 10: Inking and the InkCanvas\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://mva.microsoft.com/en-US/training-courses/windows-10-speech-recognition-and-cortana-integration-14587\" rel=\"noopener noreferrer external\" target=\"_blank\">Windows 10: Speech Recognition and Cortana Integration\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://mva.microsoft.com/en-US/training-courses/xaml-for-windows-10-layout-14328\" rel=\"noopener noreferrer external\" target=\"_blank\">XAML for Windows 10: Layout\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://mva.microsoft.com/en-US/training-courses/xaml-for-windows-10-controls-14482\" rel=\"noopener noreferrer external\" target=\"_blank\">XAML for Windows 10: Controls\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003Cli>\u003Ca href=\"https://mva.microsoft.com/en-US/training-courses/xaml-for-windows-10-items-controls-14483\" rel=\"noopener noreferrer external\" target=\"_blank\">XAML for Windows 10: Items Controls\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"conclusion\">Conclusion\u003C/h2>\n\u003Cp>What I found surprising was that a lot of questions were not about \u003Cabbr title=\"Universal Windows Platform\">UWP\u003C/abbr> app development itself but focusing on the surrounding challenges and technologies.\r\nLike:\u003C/p>\n\u003Cul>\n\u003Cli>Working in a team\u003C/li>\n\u003Cli>Sharing and reviewing code\u003C/li>\n\u003Cli>Using back-end services like Azure\u003C/li>\n\u003Cli>Using and connecting with technologies not owned by Microsoft like GitHub, SQLite and MongoDB\u003C/li>\n\u003C/ul>\n\u003Cp>So, passing the exams will show that you are not only able to write an app.\r\nBut also, that you can do with a team, an appropriate lifecycle and utilizing external data sources.\u003C/p>\n\u003Ch2 id=\"beta-bonus-charter-member\">Beta bonus: Charter member\u003C/h2>\n\u003Cp>If you do the exams while they are beta you will find a bonus notation in the certification title on your transcript:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2016/02/MCSD-Charter.webp\" type=\"image/webp\" media=\"(max-width: 628px)\">\u003Cimg src=\"/wp-content/uploads/2016/02/MCSD-Charter.png\" alt=\"MCSD Charter notation\" loading=\"lazy\" decoding=\"async\" width=\"628\" height=\"92\" srcset=\"/wp-content/uploads/2016/02/MCSD-Charter.png 628w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>This is explained at the end of the transcript.\u003C/p>\n\u003Cblockquote>\n\u003Cp>*Charter - Certification that was achieved within six months following the retail release date of the certification.\r\nCharter Members are recognized by being given the Charter version of the certificate acknowledging their early adoption of the technology solution.\u003C/p>\n\u003C/blockquote>",{"headings":1460,"imagePaths":1480,"frontmatter":1442},[1461,1464,1467,1470,1473,1476,1477],{"depth":780,"slug":1462,"text":1463},"mcsd-universal-windows-platform","MCSD: Universal Windows Platform",{"depth":780,"slug":1465,"text":1466},"exam-70-483-programming-in-c","Exam 70-483: Programming in C#",{"depth":780,"slug":1468,"text":1469},"exam-70-354-universal-windows-platform--app-architecture-and-uxui","Exam 70-354: Universal Windows Platform – App Architecture and UX/UI",{"depth":780,"slug":1471,"text":1472},"exam-70-355-universal-windows-platform--app-data-services-and-coding-patterns","Exam 70-355: Universal Windows Platform – App Data, Services, and Coding Patterns",{"depth":780,"slug":1474,"text":1475},"preparation","Preparation",{"depth":780,"slug":1149,"text":1150},{"depth":780,"slug":1478,"text":1479},"beta-bonus-charter-member","Beta bonus: Charter member",[],"2015-11-06-json-on-a-diet-how-to-shrink-your-dtos-part-1-default-value-handling",{"id":1481,"data":1483,"body":1499,"filePath":1500,"digest":1501,"rendered":1502},{"id":1484,"title":1485,"date":1486,"updated":1487,"author":15,"excerpt":1488,"layout":17,"permalink":1489,"image":1490,"categories":1491,"tags":1492,"draft":26},564,"JSON on a diet… how to shrink your DTO’s – Part 1: Default Value Handling",["Date","2015-11-06T14:08:38.000Z"],["Date","2021-07-16T20:51:18.000Z"],"These days JSON is used a lot. For storing data, for storing settings, for describing other JSON files, and often for transporting information between server and client using DTOs (Data Transfer Objects).\nRecently I was monitoring the data transferred from one of my own Web API controllers to a mobile app. I discovered the amount of data transferred was way more then expected. This inspired me try to reduce the size of the transferred data. In this and following blog posts I will describe the different options you can use and combine.\nYou can download the source code at the end of my article.\n","/2015/11/06/json-on-a-diet-how-to-shrink-your-dtos-part-1-default-value-handling/","/wp-content/uploads/2015/11/post-2015-11-06-thumbnail.png",[183],[1493,1494,1495,1496,1497,1498],"ASP.NET","DefaultValue","JSON","JSON.NET","Mobile App Service","Web API","These days [JSON](https://en.wikipedia.org/wiki/JSON) is used a lot.\r\nFor storing data, for storing settings, for describing other JSON files, and often for transporting information between server and client using DTOs ([Data Transfer Objects](https://en.wikipedia.org/wiki/Data_transfer_object)).\r\n\r\nWhen using an [Azure Mobile App Service](https://azure.microsoft.com/en-us/services/app-service/mobile?WT.mc_id=DT-MVP-5004268) or [ASP.NET Web API](https://dotnet.microsoft.com/apps/aspnet/apis) you will see that JSON is the default format to transport data.\r\nWhen running apps on a PCs with a fixed internet connection data size might not be a hot topic.\r\nBut for apps on mobile devices, possibly using slow, limited, or expensive connections you want to save on the amount of data that is transferred.\r\n\r\n\u003C!--more-->\r\n\r\nRecently I was monitoring the data transferred from one of my own Web API controllers to a mobile app.\r\nI discovered the amount of data transferred was more than expected.\r\n\r\nThis inspired me try to reduce the size of the transferred data.\r\nIn this and following articles I will describe the different options you can use and combine.\r\n\r\nYou can download the source code at [the end of my article](#source-code).\r\n\r\n## Part 1: Default Value Handling\r\n\r\nI created an ASP.NET Web API controller to demonstrate the default behavior.\r\nThe default controller returns two objects with data, some properties are empty.\r\n\r\nA `GET` request to `http://reducejsontraffic.azurewebsites.net/api/default` returns:\r\n\r\n```json\r\n[\r\n  {\r\n    \"AString\": null,\r\n    \"AnInt\": 0,\r\n    \"Fourteen\": 14,\r\n    \"ANullableByte\": null,\r\n    \"AStringArray\": null,\r\n    \"NoUri\": null,\r\n    \"SomeUri\": \"http://reducejsontraffic.azurewebsites.net/api/\",\r\n    \"TheDate\": \"2015-11-05T17:11:29.0809876+00:00\",\r\n    \"AnEmptyDate\": \"0001-01-01T00:00:00\",\r\n    \"AFixedDate\": \"2015-07-02T13:14:00+00:00\",\r\n    \"SingleObject\": null,\r\n    \"SomeEmptyObjects\": [],\r\n    \"SomeObjects\": [\r\n        { \"ADouble\": 0 },\r\n        { \"ADouble\": 3.14 },\r\n        { \"ADouble\": 1.23456789 }\r\n    ]\r\n  },\r\n  ...\r\n]\r\n```\r\n\r\n\u003Csmall>(Formatted for readability)\u003C/small>\r\n\r\nAs you can see every property is present, despite it does not have a real value.\r\n\r\nIn ASP.NET Web API, Microsoft has chosen to use the [JSON.net](https://www.newtonsoft.com/json) serializer.\r\nThe serializer has a setting called [DefaultValueHandling](https://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_DefaultValueHandling.htm) which is set to `Include` by default.\r\nTo quote the documentation:\r\n\r\n> Include members where the member value is the same as the member's default value when serializing objects.\r\n> Included members are written to JSON.\r\n> Has no effect when deserializing.\r\n\r\nAnd we can confirm this is the case when we look at the result from the first example.\r\n\r\nIf a property already gets the default value when deserializing, why would we want to transport that value anyway?\r\n\r\n## Changing the Default Value Handling\r\n\r\nAnother option for `DefaultValueHandling` is `Ignore` (and for the serializing part `IgnoreAndPopulate` acts the same).\r\nThe documentation states:\r\n\r\n> Ignore members where the member value is the same as the member's default value when serializing objects so that it is not written to JSON.\r\n> This option will ignore all default values (e.g., `null` for objects and nullable types; `0` for integers, decimals, and floating-point numbers; and `false` for booleans).\r\n> The default value ignored can be changed by placing the DefaultValueAttribute on the property.\r\n\r\nSo, when we set this option properties with default values will be removed from the data transferred.\r\n\r\nThe documentation also mentions the [`DefaultValueAttribute` attribute](https://learn.microsoft.com/dotnet/api/system.componentmodel.defaultvalueattribute?view=netframework-4.7).\r\nSo, we can describe a different default for a property.\r\n\r\n```csharp title=\"Message.cs\" showlinenumbers startlinenumber=19\r\n[DefaultValue(14)]\r\npublic int Fourteen { get; set; }\r\n```\r\n\r\nNow the property `Fourteen` will only get serialized when its value is not `14`.\r\n\r\nI created a second controller with the modified setting. This controller demonstrates this new behavior.\r\n\r\nA `GET` request to `http://reducejsontraffic.azurewebsites.net/api/defaultvaluehandling` returns:\r\n\r\n```json\r\n[\r\n  {\r\n    \"SomeUri\": \"http://reducejsontraffic.azurewebsites.net/api/\",\r\n    \"TheDate\": \"2015-11-05T17:30:02.3206122+00:00\",\r\n    \"AFixedDate\": \"2015-07-02T13:14:00+00:00\",\r\n    \"SomeEmptyObjects\": [],\r\n    \"SomeObjects\": [\r\n        { \"ADouble\": 0 },\r\n        {},\r\n        { \"ADouble\": 1.23456789 }\r\n    ]\r\n  },\r\n  ...\r\n]\r\n```\r\n\r\n\u003Csmall>(Formatted for readability)\u003C/small>\r\n\r\nThat's quite a reduction! But are all values recovered after deserialization?\r\n\r\nYes, if we didn't use the `DefaultValueAttribute` anywhere in our DTO it will work right away.\r\nOtherwise, we will need to tell the serializer explicitly we want to populate the default values on deserialization using the same DefaultValueHandling setting we used on serialization.\r\n\r\nI wrote a small console app as a client to show you everything is restored correctly.\r\n\r\nWhen we look at the watch in the debugger, we see all properties not present in the transferred data are populated with either `null` or their correct default value.\r\n\r\n![Visual Studio Watch showing a deserialized object with default value handling](/wp-content/uploads/2015/11/visual-studio-watch-default-value-handling.png \"Visual Studio Watch showing a deserialized object with default value handling\")\r\n\r\n## Conclusion\r\n\r\nIn this example we managed a reduction of 41%.\r\n\r\nOf course, the reduction depends heavily on how often default values are part of your transferred data. But it's an easy diet on transferred data that the other side can reconstruct on itself.\r\n\r\n## Source code\r\n\r\nYou can download my [Reduce Json Traffic sample project](https://github.com/eNeRGy164/ReduceJsonTraffic) on GitHub.","src/posts/2015-11-06-json-on-a-diet-how-to-shrink-your-dtos-part-1-default-value-handling.md","eca2c3067439896c",{"html":1503,"metadata":1504},"\u003Cp>These days \u003Ca href=\"https://en.wikipedia.org/wiki/JSON\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Cdfn>\u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr>\u003C/dfn>\u003Cspan>\u003C/span>\u003C/a> is used a lot.\r\nFor storing data, for storing settings, for describing other \u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr> files, and often for transporting information between server and client using DTOs (\u003Ca href=\"https://en.wikipedia.org/wiki/Data_transfer_object\" rel=\"noopener noreferrer external\" target=\"_blank\">Data Transfer Objects\u003Cspan>\u003C/span>\u003C/a>).\u003C/p>\n\u003Cp>When using an \u003Ca href=\"https://azure.microsoft.com/en-us/services/app-service/mobile?WT.mc_id=DT-MVP-5004268&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Azure Mobile App Service\u003Cspan>\u003C/span>\u003C/a> or \u003Ca href=\"https://dotnet.microsoft.com/apps/aspnet/apis\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Cdfn>\u003Cabbr title=\"Active Server Pages\">ASP\u003C/abbr>\u003C/dfn>.NET Web \u003Cdfn>\u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr>\u003C/dfn>\u003Cspan>\u003C/span>\u003C/a> you will see that \u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr> is the default format to transport data.\r\nWhen running apps on a PCs with a fixed internet connection data size might not be a hot topic.\r\nBut for apps on mobile devices, possibly using slow, limited, or expensive connections you want to save on the amount of data that is transferred.\u003C/p>\n\u003C!--more-->\n\u003Cp>Recently I was monitoring the data transferred from one of my own Web \u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr> controllers to a mobile app.\r\nI discovered the amount of data transferred was more than expected.\u003C/p>\n\u003Cp>This inspired me try to reduce the size of the transferred data.\r\nIn this and following articles I will describe the different options you can use and combine.\u003C/p>\n\u003Cp>You can download the source code at \u003Ca href=\"#source-code\">the end of my article\u003C/a>.\u003C/p>\n\u003Ch2 id=\"part-1-default-value-handling\">Part 1: Default Value Handling\u003C/h2>\n\u003Cp>I created an \u003Cabbr title=\"Active Server Pages\">ASP\u003C/abbr>.NET Web \u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr> controller to demonstrate the default behavior.\r\nThe default controller returns two objects with data, some properties are empty.\u003C/p>\n\u003Cp>A \u003Ccode>GET\u003C/code> request to \u003Ccode>http://reducejsontraffic.azurewebsites.net/api/default\u003C/code> returns:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:65ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"AString\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"AnInt\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Fourteen\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">14\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"ANullableByte\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"AStringArray\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"NoUri\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"SomeUri\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"http://reducejsontraffic.azurewebsites.net/api/\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"TheDate\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-11-05T17:11:29.0809876+00:00\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"AnEmptyDate\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"0001-01-01T00:00:00\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"AFixedDate\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-07-02T13:14:00+00:00\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"SingleObject\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"SomeEmptyObjects\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"SomeObjects\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{ \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"ADouble\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> },\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{ \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"ADouble\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">3.14\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> },\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{ \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"ADouble\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1.23456789\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F66767\">...\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[  {    &#x22;AString&#x22;: null,    &#x22;AnInt&#x22;: 0,    &#x22;Fourteen&#x22;: 14,    &#x22;ANullableByte&#x22;: null,    &#x22;AStringArray&#x22;: null,    &#x22;NoUri&#x22;: null,    &#x22;SomeUri&#x22;: &#x22;http://reducejsontraffic.azurewebsites.net/api/&#x22;,    &#x22;TheDate&#x22;: &#x22;2015-11-05T17:11:29.0809876+00:00&#x22;,    &#x22;AnEmptyDate&#x22;: &#x22;0001-01-01T00:00:00&#x22;,    &#x22;AFixedDate&#x22;: &#x22;2015-07-02T13:14:00+00:00&#x22;,    &#x22;SingleObject&#x22;: null,    &#x22;SomeEmptyObjects&#x22;: [],    &#x22;SomeObjects&#x22;: [        { &#x22;ADouble&#x22;: 0 },        { &#x22;ADouble&#x22;: 3.14 },        { &#x22;ADouble&#x22;: 1.23456789 }    ]  },  ...]\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Csmall>(Formatted for readability)\u003C/small>\u003C/p>\n\u003Cp>As you can see every property is present, despite it does not have a real value.\u003C/p>\n\u003Cp>In \u003Cabbr title=\"Active Server Pages\">ASP\u003C/abbr>.NET Web \u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr>, Microsoft has chosen to use the \u003Ca href=\"https://www.newtonsoft.com/json\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr>.net\u003Cspan>\u003C/span>\u003C/a> serializer.\r\nThe serializer has a setting called \u003Ca href=\"https://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_DefaultValueHandling.htm\" rel=\"noopener noreferrer external\" target=\"_blank\">DefaultValueHandling\u003Cspan>\u003C/span>\u003C/a> which is set to \u003Ccode>Include\u003C/code> by default.\r\nTo quote the documentation:\u003C/p>\n\u003Cblockquote>\n\u003Cp>Include members where the member value is the same as the member’s default value when serializing objects.\r\nIncluded members are written to \u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr>.\r\nHas no effect when deserializing.\u003C/p>\n\u003C/blockquote>\n\u003Cp>And we can confirm this is the case when we look at the result from the first example.\u003C/p>\n\u003Cp>If a property already gets the default value when deserializing, why would we want to transport that value anyway?\u003C/p>\n\u003Ch2 id=\"changing-the-default-value-handling\">Changing the Default Value Handling\u003C/h2>\n\u003Cp>Another option for \u003Ccode>DefaultValueHandling\u003C/code> is \u003Ccode>Ignore\u003C/code> (and for the serializing part \u003Ccode>IgnoreAndPopulate\u003C/code> acts the same).\r\nThe documentation states:\u003C/p>\n\u003Cblockquote>\n\u003Cp>Ignore members where the member value is the same as the member’s default value when serializing objects so that it is not written to \u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr>.\r\nThis option will ignore all default values (e.g., \u003Ccode>null\u003C/code> for objects and nullable types; \u003Ccode>0\u003C/code> for integers, decimals, and floating-point numbers; and \u003Ccode>false\u003C/code> for booleans).\r\nThe default value ignored can be changed by placing the DefaultValueAttribute on the property.\u003C/p>\n\u003C/blockquote>\n\u003Cp>So, when we set this option properties with default values will be removed from the data transferred.\u003C/p>\n\u003Cp>The documentation also mentions the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.componentmodel.defaultvalueattribute?view=netframework-4.7&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>DefaultValueAttribute\u003C/code> attribute\u003Cspan>\u003C/span>\u003C/a>.\r\nSo, we can describe a different default for a property.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">Message.cs\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:33ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">19\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">DefaultValue\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">14\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">20\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">int\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Fourteen\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">set\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[DefaultValue(14)]public int Fourteen { get; set; }\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now the property \u003Ccode>Fourteen\u003C/code> will only get serialized when its value is not \u003Ccode>14\u003C/code>.\u003C/p>\n\u003Cp>I created a second controller with the modified setting. This controller demonstrates this new behavior.\u003C/p>\n\u003Cp>A \u003Ccode>GET\u003C/code> request to \u003Ccode>http://reducejsontraffic.azurewebsites.net/api/defaultvaluehandling\u003C/code> returns:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:65ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"SomeUri\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"http://reducejsontraffic.azurewebsites.net/api/\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"TheDate\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-11-05T17:30:02.3206122+00:00\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"AFixedDate\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-07-02T13:14:00+00:00\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"SomeEmptyObjects\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"SomeObjects\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{ \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"ADouble\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> },\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{ \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"ADouble\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1.23456789\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F66767\">...\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[  {    &#x22;SomeUri&#x22;: &#x22;http://reducejsontraffic.azurewebsites.net/api/&#x22;,    &#x22;TheDate&#x22;: &#x22;2015-11-05T17:30:02.3206122+00:00&#x22;,    &#x22;AFixedDate&#x22;: &#x22;2015-07-02T13:14:00+00:00&#x22;,    &#x22;SomeEmptyObjects&#x22;: [],    &#x22;SomeObjects&#x22;: [        { &#x22;ADouble&#x22;: 0 },        {},        { &#x22;ADouble&#x22;: 1.23456789 }    ]  },  ...]\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Csmall>(Formatted for readability)\u003C/small>\u003C/p>\n\u003Cp>That’s quite a reduction! But are all values recovered after deserialization?\u003C/p>\n\u003Cp>Yes, if we didn’t use the \u003Ccode>DefaultValueAttribute\u003C/code> anywhere in our \u003Cdfn>\u003Cabbr title=\"Data Transfer Object\">DTO\u003C/abbr>\u003C/dfn> it will work right away.\r\nOtherwise, we will need to tell the serializer explicitly we want to populate the default values on deserialization using the same DefaultValueHandling setting we used on serialization.\u003C/p>\n\u003Cp>I wrote a small console app as a client to show you everything is restored correctly.\u003C/p>\n\u003Cp>When we look at the watch in the debugger, we see all properties not present in the transferred data are populated with either \u003Ccode>null\u003C/code> or their correct default value.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2015/11/visual-studio-watch-default-value-handling.webp\" type=\"image/webp\" media=\"(max-width: 504px)\">\u003Csource srcset=\"/wp-content/uploads/2015/11/visual-studio-watch-default-value-handling-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2015/11/visual-studio-watch-default-value-handling-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2015/11/visual-studio-watch-default-value-handling.png\" alt=\"Visual Studio Watch showing a deserialized object with default value handling\" loading=\"lazy\" decoding=\"async\" width=\"504\" height=\"419\" srcset=\"/wp-content/uploads/2015/11/visual-studio-watch-default-value-handling.png 504w, /wp-content/uploads/2015/11/visual-studio-watch-default-value-handling-150x150.png 150w, /wp-content/uploads/2015/11/visual-studio-watch-default-value-handling-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Visual Studio Watch showing a deserialized object with default value handling\u003C/figcaption>\u003C/figure>\n\u003Ch2 id=\"conclusion\">Conclusion\u003C/h2>\n\u003Cp>In this example we managed a reduction of 41%.\u003C/p>\n\u003Cp>Of course, the reduction depends heavily on how often default values are part of your transferred data. But it’s an easy diet on transferred data that the other side can reconstruct on itself.\u003C/p>\n\u003Ch2 id=\"source-code\">Source code\u003C/h2>\n\u003Cp>You can download my \u003Ca href=\"https://github.com/eNeRGy164/ReduceJsonTraffic\" rel=\"noopener noreferrer external\" target=\"_blank\">Reduce Json Traffic sample project\u003Cspan>\u003C/span>\u003C/a> on GitHub.\u003C/p>",{"headings":1505,"imagePaths":1514,"frontmatter":1483},[1506,1509,1512,1513],{"depth":780,"slug":1507,"text":1508},"part-1-default-value-handling","Part 1: Default Value Handling",{"depth":780,"slug":1510,"text":1511},"changing-the-default-value-handling","Changing the Default Value Handling",{"depth":780,"slug":1149,"text":1150},{"depth":780,"slug":1056,"text":1057},[],"2016-03-30-attending-the-microsoft-build-2016-conference",{"id":1515,"data":1517,"body":1528,"filePath":1529,"digest":1530,"rendered":1531},{"id":1518,"title":1519,"date":1520,"updated":1521,"author":15,"excerpt":1522,"layout":17,"permalink":1523,"image":1524,"categories":1525,"tags":1526,"draft":26},882,"Attending the Microsoft Build 2016 conference",["Date","2016-03-30T06:07:34.000Z"],["Date","2020-12-06T21:31:00.000Z"],"This week I’ll be attending the Microsoft Build 2016 conference in San Francisco.\nLots of news to be expected for developers covering the many technologies Microsoft is putting on the market.\n","/2016/03/30/attending-the-microsoft-build-2016-conference/","/wp-content/uploads/2016/03/post-882-thumbnail.png",[271,240],[1527,87,450],"BUILD","This week I will be attending the Microsoft Build 2016 conference in San Francisco.\r\n\r\nLots of news to be expected for developers covering the many technologies Microsoft is putting on the market.\r\n\r\n\u003C!--more-->\r\n\r\n## Keynotes\r\n\r\nTraditionally there are 2 keynotes at the Build conference.\r\nThe first one is focusing on Microsoft Windows.\r\nThe second one is more focused on Microsoft Azure.\r\nI expect the same pattern this year.\r\n\r\nBased on the news and rumors the last couple of weeks,\r\ncombined with the scheduled sessions,\r\nI expect the following topics to be covered during the keynotes.\r\n\r\n- **Windows 10**\r\n\r\n  Obviously. Redstone is coming and Edge is getting add-ins so those are two obvious topics.\r\n  I expect an overview of all the new things that are already part of the current fast ring previews.\r\n\r\n- **Xamarin**\r\n\r\n   Microsoft has recently bought the company.\r\n   A move I already expected two years ago.\r\n   And looking around San Francisco they're running quite the marketing campaign.\r\n   So naturally this needs to be in the keynote.\r\n   I hope they'll be answering the question how the licensing will be affected.\r\n\r\n- **Xbox**\r\n\r\n   We are expecting universal apps on the Xbox for several years. But this year should be it.\r\n   [A tweet by Scott Hanselman](https://twitter.com/shanselman/status/714939797358260224) indicates that Phil Spencer will be part of this year's conference.\r\n\r\n- **Surface Hub**\r\n\r\n   I don’t expect a new device, only some demos.\r\n   But as the devices are now finally available for purchase, they probably want to do some marketing around these costly beasts.\r\n   Also, a couple of sessions in the program are mentioning developing apps for this device.\r\n\r\n- **HoloLens**\r\n\r\n   The shipping of the first wave of devices is at the same time as the conference, that can’t be accidental. Lots of sessions are covering different aspects of the HoloLens.\r\n   So, a new demo during the keynote can’t be far away. Hopefully the device can measure the distance between the eyes automatically. Last year this was a manual task.\r\n\r\n- **Visual Studio vNext**\r\n\r\n   A bit of news got around about the next version of Visual Studio and the improved installer experience.\r\n   This would be the time to share this news officially.\r\n\r\n- **.NET Core**\r\n\r\n   It’s about time the .NET core is officially released as it’s been in preview for a long time.\r\n   So, I expect the 1.0 RTM version to be pushed to the world today.\r\n\r\n- **Azure**\r\n\r\n   Azure is a big platform, and I expect a couple of new features will be released to the public.\r\n   Maybe even some Azure Stack integration will be demoed.\r\n\r\n- **Office Graph**\r\n\r\n   Already announced in preview last year. I expect a full release this year.\r\n   Maybe adding new features to the APIs in preview.\r\n\r\n## My journey through the week\r\n\r\nOn [my twitter feed](https://twitter.com/eNeRGy164) I will be posting all the sessions I am attending.\r\nMy focus will probably be on UWP and Azure related sessions.\r\n\r\nWant to meet me or do you have a question about the sessions I've attended?\r\nJust send me a message.\r\n\r\n## Watching sessions\r\n\r\nNot in San Francisco and still want to be part of the action?\r\n\r\nChannel9 will be covering a lot of content live including the Keynotes and interviews.\r\nAlso, all the sessions will be available online later.\r\n\r\nGo to the [Channel9 Build 2016 website](https://learn.microsoft.com/shows/build-2016/).","src/posts/2016-03-30-attending-the-microsoft-build-2016-conference.md","3646c9ea40120291",{"html":1532,"metadata":1533},"\u003Cp>This week I will be attending the Microsoft Build 2016 conference in San Francisco.\u003C/p>\n\u003Cp>Lots of news to be expected for developers covering the many technologies Microsoft is putting on the market.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"keynotes\">Keynotes\u003C/h2>\n\u003Cp>Traditionally there are 2 keynotes at the Build conference.\r\nThe first one is focusing on Microsoft Windows.\r\nThe second one is more focused on Microsoft Azure.\r\nI expect the same pattern this year.\u003C/p>\n\u003Cp>Based on the news and rumors the last couple of weeks,\r\ncombined with the scheduled sessions,\r\nI expect the following topics to be covered during the keynotes.\u003C/p>\n\u003Cul>\n\u003Cli>\n\u003Cp>\u003Cstrong>Windows 10\u003C/strong>\u003C/p>\n\u003Cp>Obviously. Redstone is coming and Edge is getting add-ins so those are two obvious topics.\r\nI expect an overview of all the new things that are already part of the current fast ring previews.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Xamarin\u003C/strong>\u003C/p>\n\u003Cp>Microsoft has recently bought the company.\r\nA move I already expected two years ago.\r\nAnd looking around San Francisco they’re running quite the marketing campaign.\r\nSo naturally this needs to be in the keynote.\r\nI hope they’ll be answering the question how the licensing will be affected.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Xbox\u003C/strong>\u003C/p>\n\u003Cp>We are expecting universal apps on the Xbox for several years. But this year should be it.\r\n\u003Ca href=\"https://twitter.com/shanselman/status/714939797358260224\" rel=\"noopener noreferrer external\" target=\"_blank\">A tweet by Scott Hanselman\u003Cspan>\u003C/span>\u003C/a> indicates that Phil Spencer will be part of this year’s conference.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Surface Hub\u003C/strong>\u003C/p>\n\u003Cp>I don’t expect a new device, only some demos.\r\nBut as the devices are now finally available for purchase, they probably want to do some marketing around these costly beasts.\r\nAlso, a couple of sessions in the program are mentioning developing apps for this device.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>HoloLens\u003C/strong>\u003C/p>\n\u003Cp>The shipping of the first wave of devices is at the same time as the conference, that can’t be accidental. Lots of sessions are covering different aspects of the HoloLens.\r\nSo, a new demo during the keynote can’t be far away. Hopefully the device can measure the distance between the eyes automatically. Last year this was a manual task.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Visual Studio vNext\u003C/strong>\u003C/p>\n\u003Cp>A bit of news got around about the next version of Visual Studio and the improved installer experience.\r\nThis would be the time to share this news officially.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>.NET Core\u003C/strong>\u003C/p>\n\u003Cp>It’s about time the .NET core is officially released as it’s been in preview for a long time.\r\nSo, I expect the 1.0 RTM version to be pushed to the world today.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Azure\u003C/strong>\u003C/p>\n\u003Cp>Azure is a big platform, and I expect a couple of new features will be released to the public.\r\nMaybe even some Azure Stack integration will be demoed.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>\u003Cstrong>Office Graph\u003C/strong>\u003C/p>\n\u003Cp>Already announced in preview last year. I expect a full release this year.\r\nMaybe adding new features to the APIs in preview.\u003C/p>\n\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"my-journey-through-the-week\">My journey through the week\u003C/h2>\n\u003Cp>On \u003Ca href=\"https://twitter.com/eNeRGy164\" rel=\"noopener noreferrer external\" target=\"_blank\">my twitter feed\u003Cspan>\u003C/span>\u003C/a> I will be posting all the sessions I am attending.\r\nMy focus will probably be on \u003Cdfn>\u003Cabbr title=\"Universal Windows Platform\">UWP\u003C/abbr>\u003C/dfn> and Azure related sessions.\u003C/p>\n\u003Cp>Want to meet me or do you have a question about the sessions I’ve attended?\r\nJust send me a message.\u003C/p>\n\u003Ch2 id=\"watching-sessions\">Watching sessions\u003C/h2>\n\u003Cp>Not in San Francisco and still want to be part of the action?\u003C/p>\n\u003Cp>Channel9 will be covering a lot of content live including the Keynotes and interviews.\r\nAlso, all the sessions will be available online later.\u003C/p>\n\u003Cp>Go to the \u003Ca href=\"https://learn.microsoft.com/shows/build-2016/?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Channel9 Build 2016 website\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>",{"headings":1534,"imagePaths":1544,"frontmatter":1517},[1535,1538,1541],{"depth":780,"slug":1536,"text":1537},"keynotes","Keynotes",{"depth":780,"slug":1539,"text":1540},"my-journey-through-the-week","My journey through the week",{"depth":780,"slug":1542,"text":1543},"watching-sessions","Watching sessions",[],"2015-11-18-highlight-your-selected-pivot-header-in-a-universal-windows-platform-app",{"id":1545,"data":1547,"body":1558,"filePath":1559,"digest":1560,"rendered":1561},{"id":1548,"title":1549,"date":1550,"updated":1551,"author":15,"excerpt":1552,"layout":17,"permalink":1553,"image":1554,"categories":1555,"tags":1556,"draft":26},642,"Highlight your Selected Pivot Header in a Universal Windows Platform app",["Date","2015-11-18T18:50:50.000Z"],["Date","2020-12-06T18:42:05.000Z"],"Not long ago I wrote a blog post about Responsive Pivot Headers in Universal Windows Platform apps. Paul responded to this post asking how to change the background of the selected item, just like the example I posted on top of the post.\nIt's a great question and I'm sorry I didn't cover this part so the pivot looks more like the example image.\nAn omission I want to correct with this blog post.\n","/2015/11/18/highlight-your-selected-pivot-header-in-a-universal-windows-platform-app/","/wp-content/uploads/2015/11/post-642-thumbnail.png",[183,240],[1557,1344,1047],"Pivot","Not long ago I wrote a blog post about [Responsive Pivot Headers in Universal Windows Platform apps](/2015/09/04/responsive-pivot-headers-in-universal-windows-platform-apps).\r\nPaul responded asking how to change the background of the selected item, just like the example I posted on top of the article.\r\n\r\nIt is a great question and I am sorry I didn't cover this so the pivot looks more like the example.\r\n\r\nAn omission I want to correct with this article.\r\n\r\n\u003C!--more-->\r\n\r\n## The example\r\n\r\nSo, to brush up on the first post, here is the example again:\r\n\r\n![Example design from pivot guidelines by Microsoft](/wp-content/uploads/2015/09/microsoft-guidelines-example.png)\r\n\r\n## The solution\r\n\r\nThere are only 3 small changes to make to get the pivot more like the example.\r\n\r\n1. Add a dark background to the pivot header\r\n2. Change the color of the pivot header content to light so we can read it\r\n3. Add a lighter background to the selected pivot header\r\n\r\n### Adding the background\r\n\r\nThere is not really an element to set the background of the whole pivot header, so we have to add one.\r\nIn the Pivot Template we have created in the first post we add a Border to the Grid of the `PivotPanel`.\r\nIt gets the darker color and has to span the 3 columns.\r\n\r\n```xml title=\"MainPage.xaml\" {14-19}\r\n\u003CPivotPanel x:Name=\"Panel\" VerticalAlignment=\"Stretch\">\r\n\u003CGrid x:Name=\"PivotLayoutElement\">\r\n  \u003CGrid.ColumnDefinitions>\r\n    \u003CColumnDefinition Width=\"Auto\"/>\r\n    \u003CColumnDefinition Width=\"*\"/>\r\n    \u003CColumnDefinition Width=\"Auto\"/>\r\n  \u003C/Grid.ColumnDefinitions>\r\n  \u003CGrid.RowDefinitions>\r\n    ...\r\n  \u003C/Grid.RowDefinitions>\r\n  \u003CGrid.RenderTransform>\r\n    ...\r\n  \u003C/Grid.RenderTransform>\r\n  \u003CBorder Background=\"#FF34323F\"\r\n          Grid.Row=\"0\"\r\n          Grid.Column=\"0\"\r\n          Grid.ColumnSpan=\"3\"\r\n          HorizontalAlignment=\"Stretch\"\r\n          VerticalAlignment=\"Stretch\"/>\r\n  \u003CContentPresenter x:Name=\"LeftHeaderPresenter\" ... />\r\n```\r\n\r\n### Lighten up the foreground\r\n\r\nThen we go the `PivotHeaderItem` style we also created before.\r\n\r\nHere we add a setter so we can change the `RequestedTheme` to `Dark`.\r\n\r\n```xml title=\"MainPage.xaml\" {5}\r\n\u003CPivot>\r\n  \u003CPivot.Resources>\r\n    \u003CStyle TargetType=\"PivotHeaderItem\">\r\n      ...\r\n      \u003CSetter Property=\"RequestedTheme\" Value=\"Dark\" />\r\n        \u003CSetter Property=\"Template\">\r\n```\r\n\r\n### Adding the highlighted background\r\n\r\nNow we go to the Visual State named `Selected`.\r\n\r\nHere we change the Background color to the lighter color.\r\n\r\n```xml title=\"MainPage.xaml\" {10}\r\n\u003CVisualState x:Name=\"Selected\">\r\n  \u003CStoryboard>\r\n    \u003CObjectAnimationUsingKeyFrames Storyboard.TargetName=\"ContentPresenter\"\r\n                                   Storyboard.TargetProperty=\"Foreground\">\r\n        \u003CDiscreteObjectKeyFrame KeyTime=\"0\"\r\n                                Value=\"{ThemeResource SystemControlHighlightAltBaseHighBrush}\" />\r\n    \u003C/ObjectAnimationUsingKeyFrames>\r\n    \u003CObjectAnimationUsingKeyFrames Storyboard.TargetName=\"Grid\"\r\n                                   Storyboard.TargetProperty=\"Background\">\r\n        \u003CDiscreteObjectKeyFrame KeyTime=\"0\" Value=\"#FF42424C\" />\r\n    \u003C/ObjectAnimationUsingKeyFrames>\r\n  \u003C/Storyboard>\r\n\u003C/VisualState>\r\n```\r\n\r\nAnd that is it!\r\n\r\nIt is not an exact replica, but you can change all the colors and sizes to accommodate your needs.\r\n\r\n![Styled Pivot Header with selected item](/wp-content/uploads/2015/11/responsive-header-background.png)\r\n\r\n## Source code\r\n\r\nThe source code of the [sample project on GitHub](https://github.com/eNeRGy164/DynamicPivot) has been updated to reflect these changes.\r\n\r\nYou can also go to [the specific commit](https://github.com/eNeRGy164/DynamicPivot/commit/d5ee317b1bb76464f355143cab51f1fc0ae7224f) to see the exact changes.","src/posts/2015-11-18-highlight-your-selected-pivot-header-in-a-universal-windows-platform-app.md","387efbd3586b19a3",{"html":1562,"metadata":1563},"\u003Cp>Not long ago I wrote a blog post about \u003Ca href=\"/2015/09/04/responsive-pivot-headers-in-universal-windows-platform-apps\">Responsive Pivot Headers in Universal Windows Platform apps\u003C/a>.\r\nPaul responded asking how to change the background of the selected item, just like the example I posted on top of the article.\u003C/p>\n\u003Cp>It is a great question and I am sorry I didn’t cover this so the pivot looks more like the example.\u003C/p>\n\u003Cp>An omission I want to correct with this article.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"the-example\">The example\u003C/h2>\n\u003Cp>So, to brush up on the first post, here is the example again:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2015/09/microsoft-guidelines-example.webp\" type=\"image/webp\" media=\"(max-width: 240px)\">\u003Csource srcset=\"/wp-content/uploads/2015/09/microsoft-guidelines-example-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2015/09/microsoft-guidelines-example-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2015/09/microsoft-guidelines-example.png\" alt=\"Example design from pivot guidelines by Microsoft\" loading=\"lazy\" decoding=\"async\" width=\"240\" height=\"427\" srcset=\"/wp-content/uploads/2015/09/microsoft-guidelines-example.png 240w, /wp-content/uploads/2015/09/microsoft-guidelines-example-150x150.png 150w, /wp-content/uploads/2015/09/microsoft-guidelines-example-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Ch2 id=\"the-solution\">The solution\u003C/h2>\n\u003Cp>There are only 3 small changes to make to get the pivot more like the example.\u003C/p>\n\u003Col>\n\u003Cli>Add a dark background to the pivot header\u003C/li>\n\u003Cli>Change the color of the pivot header content to light so we can read it\u003C/li>\n\u003Cli>Add a lighter background to the selected pivot header\u003C/li>\n\u003C/ol>\n\u003Ch3 id=\"adding-the-background\">Adding the background\u003C/h3>\n\u003Cp>There is not really an element to set the background of the whole pivot header, so we have to add one.\r\nIn the Pivot Template we have created in the first post we add a Border to the Grid of the \u003Ccode>PivotPanel\u003C/code>.\r\nIt gets the darker color and has to span the 3 columns.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">MainPage.xaml\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:55ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">PivotPanel\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Panel\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">VerticalAlignment\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Stretch\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Grid\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"PivotLayoutElement\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Grid.ColumnDefinitions\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ColumnDefinition\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Width\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Auto\"\u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ColumnDefinition\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Width\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"*\"\u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ColumnDefinition\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Width\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Auto\"\u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">Grid.ColumnDefinitions\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Grid.RowDefinitions\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">...\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">Grid.RowDefinitions\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Grid.RenderTransform\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">...\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">Grid.RenderTransform\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#aeaeae\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#7eb3e0\">Border\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Background\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"#FF34323F\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Grid.Row\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"0\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Grid.Column\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"0\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Grid.ColumnSpan\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"3\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">HorizontalAlignment\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"Stretch\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">VerticalAlignment\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"Stretch\"\u003C/span>\u003Cspan style=\"--0:#aeaeae\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ContentPresenter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LeftHeaderPresenter\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> ... \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003CPivotPanel x:Name=&#x22;Panel&#x22; VerticalAlignment=&#x22;Stretch&#x22;>\u003CGrid x:Name=&#x22;PivotLayoutElement&#x22;>  \u003CGrid.ColumnDefinitions>    \u003CColumnDefinition Width=&#x22;Auto&#x22;/>    \u003CColumnDefinition Width=&#x22;*&#x22;/>    \u003CColumnDefinition Width=&#x22;Auto&#x22;/>  \u003C/Grid.ColumnDefinitions>  \u003CGrid.RowDefinitions>    ...  \u003C/Grid.RowDefinitions>  \u003CGrid.RenderTransform>    ...  \u003C/Grid.RenderTransform>  \u003CBorder Background=&#x22;#FF34323F&#x22;          Grid.Row=&#x22;0&#x22;          Grid.Column=&#x22;0&#x22;          Grid.ColumnSpan=&#x22;3&#x22;          HorizontalAlignment=&#x22;Stretch&#x22;          VerticalAlignment=&#x22;Stretch&#x22;/>  \u003CContentPresenter x:Name=&#x22;LeftHeaderPresenter&#x22; ... />\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"lighten-up-the-foreground\">Lighten up the foreground\u003C/h3>\n\u003Cp>Then we go the \u003Ccode>PivotHeaderItem\u003C/code> style we also created before.\u003C/p>\n\u003Cp>Here we add a setter so we can change the \u003Ccode>RequestedTheme\u003C/code> to \u003Ccode>Dark\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">MainPage.xaml\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:55ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Pivot\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Pivot.Resources\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Style\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">TargetType\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"PivotHeaderItem\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">...\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#aeaeae\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#7eb3e0\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Property\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"RequestedTheme\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"Dark\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#aeaeae\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Setter\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Property\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Template\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003CPivot>  \u003CPivot.Resources>    \u003CStyle TargetType=&#x22;PivotHeaderItem&#x22;>      ...      \u003CSetter Property=&#x22;RequestedTheme&#x22; Value=&#x22;Dark&#x22; />        \u003CSetter Property=&#x22;Template&#x22;>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"adding-the-highlighted-background\">Adding the highlighted background\u003C/h3>\n\u003Cp>Now we go to the Visual State named \u003Ccode>Selected\u003C/code>.\u003C/p>\n\u003Cp>Here we change the Background color to the lighter color.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">MainPage.xaml\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"xml\" class=\"wrap\" style=\"--ecMaxLine:97ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">x:Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Selected\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">Storyboard\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ObjectAnimationUsingKeyFrames\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Storyboard.TargetName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"ContentPresenter\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:35ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                                   \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Storyboard.TargetProperty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Foreground\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">DiscreteObjectKeyFrame\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">KeyTime\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"0\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:32ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                                \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"{ThemeResource SystemControlHighlightAltBaseHighBrush}\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#959595\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">ObjectAnimationUsingKeyFrames\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">ObjectAnimationUsingKeyFrames\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Storyboard.TargetName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Grid\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:35ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                                   \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Storyboard.TargetProperty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Background\"\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#aeaeae\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#7eb3e0\">DiscreteObjectKeyFrame\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">KeyTime\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"0\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">=\u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"#FF42424C\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#aeaeae\">/>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">ObjectAnimationUsingKeyFrames\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">Storyboard\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#959595\">&#x3C;/\u003C/span>\u003Cspan style=\"--0:#569CD6\">VisualState\u003C/span>\u003Cspan style=\"--0:#959595\">>\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"\u003CVisualState x:Name=&#x22;Selected&#x22;>  \u003CStoryboard>    \u003CObjectAnimationUsingKeyFrames Storyboard.TargetName=&#x22;ContentPresenter&#x22;                                   Storyboard.TargetProperty=&#x22;Foreground&#x22;>        \u003CDiscreteObjectKeyFrame KeyTime=&#x22;0&#x22;                                Value=&#x22;{ThemeResource SystemControlHighlightAltBaseHighBrush}&#x22; />    \u003C/ObjectAnimationUsingKeyFrames>    \u003CObjectAnimationUsingKeyFrames Storyboard.TargetName=&#x22;Grid&#x22;                                   Storyboard.TargetProperty=&#x22;Background&#x22;>        \u003CDiscreteObjectKeyFrame KeyTime=&#x22;0&#x22; Value=&#x22;#FF42424C&#x22; />    \u003C/ObjectAnimationUsingKeyFrames>  \u003C/Storyboard>\u003C/VisualState>\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>And that is it!\u003C/p>\n\u003Cp>It is not an exact replica, but you can change all the colors and sizes to accommodate your needs.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2015/11/responsive-header-background.webp\" type=\"image/webp\" media=\"(max-width: 493px)\">\u003Cimg src=\"/wp-content/uploads/2015/11/responsive-header-background.png\" alt=\"Styled Pivot Header with selected item\" loading=\"lazy\" decoding=\"async\" width=\"493\" height=\"146\" srcset=\"/wp-content/uploads/2015/11/responsive-header-background.png 493w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Ch2 id=\"source-code\">Source code\u003C/h2>\n\u003Cp>The source code of the \u003Ca href=\"https://github.com/eNeRGy164/DynamicPivot\" rel=\"noopener noreferrer external\" target=\"_blank\">sample project on GitHub\u003Cspan>\u003C/span>\u003C/a> has been updated to reflect these changes.\u003C/p>\n\u003Cp>You can also go to \u003Ca href=\"https://github.com/eNeRGy164/DynamicPivot/commit/d5ee317b1bb76464f355143cab51f1fc0ae7224f\" rel=\"noopener noreferrer external\" target=\"_blank\">the specific commit\u003Cspan>\u003C/span>\u003C/a> to see the exact changes.\u003C/p>",{"headings":1564,"imagePaths":1579,"frontmatter":1547},[1565,1568,1569,1572,1575,1578],{"depth":780,"slug":1566,"text":1567},"the-example","The example",{"depth":780,"slug":258,"text":259},{"depth":198,"slug":1570,"text":1571},"adding-the-background","Adding the background",{"depth":198,"slug":1573,"text":1574},"lighten-up-the-foreground","Lighten up the foreground",{"depth":198,"slug":1576,"text":1577},"adding-the-highlighted-background","Adding the highlighted background",{"depth":780,"slug":1056,"text":1057},[],"2016-07-13-introducing-sandboxable-use-your-favorite-azure-nuget-packages-in-a-sandbox-environment",{"id":1580,"data":1582,"body":1594,"filePath":1595,"digest":1596,"rendered":1597},{"id":1583,"title":1584,"date":1585,"updated":1586,"author":15,"excerpt":1587,"layout":17,"permalink":1588,"image":1589,"categories":1590,"tags":1591,"draft":26},895,"Introducing Sandboxable: use your favorite (Azure) NuGet packages in a sandbox environment",["Date","2016-07-13T14:08:37.000Z"],["Date","2021-07-16T20:48:10.000Z"],"I would like to introduce to you Winvision’s first open source project: Sandboxable.\nSandboxable enables your project to utilize functionality provided by other (Microsoft) libraries that normally are not available in a Partial Trust environment like the Microsoft Dynamics CRM sandbox process.\nThe project offers modified NuGet packages that will run with Partial Trust.\n","/2016/07/13/introducing-sandboxable-use-your-favorite-azure-nuget-packages-in-a-sandbox-environment/","/wp-content/uploads/2016/07/post-895-thumbnail.png",[906,183,1302],[906,1304,1592,1593,217,25],"NuGet","Open Source","I would like to introduce to you Winvision's first open-source project: [Sandboxable](https://github.com/Winvision/Sandboxable).\r\n\r\nSandboxable enables your project to utilize functionality provided by other (Microsoft) libraries that normally are not able to use in a Partial Trust environment like the Microsoft Dynamics CRM sandbox process.  \r\nThe project offers modified NuGet packages that will run with Partial Trust.\r\n\r\n\u003C!--more-->\r\n\r\n## Sandboxing\r\n\r\nSandboxing is the practice of running code in a restricted security environment, which limits the access permissions granted to the code.\r\nFor example, if you have a managed library from a source you do not trust, you should not run it as fully trusted.\r\nInstead, you should place the code in a sandbox that limits its permissions to those that you expect it to need.\r\n\r\nYou can read more on this in the article [How to: Run Partially Trusted Code in a Sandbox](https://learn.microsoft.com/revious-versions/dotnet/framework/code-access-security/how-to-run-partially-trusted-code-in-a-sandbox)\r\nIf you encounter a .NET sandbox today chances are it's running with [Security-Transparent Code, Level 2](https://learn.microsoft.com/previous-versions/dotnet/framework/code-access-security/security-transparent-code-level-2)\r\n\r\nA big example of software running in a sandbox are the Microsoft Dynamics CRM (Online) Plug-ins and custom workflow activities.\r\n([Plug-in Trusts](https://learn.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/gg334752(v=crm.8)))\r\n\r\n## The problem\r\n\r\nAs developers we use a lot of library code like NuGet packages as we are not trying to reinvent the wheel. The downside is that most of these libraries are not written with a Partial Trust environment in mind.\r\n\r\nWhen we embed these libraries to our code in the sandbox, we encounter two common issues:\r\n\r\n1. The code contains security critical code and will fail to load with a `TypeLoadException` or will throw an `SecurityException` at runtime\r\n2. The package references another package that contains security critical code and even though the code might not even be used it will trigger one of the exceptions mentioned above\r\n\r\n## Problematic constructs\r\n\r\n### Calling native code\r\n\r\n```csharp\r\n[DllImport(\"advapi32.dll\", SetLastError = true)]\r\n[return: MarshalAs(UnmanagedType.Bool)]\r\ninternal static extern bool CryptDestroyHash(IntPtr hashHandle);\r\n```\r\n\r\n### Override `SecurityCritical` properties of an object like `Exception`\r\n\r\n```csharp\r\npublic override void GetObjectData(SerializationInfo info, StreamingContext context)\r\n{\r\n  ...\r\n}\r\n```\r\n\r\nWhere `Exception` has the following attributes on this method\r\n\r\n```csharp\r\n[System.Security.SecurityCritical]\r\npublic virtual void GetObjectData(SerializationInfo info, StreamingContext context)\r\n{\r\n  ...\r\n}\r\n```\r\n\r\n### Serialize non-public classes, fields or properties\r\n\r\n```csharp\r\n[JsonProperty(DefaultValueHandling = DefaultValueHandling.Ignore, NullValueHandling = NullValueHandling.Ignore, PropertyName = PropertyNotBefore, Required = Required.Default)]\r\nprivate long? _notBeforeUnixTime { get; set; }\r\n```\r\n\r\n## The solution\r\n\r\nWhen we encounter a NuGet package that fails to load or execute in the sandbox and its source is available we make a _Sandboxable_ copy of it.\r\n\r\nThis is done by eliminating the offending code in a way that is the least obtrusive and publish this version to NuGet.\r\n\r\nThe base rules are:\r\n\r\n- Keep the code changes as small as possible\r\n- Prefix all namespaces with Sandboxable\r\n- Eliminate offending NuGet dependencies\r\n- If a new dependency is needed, it will be on a sandbox friendly NuGet package\r\n\r\n## Source and contribution\r\n\r\nThe source is published at the [Sandboxable project at GitHub](https://github.com/Winvision/Sandboxable).\r\n\r\nIncluded in the solution is also a stand-alone project to test if code will break inside a sandbox.\r\nThis makes testing libraries easier without the need to deploy it to a (remote) environment.\r\n\r\nI like to invite everybody to use the [Sandboxable NuGet packages](https://www.nuget.org/packages?q=sandboxable) and contribute to the project.","src/posts/2016-07-13-introducing-sandboxable-use-your-favorite-azure-nuget-packages-in-a-sandbox-environment.md","2f075a6e4ed9cd21",{"html":1598,"metadata":1599},"\u003Cp>I would like to introduce to you Winvision’s first open-source project: \u003Ca href=\"https://github.com/Winvision/Sandboxable\" rel=\"noopener noreferrer external\" target=\"_blank\">Sandboxable\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>Sandboxable enables your project to utilize functionality provided by other (Microsoft) libraries that normally are not able to use in a Partial Trust environment like the Microsoft Dynamics \u003Cdfn>\u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr>\u003C/dfn> sandbox process.\u003Cbr>\nThe project offers modified NuGet packages that will run with Partial Trust.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"sandboxing\">Sandboxing\u003C/h2>\n\u003Cp>Sandboxing is the practice of running code in a restricted security environment, which limits the access permissions granted to the code.\r\nFor example, if you have a managed library from a source you do not trust, you should not run it as fully trusted.\r\nInstead, you should place the code in a sandbox that limits its permissions to those that you expect it to need.\u003C/p>\n\u003Cp>You can read more on this in the article \u003Ca href=\"https://learn.microsoft.com/revious-versions/dotnet/framework/code-access-security/how-to-run-partially-trusted-code-in-a-sandbox?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">How to: Run Partially Trusted Code in a Sandbox\u003Cspan>\u003C/span>\u003C/a>\r\nIf you encounter a .NET sandbox today chances are it’s running with \u003Ca href=\"https://learn.microsoft.com/previous-versions/dotnet/framework/code-access-security/security-transparent-code-level-2?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Security-Transparent Code, Level 2\u003Cspan>\u003C/span>\u003C/a>\u003C/p>\n\u003Cp>A big example of software running in a sandbox are the Microsoft Dynamics \u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr> (Online) Plug-ins and custom workflow activities.\r\n(\u003Ca href=\"https://learn.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/gg334752(v=crm.8)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Plug-in Trusts\u003Cspan>\u003C/span>\u003C/a>)\u003C/p>\n\u003Ch2 id=\"the-problem\">The problem\u003C/h2>\n\u003Cp>As developers we use a lot of library code like NuGet packages as we are not trying to reinvent the wheel. The downside is that most of these libraries are not written with a Partial Trust environment in mind.\u003C/p>\n\u003Cp>When we embed these libraries to our code in the sandbox, we encounter two common issues:\u003C/p>\n\u003Col>\n\u003Cli>The code contains security critical code and will fail to load with a \u003Ccode>TypeLoadException\u003C/code> or will throw an \u003Ccode>SecurityException\u003C/code> at runtime\u003C/li>\n\u003Cli>The package references another package that contains security critical code and even though the code might not even be used it will trigger one of the exceptions mentioned above\u003C/li>\n\u003C/ol>\n\u003Ch2 id=\"problematic-constructs\">Problematic constructs\u003C/h2>\n\u003Ch3 id=\"calling-native-code\">Calling native code\u003C/h3>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:64ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">DllImport\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"advapi32.dll\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SetLastError\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">true\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#569CD6\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">MarshalAs\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">UnmanagedType\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Bool\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">internal\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">static\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">extern\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">bool\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CryptDestroyHash\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">IntPtr\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">hashHandle\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[DllImport(&#x22;advapi32.dll&#x22;, SetLastError = true)][return: MarshalAs(UnmanagedType.Bool)]internal static extern bool CryptDestroyHash(IntPtr hashHandle);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"override-securitycritical-properties-of-an-object-like-exception\">Override \u003Ccode>SecurityCritical\u003C/code> properties of an object like \u003Ccode>Exception\u003C/code>\u003C/h3>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:84ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">override\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">void\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetObjectData\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">SerializationInfo\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">info\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">StreamingContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">..\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"public override void GetObjectData(SerializationInfo info, StreamingContext context){  ...}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Where \u003Ccode>Exception\u003C/code> has the following attributes on this method\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:83ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">System\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Security\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">SecurityCritical\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">virtual\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">void\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetObjectData\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">SerializationInfo\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">info\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">StreamingContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">..\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[System.Security.SecurityCritical]public virtual void GetObjectData(SerializationInfo info, StreamingContext context){  ...}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"serialize-non-public-classes-fields-or-properties\">Serialize non-public classes, fields or properties\u003C/h3>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:175ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">JsonProperty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DefaultValueHandling\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DefaultValueHandling\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Ignore\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">NullValueHandling\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">NullValueHandling\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Ignore\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">PropertyName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">PropertyNotBefore\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Required\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Required\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Default\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">private\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">long\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">?\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">_notBeforeUnixTime\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">set\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[JsonProperty(DefaultValueHandling = DefaultValueHandling.Ignore, NullValueHandling = NullValueHandling.Ignore, PropertyName = PropertyNotBefore, Required = Required.Default)]private long? _notBeforeUnixTime { get; set; }\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"the-solution\">The solution\u003C/h2>\n\u003Cp>When we encounter a NuGet package that fails to load or execute in the sandbox and its source is available we make a \u003Cem>Sandboxable\u003C/em> copy of it.\u003C/p>\n\u003Cp>This is done by eliminating the offending code in a way that is the least obtrusive and publish this version to NuGet.\u003C/p>\n\u003Cp>The base rules are:\u003C/p>\n\u003Cul>\n\u003Cli>Keep the code changes as small as possible\u003C/li>\n\u003Cli>Prefix all namespaces with Sandboxable\u003C/li>\n\u003Cli>Eliminate offending NuGet dependencies\u003C/li>\n\u003Cli>If a new dependency is needed, it will be on a sandbox friendly NuGet package\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"source-and-contribution\">Source and contribution\u003C/h2>\n\u003Cp>The source is published at the \u003Ca href=\"https://github.com/Winvision/Sandboxable\" rel=\"noopener noreferrer external\" target=\"_blank\">Sandboxable project at GitHub\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>Included in the solution is also a stand-alone project to test if code will break inside a sandbox.\r\nThis makes testing libraries easier without the need to deploy it to a (remote) environment.\u003C/p>\n\u003Cp>I like to invite everybody to use the \u003Ca href=\"https://www.nuget.org/packages?q=sandboxable\" rel=\"noopener noreferrer external\" target=\"_blank\">Sandboxable NuGet packages\u003Cspan>\u003C/span>\u003C/a> and contribute to the project.\u003C/p>",{"headings":1600,"imagePaths":1621,"frontmatter":1582},[1601,1604,1605,1608,1611,1614,1617,1618],{"depth":780,"slug":1602,"text":1603},"sandboxing","Sandboxing",{"depth":780,"slug":255,"text":256},{"depth":780,"slug":1606,"text":1607},"problematic-constructs","Problematic constructs",{"depth":198,"slug":1609,"text":1610},"calling-native-code","Calling native code",{"depth":198,"slug":1612,"text":1613},"override-securitycritical-properties-of-an-object-like-exception","Override SecurityCritical properties of an object like Exception",{"depth":198,"slug":1615,"text":1616},"serialize-non-public-classes-fields-or-properties","Serialize non-public classes, fields or properties",{"depth":780,"slug":258,"text":259},{"depth":780,"slug":1619,"text":1620},"source-and-contribution","Source and contribution",[],"2015-12-04-json-on-a-diet-how-to-shrink-your-dtos-part-2-skip-empty-collections",{"id":1622,"data":1624,"body":1635,"filePath":1636,"digest":1637,"rendered":1638},{"id":1625,"title":1626,"date":1627,"updated":1628,"author":15,"excerpt":1629,"layout":17,"permalink":1630,"image":1631,"categories":1632,"tags":1633,"draft":26},572,"JSON on a diet… how to shrink your DTO’s – Part 2: Skip empty collections",["Date","2015-12-04T17:19:03.000Z"],["Date","2020-12-06T18:47:30.000Z"],"This is the second part in a series of posts about reducing the amount of data transferred between ASP.NET Web API or Azure Mobile App Service and the (mobile) client.\nIn this post we will squeeze a little bit more from our DTOs (Data Transfer Objects).\n","/2015/12/04/json-on-a-diet-how-to-shrink-your-dtos-part-2-skip-empty-collections/","/wp-content/uploads/2015/12/post-672-thumbnail.png",[183],[1493,1634,1494,1495,1496,1497,1498],"Collections","This is the second part in a series of posts about reducing the amount of data transferred between ASP.NET Web API or Azure Mobile App Service and the (mobile) client.\r\n\r\nWe will continue where we left off in [Part 1: Default Value Handling](/2015/11/06/json-on-a-diet-how-to-shrink-your-dtos-part-1-default-value-handling).\r\n\r\nIn the first post we managed a reduction of 41%.\r\n\r\nOf course, the reduction depends heavily on how often default values are part of your transferred data.\r\nBut it's an easy diet on transferred data that the other side can reconstruct on itself.\r\n\r\nIn this post we will squeeze a little bit more from our Data Transfer Objects (DTOs).\r\n\r\n\u003C!--more-->\r\n\r\n## Part 2: Skip empty collections\r\n\r\nFirst, we look at the response we got from the second controller:\r\n\r\n```json\r\n[\r\n  {\r\n    \"SomeUri\": \"http://reducejsontraffic.azurewebsites.net/api/\",\r\n    \"TheDate\": \"2015-11-05T17:30:02.3206122+00:00\",\r\n    \"AFixedDate\": \"2015-07-02T13:14:00+00:00\",\r\n    \"SomeEmptyObjects\": [],\r\n    \"SomeObjects\": [\r\n      { \"ADouble\": 0 },\r\n      {},\r\n      { \"ADouble\": 1.23456789 }\r\n    ]\r\n  },\r\n  ...\r\n]\r\n```\r\n\r\n\u003Csmall>(Formatted for readability)\u003C/small>\r\n\r\nWe see that the property `SomeEmptyObjects` is present in the message, despite being an empty collection.\r\nSo, this is the next target for elimination.\r\n\r\n## Removing the empty collection\r\n\r\nThe reason the collection is present in the message is because a value of `null` is of course different than an empty array.\r\nBut this post is about eliminating data on transport so we start with removing empty collections from our messages.\r\n\r\nI was not the first one with this question, and at StackOverflow I found [an answer by Athari](https://stackoverflow.com/questions/18471864/how-to-make-json-net-skip-serialization-of-empty-collections/18486790#18486790).\r\n\r\nThe post contains a custom contract resolver that deals with this situation.\r\n\r\n```csharp title=\"SkipEmptyCollectionsContractResolver.cs\"\r\npublic class SkipEmptyCollectionsContractResolver : DefaultContractResolver\r\n{\r\n  protected override JsonProperty CreateProperty(\r\n      MemberInfo member, MemberSerialization memberSerialization)\r\n  {\r\n    var property = base.CreateProperty(member, memberSerialization);\r\n\r\n    var isDefaultValueIgnored = ((property.DefaultValueHandling ??\r\n        DefaultValueHandling.Ignore) & DefaultValueHandling.Ignore) != 0;\r\n\r\n    if (!isDefaultValueIgnored\r\n        || typeof(string).IsAssignableFrom(property.PropertyType)\r\n        || !typeof(IEnumerable).IsAssignableFrom(property.PropertyType))\r\n    {\r\n      return property;\r\n    }\r\n\r\n    Predicate\u003Cobject> newShouldSerialize = obj =>\r\n    {\r\n      var collection = property.ValueProvider.GetValue(obj) as ICollection;\r\n      return collection == null || collection.Count != 0;\r\n    };\r\n\r\n    var oldShouldSerialize = property.ShouldSerialize;\r\n    property.ShouldSerialize = oldShouldSerialize != null\r\n        ? o => oldShouldSerialize(o) && newShouldSerialize(o)\r\n        : newShouldSerialize;\r\n\r\n    return property;\r\n  }\r\n}\r\n```\r\n\r\nI created a third controller with the custom [`ContractResolver`](https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_JsonSerializerSettings_ContractResolver.htm).\r\nThis controller demonstrates this new behavior.\r\n\r\nA `GET` request to `http://reducejsontraffic.azurewebsites.net/api/skipemptycollection` returns:\r\n\r\n```json\r\n[\r\n  {\r\n    \"SomeUri\": \"http://reducejsontraffic.azurewebsites.net/api/\",\r\n    \"TheDate\": \"2015-11-10T16:35:32.3507203+00:00\",\r\n    \"AFixedDate\": \"2015-07-02T13:14:00+00:00\",\r\n    \"SomeObjects\": [\r\n      {\r\n        \"ADouble\": 0\r\n      },\r\n      {},\r\n      {\r\n        \"ADouble\": 1.23456789\r\n      }\r\n    ]\r\n  },\r\n  ...\r\n]\r\n```\r\n\r\n\u003Csmall>(Formatted for readability)\u003C/small>\r\n\r\nRemoving the empty collection removes another 6% from our transferred data.\r\nBringing the total reduction of this example to 47%.\r\n\r\nAs I wrote before: there is a difference between a value of `null` and an empty array.\r\nThe trade-off is that by removing the information from the DTO the client doesn't know if there was an empty collection or nothing at all.\r\nIf this is fine for your code you're done for now.\r\n\r\n## Reviving empty collections on the receiving side\r\n\r\nIn the previous blog post I used the `DefaultAttribute` to declare these defaults on simple types:\r\n\r\n```csharp title=\"Message.cs\" showlinenumbers startlinenumber=19\r\n[DefaultValue(14)]\r\npublic int Fourteen { get; set; }\r\n```\r\n\r\nWhen the client uses the `Populate` (or `IgnoreAndPopulate`) as `DefaultValueHandling` the property `Fourteen` will get the value of `14` then it's not present in the data.\r\n\r\nThis also works for the `AStringArray` property which is an array of `String`.\r\n\r\n```csharp title=\"Message.cs\" showlinenumbers startlinenumber=24\r\n[DefaultValue(new string[] {})]\r\npublic string[] AStringArray { get; set; }\r\n```\r\n\r\nHowever, for the arrays that contain objects you can't declare this as a default.\r\nWhen you try:\r\n\r\n```csharp title=\"Message.cs\"\r\n[DefaultValue(new SomeObject[] { })]\r\npublic SomeObject[] SomeEmptyObjects { get; set; }\r\n```\r\n\r\nThis will give the following error:\r\n\r\n> \"CS0182: An attribute argument must be a constant expression, typeof expression or array creation expression of an attribute parameter type\"\r\n\r\nWe will have to find another way to declare the default value.\r\n\r\n### Initialize collections in the constructor\r\n\r\nMy own preferred way to initialize collections on a POCO is by setting the collection in the constructor.\r\n\r\n```csharp title=\"Message.cs\" showlinenumbers startlinenumber=9\r\npublic Message()\r\n{\r\n    SomeObjects = new SomeObject[0];\r\n    SomeEmptyObjects = new SomeObject[0];\r\n}\r\n```\r\n\r\nThis will make sure we always have an empty collection. And if there is data in the message the Serializer will create a filled collection.\r\n\r\nThere is a caveat though. When there is no data in message and we have a set the DefaultValueHandling to `Populate` the empty collection is overwritten with a value of `null`.\r\nTherefore, we need to override the DefaultValueHandling for collection properties.\r\n\r\n```csharp title=\"Message.cs\" showlinenumbers startlinenumber=39\r\n[JsonProperty(DefaultValueHandling = DefaultValueHandling.Include)]\r\npublic SomeObject[] SomeEmptyObjects { get; set; }\r\n```\r\n\r\nTo test this, we launch the demo client app again.\r\n\r\nWhen we look at the watch in the debugger, we see again that all the properties that are not present in the transferred data are populated with either `null` or their correct default value.\r\n\r\n![Visual Studio Watch showing a deserialized object with default value handling](/wp-content/uploads/2015/12/visual-studio-watch-default-value-handling-part2.png)\r\n\r\n## Conclusion\r\n\r\nIn this example we managed to get a total reduction of 47% and still have all the data available in the client.\r\n\r\nOf course, the reduction still depends heavily on how often default values and empty collections are part of your transferred data. But the diet continues.\r\n\r\n## Source code\r\n\r\nYou can download the updated [Reduce Json Traffic sample project](https://github.com/eNeRGy164/ReduceJsonTraffic) on GitHub.\r\n\r\nYou can also go to [the specific commit](https://github.com/eNeRGy164/ReduceJsonTraffic/commit/a4c639a234236ac78af5a1110d240d5ee06ac105) to see the exact changes.","src/posts/2015-12-04-json-on-a-diet-how-to-shrink-your-dtos-part-2-skip-empty-collections.md","e1efe6ac06cf833b",{"html":1639,"metadata":1640},"\u003Cp>This is the second part in a series of posts about reducing the amount of data transferred between \u003Cdfn>\u003Cabbr title=\"Active Server Pages\">ASP\u003C/abbr>\u003C/dfn>.NET Web \u003Cdfn>\u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr>\u003C/dfn> or Azure Mobile App Service and the (mobile) client.\u003C/p>\n\u003Cp>We will continue where we left off in \u003Ca href=\"/2015/11/06/json-on-a-diet-how-to-shrink-your-dtos-part-1-default-value-handling\">Part 1: Default Value Handling\u003C/a>.\u003C/p>\n\u003Cp>In the first post we managed a reduction of 41%.\u003C/p>\n\u003Cp>Of course, the reduction depends heavily on how often default values are part of your transferred data.\r\nBut it’s an easy diet on transferred data that the other side can reconstruct on itself.\u003C/p>\n\u003Cp>In this post we will squeeze a little bit more from our Data Transfer Objects (DTOs).\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"part-2-skip-empty-collections\">Part 2: Skip empty collections\u003C/h2>\n\u003Cp>First, we look at the response we got from the second controller:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:65ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"SomeUri\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"http://reducejsontraffic.azurewebsites.net/api/\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"TheDate\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-11-05T17:30:02.3206122+00:00\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"AFixedDate\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-07-02T13:14:00+00:00\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"SomeEmptyObjects\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"SomeObjects\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{ \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"ADouble\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> },\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{ \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"ADouble\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1.23456789\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F66767\">...\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[  {    &#x22;SomeUri&#x22;: &#x22;http://reducejsontraffic.azurewebsites.net/api/&#x22;,    &#x22;TheDate&#x22;: &#x22;2015-11-05T17:30:02.3206122+00:00&#x22;,    &#x22;AFixedDate&#x22;: &#x22;2015-07-02T13:14:00+00:00&#x22;,    &#x22;SomeEmptyObjects&#x22;: [],    &#x22;SomeObjects&#x22;: [      { &#x22;ADouble&#x22;: 0 },      {},      { &#x22;ADouble&#x22;: 1.23456789 }    ]  },  ...]\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Csmall>(Formatted for readability)\u003C/small>\u003C/p>\n\u003Cp>We see that the property \u003Ccode>SomeEmptyObjects\u003C/code> is present in the message, despite being an empty collection.\r\nSo, this is the next target for elimination.\u003C/p>\n\u003Ch2 id=\"removing-the-empty-collection\">Removing the empty collection\u003C/h2>\n\u003Cp>The reason the collection is present in the message is because a value of \u003Ccode>null\u003C/code> is of course different than an empty array.\r\nBut this post is about eliminating data on transport so we start with removing empty collections from our messages.\u003C/p>\n\u003Cp>I was not the first one with this question, and at StackOverflow I found \u003Ca href=\"https://stackoverflow.com/questions/18471864/how-to-make-json-net-skip-serialization-of-empty-collections/18486790#18486790\" rel=\"noopener noreferrer external\" target=\"_blank\">an answer by Athari\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>The post contains a custom contract resolver that deals with this situation.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">SkipEmptyCollectionsContractResolver.cs\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:75ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">class\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">SkipEmptyCollectionsContractResolver\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> : \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">DefaultContractResolver\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">protected\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">override\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">JsonProperty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CreateProperty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">MemberInfo\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">member\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">MemberSerialization\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">memberSerialization\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">property\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">base\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CreateProperty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">member\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">memberSerialization\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">isDefaultValueIgnored\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> ((\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">property\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DefaultValueHandling\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">??\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DefaultValueHandling\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Ignore\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">&#x26;\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DefaultValueHandling\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Ignore\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">isDefaultValueIgnored\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">||\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">typeof\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">).\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsAssignableFrom\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">property\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">PropertyType\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">||\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!\u003C/span>\u003Cspan style=\"--0:#569CD6\">typeof\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">IEnumerable\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">).\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">IsAssignableFrom\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">property\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">PropertyType\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">))\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#C586C0\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">property\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Predicate\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#569CD6\">object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">newShouldSerialize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">obj\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">collection\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">property\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ValueProvider\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetValue\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">obj\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#569CD6\">as\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ICollection\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#C586C0\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">collection\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">==\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">||\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">collection\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Count\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">oldShouldSerialize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">property\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ShouldSerialize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">property\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ShouldSerialize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">oldShouldSerialize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">!=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">?\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">o\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">oldShouldSerialize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">o\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">&#x26;&#x26;\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">newShouldSerialize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">o\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">newShouldSerialize\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#C586C0\">return\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">property\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"public class SkipEmptyCollectionsContractResolver : DefaultContractResolver{  protected override JsonProperty CreateProperty(      MemberInfo member, MemberSerialization memberSerialization)  {    var property = base.CreateProperty(member, memberSerialization);    var isDefaultValueIgnored = ((property.DefaultValueHandling ??        DefaultValueHandling.Ignore) &#x26; DefaultValueHandling.Ignore) != 0;    if (!isDefaultValueIgnored        || typeof(string).IsAssignableFrom(property.PropertyType)        || !typeof(IEnumerable).IsAssignableFrom(property.PropertyType))    {      return property;    }    Predicate\u003Cobject> newShouldSerialize = obj =>    {      var collection = property.ValueProvider.GetValue(obj) as ICollection;      return collection == null || collection.Count != 0;    };    var oldShouldSerialize = property.ShouldSerialize;    property.ShouldSerialize = oldShouldSerialize != null        ? o => oldShouldSerialize(o) &#x26;&#x26; newShouldSerialize(o)        : newShouldSerialize;    return property;  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>I created a third controller with the custom \u003Ca href=\"https://www.newtonsoft.com/json/help/html/P_Newtonsoft_Json_JsonSerializerSettings_ContractResolver.htm\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ContractResolver\u003C/code>\u003Cspan>\u003C/span>\u003C/a>.\r\nThis controller demonstrates this new behavior.\u003C/p>\n\u003Cp>A \u003Ccode>GET\u003C/code> request to \u003Ccode>http://reducejsontraffic.azurewebsites.net/api/skipemptycollection\u003C/code> returns:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:65ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"SomeUri\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"http://reducejsontraffic.azurewebsites.net/api/\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"TheDate\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-11-10T16:35:32.3507203+00:00\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"AFixedDate\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-07-02T13:14:00+00:00\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"SomeObjects\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"ADouble\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"ADouble\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1.23456789\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F66767\">...\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[  {    &#x22;SomeUri&#x22;: &#x22;http://reducejsontraffic.azurewebsites.net/api/&#x22;,    &#x22;TheDate&#x22;: &#x22;2015-11-10T16:35:32.3507203+00:00&#x22;,    &#x22;AFixedDate&#x22;: &#x22;2015-07-02T13:14:00+00:00&#x22;,    &#x22;SomeObjects&#x22;: [      {        &#x22;ADouble&#x22;: 0      },      {},      {        &#x22;ADouble&#x22;: 1.23456789      }    ]  },  ...]\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Csmall>(Formatted for readability)\u003C/small>\u003C/p>\n\u003Cp>Removing the empty collection removes another 6% from our transferred data.\r\nBringing the total reduction of this example to 47%.\u003C/p>\n\u003Cp>As I wrote before: there is a difference between a value of \u003Ccode>null\u003C/code> and an empty array.\r\nThe trade-off is that by removing the information from the \u003Cdfn>\u003Cabbr title=\"Data Transfer Object\">DTO\u003C/abbr>\u003C/dfn> the client doesn’t know if there was an empty collection or nothing at all.\r\nIf this is fine for your code you’re done for now.\u003C/p>\n\u003Ch2 id=\"reviving-empty-collections-on-the-receiving-side\">Reviving empty collections on the receiving side\u003C/h2>\n\u003Cp>In the previous blog post I used the \u003Ccode>DefaultAttribute\u003C/code> to declare these defaults on simple types:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">Message.cs\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:33ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">19\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">DefaultValue\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">14\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">20\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">int\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Fourteen\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">set\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[DefaultValue(14)]public int Fourteen { get; set; }\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>When the client uses the \u003Ccode>Populate\u003C/code> (or \u003Ccode>IgnoreAndPopulate\u003C/code>) as \u003Ccode>DefaultValueHandling\u003C/code> the property \u003Ccode>Fourteen\u003C/code> will get the value of \u003Ccode>14\u003C/code> then it’s not present in the data.\u003C/p>\n\u003Cp>This also works for the \u003Ccode>AStringArray\u003C/code> property which is an array of \u003Ccode>String\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">Message.cs\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:42ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">24\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">DefaultValue\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[] {})]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">25\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[] \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">AStringArray\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">set\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[DefaultValue(new string[] {})]public string[] AStringArray { get; set; }\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>However, for the arrays that contain objects you can’t declare this as a default.\r\nWhen you try:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">Message.cs\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:50ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">DefaultValue\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">SomeObject\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[] { })]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SomeObject\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[] \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SomeEmptyObjects\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">set\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[DefaultValue(new SomeObject[] { })]public SomeObject[] SomeEmptyObjects { get; set; }\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This will give the following error:\u003C/p>\n\u003Cblockquote>\n\u003Cp>“CS0182: An attribute argument must be a constant expression, typeof expression or array creation expression of an attribute parameter type”\u003C/p>\n\u003C/blockquote>\n\u003Cp>We will have to find another way to declare the default value.\u003C/p>\n\u003Ch3 id=\"initialize-collections-in-the-constructor\">Initialize collections in the constructor\u003C/h3>\n\u003Cp>My own preferred way to initialize collections on a \u003Cdfn>\u003Cabbr title=\"Plain Old CLR Object\">POCO\u003C/abbr>\u003C/dfn> is by setting the collection in the constructor.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">Message.cs\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:41ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">9\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Message\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">()\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">10\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">11\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SomeObjects\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">SomeObject\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">];\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">12\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SomeEmptyObjects\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">SomeObject\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">];\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">13\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"public Message(){    SomeObjects = new SomeObject[0];    SomeEmptyObjects = new SomeObject[0];}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This will make sure we always have an empty collection. And if there is data in the message the Serializer will create a filled collection.\u003C/p>\n\u003Cp>There is a caveat though. When there is no data in message and we have a set the DefaultValueHandling to \u003Ccode>Populate\u003C/code> the empty collection is overwritten with a value of \u003Ccode>null\u003C/code>.\r\nTherefore, we need to override the DefaultValueHandling for collection properties.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">Message.cs\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:67ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">39\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">JsonProperty\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DefaultValueHandling\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">DefaultValueHandling\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Include\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"gutter\">\u003Cdiv class=\"ln\" aria-hidden=\"true\">40\u003C/div>\u003C/div>\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SomeObject\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[] \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">SomeEmptyObjects\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">set\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"[JsonProperty(DefaultValueHandling = DefaultValueHandling.Include)]public SomeObject[] SomeEmptyObjects { get; set; }\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>To test this, we launch the demo client app again.\u003C/p>\n\u003Cp>When we look at the watch in the debugger, we see again that all the properties that are not present in the transferred data are populated with either \u003Ccode>null\u003C/code> or their correct default value.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2015/12/visual-studio-watch-default-value-handling-part2.webp\" type=\"image/webp\" media=\"(max-width: 520px)\">\u003Csource srcset=\"/wp-content/uploads/2015/12/visual-studio-watch-default-value-handling-part2-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2015/12/visual-studio-watch-default-value-handling-part2-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2015/12/visual-studio-watch-default-value-handling-part2.png\" alt=\"Visual Studio Watch showing a deserialized object with default value handling\" loading=\"lazy\" decoding=\"async\" width=\"520\" height=\"417\" srcset=\"/wp-content/uploads/2015/12/visual-studio-watch-default-value-handling-part2.png 520w, /wp-content/uploads/2015/12/visual-studio-watch-default-value-handling-part2-150x150.png 150w, /wp-content/uploads/2015/12/visual-studio-watch-default-value-handling-part2-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Ch2 id=\"conclusion\">Conclusion\u003C/h2>\n\u003Cp>In this example we managed to get a total reduction of 47% and still have all the data available in the client.\u003C/p>\n\u003Cp>Of course, the reduction still depends heavily on how often default values and empty collections are part of your transferred data. But the diet continues.\u003C/p>\n\u003Ch2 id=\"source-code\">Source code\u003C/h2>\n\u003Cp>You can download the updated \u003Ca href=\"https://github.com/eNeRGy164/ReduceJsonTraffic\" rel=\"noopener noreferrer external\" target=\"_blank\">Reduce Json Traffic sample project\u003Cspan>\u003C/span>\u003C/a> on GitHub.\u003C/p>\n\u003Cp>You can also go to \u003Ca href=\"https://github.com/eNeRGy164/ReduceJsonTraffic/commit/a4c639a234236ac78af5a1110d240d5ee06ac105\" rel=\"noopener noreferrer external\" target=\"_blank\">the specific commit\u003Cspan>\u003C/span>\u003C/a> to see the exact changes.\u003C/p>",{"headings":1641,"imagePaths":1656,"frontmatter":1624},[1642,1645,1648,1651,1654,1655],{"depth":780,"slug":1643,"text":1644},"part-2-skip-empty-collections","Part 2: Skip empty collections",{"depth":780,"slug":1646,"text":1647},"removing-the-empty-collection","Removing the empty collection",{"depth":780,"slug":1649,"text":1650},"reviving-empty-collections-on-the-receiving-side","Reviving empty collections on the receiving side",{"depth":198,"slug":1652,"text":1653},"initialize-collections-in-the-constructor","Initialize collections in the constructor",{"depth":780,"slug":1149,"text":1150},{"depth":780,"slug":1056,"text":1057},[],"2016-12-31-speaking-at-dotned-saturday-2017-serious-request-azure-as-scalable-platform",{"id":1657,"data":1659,"body":1669,"filePath":1670,"digest":1671,"rendered":1672},{"id":1660,"title":1661,"date":1662,"updated":1663,"author":15,"excerpt":1664,"layout":17,"permalink":1665,"image":1666,"categories":1667,"tags":1668,"draft":26},1027,"Speaking at dotNed Saturday 2017 – Serious Request, Azure as scalable platform",["Date","2016-12-31T11:24:13.000Z"],["Date","2020-12-06T22:08:20.000Z"],"I’m invited to speak at dotNed Saturday, the Dutch .NET community event.\nMy session, is called “Serious Request, Azure als schaalbaar platform” and I’ll be talking about my experiences using Azure to build a high available, secure and scalable platform for digital donations. This platform is used during “3FM Serious Request”, the annual charity event organized by the Dutch radio station 3FM for the Dutch Red Cross.\n","/2016/12/31/speaking-at-dotned-saturday-2017-serious-request-azure-as-scalable-platform/","/wp-content/uploads/2016/12/post-1027-thumbnail.png",[906],[906,908,873,910,911],"![dotNed Saturday logo](/wp-content/uploads/2016/12/dotned-saturday.png)\r\n\r\nI am invited to speak at [dotNed Saturday](https://dotnedsaturday.nl/), \"_the_ Dutch .NET community event\".\r\n\r\nThe event is held on the 28\u003Csup>th\u003C/sup> of January at InfoSupport in Veenendaal.\r\n\r\n\u003C!--more-->\r\n\r\nMy session, in Dutch, is called \"\u003Cspan lang=\"nl\">**Serious Request, Azure als schaalbaar platform**\u003C/span>\"\r\nand I will be talking about my experiences using Azure to build a high available,\r\nsecure and scalable platform for digital donations.\r\n\r\nThis platform is used during \"[3FM Serious Request](https://nl.wikipedia.org/wiki/3FM_Serious_Request)\",\r\nthe annual charity event organized by the Dutch radio station 3FM for [the Dutch Red Cross](https://www.rodekruis.nl/).\r\n\r\nIf the schedule does not change, I will be speaking in the _Seminarruimte 2_ between 14:30 - 15:30.","src/posts/2016-12-31-speaking-at-dotned-saturday-2017-serious-request-azure-as-scalable-platform.md","02520d59738e5ac9",{"html":1673,"metadata":1674},"\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2016/12/dotned-saturday.webp\" type=\"image/webp\" media=\"(max-width: 296px)\">\u003Cimg src=\"/wp-content/uploads/2016/12/dotned-saturday.png\" alt=\"dotNed Saturday logo\" loading=\"lazy\" decoding=\"async\" width=\"296\" height=\"96\" srcset=\"/wp-content/uploads/2016/12/dotned-saturday.png 296w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>I am invited to speak at \u003Ca href=\"https://dotnedsaturday.nl/\" rel=\"noopener noreferrer external\" target=\"_blank\">dotNed Saturday\u003Cspan>\u003C/span>\u003C/a>, “\u003Cem>the\u003C/em> Dutch .NET community event”.\u003C/p>\n\u003Cp>The event is held on the 28\u003Csup>th\u003C/sup> of January at InfoSupport in Veenendaal.\u003C/p>\n\u003C!--more-->\n\u003Cp>My session, in Dutch, is called “\u003Cspan lang=\"nl\">\u003Cstrong>Serious Request, Azure als schaalbaar platform\u003C/strong>\u003C/span>”\r\nand I will be talking about my experiences using Azure to build a high available,\r\nsecure and scalable platform for digital donations.\u003C/p>\n\u003Cp>This platform is used during “\u003Ca href=\"https://nl.wikipedia.org/wiki/3FM_Serious_Request\" rel=\"noopener noreferrer external\" target=\"_blank\">3FM Serious Request\u003Cspan>\u003C/span>\u003C/a>”,\r\nthe annual charity event organized by the Dutch radio station 3FM for \u003Ca href=\"https://www.rodekruis.nl/\" rel=\"noopener noreferrer external\" target=\"_blank\">the Dutch Red Cross\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>If the schedule does not change, I will be speaking in the \u003Cem>Seminarruimte 2\u003C/em> between 14:30 - 15:30.\u003C/p>",{"headings":1675,"imagePaths":1676,"frontmatter":1659},[],[],"2016-11-25-sending-a-message-to-an-azure-queue-from-a-sandboxed-crm-plug-in",{"id":1677,"data":1679,"body":1691,"filePath":1692,"digest":1693,"rendered":1694},{"id":1680,"title":1681,"date":1682,"updated":1683,"author":15,"excerpt":1684,"layout":17,"permalink":1685,"image":1686,"categories":1687,"tags":1688,"draft":26},911,"Sending a message to an Azure queue from a sandboxed CRM plug-in",["Date","2016-11-25T06:58:11.000Z"],["Date","2021-07-16T20:46:57.000Z"],"A while back I've introduced Sandboxable. It's a means to use NuGet packages that normally are not available for code that runs with Partial Trust.\nIn this post, we will walk through the steps to create a Microsoft Dynamics CRM plug-in that will add a message to an Azure queue.\n","/2016/11/25/sending-a-message-to-an-azure-queue-from-a-sandboxed-crm-plug-in/","/wp-content/uploads/2016/11/post-911-thumbnail.png",[906,183,1302],[906,1304,1592,217,1689,1690,25],"Queue","Sandbox","A while back I have \"[introduced Sandboxable](/2016/07/13/introducing-sandboxable-use-your-favorite-azure-nuget-packages-in-a-sandbox-environment)\".\r\nIt is a means to use NuGet packages that normally are not available for code that runs with Partial Trust.\r\n\r\nIn this article, I will walk through the steps to create a Microsoft Dynamics CRM plug-in that will add a message to an Azure queue.\r\n\r\n\u003C!--more-->\r\n\r\nAt the end of the article, you will find the links to the [complete source code](#sample-code) for you to use.\r\n\r\n## Setting up the project\r\n\r\n1. Create a new `Class Library` project in Visual Studio.\r\n2. Add the following NuGet packages with their dependencies:\r\n   - `Microsoft.CrmSdk.CoreAssemblies`  \r\n      This package will add the base to create a plug-in for CRM\r\n   - `MSBuild.ILMerge.Task`  \r\n      This package makes sure that the generated assembly will also contain all dependencies.  \r\n      More information about this package can be found on the [ILMerge MSBuild task NuGet package CodePlex page](https://web.archive.org/web/20200414123005/https://archive.codeplex.com/?p=ilmergemsbuild)\r\n   - `Sandboxable.Microsoft.WindowsAzure.Storage`  \r\n      This package provides the Azure storage SDK, modified to run in the sandbox.\r\n3. Change the `Copy Local` property for the CRM references to `false`.\r\n   These assemblies are already present in the runtime hosting the sandbox, so they can be kept outside our assembly\r\n4. Enable strong name key signing on your project\r\n\r\nNow you can do a test build of the project to check if everything works correctly.\r\n\r\n## Writing the plug-in\r\n\r\nI've based the plug-in code on the MSDN article \"[Write a plug-in](\u003Chttps://learn.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/gg328263(v=crm.8)>)\".\r\n\r\n### Getting the connection details\r\n\r\nTo connect to an Azure queue, you need 3 details.\r\n\r\n1. The storage account name.\r\n2. One of the storage account access keys.\r\n3. The name of the queue.\r\n\r\nThere are several ways to get these details at runtime.\r\nTo name a few: hard-coded, stored as data in an entity,\r\nstored in a web resource as an XML file or in the plug-in step configuration.\r\n\r\nFor this sample we'll use a JSON string stored in the secure storage property of the plug-in step.\r\n\r\nTo deserialize these settings we use `JsonConvert` with a nested `PluginSettings` class.\r\n\r\n```csharp\r\nPluginSettings pluginSettings =\r\n      JsonConvert.DeserializeObject\u003CPluginSettings>(this.secureString);\r\n```\r\n\r\n### Initializing the Cloud Queue Client\r\n\r\nThe [`CloudQueueClient` class](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.queue.cloudqueueclient?view=azure-dotnet-legacy) offers a straightforward way to manage and use Azure queues.\r\n\r\nTo initialize this class, we need to provide the URL and the [StorageCredentials](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.auth.storagecredentials?view=azure-dotnet-legacy).\r\n\r\n```csharp\r\nStorageCredentials storageCredentials =\r\n      new StorageCredentials(pluginSettings.AccountName, pluginSettings.Key);\r\n\r\nUri baseUri =\r\n      new Uri($\"https://{pluginSettings.AccountName}.queue.core.windows.net\");\r\n\r\nCloudQueueClient queueClient =\r\n      new CloudQueueClient(baseUri, storageCredentials);\r\n```\r\n\r\n### Creating a reference to the queue\r\n\r\nWith the queue client, we can create a reference to the [CloudQueue](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.queue.cloudqueue?view=azure-dotnet-legacy) with the name that is stored in the constant named `QueueName`.\r\n\r\nTo make sure the queue exists, we call the [`CreateIfNotExists` method](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.queue.cloudqueue.createifnotexists?view=azure-dotnet-legacy) which ensures us if there is not a queue present yet, it will be created for us at that moment.\r\n\r\n```csharp\r\nCloudQueue queue = queueClient.GetQueueReference(QueueName);\r\n\r\nqueue.CreateIfNotExists();\r\n```\r\n\r\n### Adding the message to the queue\r\n\r\nWe create some message data, using the context of the current plug-in execution.\r\nThis data is wrapped in a [CloudQueueMessage](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.queue.cloudqueuemessage?view=azure-dotnet-legacy).\r\n\r\nWe add the message to the queue,\r\nusing the [`AddMessage` method](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.queue.cloudqueue.addmessage?view=azure-dotnet-legacy) and we are done!\r\n\r\n```csharp\r\nvar messageData = new\r\n{\r\n  context.UserId,\r\n  context.MessageName,\r\n  entity.LogicalName,\r\n  entity.Id,\r\n  entity.Attributes\r\n};\r\n\r\nCloudQueueMessage queueMessage =\r\n      new CloudQueueMessage(JsonConvert.SerializeObject(messageData));\r\n\r\nqueue.AddMessage(queueMessage);\r\n```\r\n\r\nWe must build our project again so we can proceed.\r\n\r\n## Register the plug-in assembly\r\n\r\nNow the freshly baked assembly needs to be registered on the server.  \r\nThe steps to do this are outside the scope for this post but more information can be found in the\r\n[Walkthrough: Register a plug-in using the plug-in registration tool](\u003Chttps://learn.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/gg309580(v=crm.8)>).\r\n\r\n## Register the plug-in step for an event\r\n\r\nTo test the plug-in, we’ll register it on the creation event of the `contact` entity.  \r\nFor performance optimization we’ll choose the asynchronous execution method.\r\n\r\n> [!WARNING]\r\n> External resources should never be part of your synchronous pipeline.\r\n\r\nIn the `Secure Configuration` property, we set the value with the JSON object containing the connection information:\r\n\r\n```json\r\n{\r\n  \"AccountName\": \"loremipsum\",\r\n  \"Key\": \"DDWLOREM...IPSUMr0A==\"\r\n}\r\n```\r\n\r\n\u003Csmall>(Obviously, these values do not represent real data)\u003C/small>\r\n\r\n![Register the plug-in step for the creation event of contact entities](/wp-content/uploads/2016/11/register-new-step.png)\r\n\r\n## Testing the plug-in\r\n\r\nWe create a new contact in CRM called _Sample User_.\r\n\r\nAfter a couple of seconds, we see the following message appear on the queue:\r\n\r\n```json\r\n{\r\n  \"UserId\":\"d617a1a0-359a-e411-9407-00155d0ae259\",\r\n  \"MessageName\":\"Create\",\r\n  \"LogicalName\":\"contact\",\r\n  \"Id\":\"6e843a34-91b1-e611-80e4-00155d0a0b40\",\r\n  \"Attributes\":[\r\n    {\r\n      \"Key\":\"firstname\",\r\n      \"Value\":\"Sample\"\r\n    },\r\n    {\r\n      \"Key\":\"lastname\",\r\n      \"Value\":\"User\"\r\n    },\r\n    {\r\n      \"Key\":\"fullname\",\r\n      \"Value\":\"Sample User\"\r\n    },\r\n    ...\r\n  ]\r\n}\r\n```\r\n\r\n\u003Csmall>(Formatted for readability)\u003C/small>\r\n\r\n## Concluding\r\n\r\nBy utilizing the Azure SDK, we only needed a few lines of code to send messages to an Azure queue and making all sorts of integration with other systems possible.\r\n\r\nBy using the Sandboxable project we’re no longer limited by the sandbox.\r\n\r\n## Sample code\r\n\r\nThe complete source code is available as [sample project](https://github.com/Winvision/Sandboxable-Samples/tree/master/src/CrmQueue).\r\n\r\nExpect more samples in the [**Sandboxable-Samples** repository on GitHub](https://github.com/Winvision/Sandboxable-Samples) in the future.","src/posts/2016-11-25-sending-a-message-to-an-azure-queue-from-a-sandboxed-crm-plug-in.md","d4a2045e9ab75eb1",{"html":1695,"metadata":1696},"\u003Cp>A while back I have “\u003Ca href=\"/2016/07/13/introducing-sandboxable-use-your-favorite-azure-nuget-packages-in-a-sandbox-environment\">introduced Sandboxable\u003C/a>”.\r\nIt is a means to use NuGet packages that normally are not available for code that runs with Partial Trust.\u003C/p>\n\u003Cp>In this article, I will walk through the steps to create a Microsoft Dynamics \u003Cdfn>\u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr>\u003C/dfn> plug-in that will add a message to an Azure queue.\u003C/p>\n\u003C!--more-->\n\u003Cp>At the end of the article, you will find the links to the \u003Ca href=\"#sample-code\">complete source code\u003C/a> for you to use.\u003C/p>\n\u003Ch2 id=\"setting-up-the-project\">Setting up the project\u003C/h2>\n\u003Col>\n\u003Cli>Create a new \u003Ccode>Class Library\u003C/code> project in Visual Studio.\u003C/li>\n\u003Cli>Add the following NuGet packages with their dependencies:\n\u003Cul>\n\u003Cli>\u003Ccode>Microsoft.CrmSdk.CoreAssemblies\u003C/code>\u003Cbr>\nThis package will add the base to create a plug-in for \u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr>\u003C/li>\n\u003Cli>\u003Ccode>MSBuild.ILMerge.Task\u003C/code>\u003Cbr>\nThis package makes sure that the generated assembly will also contain all dependencies.\u003Cbr>\nMore information about this package can be found on the \u003Ca href=\"https://web.archive.org/web/20200414123005/https://archive.codeplex.com/?p=ilmergemsbuild\" rel=\"noopener noreferrer external\" target=\"_blank\">ILMerge MSBuild task NuGet package CodePlex page\u003Cspan>\u003C/span>\u003C/a>\u003C/li>\n\u003Cli>\u003Ccode>Sandboxable.Microsoft.WindowsAzure.Storage\u003C/code>\u003Cbr>\nThis package provides the Azure storage \u003Cdfn>\u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/dfn>, modified to run in the sandbox.\u003C/li>\n\u003C/ul>\n\u003C/li>\n\u003Cli>Change the \u003Ccode>Copy Local\u003C/code> property for the \u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr> references to \u003Ccode>false\u003C/code>.\r\nThese assemblies are already present in the runtime hosting the sandbox, so they can be kept outside our assembly\u003C/li>\n\u003Cli>Enable strong name key signing on your project\u003C/li>\n\u003C/ol>\n\u003Cp>Now you can do a test build of the project to check if everything works correctly.\u003C/p>\n\u003Ch2 id=\"writing-the-plug-in\">Writing the plug-in\u003C/h2>\n\u003Cp>I’ve based the plug-in code on the \u003Cdfn>\u003Cabbr title=\"Microsoft Developer Network\">MSDN\u003C/abbr>\u003C/dfn> article “\u003Ca href=\"https://learn.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/gg328263(v=crm.8)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Write a plug-in\u003Cspan>\u003C/span>\u003C/a>”.\u003C/p>\n\u003Ch3 id=\"getting-the-connection-details\">Getting the connection details\u003C/h3>\n\u003Cp>To connect to an Azure queue, you need 3 details.\u003C/p>\n\u003Col>\n\u003Cli>The storage account name.\u003C/li>\n\u003Cli>One of the storage account access keys.\u003C/li>\n\u003Cli>The name of the queue.\u003C/li>\n\u003C/ol>\n\u003Cp>There are several ways to get these details at runtime.\r\nTo name a few: hard-coded, stored as data in an entity,\r\nstored in a web resource as an \u003Cdfn>\u003Cabbr title=\"eXtensible Markup Language\">XML\u003C/abbr>\u003C/dfn> file or in the plug-in step configuration.\u003C/p>\n\u003Cp>For this sample we’ll use a \u003Cdfn>\u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr>\u003C/dfn> string stored in the secure storage property of the plug-in step.\u003C/p>\n\u003Cp>To deserialize these settings we use \u003Ccode>JsonConvert\u003C/code> with a nested \u003Ccode>PluginSettings\u003C/code> class.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:71ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">PluginSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">pluginSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">JsonConvert\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">DeserializeObject\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">PluginSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">>(\u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">secureString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"PluginSettings pluginSettings =      JsonConvert.DeserializeObject\u003CPluginSettings>(this.secureString);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"initializing-the-cloud-queue-client\">Initializing the Cloud Queue Client\u003C/h3>\n\u003Cp>The \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.queue.cloudqueueclient?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>CloudQueueClient\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> offers a straightforward way to manage and use Azure queues.\u003C/p>\n\u003Cp>To initialize this class, we need to provide the \u003Cdfn>\u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>\u003C/dfn> and the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.auth.storagecredentials?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">StorageCredentials\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:78ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">StorageCredentials\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">storageCredentials\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">StorageCredentials\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">pluginSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">AccountName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">pluginSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Key\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">Uri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">baseUri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Uri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">$\"https://{\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">pluginSettings\u003C/span>\u003Cspan style=\"--0:#CE9178\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">AccountName\u003C/span>\u003Cspan style=\"--0:#CE9178\">}.queue.core.windows.net\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">CloudQueueClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">queueClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">CloudQueueClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">baseUri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">storageCredentials\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"StorageCredentials storageCredentials =      new StorageCredentials(pluginSettings.AccountName, pluginSettings.Key);Uri baseUri =      new Uri($&#x22;https://{pluginSettings.AccountName}.queue.core.windows.net&#x22;);CloudQueueClient queueClient =      new CloudQueueClient(baseUri, storageCredentials);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"creating-a-reference-to-the-queue\">Creating a reference to the queue\u003C/h3>\n\u003Cp>With the queue client, we can create a reference to the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.queue.cloudqueue?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">CloudQueue\u003Cspan>\u003C/span>\u003C/a> with the name that is stored in the constant named \u003Ccode>QueueName\u003C/code>.\u003C/p>\n\u003Cp>To make sure the queue exists, we call the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.queue.cloudqueue.createifnotexists?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>CreateIfNotExists\u003C/code> method\u003Cspan>\u003C/span>\u003C/a> which ensures us if there is not a queue present yet, it will be created for us at that moment.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:60ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">CloudQueue\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">queue\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">queueClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetQueueReference\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">QueueName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">queue\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CreateIfNotExists\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"CloudQueue queue = queueClient.GetQueueReference(QueueName);queue.CreateIfNotExists();\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"adding-the-message-to-the-queue\">Adding the message to the queue\u003C/h3>\n\u003Cp>We create some message data, using the context of the current plug-in execution.\r\nThis data is wrapped in a \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.queue.cloudqueuemessage?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">CloudQueueMessage\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>We add the message to the queue,\r\nusing the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.queue.cloudqueue.addmessage?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>AddMessage\u003C/code> method\u003Cspan>\u003C/span>\u003C/a> and we are done!\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:70ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">messageData\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">UserId\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">MessageName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entity\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LogicalName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entity\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Id\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entity\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Attributes\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">CloudQueueMessage\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">queueMessage\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">CloudQueueMessage\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">JsonConvert\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">SerializeObject\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">messageData\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">));\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">queue\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">AddMessage\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">queueMessage\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var messageData = new{  context.UserId,  context.MessageName,  entity.LogicalName,  entity.Id,  entity.Attributes};CloudQueueMessage queueMessage =      new CloudQueueMessage(JsonConvert.SerializeObject(messageData));queue.AddMessage(queueMessage);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>We must build our project again so we can proceed.\u003C/p>\n\u003Ch2 id=\"register-the-plug-in-assembly\">Register the plug-in assembly\u003C/h2>\n\u003Cp>Now the freshly baked assembly needs to be registered on the server.\u003Cbr>\nThe steps to do this are outside the scope for this post but more information can be found in the\r\n\u003Ca href=\"https://learn.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/gg309580(v=crm.8)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Walkthrough: Register a plug-in using the plug-in registration tool\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Ch2 id=\"register-the-plug-in-step-for-an-event\">Register the plug-in step for an event\u003C/h2>\n\u003Cp>To test the plug-in, we’ll register it on the creation event of the \u003Ccode>contact\u003C/code> entity.\u003Cbr>\nFor performance optimization we’ll choose the asynchronous execution method.\u003C/p>\n\u003Cdiv class=\"markdown-alert markdown-alert-warning\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.146.146 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.163.163 0 0 1-.054.06.116.116 0 0 1-.066.017H1.146a.115.115 0 0 1-.066-.017.163.163 0 0 1-.054-.06.176.176 0 0 1 .002-.183L7.884 2.073a.147.147 0 0 1 .054-.057zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z\">\u003C/path>\u003Cpath d=\"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z\">\u003C/path>\u003C/svg>Warning\u003C/p>\n\u003Cp>\r\nExternal resources should never be part of your synchronous pipeline.\u003C/p>\n\u003C/div>\n\u003Cp>In the \u003Ccode>Secure Configuration\u003C/code> property, we set the value with the \u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr> object containing the connection information:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:32ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"AccountName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"loremipsum\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Key\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"DDWLOREM...IPSUMr0A==\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;AccountName&#x22;: &#x22;loremipsum&#x22;,  &#x22;Key&#x22;: &#x22;DDWLOREM...IPSUMr0A==&#x22;}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Csmall>(Obviously, these values do not represent real data)\u003C/small>\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2016/11/register-new-step.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2016/11/register-new-step.webp\" type=\"image/webp\" media=\"(max-width: 1000px)\">\u003Csource srcset=\"/wp-content/uploads/2016/11/register-new-step-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2016/11/register-new-step-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2016/11/register-new-step-636x401.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2016/11/register-new-step-636x401.png\" alt=\"Register the plug-in step for the creation event of contact entities\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"401\" srcset=\"/wp-content/uploads/2016/11/register-new-step.png 1000w, /wp-content/uploads/2016/11/register-new-step-150x150.png 150w, /wp-content/uploads/2016/11/register-new-step-185x185.png 185w, /wp-content/uploads/2016/11/register-new-step-636x401.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003C/figure>\n\u003Ch2 id=\"testing-the-plug-in\">Testing the plug-in\u003C/h2>\n\u003Cp>We create a new contact in \u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr> called \u003Cem>Sample User\u003C/em>.\u003C/p>\n\u003Cp>After a couple of seconds, we see the following message appear on the queue:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:50ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"UserId\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"d617a1a0-359a-e411-9407-00155d0ae259\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"MessageName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Create\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"LogicalName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"contact\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Id\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"6e843a34-91b1-e611-80e4-00155d0a0b40\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Attributes\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:[\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Key\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"firstname\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Sample\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Key\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"lastname\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"User\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Key\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"fullname\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Sample User\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F66767\">...\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;UserId&#x22;:&#x22;d617a1a0-359a-e411-9407-00155d0ae259&#x22;,  &#x22;MessageName&#x22;:&#x22;Create&#x22;,  &#x22;LogicalName&#x22;:&#x22;contact&#x22;,  &#x22;Id&#x22;:&#x22;6e843a34-91b1-e611-80e4-00155d0a0b40&#x22;,  &#x22;Attributes&#x22;:[    {      &#x22;Key&#x22;:&#x22;firstname&#x22;,      &#x22;Value&#x22;:&#x22;Sample&#x22;    },    {      &#x22;Key&#x22;:&#x22;lastname&#x22;,      &#x22;Value&#x22;:&#x22;User&#x22;    },    {      &#x22;Key&#x22;:&#x22;fullname&#x22;,      &#x22;Value&#x22;:&#x22;Sample User&#x22;    },    ...  ]}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Csmall>(Formatted for readability)\u003C/small>\u003C/p>\n\u003Ch2 id=\"concluding\">Concluding\u003C/h2>\n\u003Cp>By utilizing the Azure \u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>, we only needed a few lines of code to send messages to an Azure queue and making all sorts of integration with other systems possible.\u003C/p>\n\u003Cp>By using the Sandboxable project we’re no longer limited by the sandbox.\u003C/p>\n\u003Ch2 id=\"sample-code\">Sample code\u003C/h2>\n\u003Cp>The complete source code is available as \u003Ca href=\"https://github.com/Winvision/Sandboxable-Samples/tree/master/src/CrmQueue\" rel=\"noopener noreferrer external\" target=\"_blank\">sample project\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>Expect more samples in the \u003Ca href=\"https://github.com/Winvision/Sandboxable-Samples\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Cstrong>Sandboxable-Samples\u003C/strong> repository on GitHub\u003Cspan>\u003C/span>\u003C/a> in the future.\u003C/p>",{"headings":1697,"imagePaths":1729,"frontmatter":1679},[1698,1701,1704,1707,1710,1713,1716,1719,1722,1725,1728],{"depth":780,"slug":1699,"text":1700},"setting-up-the-project","Setting up the project",{"depth":780,"slug":1702,"text":1703},"writing-the-plug-in","Writing the plug-in",{"depth":198,"slug":1705,"text":1706},"getting-the-connection-details","Getting the connection details",{"depth":198,"slug":1708,"text":1709},"initializing-the-cloud-queue-client","Initializing the Cloud Queue Client",{"depth":198,"slug":1711,"text":1712},"creating-a-reference-to-the-queue","Creating a reference to the queue",{"depth":198,"slug":1714,"text":1715},"adding-the-message-to-the-queue","Adding the message to the queue",{"depth":780,"slug":1717,"text":1718},"register-the-plug-in-assembly","Register the plug-in assembly",{"depth":780,"slug":1720,"text":1721},"register-the-plug-in-step-for-an-event","Register the plug-in step for an event",{"depth":780,"slug":1723,"text":1724},"testing-the-plug-in","Testing the plug-in",{"depth":780,"slug":1726,"text":1727},"concluding","Concluding",{"depth":780,"slug":1247,"text":1248},[],"2016-12-14-storing-entities-on-azure-blob-storage-from-a-sandboxed-crm-plug-in",{"id":1730,"data":1732,"body":1743,"filePath":1744,"digest":1745,"rendered":1746},{"id":1733,"title":1734,"date":1735,"updated":1736,"author":15,"excerpt":1737,"layout":17,"permalink":1738,"image":1739,"categories":1740,"tags":1741,"draft":26},1003,"Storing entities on Azure blob storage from a sandboxed CRM plug-in",["Date","2016-12-14T08:53:46.000Z"],["Date","2021-07-16T20:45:25.000Z"],"This post will be about a new sample of using “Sandboxable”.\nWe will walk through the steps to create a Microsoft Dynamics CRM plug-in that on deletion of any record, stores the deleted data as a file on Azure blob storage.\n","/2016/12/14/storing-entities-on-azure-blob-storage-from-a-sandboxed-crm-plug-in/","/wp-content/uploads/2016/12/post-1003-thumbnail.png",[906,183,1302],[906,1742,1304,1592,217,1690,25],"Blob","This post will be about a new sample of using \"[Sandboxable](/2016/07/13/introducing-sandboxable-use-your-favorite-azure-nuget-packages-in-a-sandbox-environment)\".\r\n\u003Ctime datetime=\"2016-11-25\">Earlier\u003C/time> I wrote an article about [sending messages on an Azure queue](/2016/11/25/sending-a-message-to-an-azure-queue-from-a-sandboxed-crm-plug-in).\r\n\r\nIn this article, I will walk through the steps to create a Microsoft Dynamics CRM plug-in that on deletion of any record,\r\nstores the deleted data as a file on Azure blob storage.\r\n\r\n\u003C!--more-->\r\n\r\n> [!NOTE]\r\n> When using Azure blobs to store data, you should enable [Azure Storage Service Encryption for Data at Rest](https://docs.microsoft.com/en-us/azure/storage/common/storage-service-encryption).\r\n\r\nAs usual, you will find the links to the [complete source code](#sample-code) at the end of this post.\r\n\r\n## Setting up the project\r\n\r\nFor this sample, the steps for [setting up the project](/2016/11/25/sending-a-message-to-an-azure-queue-from-a-sandboxed-crm-plug-in#setting-up-the-project) are the same as the steps described in the previous post.\r\nSo, I will not list them here again.\r\n\r\n## Writing the plug-in\r\n\r\nI have based the plug-in code on the MSDN article \"[Write a plug-in](\u003Chttps://learn.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/gg328263(v=crm.8)>)\".\r\n\r\n### Getting the deleted entity\r\n\r\nTo get the details about the deleted record we need to get them from the [`PreEntityImage` collection](\u003Chttps://learn.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/gg326980(v=crm.8)>).\r\nThe registration of a `Pre-Image` will be described later in this post.\r\n\r\n```csharp\r\nEntity entity = context.PreEntityImages[\"Target\"];\r\n```\r\n\r\n### Getting the connection details\r\n\r\nTo connect to Azure blob storage, you need 2 details.\r\n\r\n1. The storage account name.\r\n2. One of the storage account access keys.\r\n\r\nFor this sample, I will use a JSON string stored in the secure storage property of the plug-in step.\r\n\r\nTo deserialize these settings we use `JsonConvert` with a nested `PluginSettings` class.\r\n\r\n```csharp\r\nPluginSettings pluginSettings =\r\n      JsonConvert.DeserializeObject\u003CPluginSettings>(this.secureString);\r\n```\r\n\r\n### Initializing the Cloud Blob Client\r\n\r\nThe [`CloudBlobClient` class](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblobclient?view=azure-dotnet-legacy) offers an easy way to manage and use all Azure blob storage related resources.\r\n\r\nTo initialize this class, we need to provide the URL and the [StorageCredentials](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.auth.storagecredentials?view=azure-dotnet-legacy).\r\n\r\n```csharp\r\nStorageCredentials storageCredentials =\r\n      new StorageCredentials(pluginSettings.AccountName, pluginSettings.Key);\r\n\r\nUri baseUri =\r\n      new Uri($\"https://{pluginSettings.AccountName}.blob.core.windows.net\");\r\n\r\nCloudBlobClient blobClient =\r\n      new CloudBlobClient(baseUri, storageCredentials);\r\n```\r\n\r\n### Creating a root container\r\n\r\nFirst, make sure there is a container to store all the contents generated by this plug-in.\r\n\r\nWith the blob client, we can create a reference to the [CloudBlobContainer](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblobcontainer?view=azure-dotnet-legacy) with the name that is stored in the constant named `FolderName`.\r\n\r\nTo make sure the container exists, we call the [`CreateIfNotExists` method](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblobcontainer.createifnotexistsasync?view=azure-dotnet-legacy) which ensures us if there is not a container present yet, it will be created at that moment.\r\n\r\n```csharp\r\nCloudBlobContainer container = blobClient.GetContainerReference(FolderName);\r\n\r\ncontainer.CreateIfNotExists();\r\n```\r\n\r\n#### Creating an entity directory\r\n\r\nNow we want to create a directory inside the container to store entity specific records.\r\n\r\n```csharp\r\nCloudBlobDirectory entityDirectory =\r\n      container.GetDirectoryReference(entity.LogicalName);\r\n```\r\n\r\n> [!NOTE]\r\n> Directories differ from containers because they do not exist on disk.\r\n> That is why we do not need to check if the directory already exists.\r\n> If you are interested in more details, I recommend the article [Modeling a Directory Structure on Azure Blob Storage](https://johnatten.com/2013/05/24/modeling-a-directory-structure-on-azure-blob-storage/) by John Atten.\r\n\r\n### Adding a blob to the directory\r\n\r\nJust like the container and the directory before, we also need to create a reference for the blob.\r\n\r\nOn the blob directory ask for a reference to the [CloudBlockBlob](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblockblob?view=azure-dotnet-legacy) using the [`GetBlockBlobReference` method](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblobcontainer.getblockblobreference?view=azure-dotnet-legacy).\r\n\r\n```csharp\r\nstring fileName = entity.Id.ToString(\"N\") + \".json\";\r\n\r\nCloudBlockBlob blob = entityDirectory.GetBlockBlobReference(fileName);\r\n```\r\n\r\nWe will not create the blob immediately because we want to add some details about the content we are about to store.\r\nThis can be done by setting the `Properties` and `Metadata` properties of the blob.\r\n\r\nOne of the [BlobProperties](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.blobproperties?view=azure-dotnet-legacy)\r\nwe want to set is the [`ContentType` property](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.blobproperties.contenttype?view=azure-dotnet-legacy).\r\nThis will allow other systems to recognize the file correctly as a JSON file.\r\n\r\n```csharp\r\nblob.Properties.ContentType = \"application/json\";\r\n```\r\n\r\nHowever, the `BlobProperties` only contains a fixed set of properties.\r\n\r\nBy using the [`Metadata` property](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblob.metadata?view=azure-dotnet-legacy)\r\non the blob allows us to store custom metadata with the blob.\r\n\r\n```csharp\r\nblob.Metadata[\"userid\"] = context.UserId.ToString(\"B\").ToLowerInvariant();\r\nblob.Metadata[\"userfullname\"] = fullName;\r\nblob.Metadata[\"deletiondate\"] = context.OperationCreatedOn.ToString(\"O\");\r\n```\r\n\r\nNow it is time to write some file contents to the blob.\r\nWe create blob data, using the context of the current plug-in execution.\r\nFor demonstration purposes we serialize the JSON with the [Formatting](https://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_Formatting.htm) option set to `Indented`.\r\n\r\nBecause the blob content is plain text, we can use the [UploadText method](https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblockblob.uploadtext?view=azure-dotnet-legacy).\r\n\r\n```csharp\r\nvar blobData = new\r\n  {\r\n    context.UserId,\r\n    FullName = fullName,\r\n    context.MessageName,\r\n    entity.LogicalName,\r\n    entity.Id,\r\n    entity.Attributes\r\n  };\r\n\r\nblob.UploadText(JsonConvert.SerializeObject(blobData, Formatting.Indented));\r\n```\r\n\r\nNow build the project so we can proceed.\r\n\r\n## Register the plug-in assembly\r\n\r\nNow the freshly baked assembly needs to be registered on the server.  \r\nThe steps to do this are outside the scope for this post, but more information can be found in the\r\n[walkthrough: Register a plug-in using the plug-in registration tool](\u003Chttps://learn.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/gg309580(v=crm.8)>).\r\n\r\n## Register the plug-in step for an event\r\n\r\nTo test the plug-in, we’ll register it asynchronously on the deletion event of every entity.\r\n\r\n> [!WARNING]\r\n> Dependencies on external resources should never be part of a synchronous pipeline.\r\n\r\nIn the `Secure Configuration` property, we set the value with the JSON object containing the connection information:\r\n\r\n```json\r\n{\r\n  \"AccountName\": \"loremipsum\",\r\n  \"Key\": \"DDWLOREM...IPSUMr0A==\"\r\n}\r\n```\r\n\r\n\u003Csmall>(Obviously, these values do not represent real data)\u003C/small>\r\n\r\n![Register the plug-in step for the deletion event of any entity](/wp-content/uploads/2016/12/register-step-delete-all-entities.png)\r\n\r\nBecause we are working with the deletion event, we need to register a `Pre-Image` to capture the values of all attributes before the actual deletion took place.\r\n\r\nWe set the value of the `Name` and the `Entity Alias` properties to `Target`\r\n\r\n![Register a new image for the plug-in step for the deletion event of any entity](/wp-content/uploads/2016/12/register-new-image-delete-all-entities.png)\r\n\r\n## Testing the plug-in\r\n\r\nWe delete a contact in CRM. In my case the contact is called _Sample User_.\r\n\r\nAfter a couple of seconds, we see the following container and directories appear on the storage account:\r\n\r\n![The \"samplecrmfolder\" container with multiple directories for different entities](/wp-content/uploads/2016/12/sample-crm-folder.png)\r\n\r\n\u003Csmall>Screenshot from [Azure Management Studio by Cerebrata](https://cerebrata.com/features/azure-storage)\u003C/small>\r\n\r\nOpening the file in the `contact` directory, shows us some familiar content:\r\n\r\n```json\r\n{\r\n  \"UserId\": \"d617a1a0-359a-e411-9407-00155d0ae259\",\r\n  \"FullName\": \"Lorem Ipsum\",\r\n  \"MessageName\": \"Delete\",\r\n  \"LogicalName\": \"contact\",\r\n  \"Id\": \"6e843a34-91b1-e611-80e4-00155d0a0b40\",\r\n  \"Attributes\": [\r\n    {\r\n      \"Key\": \"firstname\",\r\n      \"Value\": \"Sample\"\r\n    },\r\n    {\r\n      \"Key\": \"lastname\",\r\n      \"Value\": \"User\"\r\n    },\r\n    {\r\n      \"Key\": \"fullname\",\r\n      \"Value\": \"Sample User\"\r\n    },\r\n    ...\r\n  ]\r\n}\r\n```\r\n\r\nIf we look at the HTTP response header when retrieving the file,\r\nwe see that the content type and metadata properties are present:\r\n\r\n```http {2,5-7}\r\nHTTP/1.1 200 OK\r\nContent-Type: application/json\r\nServer: Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0\r\nx-ms-version: 2015-12-11\r\nx-ms-meta-userid: {d617a1a0-359a-e411-9407-00155d0ae259}\r\nx-ms-meta-userfullname: Lorem Ipsum\r\nx-ms-meta-deletiondate: 2016-12-08T14:23:25.5635361Z\r\nx-ms-blob-type: BlockBlob\r\n```\r\n\r\n## Concluding\r\n\r\nBy utilizing the Sandboxable Azure SDK, we only needed a few lines of code to store deleted CRM records in Azure blob storage, making a remote archive a piece of cake.\r\n\r\n> [!TIP]\r\n> When using blob storage for archiving you might want to look at\r\n> [Blob Storage Accounts with Cool storage tier](https://learn.microsoft.com/azure/storage/blobs/access-tiers-overview?tabs=azure-portal#cold-tier)\r\n> which might save you same money.\r\n\r\n## Sample code\r\n\r\nThe complete source code is available as a [sample project](https://github.com/Winvision/Sandboxable-Samples/tree/master/src/CrmBlob).\r\n\r\nExpect more samples in the [Sandboxable-Samples repository on GitHub](https://github.com/Winvision/Sandboxable-Samples) in the future.","src/posts/2016-12-14-storing-entities-on-azure-blob-storage-from-a-sandboxed-crm-plug-in.md","ef52b1da846248e8",{"html":1747,"metadata":1748},"\u003Cp>This post will be about a new sample of using “\u003Ca href=\"/2016/07/13/introducing-sandboxable-use-your-favorite-azure-nuget-packages-in-a-sandbox-environment\">Sandboxable\u003C/a>”.\r\n\u003Ctime datetime=\"2016-11-25\">Earlier\u003C/time> I wrote an article about \u003Ca href=\"/2016/11/25/sending-a-message-to-an-azure-queue-from-a-sandboxed-crm-plug-in\">sending messages on an Azure queue\u003C/a>.\u003C/p>\n\u003Cp>In this article, I will walk through the steps to create a Microsoft Dynamics \u003Cdfn>\u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr>\u003C/dfn> plug-in that on deletion of any record,\r\nstores the deleted data as a file on Azure blob storage.\u003C/p>\n\u003C!--more-->\n\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\r\nWhen using Azure blobs to store data, you should enable \u003Ca href=\"https://docs.microsoft.com/en-us/azure/storage/common/storage-service-encryption?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Azure Storage Service Encryption for Data at Rest\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003C/div>\n\u003Cp>As usual, you will find the links to the \u003Ca href=\"#sample-code\">complete source code\u003C/a> at the end of this post.\u003C/p>\n\u003Ch2 id=\"setting-up-the-project\">Setting up the project\u003C/h2>\n\u003Cp>For this sample, the steps for \u003Ca href=\"/2016/11/25/sending-a-message-to-an-azure-queue-from-a-sandboxed-crm-plug-in#setting-up-the-project\">setting up the project\u003C/a> are the same as the steps described in the previous post.\r\nSo, I will not list them here again.\u003C/p>\n\u003Ch2 id=\"writing-the-plug-in\">Writing the plug-in\u003C/h2>\n\u003Cp>I have based the plug-in code on the \u003Cdfn>\u003Cabbr title=\"Microsoft Developer Network\">MSDN\u003C/abbr>\u003C/dfn> article “\u003Ca href=\"https://learn.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/gg328263(v=crm.8)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Write a plug-in\u003Cspan>\u003C/span>\u003C/a>”.\u003C/p>\n\u003Ch3 id=\"getting-the-deleted-entity\">Getting the deleted entity\u003C/h3>\n\u003Cp>To get the details about the deleted record we need to get them from the \u003Ca href=\"https://learn.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/gg326980(v=crm.8)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>PreEntityImage\u003C/code> collection\u003Cspan>\u003C/span>\u003C/a>.\r\nThe registration of a \u003Ccode>Pre-Image\u003C/code> will be described later in this post.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:50ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">Entity\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entity\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">PreEntityImages\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Target\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">];\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Entity entity = context.PreEntityImages[&#x22;Target&#x22;];\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"getting-the-connection-details\">Getting the connection details\u003C/h3>\n\u003Cp>To connect to Azure blob storage, you need 2 details.\u003C/p>\n\u003Col>\n\u003Cli>The storage account name.\u003C/li>\n\u003Cli>One of the storage account access keys.\u003C/li>\n\u003C/ol>\n\u003Cp>For this sample, I will use a \u003Cdfn>\u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr>\u003C/dfn> string stored in the secure storage property of the plug-in step.\u003C/p>\n\u003Cp>To deserialize these settings we use \u003Ccode>JsonConvert\u003C/code> with a nested \u003Ccode>PluginSettings\u003C/code> class.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:71ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">PluginSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">pluginSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">JsonConvert\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">DeserializeObject\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">PluginSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">>(\u003C/span>\u003Cspan style=\"--0:#569CD6\">this\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">secureString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"PluginSettings pluginSettings =      JsonConvert.DeserializeObject\u003CPluginSettings>(this.secureString);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"initializing-the-cloud-blob-client\">Initializing the Cloud Blob Client\u003C/h3>\n\u003Cp>The \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblobclient?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>CloudBlobClient\u003C/code> class\u003Cspan>\u003C/span>\u003C/a> offers an easy way to manage and use all Azure blob storage related resources.\u003C/p>\n\u003Cp>To initialize this class, we need to provide the \u003Cdfn>\u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>\u003C/dfn> and the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.auth.storagecredentials?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">StorageCredentials\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:77ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">StorageCredentials\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">storageCredentials\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">StorageCredentials\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">pluginSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">AccountName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">pluginSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Key\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">Uri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">baseUri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Uri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">$\"https://{\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">pluginSettings\u003C/span>\u003Cspan style=\"--0:#CE9178\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">AccountName\u003C/span>\u003Cspan style=\"--0:#CE9178\">}.blob.core.windows.net\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">CloudBlobClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">blobClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">CloudBlobClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">baseUri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">storageCredentials\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"StorageCredentials storageCredentials =      new StorageCredentials(pluginSettings.AccountName, pluginSettings.Key);Uri baseUri =      new Uri($&#x22;https://{pluginSettings.AccountName}.blob.core.windows.net&#x22;);CloudBlobClient blobClient =      new CloudBlobClient(baseUri, storageCredentials);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch3 id=\"creating-a-root-container\">Creating a root container\u003C/h3>\n\u003Cp>First, make sure there is a container to store all the contents generated by this plug-in.\u003C/p>\n\u003Cp>With the blob client, we can create a reference to the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblobcontainer?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">CloudBlobContainer\u003Cspan>\u003C/span>\u003C/a> with the name that is stored in the constant named \u003Ccode>FolderName\u003C/code>.\u003C/p>\n\u003Cp>To make sure the container exists, we call the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblobcontainer.createifnotexistsasync?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>CreateIfNotExists\u003C/code> method\u003Cspan>\u003C/span>\u003C/a> which ensures us if there is not a container present yet, it will be created at that moment.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:76ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">CloudBlobContainer\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">container\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">blobClient\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetContainerReference\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">FolderName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">container\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CreateIfNotExists\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"CloudBlobContainer container = blobClient.GetContainerReference(FolderName);container.CreateIfNotExists();\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch4 id=\"creating-an-entity-directory\">Creating an entity directory\u003C/h4>\n\u003Cp>Now we want to create a directory inside the container to store entity specific records.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:58ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">CloudBlobDirectory\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entityDirectory\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">container\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetDirectoryReference\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entity\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LogicalName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"CloudBlobDirectory entityDirectory =      container.GetDirectoryReference(entity.LogicalName);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\r\nDirectories differ from containers because they do not exist on disk.\r\nThat is why we do not need to check if the directory already exists.\r\nIf you are interested in more details, I recommend the article \u003Ca href=\"https://johnatten.com/2013/05/24/modeling-a-directory-structure-on-azure-blob-storage/\" rel=\"noopener noreferrer external\" target=\"_blank\">Modeling a Directory Structure on Azure Blob Storage\u003Cspan>\u003C/span>\u003C/a> by John Atten.\u003C/p>\n\u003C/div>\n\u003Ch3 id=\"adding-a-blob-to-the-directory\">Adding a blob to the directory\u003C/h3>\n\u003Cp>Just like the container and the directory before, we also need to create a reference for the blob.\u003C/p>\n\u003Cp>On the blob directory ask for a reference to the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblockblob?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">CloudBlockBlob\u003Cspan>\u003C/span>\u003C/a> using the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblobcontainer.getblockblobreference?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>GetBlockBlobReference\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:70ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">fileName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entity\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Id\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"N\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">+\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\".json\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#4EC9B0\">CloudBlockBlob\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">blob\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entityDirectory\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">GetBlockBlobReference\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">fileName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"string fileName = entity.Id.ToString(&#x22;N&#x22;) + &#x22;.json&#x22;;CloudBlockBlob blob = entityDirectory.GetBlockBlobReference(fileName);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>We will not create the blob immediately because we want to add some details about the content we are about to store.\r\nThis can be done by setting the \u003Ccode>Properties\u003C/code> and \u003Ccode>Metadata\u003C/code> properties of the blob.\u003C/p>\n\u003Cp>One of the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.blobproperties?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">BlobProperties\u003Cspan>\u003C/span>\u003C/a>\r\nwe want to set is the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.blobproperties.contenttype?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ContentType\u003C/code> property\u003Cspan>\u003C/span>\u003C/a>.\r\nThis will allow other systems to recognize the file correctly as a \u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr> file.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:49ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">blob\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Properties\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ContentType\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"application/json\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"blob.Properties.ContentType = &#x22;application/json&#x22;;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>However, the \u003Ccode>BlobProperties\u003C/code> only contains a fixed set of properties.\u003C/p>\n\u003Cp>By using the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblob.metadata?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Metadata\u003C/code> property\u003Cspan>\u003C/span>\u003C/a>\r\non the blob allows us to store custom metadata with the blob.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:74ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">blob\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Metadata\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"userid\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">UserId\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"B\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">).\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToLowerInvariant\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">blob\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Metadata\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"userfullname\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">fullName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">blob\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Metadata\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"deletiondate\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">OperationCreatedOn\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ToString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"O\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"blob.Metadata[&#x22;userid&#x22;] = context.UserId.ToString(&#x22;B&#x22;).ToLowerInvariant();blob.Metadata[&#x22;userfullname&#x22;] = fullName;blob.Metadata[&#x22;deletiondate&#x22;] = context.OperationCreatedOn.ToString(&#x22;O&#x22;);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now it is time to write some file contents to the blob.\r\nWe create blob data, using the context of the current plug-in execution.\r\nFor demonstration purposes we serialize the \u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr> with the \u003Ca href=\"https://www.newtonsoft.com/json/help/html/T_Newtonsoft_Json_Formatting.htm\" rel=\"noopener noreferrer external\" target=\"_blank\">Formatting\u003Cspan>\u003C/span>\u003C/a> option set to \u003Ccode>Indented\u003C/code>.\u003C/p>\n\u003Cp>Because the blob content is plain text, we can use the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.azure.storage.blob.cloudblockblob.uploadtext?view=azure-dotnet-legacy&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">UploadText method\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:76ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">blobData\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">UserId\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">FullName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">fullName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">context\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">MessageName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entity\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">LogicalName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entity\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Id\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">entity\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Attributes\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">};\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">blob\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">UploadText\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">JsonConvert\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">SerializeObject\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">blobData\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Formatting\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Indented\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">));\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var blobData = new  {    context.UserId,    FullName = fullName,    context.MessageName,    entity.LogicalName,    entity.Id,    entity.Attributes  };blob.UploadText(JsonConvert.SerializeObject(blobData, Formatting.Indented));\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now build the project so we can proceed.\u003C/p>\n\u003Ch2 id=\"register-the-plug-in-assembly\">Register the plug-in assembly\u003C/h2>\n\u003Cp>Now the freshly baked assembly needs to be registered on the server.\u003Cbr>\nThe steps to do this are outside the scope for this post, but more information can be found in the\r\n\u003Ca href=\"https://learn.microsoft.com/previous-versions/dynamicscrm-2016/developers-guide/gg309580(v=crm.8)?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">walkthrough: Register a plug-in using the plug-in registration tool\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Ch2 id=\"register-the-plug-in-step-for-an-event\">Register the plug-in step for an event\u003C/h2>\n\u003Cp>To test the plug-in, we’ll register it asynchronously on the deletion event of every entity.\u003C/p>\n\u003Cdiv class=\"markdown-alert markdown-alert-warning\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.146.146 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.163.163 0 0 1-.054.06.116.116 0 0 1-.066.017H1.146a.115.115 0 0 1-.066-.017.163.163 0 0 1-.054-.06.176.176 0 0 1 .002-.183L7.884 2.073a.147.147 0 0 1 .054-.057zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z\">\u003C/path>\u003Cpath d=\"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z\">\u003C/path>\u003C/svg>Warning\u003C/p>\n\u003Cp>\r\nDependencies on external resources should never be part of a synchronous pipeline.\u003C/p>\n\u003C/div>\n\u003Cp>In the \u003Ccode>Secure Configuration\u003C/code> property, we set the value with the \u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr> object containing the connection information:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:32ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"AccountName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"loremipsum\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Key\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"DDWLOREM...IPSUMr0A==\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;AccountName&#x22;: &#x22;loremipsum&#x22;,  &#x22;Key&#x22;: &#x22;DDWLOREM...IPSUMr0A==&#x22;}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Csmall>(Obviously, these values do not represent real data)\u003C/small>\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2016/12/register-step-delete-all-entities.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2016/12/register-step-delete-all-entities.webp\" type=\"image/webp\" media=\"(max-width: 1000px)\">\u003Csource srcset=\"/wp-content/uploads/2016/12/register-step-delete-all-entities-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2016/12/register-step-delete-all-entities-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2016/12/register-step-delete-all-entities-636x401.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2016/12/register-step-delete-all-entities-636x401.png\" alt=\"Register the plug-in step for the deletion event of any entity\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"401\" srcset=\"/wp-content/uploads/2016/12/register-step-delete-all-entities.png 1000w, /wp-content/uploads/2016/12/register-step-delete-all-entities-150x150.png 150w, /wp-content/uploads/2016/12/register-step-delete-all-entities-185x185.png 185w, /wp-content/uploads/2016/12/register-step-delete-all-entities-636x401.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003C/figure>\n\u003Cp>Because we are working with the deletion event, we need to register a \u003Ccode>Pre-Image\u003C/code> to capture the values of all attributes before the actual deletion took place.\u003C/p>\n\u003Cp>We set the value of the \u003Ccode>Name\u003C/code> and the \u003Ccode>Entity Alias\u003C/code> properties to \u003Ccode>Target\u003C/code>\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2016/12/register-new-image-delete-all-entities.webp\" type=\"image/webp\" media=\"(max-width: 600px)\">\u003Csource srcset=\"/wp-content/uploads/2016/12/register-new-image-delete-all-entities-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2016/12/register-new-image-delete-all-entities-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2016/12/register-new-image-delete-all-entities.png\" alt=\"Register a new image for the plug-in step for the deletion event of any entity\" loading=\"lazy\" decoding=\"async\" width=\"600\" height=\"710\" srcset=\"/wp-content/uploads/2016/12/register-new-image-delete-all-entities.png 600w, /wp-content/uploads/2016/12/register-new-image-delete-all-entities-150x150.png 150w, /wp-content/uploads/2016/12/register-new-image-delete-all-entities-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Ch2 id=\"testing-the-plug-in\">Testing the plug-in\u003C/h2>\n\u003Cp>We delete a contact in \u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr>. In my case the contact is called \u003Cem>Sample User\u003C/em>.\u003C/p>\n\u003Cp>After a couple of seconds, we see the following container and directories appear on the storage account:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2016/12/sample-crm-folder.webp\" type=\"image/webp\" media=\"(max-width: 160px)\">\u003Cimg src=\"/wp-content/uploads/2016/12/sample-crm-folder.png\" alt=\"The &#x22;samplecrmfolder&#x22; container with multiple directories for different entities\" loading=\"lazy\" decoding=\"async\" width=\"160\" height=\"82\" srcset=\"/wp-content/uploads/2016/12/sample-crm-folder.png 160w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>\u003Csmall>Screenshot from \u003Ca href=\"https://cerebrata.com/features/azure-storage\" rel=\"noopener noreferrer external\" target=\"_blank\">Azure Management Studio by Cerebrata\u003Cspan>\u003C/span>\u003C/a>\u003C/small>\u003C/p>\n\u003Cp>Opening the file in the \u003Ccode>contact\u003C/code> directory, shows us some familiar content:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:51ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"UserId\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"d617a1a0-359a-e411-9407-00155d0ae259\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"FullName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Lorem Ipsum\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"MessageName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Delete\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"LogicalName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"contact\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Id\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"6e843a34-91b1-e611-80e4-00155d0a0b40\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Attributes\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Key\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"firstname\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Sample\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Key\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"lastname\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"User\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Key\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"fullname\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"Value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Sample User\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#F66767\">...\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;UserId&#x22;: &#x22;d617a1a0-359a-e411-9407-00155d0ae259&#x22;,  &#x22;FullName&#x22;: &#x22;Lorem Ipsum&#x22;,  &#x22;MessageName&#x22;: &#x22;Delete&#x22;,  &#x22;LogicalName&#x22;: &#x22;contact&#x22;,  &#x22;Id&#x22;: &#x22;6e843a34-91b1-e611-80e4-00155d0a0b40&#x22;,  &#x22;Attributes&#x22;: [    {      &#x22;Key&#x22;: &#x22;firstname&#x22;,      &#x22;Value&#x22;: &#x22;Sample&#x22;    },    {      &#x22;Key&#x22;: &#x22;lastname&#x22;,      &#x22;Value&#x22;: &#x22;User&#x22;    },    {      &#x22;Key&#x22;: &#x22;fullname&#x22;,      &#x22;Value&#x22;: &#x22;Sample User&#x22;    },    ...  ]}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>If we look at the \u003Cdfn>\u003Cabbr title=\"HyperText Transfer Protocol\">HTTP\u003C/abbr>\u003C/dfn> response header when retrieving the file,\r\nwe see that the content type and metadata properties are present:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"http\" class=\"wrap\" style=\"--ecMaxLine:56ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">HTTP\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">/\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1.1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">200\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">OK\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#7eb3e0\">Content-Type:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#d6a28d\">application/json\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">Server:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">x-ms-version:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">2015-12-11\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#7eb3e0\">x-ms-meta-userid:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#d6a28d\">{d617a1a0-359a-e411-9407-00155d0ae259}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#7eb3e0\">x-ms-meta-userfullname:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#d6a28d\">Lorem Ipsum\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#7eb3e0\">x-ms-meta-deletiondate:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#d6a28d\">2016-12-08T14:23:25.5635361Z\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">x-ms-blob-type:\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">BlockBlob\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"HTTP/1.1 200 OKContent-Type: application/jsonServer: Windows-Azure-Blob/1.0 Microsoft-HTTPAPI/2.0x-ms-version: 2015-12-11x-ms-meta-userid: {d617a1a0-359a-e411-9407-00155d0ae259}x-ms-meta-userfullname: Lorem Ipsumx-ms-meta-deletiondate: 2016-12-08T14:23:25.5635361Zx-ms-blob-type: BlockBlob\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"concluding\">Concluding\u003C/h2>\n\u003Cp>By utilizing the Sandboxable Azure \u003Cdfn>\u003Cabbr title=\"Software Development Kit\">SDK\u003C/abbr>\u003C/dfn>, we only needed a few lines of code to store deleted \u003Cabbr title=\"Customer Relationship Management\">CRM\u003C/abbr> records in Azure blob storage, making a remote archive a piece of cake.\u003C/p>\n\u003Cdiv class=\"markdown-alert markdown-alert-tip\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M2 6a6 6 0 1 1 10.174 4.31c-.203.196-.359.4-.453.619l-.762 1.769A.5.5 0 0 1 10.5 13a.5.5 0 0 1 0 1 .5.5 0 0 1 0 1l-.224.447a1 1 0 0 1-.894.553H6.618a1 1 0 0 1-.894-.553L5.5 15a.5.5 0 0 1 0-1 .5.5 0 0 1 0-1 .5.5 0 0 1-.46-.302l-.761-1.77a1.964 1.964 0 0 0-.453-.618A5.984 5.984 0 0 1 2 6m6-5a5 5 0 0 0-3.479 8.592c.263.254.514.564.676.941L5.83 12h4.342l.632-1.467c.162-.377.413-.687.676-.941A5 5 0 0 0 8 1\">\u003C/path>\u003C/svg>Tip\u003C/p>\n\u003Cp>\r\nWhen using blob storage for archiving you might want to look at\r\n\u003Ca href=\"https://learn.microsoft.com/azure/storage/blobs/access-tiers-overview?tabs=azure-portal&#x26;wt.mc_id=AZ-MVP-5004268#cold-tier\" rel=\"noopener noreferrer external\" target=\"_blank\">Blob Storage Accounts with Cool storage tier\u003Cspan>\u003C/span>\u003C/a>\r\nwhich might save you same money.\u003C/p>\n\u003C/div>\n\u003Ch2 id=\"sample-code\">Sample code\u003C/h2>\n\u003Cp>The complete source code is available as a \u003Ca href=\"https://github.com/Winvision/Sandboxable-Samples/tree/master/src/CrmBlob\" rel=\"noopener noreferrer external\" target=\"_blank\">sample project\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>Expect more samples in the \u003Ca href=\"https://github.com/Winvision/Sandboxable-Samples\" rel=\"noopener noreferrer external\" target=\"_blank\">Sandboxable-Samples repository on GitHub\u003Cspan>\u003C/span>\u003C/a> in the future.\u003C/p>",{"headings":1749,"imagePaths":1773,"frontmatter":1732},[1750,1751,1752,1755,1756,1759,1762,1765,1768,1769,1770,1771,1772],{"depth":780,"slug":1699,"text":1700},{"depth":780,"slug":1702,"text":1703},{"depth":198,"slug":1753,"text":1754},"getting-the-deleted-entity","Getting the deleted entity",{"depth":198,"slug":1705,"text":1706},{"depth":198,"slug":1757,"text":1758},"initializing-the-cloud-blob-client","Initializing the Cloud Blob Client",{"depth":198,"slug":1760,"text":1761},"creating-a-root-container","Creating a root container",{"depth":633,"slug":1763,"text":1764},"creating-an-entity-directory","Creating an entity directory",{"depth":198,"slug":1766,"text":1767},"adding-a-blob-to-the-directory","Adding a blob to the directory",{"depth":780,"slug":1717,"text":1718},{"depth":780,"slug":1720,"text":1721},{"depth":780,"slug":1723,"text":1724},{"depth":780,"slug":1726,"text":1727},{"depth":780,"slug":1247,"text":1248},[],"2017-02-08-dotned-saturday-2017-sharing-my-slides",{"id":1774,"data":1776,"body":1786,"filePath":1787,"digest":1788,"rendered":1789},{"id":1777,"title":1778,"date":1779,"updated":1780,"author":15,"excerpt":1781,"layout":17,"permalink":1782,"image":1783,"categories":1784,"tags":1785,"draft":26},1090,"dotNed Saturday 2017: sharing my slides",["Date","2017-02-08T17:43:41.000Z"],["Date","2020-12-06T22:10:43.000Z"],"Last month I gave my session, in Dutch, titled Serious Request, Azure als schaalbaar platform during the dotNed Saturday event.\nI’m sharing my slides so you can start building awesome, secure, scalable, performing and monitorable web platforms using Azure.\n","/2017/02/08/dotned-saturday-2017-sharing-my-slides/","/wp-content/uploads/2017/02/post-1090-thumbnail.png",[906],[906,908,872,873,910,932,911],"Last month I gave my session, in Dutch,\r\ntitled \"\u003Cspan lang=\"nl\">**Serious Request, Azure als schaalbaar platform**\u003C/span>\"\r\nduring the [dotNed Saturday](https://dotnedsaturday.nl/) event.\r\n\r\nFirst, I’d like to thank everyone attending this session.\r\n\r\nThe session was about my experiences using Microsoft Azure to build a high available,\r\nsecure and scalable platform for digital donations.\r\n\r\nThis platform is used during \"[3FM Serious Request](https://nl.wikipedia.org/wiki/3FM_Serious_Request)\",\r\nthe annual charity event organized by the Dutch radio station 3FM for [the Dutch Red Cross](https://www.rodekruis.nl).\r\n\r\nI am sharing my slides so you can use my guides,\r\ntips & tricks to start building awesome, secure,\r\nscalable, performing and monitorable web platforms using Azure.\r\n\r\n\u003C!--more-->\r\n\r\n\u003Ciframe src=\"https://onedrive.live.com/embed?resid=2D38DB8234B02DA9%211413592&authkey=%21ACiUheMPoDazfVc&em=2&wdAr=1.7777777777777777\" width=\"625px\" height=\"387px\" loading=\"lazy\">\u003C/iframe>\r\n\r\nAny questions about my session? Just contact me.","src/posts/2017-02-08-dotned-saturday-2017-sharing-my-slides.md","64f1df97b017fbec",{"html":1790,"metadata":1791},"\u003Cp>Last month I gave my session, in Dutch,\r\ntitled “\u003Cspan lang=\"nl\">\u003Cstrong>Serious Request, Azure als schaalbaar platform\u003C/strong>\u003C/span>”\r\nduring the \u003Ca href=\"https://dotnedsaturday.nl/\" rel=\"noopener noreferrer external\" target=\"_blank\">dotNed Saturday\u003Cspan>\u003C/span>\u003C/a> event.\u003C/p>\n\u003Cp>First, I’d like to thank everyone attending this session.\u003C/p>\n\u003Cp>The session was about my experiences using Microsoft Azure to build a high available,\r\nsecure and scalable platform for digital donations.\u003C/p>\n\u003Cp>This platform is used during “\u003Ca href=\"https://nl.wikipedia.org/wiki/3FM_Serious_Request\" rel=\"noopener noreferrer external\" target=\"_blank\">3FM Serious Request\u003Cspan>\u003C/span>\u003C/a>”,\r\nthe annual charity event organized by the Dutch radio station 3FM for \u003Ca href=\"https://www.rodekruis.nl\" rel=\"noopener noreferrer external\" target=\"_blank\">the Dutch Red Cross\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>I am sharing my slides so you can use my guides,\r\ntips &#x26; tricks to start building awesome, secure,\r\nscalable, performing and monitorable web platforms using Azure.\u003C/p>\n\u003C!--more-->\n\u003Ciframe src=\"https://onedrive.live.com/embed?resid=2D38DB8234B02DA9%211413592&#x26;authkey=%21ACiUheMPoDazfVc&#x26;em=2&#x26;wdAr=1.7777777777777777\" width=\"625px\" height=\"387px\" loading=\"lazy\">\u003C/iframe>\n\u003Cp>Any questions about my session? Just contact me.\u003C/p>",{"headings":1792,"imagePaths":1793,"frontmatter":1776},[],[],"2017-03-20-add-secrets-to-your-azure-key-vault-using-arm-templates",{"id":1794,"data":1796,"body":1810,"filePath":1811,"digest":1812,"rendered":1813},{"id":1797,"title":1798,"date":1799,"updated":1800,"author":15,"excerpt":1801,"layout":17,"permalink":1802,"image":1803,"categories":1804,"tags":1805,"draft":26},1163,"Add secrets to your Azure Key Vault using ARM templates",["Date","2017-03-20T15:33:05.000Z"],["Date","2020-12-07T16:27:46.000Z"],"Azure Key Vault is a great resource to store your secrets like passwords, connection strings, certificates, etc. and access them programmatically. A great feature is to add or update your secrets during deployment so you do not have to manage your secrets manually.\nIn this article, I will explain how you can add secrets to an Azure Key Vault using ARM templates.\n","/2017/03/20/add-secrets-to-your-azure-key-vault-using-arm-templates/","/wp-content/uploads/2017/03/post-1163-thumbnail.png",[906],[1806,906,1807,1808,1809],"ARM","Key Vault","secrets","templates","Azure Key Vault is a great resource to store your secrets like passwords,\r\nconnection strings, certificates, etc. and access them programmatically.\r\nA great feature is to add or update your secrets during deployment so you do not have to manage your secrets manually.\r\n\r\nIn this article, I will explain how you can add secrets to an Azure Key Vault using ARM templates.\r\n\r\n\u003C!--more-->\r\n\r\nAt the end of the article, you will find the link to the [source code](#source-code).\r\n\r\n## Creating the Key Vault\r\n\r\nFirst, we create the Key Vault to store all our secrets.\r\n\r\nYou can add an access policy so you’re able to see and manage the secrets using,\r\nfor example, the Azure Portal.\r\n\r\nTo create a Key Vault, we add the following resource to the ARM template:\r\n\r\n```json\r\n{\r\n  \"type\": \"Microsoft.KeyVault/vaults\",\r\n  \"name\": \"LoremVault\",\r\n  \"apiVersion\": \"2015-06-01\",\r\n  \"location\": \"[resourceGroup().location]\",\r\n  \"properties\": {\r\n    \"sku\": {\r\n      \"family\": \"A\",\r\n      \"name\": \"Standard\"\r\n    },\r\n    \"tenantId\": \"[subscription().tenantId]\",\r\n    \"accessPolicies\": [\r\n      {\r\n        \"tenantId\": \"[subscription().tenantId]\",\r\n        \"objectId\": \"CHANGETO-YOUR-USER-GUID-000000000000\",\r\n        \"permissions\": {\r\n          \"keys\": [\"All\"],\r\n          \"secrets\": [\"All\"]\r\n        }\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\n## Adding a plain text Secret\r\n\r\nWith the Key Vault in place, we can start adding secrets to it.\r\n\r\nWe add a resource to the ARM template to describe the secret.\r\n\r\nThe `name` must be prefixed with the name of the Key Vault.\r\nWe also declare that the resource depends on the Key Vault resource.\r\nThis ensures the Resource Manager does not try to store the secret before the Key Vault is created.\r\n\r\nA secret consists of two properties:\r\n\r\n- `contentType` contains the [media type](https://en.wikipedia.org/wiki/Media_type) of the secret\r\n- `value` contains the value of the secret\r\n\r\n```json {2,6-7,10}\r\n{\r\n  \"type\": \"Microsoft.KeyVault/vaults/secrets\",\r\n  \"name\": \"LoremVault/SomeSecret\",\r\n  \"apiVersion\": \"2015-06-01\",\r\n  \"properties\": {\r\n    \"contentType\": \"text/plain\",\r\n    \"value\": \"ThisIpsemIsSecret\"\r\n  },\r\n  \"dependsOn\": [\"[resourceId('Microsoft.KeyVault/vaults', 'LoremVault')]\"]\r\n}\r\n```\r\n\r\n## Adding a certificate as a Secret\r\n\r\nThis is almost the same a storing a plain text value.\r\n\r\nChange the `contentType` to `application/x-pkcs12` and add the certificate as\r\n[Base64](https://en.wikipedia.org/wiki/Base64) encoded string to the `value`:\r\n\r\n```json {6-7}\r\n{\r\n  \"type\": \"Microsoft.KeyVault/vaults/secrets\",\r\n  \"name\": \"LoremVault/SomeCertificate\",\r\n  \"apiVersion\": \"2015-06-01\",\r\n  \"properties\": {\r\n    \"contentType\": \"application/x-pkcs12\",\r\n    \"value\": \"MIIV0QIBAzCC…yada…yada…RIJcq3QACAggA\"\r\n  },\r\n  \"dependsOn\": [\"[resourceId('Microsoft.KeyVault/vaults', 'LoremVault')]\"]\r\n}\r\n```\r\n\r\nBesides storing hardcoded values it is also possible to use parameters, variables,\r\nor even the output of other resources as source for the value of your secrets.\r\n\r\n## Adding a connection string to a Storage Account\r\n\r\nLet's make a Secret resource containing the connection string of an Azure Storage Account.\r\n\r\nFirst, we add a Storage Account resource to the ARM template:\r\n\r\n```json\r\n{\r\n  \"type\": \"Microsoft.Storage/storageAccounts\",\r\n  \"kind\": \"Storage\",\r\n  \"name\": \"loremipsumstore\",\r\n  \"apiVersion\": \"2016-01-01\",\r\n  \"sku\": {\r\n    \"name\": \"Standard_LRS\"\r\n  },\r\n  \"location\": \"[resourceGroup().location]\"\r\n}\r\n```\r\n\r\nNow we add a Secret resource that is depending on the Storage Account and the Key Vault defined earlier.\r\n\r\nThe value of the secret is set with a connection string containing the first access key of the Storage Account:\r\n\r\n```json {7}\r\n{\r\n  \"type\": \"Microsoft.KeyVault/vaults/secrets\",\r\n  \"name\": \"LoremVault/ConnectionString\",\r\n  \"apiVersion\": \"2015-06-01\",\r\n  \"properties\": {\r\n    \"contentType\": \"text/plain\",\r\n    \"value\": \"[concat('DefaultEndpointsProtocol=https;AccountName=loremipsumstore;', AccountKey=', listKeys(resourceId('Microsoft.Storage/storageAccounts', 'loremipsumstore'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value, ';')]\"\r\n  },\r\n  \"dependsOn\": [\r\n    \"[resourceId('Microsoft.KeyVault/vaults', 'LoremVault')]\",\r\n    \"[resourceId('Microsoft.Storage/storageAccounts', 'loremipsumstore')]\"\r\n  ]\r\n}\r\n```\r\n\r\n\u003Csmall>Thanks to [Maarten van Sambeek](https://www.linkedin.com/in/maartenvansambeek/) for sharing this code with me.\u003C/small>\r\n\r\nNow you have stored your connection string securely without it ever surfacing outside of your deployment.\r\nIf you use access policies so your application reads the connection string directly from Key Vault,\r\nyou do not have to store your connection string anywhere where it is readable like in a `web.config` file.\r\n\r\n### Source code\r\n\r\nI have created a GitHub Gist with a full working\r\n[Key Vault deployment template sample](https://gist.github.com/eNeRGy164/19c9dea85994526052e666f4d0e734c7) for reference.","src/posts/2017-03-20-add-secrets-to-your-azure-key-vault-using-arm-templates.md","848f32d4c3c600c1",{"html":1814,"metadata":1815},"\u003Cp>Azure Key Vault is a great resource to store your secrets like passwords,\r\nconnection strings, certificates, etc. and access them programmatically.\r\nA great feature is to add or update your secrets during deployment so you do not have to manage your secrets manually.\u003C/p>\n\u003Cp>In this article, I will explain how you can add secrets to an Azure Key Vault using \u003Cdfn>\u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr>\u003C/dfn> templates.\u003C/p>\n\u003C!--more-->\n\u003Cp>At the end of the article, you will find the link to the \u003Ca href=\"#source-code\">source code\u003C/a>.\u003C/p>\n\u003Ch2 id=\"creating-the-key-vault\">Creating the Key Vault\u003C/h2>\n\u003Cp>First, we create the Key Vault to store all our secrets.\u003C/p>\n\u003Cp>You can add an access policy so you’re able to see and manage the secrets using,\r\nfor example, the Azure Portal.\u003C/p>\n\u003Cp>To create a Key Vault, we add the following resource to the \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> template:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:59ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.KeyVault/vaults\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremVault\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-06-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"location\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceGroup().location]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"sku\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"family\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"A\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Standard\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"tenantId\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[subscription().tenantId]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"accessPolicies\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"tenantId\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[subscription().tenantId]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"objectId\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"CHANGETO-YOUR-USER-GUID-000000000000\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"permissions\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"keys\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"All\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"secrets\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"All\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.KeyVault/vaults&#x22;,  &#x22;name&#x22;: &#x22;LoremVault&#x22;,  &#x22;apiVersion&#x22;: &#x22;2015-06-01&#x22;,  &#x22;location&#x22;: &#x22;[resourceGroup().location]&#x22;,  &#x22;properties&#x22;: {    &#x22;sku&#x22;: {      &#x22;family&#x22;: &#x22;A&#x22;,      &#x22;name&#x22;: &#x22;Standard&#x22;    },    &#x22;tenantId&#x22;: &#x22;[subscription().tenantId]&#x22;,    &#x22;accessPolicies&#x22;: [      {        &#x22;tenantId&#x22;: &#x22;[subscription().tenantId]&#x22;,        &#x22;objectId&#x22;: &#x22;CHANGETO-YOUR-USER-GUID-000000000000&#x22;,        &#x22;permissions&#x22;: {          &#x22;keys&#x22;: [&#x22;All&#x22;],          &#x22;secrets&#x22;: [&#x22;All&#x22;]        }      }    ]  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"adding-a-plain-text-secret\">Adding a plain text Secret\u003C/h2>\n\u003Cp>With the Key Vault in place, we can start adding secrets to it.\u003C/p>\n\u003Cp>We add a resource to the \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> template to describe the secret.\u003C/p>\n\u003Cp>The \u003Ccode>name\u003C/code> must be prefixed with the name of the Key Vault.\r\nWe also declare that the resource depends on the Key Vault resource.\r\nThis ensures the Resource Manager does not try to store the secret before the Key Vault is created.\u003C/p>\n\u003Cp>A secret consists of two properties:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>contentType\u003C/code> contains the \u003Ca href=\"https://en.wikipedia.org/wiki/Media_type\" rel=\"noopener noreferrer external\" target=\"_blank\">media type\u003Cspan>\u003C/span>\u003C/a> of the secret\u003C/li>\n\u003Cli>\u003Ccode>value\u003C/code> contains the value of the secret\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:74ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"Microsoft.KeyVault/vaults/secrets\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremVault/SomeSecret\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-06-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"contentType\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"text/plain\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"ThisIpsemIsSecret\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"dependsOn\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceId('Microsoft.KeyVault/vaults', 'LoremVault')]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.KeyVault/vaults/secrets&#x22;,  &#x22;name&#x22;: &#x22;LoremVault/SomeSecret&#x22;,  &#x22;apiVersion&#x22;: &#x22;2015-06-01&#x22;,  &#x22;properties&#x22;: {    &#x22;contentType&#x22;: &#x22;text/plain&#x22;,    &#x22;value&#x22;: &#x22;ThisIpsemIsSecret&#x22;  },  &#x22;dependsOn&#x22;: [&#x22;[resourceId(&#x27;Microsoft.KeyVault/vaults&#x27;, &#x27;LoremVault&#x27;)]&#x22;]}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"adding-a-certificate-as-a-secret\">Adding a certificate as a Secret\u003C/h2>\n\u003Cp>This is almost the same a storing a plain text value.\u003C/p>\n\u003Cp>Change the \u003Ccode>contentType\u003C/code> to \u003Ccode>application/x-pkcs12\u003C/code> and add the certificate as\r\n\u003Ca href=\"https://en.wikipedia.org/wiki/Base64\" rel=\"noopener noreferrer external\" target=\"_blank\">Base64\u003Cspan>\u003C/span>\u003C/a> encoded string to the \u003Ccode>value\u003C/code>:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:74ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.KeyVault/vaults/secrets\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremVault/SomeCertificate\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-06-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"contentType\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"application/x-pkcs12\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"MIIV0QIBAzCC…yada…yada…RIJcq3QACAggA\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"dependsOn\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceId('Microsoft.KeyVault/vaults', 'LoremVault')]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.KeyVault/vaults/secrets&#x22;,  &#x22;name&#x22;: &#x22;LoremVault/SomeCertificate&#x22;,  &#x22;apiVersion&#x22;: &#x22;2015-06-01&#x22;,  &#x22;properties&#x22;: {    &#x22;contentType&#x22;: &#x22;application/x-pkcs12&#x22;,    &#x22;value&#x22;: &#x22;MIIV0QIBAzCC…yada…yada…RIJcq3QACAggA&#x22;  },  &#x22;dependsOn&#x22;: [&#x22;[resourceId(&#x27;Microsoft.KeyVault/vaults&#x27;, &#x27;LoremVault&#x27;)]&#x22;]}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Besides storing hardcoded values it is also possible to use parameters, variables,\r\nor even the output of other resources as source for the value of your secrets.\u003C/p>\n\u003Ch2 id=\"adding-a-connection-string-to-a-storage-account\">Adding a connection string to a Storage Account\u003C/h2>\n\u003Cp>Let’s make a Secret resource containing the connection string of an Azure Storage Account.\u003C/p>\n\u003Cp>First, we add a Storage Account resource to the \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> template:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:46ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.Storage/storageAccounts\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"kind\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Storage\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"loremipsumstore\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2016-01-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"sku\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Standard_LRS\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"location\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceGroup().location]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.Storage/storageAccounts&#x22;,  &#x22;kind&#x22;: &#x22;Storage&#x22;,  &#x22;name&#x22;: &#x22;loremipsumstore&#x22;,  &#x22;apiVersion&#x22;: &#x22;2016-01-01&#x22;,  &#x22;sku&#x22;: {    &#x22;name&#x22;: &#x22;Standard_LRS&#x22;  },  &#x22;location&#x22;: &#x22;[resourceGroup().location]&#x22;}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now we add a Secret resource that is depending on the Storage Account and the Key Vault defined earlier.\u003C/p>\n\u003Cp>The value of the secret is set with a connection string containing the first access key of the Storage Account:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:263ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.KeyVault/vaults/secrets\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremVault/ConnectionString\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-06-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"contentType\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"text/plain\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"[concat('DefaultEndpointsProtocol=https;AccountName=loremipsumstore;', AccountKey=', listKeys(resourceId('Microsoft.Storage/storageAccounts', 'loremipsumstore'), providers('Microsoft.Storage', 'storageAccounts').apiVersions[0]).keys[0].value, ';')]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"dependsOn\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceId('Microsoft.KeyVault/vaults', 'LoremVault')]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceId('Microsoft.Storage/storageAccounts', 'loremipsumstore')]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.KeyVault/vaults/secrets&#x22;,  &#x22;name&#x22;: &#x22;LoremVault/ConnectionString&#x22;,  &#x22;apiVersion&#x22;: &#x22;2015-06-01&#x22;,  &#x22;properties&#x22;: {    &#x22;contentType&#x22;: &#x22;text/plain&#x22;,    &#x22;value&#x22;: &#x22;[concat(&#x27;DefaultEndpointsProtocol=https;AccountName=loremipsumstore;&#x27;, AccountKey=&#x27;, listKeys(resourceId(&#x27;Microsoft.Storage/storageAccounts&#x27;, &#x27;loremipsumstore&#x27;), providers(&#x27;Microsoft.Storage&#x27;, &#x27;storageAccounts&#x27;).apiVersions[0]).keys[0].value, &#x27;;&#x27;)]&#x22;  },  &#x22;dependsOn&#x22;: [    &#x22;[resourceId(&#x27;Microsoft.KeyVault/vaults&#x27;, &#x27;LoremVault&#x27;)]&#x22;,    &#x22;[resourceId(&#x27;Microsoft.Storage/storageAccounts&#x27;, &#x27;loremipsumstore&#x27;)]&#x22;  ]}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Csmall>Thanks to \u003Ca href=\"https://www.linkedin.com/in/maartenvansambeek/\">Maarten van Sambeek\u003C/a> for sharing this code with me.\u003C/small>\u003C/p>\n\u003Cp>Now you have stored your connection string securely without it ever surfacing outside of your deployment.\r\nIf you use access policies so your application reads the connection string directly from Key Vault,\r\nyou do not have to store your connection string anywhere where it is readable like in a \u003Ccode>web.config\u003C/code> file.\u003C/p>\n\u003Ch3 id=\"source-code\">Source code\u003C/h3>\n\u003Cp>I have created a GitHub Gist with a full working\r\n\u003Ca href=\"https://gist.github.com/eNeRGy164/19c9dea85994526052e666f4d0e734c7\" rel=\"noopener noreferrer external\" target=\"_blank\">Key Vault deployment template sample\u003Cspan>\u003C/span>\u003C/a> for reference.\u003C/p>",{"headings":1816,"imagePaths":1830,"frontmatter":1796},[1817,1820,1823,1826,1829],{"depth":780,"slug":1818,"text":1819},"creating-the-key-vault","Creating the Key Vault",{"depth":780,"slug":1821,"text":1822},"adding-a-plain-text-secret","Adding a plain text Secret",{"depth":780,"slug":1824,"text":1825},"adding-a-certificate-as-a-secret","Adding a certificate as a Secret",{"depth":780,"slug":1827,"text":1828},"adding-a-connection-string-to-a-storage-account","Adding a connection string to a Storage Account",{"depth":198,"slug":1056,"text":1057},[],"2017-03-13-create-virtual-applications-and-directories-in-your-azure-web-app-using-arm-templates",{"id":1831,"data":1833,"body":1848,"filePath":1849,"digest":1850,"rendered":1851},{"id":1834,"title":1835,"date":1836,"updated":1837,"author":15,"excerpt":1838,"layout":17,"permalink":1839,"image":1840,"categories":1841,"tags":1842,"draft":26},1148,"Create Virtual Applications and Directories in your Azure Web App using ARM templates",["Date","2017-03-13T15:17:22.000Z"],["Date","2021-07-16T20:43:02.000Z"],"When I start on a project that uses Azure resources, one of the first things I do is build the infrastructure and automate the deployment using VSTS or TFS.\nIn this post I‘ll explain how you can extend Azure Web Apps with Virtual Applications and Virtual Directories using ARM templates.\n","/2017/03/13/create-virtual-applications-and-directories-in-your-azure-web-app-using-arm-templates/","/wp-content/uploads/2017/03/post-1148-thumbnail.png",[906],[1806,906,1843,1844,1845,1846,1847],"Template","TFS","Virtual Application","Virtual Directory","VSTS","When I start on a project that uses Azure resources, one of the first things I do is build the infrastructure and automate the deployment using VSTS or TFS. The definition of the infrastructure is defined using ARM templates.  \r\nWhen you search online you will find plenty of examples on how to create and use ARM templates. But when you move beyond the basics, you’ll find out the documentation is lacking.\r\n\r\nIn this post, I’ll explain how you can extend Azure Web Apps with Virtual Applications and Virtual Directories using ARM templates.\r\n\r\n\u003C!--more-->\r\n\r\n> [!NOTE]\r\n> I will not be covering on reasons why you would want to use Virtual Applications or Directories.\r\n> If you're interested in more background on these, you can read\r\n> [Understanding Sites, Applications, and Virtual Directories on IIS 7](https://learn.microsoft.com/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis).\r\n\r\nAt the end of the article, you will find the link to the [source code](#source-code).\r\n\r\n## The Web App definition\r\n\r\nWe start with a basic site template, for brevity I skipped the app service definition.\r\n\r\nThe `resources` property is an empty collection by default.\r\n\r\n```json {7}\r\n{\r\n  \"type\": \"Microsoft.Web/sites\",\r\n  \"kind\": \"app\",\r\n  \"name\": \"LoremIpsumWebApp\",\r\n  \"apiVersion\": \"2015-08-01\",\r\n  \"location\": \"[resourceGroup().location]\",\r\n  \"resources\": [],\r\n  \"dependsOn\": [\r\n    \"[resourceId('Microsoft.Web/serverfarms', 'LoremIpsumAppService')]\"\r\n  ]\r\n}\r\n```\r\n\r\n## Adding the Configuration resource\r\n\r\nConfiguration of the Web App properties is done with a resource with the type of `Microsoft.Web/sites/config`.\r\n\r\nThe name of the resource starts with the name of the parent Web App extended with `/web`.\r\n\r\nIn the property `properties`, you can configure several configuration properties like Virtual Applications,\r\nenabling _Always On_ or disabling _PHP_.\r\n\r\nA Web App always contains a root application.\r\n\r\n```json {2,7-8,10-14}\r\n{\r\n  \"type\": \"Microsoft.Web/sites/config\",\r\n  \"name\": \"LoremIpsumWebApp/web\",\r\n  \"apiVersion\": \"2015-08-01\",\r\n  \"dependsOn\": [\"[resourceId('Microsoft.Web/sites', 'LoremIpsumWebApp')]\"],\r\n  \"properties\": {\r\n    \"phpVersion\": \"\",\r\n    \"alwaysOn\": \"true\",\r\n    \"virtualApplications\": [\r\n      {\r\n        \"virtualPath\": \"/\",\r\n        \"physicalPath\": \"site\\\\wwwroot\",\r\n        \"virtualDirectories\": null\r\n      }\r\n    ]\r\n  }\r\n}\r\n```\r\n\r\nWe add the new config resource as a child resource to the Web App:\r\n\r\n```json {4-9}\r\n{\r\n  \"type\": \"Microsoft.Web/sites\",\r\n  …\r\n  \"resources\": [\r\n    {\r\n      \"type\": \"Microsoft.Web/sites/config\",\r\n      …\r\n    }\r\n  ],\r\n  …\r\n}\r\n```\r\n\r\n\u003Csmall>Other properties trimmed for brevity.\u003C/small>\r\n\r\n## Adding Virtual Applications\r\n\r\nWe can add a Virtual Application by adding it to the `virtualApplications` array.  \r\nThere are two required properties:\r\n\r\n- The `virtualPath` is the relative path to the root URL of the website.\r\n- The `physicalPath` is the (relative) path on disk where the files for this application are stored.\r\n\r\n```json\r\n{\r\n  \"virtualPath\": \"/DolorSitAmet\",\r\n  \"physicalPath\": \"site\\\\dolor-sit-amet\",\r\n  \"virtualDirectories\": null\r\n}\r\n```\r\n\r\n## Adding Virtual Directories\r\n\r\nVirtual Directories are always a part of a Virtual Application.\r\n\r\nA Virtual Directory has the same two required properties that are needed for a Virtual Application: `virtualPath` and `physicalPath`.\r\n\r\n```json\r\n{\r\n  \"virtualPath\": \"/Images\",\r\n  \"physicalPath\": \"site\\\\path-to\\\\images\"\r\n}\r\n```\r\n\r\nThis object is added to the Virtual Application:\r\n\r\n```json\r\n{\r\n  \"virtualPath\": \"/DolorSitAmet\",\r\n  \"physicalPath\": \"site\\\\dolor-sit-amet\",\r\n  \"virtualDirectories\": [\r\n    {\r\n      \"virtualPath\": \"/Images\",\r\n      \"physicalPath\": \"site\\\\path-to\\\\images\"\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\nNow you can deploy the ARM template to your Azure Resource Group and then configure a Web Deploy to your brand-new Virtual Application!\r\n\r\n## Source code\r\n\r\nI have created a GitHub Gist with a full working [deployment template sample](https://gist.github.com/eNeRGy164/0ff063f039088f2cae6219fa6110cbda) for reference.","src/posts/2017-03-13-create-virtual-applications-and-directories-in-your-azure-web-app-using-arm-templates.md","20239e22b0628d63",{"html":1852,"metadata":1853},"\u003Cp>When I start on a project that uses Azure resources, one of the first things I do is build the infrastructure and automate the deployment using \u003Cdfn>\u003Cabbr title=\"Visual Studio Team Services\">VSTS\u003C/abbr>\u003C/dfn> or \u003Cdfn>\u003Cabbr title=\"Team Foundation Server\">TFS\u003C/abbr>\u003C/dfn>. The definition of the infrastructure is defined using \u003Cdfn>\u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr>\u003C/dfn> templates.\u003Cbr>\nWhen you search online you will find plenty of examples on how to create and use \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> templates. But when you move beyond the basics, you’ll find out the documentation is lacking.\u003C/p>\n\u003Cp>In this post, I’ll explain how you can extend Azure Web Apps with Virtual Applications and Virtual Directories using \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> templates.\u003C/p>\n\u003C!--more-->\n\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\r\nI will not be covering on reasons why you would want to use Virtual Applications or Directories.\r\nIf you’re interested in more background on these, you can read\r\n\u003Ca href=\"https://learn.microsoft.com/iis/get-started/planning-your-iis-architecture/understanding-sites-applications-and-virtual-directories-on-iis?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Understanding Sites, Applications, and Virtual Directories on \u003Cdfn>\u003Cabbr title=\"Internet Information Services\">IIS\u003C/abbr>\u003C/dfn> 7\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003C/div>\n\u003Cp>At the end of the article, you will find the link to the \u003Ca href=\"#source-code\">source code\u003C/a>.\u003C/p>\n\u003Ch2 id=\"the-web-app-definition\">The Web App definition\u003C/h2>\n\u003Cp>We start with a basic site template, for brevity I skipped the app service definition.\u003C/p>\n\u003Cp>The \u003Ccode>resources\u003C/code> property is an empty collection by default.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:71ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.Web/sites\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"kind\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"app\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremIpsumWebApp\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-08-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"location\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceGroup().location]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"resources\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"dependsOn\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceId('Microsoft.Web/serverfarms', 'LoremIpsumAppService')]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.Web/sites&#x22;,  &#x22;kind&#x22;: &#x22;app&#x22;,  &#x22;name&#x22;: &#x22;LoremIpsumWebApp&#x22;,  &#x22;apiVersion&#x22;: &#x22;2015-08-01&#x22;,  &#x22;location&#x22;: &#x22;[resourceGroup().location]&#x22;,  &#x22;resources&#x22;: [],  &#x22;dependsOn&#x22;: [    &#x22;[resourceId(&#x27;Microsoft.Web/serverfarms&#x27;, &#x27;LoremIpsumAppService&#x27;)]&#x22;  ]}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"adding-the-configuration-resource\">Adding the Configuration resource\u003C/h2>\n\u003Cp>Configuration of the Web App properties is done with a resource with the type of \u003Ccode>Microsoft.Web/sites/config\u003C/code>.\u003C/p>\n\u003Cp>The name of the resource starts with the name of the parent Web App extended with \u003Ccode>/web\u003C/code>.\u003C/p>\n\u003Cp>In the property \u003Ccode>properties\u003C/code>, you can configure several configuration properties like Virtual Applications,\r\nenabling \u003Cem>Always On\u003C/em> or disabling \u003Cem>\u003Cdfn>\u003Cabbr title=\"PHP: Hypertext Preprocessor (recursive acronym)\">PHP\u003C/abbr>\u003C/dfn>\u003C/em>.\u003C/p>\n\u003Cp>A Web App always contains a root application.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:75ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"Microsoft.Web/sites/config\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremIpsumWebApp/web\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-08-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"dependsOn\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceId('Microsoft.Web/sites', 'LoremIpsumWebApp')]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"phpVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"alwaysOn\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"true\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"virtualApplications\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"virtualPath\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"/\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"physicalPath\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"site\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\\\\u003C/span>\u003Cspan style=\"--0:#d6a28d\">wwwroot\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"virtualDirectories\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#7eb3e0\">null\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.Web/sites/config&#x22;,  &#x22;name&#x22;: &#x22;LoremIpsumWebApp/web&#x22;,  &#x22;apiVersion&#x22;: &#x22;2015-08-01&#x22;,  &#x22;dependsOn&#x22;: [&#x22;[resourceId(&#x27;Microsoft.Web/sites&#x27;, &#x27;LoremIpsumWebApp&#x27;)]&#x22;],  &#x22;properties&#x22;: {    &#x22;phpVersion&#x22;: &#x22;&#x22;,    &#x22;alwaysOn&#x22;: &#x22;true&#x22;,    &#x22;virtualApplications&#x22;: [      {        &#x22;virtualPath&#x22;: &#x22;/&#x22;,        &#x22;physicalPath&#x22;: &#x22;site\\\\wwwroot&#x22;,        &#x22;virtualDirectories&#x22;: null      }    ]  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>We add the new config resource as a child resource to the Web App:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:43ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.Web/sites\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F66767\">…\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"resources\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"Microsoft.Web/sites/config\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#f89191\">…\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#F66767\">…\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.Web/sites&#x22;,  …  &#x22;resources&#x22;: [    {      &#x22;type&#x22;: &#x22;Microsoft.Web/sites/config&#x22;,      …    }  ],  …}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Csmall>Other properties trimmed for brevity.\u003C/small>\u003C/p>\n\u003Ch2 id=\"adding-virtual-applications\">Adding Virtual Applications\u003C/h2>\n\u003Cp>We can add a Virtual Application by adding it to the \u003Ccode>virtualApplications\u003C/code> array.\u003Cbr>\nThere are two required properties:\u003C/p>\n\u003Cul>\n\u003Cli>The \u003Ccode>virtualPath\u003C/code> is the relative path to the root \u003Cdfn>\u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>\u003C/dfn> of the website.\u003C/li>\n\u003Cli>The \u003Ccode>physicalPath\u003C/code> is the (relative) path on disk where the files for this application are stored.\u003C/li>\n\u003C/ul>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:41ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"virtualPath\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"/DolorSitAmet\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"physicalPath\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"site\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\\\\u003C/span>\u003Cspan style=\"--0:#CE9178\">dolor-sit-amet\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"virtualDirectories\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#569CD6\">null\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;virtualPath&#x22;: &#x22;/DolorSitAmet&#x22;,  &#x22;physicalPath&#x22;: &#x22;site\\\\dolor-sit-amet&#x22;,  &#x22;virtualDirectories&#x22;: null}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"adding-virtual-directories\">Adding Virtual Directories\u003C/h2>\n\u003Cp>Virtual Directories are always a part of a Virtual Application.\u003C/p>\n\u003Cp>A Virtual Directory has the same two required properties that are needed for a Virtual Application: \u003Ccode>virtualPath\u003C/code> and \u003Ccode>physicalPath\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:41ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"virtualPath\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"/Images\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"physicalPath\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"site\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\\\\u003C/span>\u003Cspan style=\"--0:#CE9178\">path-to\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\\\\u003C/span>\u003Cspan style=\"--0:#CE9178\">images\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;virtualPath&#x22;: &#x22;/Images&#x22;,  &#x22;physicalPath&#x22;: &#x22;site\\\\path-to\\\\images&#x22;}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This object is added to the Virtual Application:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:45ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"virtualPath\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"/DolorSitAmet\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"physicalPath\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"site\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\\\\u003C/span>\u003Cspan style=\"--0:#CE9178\">dolor-sit-amet\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"virtualDirectories\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"virtualPath\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"/Images\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"physicalPath\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"site\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\\\\u003C/span>\u003Cspan style=\"--0:#CE9178\">path-to\u003C/span>\u003Cspan style=\"--0:#D7BA7D\">\\\\\u003C/span>\u003Cspan style=\"--0:#CE9178\">images\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;virtualPath&#x22;: &#x22;/DolorSitAmet&#x22;,  &#x22;physicalPath&#x22;: &#x22;site\\\\dolor-sit-amet&#x22;,  &#x22;virtualDirectories&#x22;: [    {      &#x22;virtualPath&#x22;: &#x22;/Images&#x22;,      &#x22;physicalPath&#x22;: &#x22;site\\\\path-to\\\\images&#x22;    }  ]}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now you can deploy the \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> template to your Azure Resource Group and then configure a Web Deploy to your brand-new Virtual Application!\u003C/p>\n\u003Ch2 id=\"source-code\">Source code\u003C/h2>\n\u003Cp>I have created a GitHub Gist with a full working \u003Ca href=\"https://gist.github.com/eNeRGy164/0ff063f039088f2cae6219fa6110cbda\" rel=\"noopener noreferrer external\" target=\"_blank\">deployment template sample\u003Cspan>\u003C/span>\u003C/a> for reference.\u003C/p>",{"headings":1854,"imagePaths":1868,"frontmatter":1833},[1855,1858,1861,1864,1867],{"depth":780,"slug":1856,"text":1857},"the-web-app-definition","The Web App definition",{"depth":780,"slug":1859,"text":1860},"adding-the-configuration-resource","Adding the Configuration resource",{"depth":780,"slug":1862,"text":1863},"adding-virtual-applications","Adding Virtual Applications",{"depth":780,"slug":1865,"text":1866},"adding-virtual-directories","Adding Virtual Directories",{"depth":780,"slug":1056,"text":1057},[],"2017-02-11-powershell-script-convertfrom-sitemap",{"id":1869,"data":1871,"body":1882,"filePath":1883,"digest":1884,"rendered":1885},{"id":1872,"title":1873,"date":1874,"updated":1875,"author":15,"excerpt":1876,"layout":17,"permalink":1877,"image":1878,"categories":1879,"tags":1880,"draft":26},1128,"PowerShell script: ConvertFrom-SiteMap",["Date","2017-02-11T22:46:48.000Z"],["Date","2020-12-06T22:12:26.000Z"],"The other day I needed to get the URLs for all pages in my blog for some PowerShell scripting I wanted to do. Like most websites, this blog has a sitemap and I wanted to use that as a source.\nAs I couldn’t find any existing PowerShell scripts on the web that I could use, I just wrote one myself.\nNow I like to share this script with you.\n","/2017/02/11/powershell-script-convertfrom-sitemap/","/wp-content/uploads/2017/02/post-1128-thumbnail.png",[1196],[1262,1196,1881],"sitemap","The other day I needed to get the URLs for all pages in my blog for some PowerShell scripting I wanted to do\r\nLike most websites, this blog has a [sitemap](/sitemap-0.xml) and I wanted to use that as a source.\r\n\r\nAs I could not find any existing PowerShell scripts on the web that I could use, I just wrote one myself.\r\n\r\nNow I like to share this script with you.\r\n\r\n\u003C!--more-->\r\n\r\nAt the end of the article, you will find the link to the [source code](#source-code).\r\n\r\n## Basic usage\r\n\r\nJust execute the script with an URL to an XML Sitemap.\r\n\r\n```powershell title=\"PowerShell\"\r\n.\\ConvertFrom-SiteMap.ps1 -Url https://blog.hompus.nl/sitemap-0.xml\r\n```\r\n\r\nWhich results in something like this:\r\n\r\n```plain\r\nloc        : /\r\nlastmod    : 2017-02-10T23:57:52+00:00\r\nchangefreq : daily\r\npriority   : 1.0\r\n\r\nloc        : /category/azure/\r\nlastmod    : 2017-02-08T17:43:41+00:00\r\nchangefreq : weekly\r\npriority   : 0.3\r\n\r\nloc        : /category/csharp/\r\nlastmod    : 2016-12-14T08:53:46+00:00\r\nchangefreq : weekly\r\npriority   : 0.3\r\n```\r\n\r\n\u003Csmall>Displaying only the first 3 entries\u003C/small>\r\n\r\n> [!NOTE]\r\n> Under the section [XML tag definitions](https://www.sitemaps.org/protocol.html#xmlTagDefinitions)\r\n> the protocol states that the `lastmod`, `changefreq` and `priority` attributes are optional,\r\n> so they can be missing in the sitemap.\r\n\r\nNow you can do basic PowerShell manipulation of the result set like sorting, selecting, filtering and formatting.\r\n\r\nFor example:\r\n\r\n```powershell title=\"PowerShell\"\r\n.\\ConvertFrom-SiteMap.ps1 -Url /sitemap-0.xml\r\n        | Sort-Object priority -Descending\r\n        | Select-Object priority, changefreq, loc -First 5\r\n        | Where-Object { $_.priority -ge 0.3 }\r\n        | Format-Table\r\n```\r\n\r\nOutputs:\r\n\r\n```plain\r\npriority changefreq loc\r\n-------- ---------- ----\r\n1.0      daily      /\r\n0.6      weekly     /about/\r\n0.6      weekly     /archives/\r\n0.3      weekly     /category/windows/\r\n0.3      weekly     /category/visual-studio/\r\n```\r\n\r\n## Ignoring Sitemap Index entries\r\n\r\nA sitemap can also be a [Sitemap Index File](https://www.sitemaps.org/protocol.html#index).\r\nThe file then contains links to other sitemap files.\r\n\r\nBy default, the script will follow these links.\r\nIf you don't want this to happen you can set the `NoFollow` switch.\r\n\r\n```powershell title=\"PowerShell\"\r\n.\\ConvertFrom-SiteMap.ps1 -Url https://blog.hompus.nl/sitemap-0.xml -NoFollow\r\n```\r\n\r\n## Source code\r\n\r\nThe complete source code is available as a\r\n[GitHub Gist](https://gist.github.com/eNeRGy164/a644417b737eb5d3af3c80d4ceb527e1).","src/posts/2017-02-11-powershell-script-convertfrom-sitemap.md","35963a2a9787885b",{"html":1886,"metadata":1887},"\u003Cp>The other day I needed to get the URLs for all pages in my blog for some PowerShell scripting I wanted to do\r\nLike most websites, this blog has a \u003Ca href=\"/sitemap-0.xml\">sitemap\u003C/a> and I wanted to use that as a source.\u003C/p>\n\u003Cp>As I could not find any existing PowerShell scripts on the web that I could use, I just wrote one myself.\u003C/p>\n\u003Cp>Now I like to share this script with you.\u003C/p>\n\u003C!--more-->\n\u003Cp>At the end of the article, you will find the link to the \u003Ca href=\"#source-code\">source code\u003C/a>.\u003C/p>\n\u003Ch2 id=\"basic-usage\">Basic usage\u003C/h2>\n\u003Cp>Just execute the script with an \u003Cdfn>\u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>\u003C/dfn> to an \u003Cdfn>\u003Cabbr title=\"eXtensible Markup Language\">XML\u003C/abbr>\u003C/dfn> Sitemap.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:67ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">\\ConvertFrom-SiteMap.ps1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Url https:\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">//\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">blog.hompus.nl\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">/\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">sitemap\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0.\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">xml\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\".\\ConvertFrom-SiteMap.ps1 -Url https://blog.hompus.nl/sitemap-0.xml\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Which results in something like this:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:38ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">loc        : /\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">lastmod    : 2017-02-10T23:57:52+00:00\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">changefreq : daily\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">priority   : 1.0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">loc        : /category/azure/\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">lastmod    : 2017-02-08T17:43:41+00:00\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">changefreq : weekly\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">priority   : 0.3\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">loc        : /category/csharp/\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">lastmod    : 2016-12-14T08:53:46+00:00\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">changefreq : weekly\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">priority   : 0.3\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"loc        : /lastmod    : 2017-02-10T23:57:52+00:00changefreq : dailypriority   : 1.0loc        : /category/azure/lastmod    : 2017-02-08T17:43:41+00:00changefreq : weeklypriority   : 0.3loc        : /category/csharp/lastmod    : 2016-12-14T08:53:46+00:00changefreq : weeklypriority   : 0.3\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>\u003Csmall>Displaying only the first 3 entries\u003C/small>\u003C/p>\n\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\r\nUnder the section \u003Ca href=\"https://www.sitemaps.org/protocol.html#xmlTagDefinitions\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Cabbr title=\"eXtensible Markup Language\">XML\u003C/abbr> tag definitions\u003Cspan>\u003C/span>\u003C/a>\r\nthe protocol states that the \u003Ccode>lastmod\u003C/code>, \u003Ccode>changefreq\u003C/code> and \u003Ccode>priority\u003C/code> attributes are optional,\r\nso they can be missing in the sitemap.\u003C/p>\n\u003C/div>\n\u003Cp>Now you can do basic PowerShell manipulation of the result set like sorting, selecting, filtering and formatting.\u003C/p>\n\u003Cp>For example:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:58ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">\\ConvertFrom-SiteMap.ps1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Url \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">/\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">sitemap\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0.\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">xml\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Sort-Object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> priority \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Descending\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Select-Object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> priority\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> changefreq\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">,\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> loc \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">First \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">5\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Where-Object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$_\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.priority\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-ge\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0.3\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Format-Table\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\".\\ConvertFrom-SiteMap.ps1 -Url /sitemap-0.xml        | Sort-Object priority -Descending        | Select-Object priority, changefreq, loc -First 5        | Where-Object { $_.priority -ge 0.3 }        | Format-Table\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Outputs:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:44ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">priority changefreq loc\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">-------- ---------- ----\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">1.0      daily      /\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">0.6      weekly     /about/\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">0.6      weekly     /archives/\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">0.3      weekly     /category/windows/\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">0.3      weekly     /category/visual-studio/\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"priority changefreq loc-------- ---------- ----1.0      daily      /0.6      weekly     /about/0.6      weekly     /archives/0.3      weekly     /category/windows/0.3      weekly     /category/visual-studio/\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"ignoring-sitemap-index-entries\">Ignoring Sitemap Index entries\u003C/h2>\n\u003Cp>A sitemap can also be a \u003Ca href=\"https://www.sitemaps.org/protocol.html#index\" rel=\"noopener noreferrer external\" target=\"_blank\">Sitemap Index File\u003Cspan>\u003C/span>\u003C/a>.\r\nThe file then contains links to other sitemap files.\u003C/p>\n\u003Cp>By default, the script will follow these links.\r\nIf you don’t want this to happen you can set the \u003Ccode>NoFollow\u003C/code> switch.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:77ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">\\ConvertFrom-SiteMap.ps1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Url https:\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">//\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">blog.hompus.nl\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">/\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">sitemap\u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0.\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">xml \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">NoFollow\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\".\\ConvertFrom-SiteMap.ps1 -Url https://blog.hompus.nl/sitemap-0.xml -NoFollow\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"source-code\">Source code\u003C/h2>\n\u003Cp>The complete source code is available as a\r\n\u003Ca href=\"https://gist.github.com/eNeRGy164/a644417b737eb5d3af3c80d4ceb527e1\" rel=\"noopener noreferrer external\" target=\"_blank\">GitHub Gist\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>",{"headings":1888,"imagePaths":1896,"frontmatter":1871},[1889,1892,1895],{"depth":780,"slug":1890,"text":1891},"basic-usage","Basic usage",{"depth":780,"slug":1893,"text":1894},"ignoring-sitemap-index-entries","Ignoring Sitemap Index entries",{"depth":780,"slug":1056,"text":1057},[],"2017-05-29-adding-application-logging-blob-to-a-azure-web-app-service-using-powershell",{"id":1897,"data":1899,"body":1911,"filePath":1912,"digest":1913,"rendered":1914},{"id":1900,"title":1901,"date":1902,"updated":1903,"author":15,"excerpt":1904,"layout":17,"permalink":1905,"image":1906,"categories":1907,"tags":1908,"draft":26},1205,"Adding Application Logging (Blob) to an Azure Web App Service using PowerShell",["Date","2017-05-29T13:48:03.000Z"],["Date","2020-12-07T16:31:55.000Z"],"The other day I wanted to configure Application Logging on Blob Storage for a Web App Service and found out this needs a SAS URL. And this is something an ARM template can’t provide for you.\nIn this post, I will walk you through the necessary PowerShell code to run.\n","/2017/05/29/adding-application-logging-blob-to-a-azure-web-app-service-using-powershell/","/wp-content/uploads/2017/05/post-1205-thumbnail.png",[906,1196],[1806,906,1196,1909,1843,1910],"SAS","Web App Service","These days it's normal to deploy and configure all aspects of your Azure Resources using the Azure Resource Manager and the accompanying ARM Templates.\r\nBut sometimes you walk into a missing feature that's is not (yet) available in the ARM system.\r\n\r\nThe other day I wanted to configure Application Logging on Blob Storage for a Web App Service and found out this needs a SAS URL.\r\nAnd this is something an ARM template cannot provide for you.\r\n\r\n\u003C!--more-->\r\n\r\nIn this article, I will walk you through the necessary PowerShell code to run.\r\nFor example, after your ARM template has been deployed.\r\nAt the end of this article, you will find the link to the [source code](#source-code).\r\n\r\n## The ARM template\r\n\r\nIn the ARM template, we deploy a Storage Account and a Web App Service.\r\n\r\n```json\r\n{\r\n  \"$schema\": \"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\",\r\n  \"contentVersion\": \"1.0.0.0\",\r\n  \"resources\": [\r\n    {\r\n      \"type\": \"Microsoft.Storage/storageAccounts\",\r\n      \"kind\": \"Storage\",\r\n      \"name\": \"loremipsumstore\",\r\n      \"apiVersion\": \"2016-01-01\",\r\n      \"sku\": {\r\n        \"name\": \"Standard_LRS\"\r\n      },\r\n      \"location\": \"[resourceGroup().location]\"\r\n    },\r\n    {\r\n      \"type\": \"Microsoft.Web/serverfarms\",\r\n      \"kind\": \"app\",\r\n      \"name\": \"LoremIpsumAppService\",\r\n      \"sku\": {\r\n        \"name\": \"B1\"\r\n      },\r\n      \"apiVersion\": \"2015-08-01\",\r\n      \"location\": \"[resourceGroup().location]\",\r\n      \"properties\": {\r\n        \"name\": \"LoremIpsumAppService\",\r\n        \"numberOfWorkers\": 1\r\n      },\r\n      \"resources\": [\r\n        {\r\n          \"type\": \"Microsoft.Web/sites\",\r\n          \"kind\": \"app\",\r\n          \"name\": \"LoremIpsumWebApp\",\r\n          \"apiVersion\": \"2015-08-01\",\r\n          \"location\": \"[resourceGroup().location]\",\r\n          \"properties\": {\r\n            \"name\": \"LoremIpsumWebApp\"\r\n          },\r\n          \"dependsOn\": [\r\n            \"[resourceId('Microsoft.Web/serverfarms', 'LoremIpsumAppService')]\"\r\n          ]\r\n        }\r\n      ]\r\n    }\r\n  ]\r\n}\r\n```\r\n\r\n## The problem\r\n\r\nWhen we configure the Application Logging to Blob Storage using the Azure Portal,\r\nwe see the following properties in the JSON of the Web App Service using the [Azure Resource Explorer](https://resources.azure.com/).\r\n\r\n```json\r\n\"applicationLogs\":{\r\n  \"azureBlobStorage\":{\r\n    \"level\":\"Verbose\",\r\n    \"sasUrl\":\"https://loremipsumstore.blob.core.windows.net/webapp-logs?sv=2015-04-05&sr=c&sig=XXX…XXX&st=2017-05-29T22:00:00Z&se=2217-05-29T22:00:00Z&sp=rwdl\",\r\n    \"retentionInDays\":30\r\n  }\r\n}\r\n```\r\n\r\nBut secretly, the last two properties are stored in the AppSettings.\r\nWhen we look there, we see the following two keys:\r\n\r\n```plain\r\nDIAGNOSTICS_AZUREBLOBCONTAINERSASURL https://loremipsumstore.blob.core.windows.net/webapp-logs?sv=2015-04-05&sr=c&sig=XXX…XXX&st=2017-05-29T22:00:00Z&se=2217-05-29T22:00:00Z&sp=rwdl\r\nDIAGNOSTICS_AZUREBLOBRETENTIONINDAYS 30\r\n```\r\n\r\nSetting AppSettings with an ARM template is not that hard.\r\nBut the URL we need to set cannot be predefined and ARM templates do not have support for the generation of a SAS URL.\r\n\r\nMany ARM template samples _do_ use SAS URLs, but always as a parameter.\r\nBut how can you supply a parameter to a resource that might not yet exist?\r\n\r\nThat is the whole point of using the template.\r\n\r\nSo, the only option is to configure the Web App Service after running the deployment.\r\n\r\n## The solution\r\n\r\nFor this solution, we use PowerShell. This makes it easy for running this code in a VSTS or TFS release pipeline.\r\nBut it can be used in any way you want to configure your environments.\r\n\r\n> [!NOTE]\r\n> Depending on how you run this script you might need to login first using `Login-AzureRmAccount` \r\n> and select the Azure Subscription you want to use using `Select-AzureRmSubscription`.\r\n\r\nThe configuration is done in 6 steps.\r\n\r\n1. We get the Storage Account where we want to store the Application Logs.\r\n\r\n   ```powershell title=\"PowerShell\"\r\n   $sa = Get-AzureRmStorageAccount\r\n            -ResourceGroupName \"loremipsumresourcegroup\"\r\n            -Name \"loremipsumstore\"\r\n   ```\r\n\r\n2. We make sure there is a container to store the logs.\r\n   Because we can run the script multiple times, we ignore the error if the container already exists.\r\n\r\n   ```powershell title=\"PowerShell\"\r\n   New-AzureStorageContainer\r\n        -Context $sa.Context\r\n        -Name \"webapp-logs\"\r\n        -ErrorAction Ignore\r\n   ```\r\n\r\n3. Next, we generate the SAS token for the container.\r\n   We use the same settings Microsoft uses when creating the link using the Azure Portal.\r\n\r\n   ```powershell title=\"PowerShell\"\r\n   $sasToken = New-AzureStorageContainerSASToken\r\n                    -Context $sa.Context\r\n                    -Name \"webapp-logs\"\r\n                    -FullUri\r\n                    -Permission rwdl\r\n                    -StartTime (Get-Date).Date\r\n                    -ExpiryTime (Get-Date).Date.AddYears(200)\r\n   ```\r\n\r\n4. We want to update the AppSettings as the configuration is stored there.\r\n   But when you update the AppSettings, any setting not present in the update will be removed.\r\n   Therefore, we first want to get all the existing AppSettings.\r\n\r\n   ```powershell title=\"PowerShell\"\r\n   $webApp = Get-AzureRmWebApp\r\n                  -ResourceGroupName \"loremipsumresourcegroup\"\r\n                  -Name \"LoremIpsumWebApp\"\r\n   ```\r\n\r\n5. Strangely the `Set-AzureRmWebApp` command does not accept the `SiteConfig.AppSettings` we got from the `Get-AzureRmWebApp` command.\r\n   We need to create a Hash Table for this.  \r\n   To make sure the Application Settings keep the same order, we define the Hash Table as `Ordered`.\r\n\r\n   ```powershell title=\"PowerShell\"\r\n   $appSettings = [ordered]@{}\r\n   $webapp.SiteConfig.AppSettings | % { $appSettings[$_.Name] = $_.Value }\r\n   $appSettings.DIAGNOSTICS_AZUREBLOBCONTAINERSASURL = [string]$sasToken\r\n   ```\r\n\r\n6. Now we can update the App Service using the `Set-AzureRmWebApp` command.\r\n\r\n   ```powershell title=\"PowerShell\"\r\n   Set-AzureRmWebApp\r\n      -ResourceGroupName \"loremipsumresourcegroup\"\r\n      -Name \"LoremIpsumWebApp\"\r\n      -AppSettings $appSettings\r\n   ```\r\n\r\n## Source code\r\n\r\nThe complete source code is available as\r\n[GitHub Gist](https://gist.github.com/eNeRGy164/6f055a0614bcb89586b3fbdad8d99c32) for reference.","src/posts/2017-05-29-adding-application-logging-blob-to-a-azure-web-app-service-using-powershell.md","274f96c4c1f614a8",{"html":1915,"metadata":1916},"\u003Cp>These days it’s normal to deploy and configure all aspects of your Azure Resources using the Azure Resource Manager and the accompanying \u003Cdfn>\u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr>\u003C/dfn> Templates.\r\nBut sometimes you walk into a missing feature that’s is not (yet) available in the \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> system.\u003C/p>\n\u003Cp>The other day I wanted to configure Application Logging on Blob Storage for a Web App Service and found out this needs a SAS \u003Cdfn>\u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>\u003C/dfn>.\r\nAnd this is something an \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> template cannot provide for you.\u003C/p>\n\u003C!--more-->\n\u003Cp>In this article, I will walk you through the necessary PowerShell code to run.\r\nFor example, after your \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> template has been deployed.\r\nAt the end of this article, you will find the link to the \u003Ca href=\"#source-code\">source code\u003C/a>.\u003C/p>\n\u003Ch2 id=\"the-arm-template\">The \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> template\u003C/h2>\n\u003Cp>In the \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> template, we deploy a Storage Account and a Web App Service.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:95ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"$schema\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"contentVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"1.0.0.0\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"resources\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.Storage/storageAccounts\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"kind\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Storage\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"loremipsumstore\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2016-01-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"sku\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Standard_LRS\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"location\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceGroup().location]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.Web/serverfarms\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"kind\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"app\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremIpsumAppService\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"sku\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"B1\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-08-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"location\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceGroup().location]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremIpsumAppService\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"numberOfWorkers\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">1\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"resources\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.Web/sites\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"kind\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"app\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremIpsumWebApp\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-08-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"location\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceGroup().location]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremIpsumWebApp\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">          \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"dependsOn\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceId('Microsoft.Web/serverfarms', 'LoremIpsumAppService')]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">          \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;$schema&#x22;: &#x22;https://schema.management.azure.com/schemas/2015-01-01/deploymentTemplate.json#&#x22;,  &#x22;contentVersion&#x22;: &#x22;1.0.0.0&#x22;,  &#x22;resources&#x22;: [    {      &#x22;type&#x22;: &#x22;Microsoft.Storage/storageAccounts&#x22;,      &#x22;kind&#x22;: &#x22;Storage&#x22;,      &#x22;name&#x22;: &#x22;loremipsumstore&#x22;,      &#x22;apiVersion&#x22;: &#x22;2016-01-01&#x22;,      &#x22;sku&#x22;: {        &#x22;name&#x22;: &#x22;Standard_LRS&#x22;      },      &#x22;location&#x22;: &#x22;[resourceGroup().location]&#x22;    },    {      &#x22;type&#x22;: &#x22;Microsoft.Web/serverfarms&#x22;,      &#x22;kind&#x22;: &#x22;app&#x22;,      &#x22;name&#x22;: &#x22;LoremIpsumAppService&#x22;,      &#x22;sku&#x22;: {        &#x22;name&#x22;: &#x22;B1&#x22;      },      &#x22;apiVersion&#x22;: &#x22;2015-08-01&#x22;,      &#x22;location&#x22;: &#x22;[resourceGroup().location]&#x22;,      &#x22;properties&#x22;: {        &#x22;name&#x22;: &#x22;LoremIpsumAppService&#x22;,        &#x22;numberOfWorkers&#x22;: 1      },      &#x22;resources&#x22;: [        {          &#x22;type&#x22;: &#x22;Microsoft.Web/sites&#x22;,          &#x22;kind&#x22;: &#x22;app&#x22;,          &#x22;name&#x22;: &#x22;LoremIpsumWebApp&#x22;,          &#x22;apiVersion&#x22;: &#x22;2015-08-01&#x22;,          &#x22;location&#x22;: &#x22;[resourceGroup().location]&#x22;,          &#x22;properties&#x22;: {            &#x22;name&#x22;: &#x22;LoremIpsumWebApp&#x22;          },          &#x22;dependsOn&#x22;: [            &#x22;[resourceId(&#x27;Microsoft.Web/serverfarms&#x27;, &#x27;LoremIpsumAppService&#x27;)]&#x22;          ]        }      ]    }  ]}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"the-problem\">The problem\u003C/h2>\n\u003Cp>When we configure the Application Logging to Blob Storage using the Azure Portal,\r\nwe see the following properties in the \u003Cdfn>\u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr>\u003C/dfn> of the Web App Service using the \u003Ca href=\"https://resources.azure.com/\" rel=\"noopener noreferrer external\" target=\"_blank\">Azure Resource Explorer\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:160ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CE9178\">\"applicationLogs\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"azureBlobStorage\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"level\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Verbose\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"sasUrl\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"https://loremipsumstore.blob.core.windows.net/webapp-logs?sv=2015-04-05&#x26;sr=c&#x26;sig=XXX…XXX&#x26;st=2017-05-29T22:00:00Z&#x26;se=2217-05-29T22:00:00Z&#x26;sp=rwdl\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"retentionInDays\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">30\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"&#x22;applicationLogs&#x22;:{  &#x22;azureBlobStorage&#x22;:{    &#x22;level&#x22;:&#x22;Verbose&#x22;,    &#x22;sasUrl&#x22;:&#x22;https://loremipsumstore.blob.core.windows.net/webapp-logs?sv=2015-04-05&#x26;sr=c&#x26;sig=XXX…XXX&#x26;st=2017-05-29T22:00:00Z&#x26;se=2217-05-29T22:00:00Z&#x26;sp=rwdl&#x22;,    &#x22;retentionInDays&#x22;:30  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>But secretly, the last two properties are stored in the AppSettings.\r\nWhen we look there, we see the following two keys:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:181ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">DIAGNOSTICS_AZUREBLOBCONTAINERSASURL https://loremipsumstore.blob.core.windows.net/webapp-logs?sv=2015-04-05&#x26;sr=c&#x26;sig=XXX…XXX&#x26;st=2017-05-29T22:00:00Z&#x26;se=2217-05-29T22:00:00Z&#x26;sp=rwdl\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">DIAGNOSTICS_AZUREBLOBRETENTIONINDAYS 30\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"DIAGNOSTICS_AZUREBLOBCONTAINERSASURL https://loremipsumstore.blob.core.windows.net/webapp-logs?sv=2015-04-05&#x26;sr=c&#x26;sig=XXX…XXX&#x26;st=2017-05-29T22:00:00Z&#x26;se=2217-05-29T22:00:00Z&#x26;sp=rwdlDIAGNOSTICS_AZUREBLOBRETENTIONINDAYS 30\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Setting AppSettings with an \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> template is not that hard.\r\nBut the \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr> we need to set cannot be predefined and \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> templates do not have support for the generation of a SAS \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>.\u003C/p>\n\u003Cp>Many \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> template samples \u003Cem>do\u003C/em> use SAS URLs, but always as a parameter.\r\nBut how can you supply a parameter to a resource that might not yet exist?\u003C/p>\n\u003Cp>That is the whole point of using the template.\u003C/p>\n\u003Cp>So, the only option is to configure the Web App Service after running the deployment.\u003C/p>\n\u003Ch2 id=\"the-solution\">The solution\u003C/h2>\n\u003Cp>For this solution, we use PowerShell. This makes it easy for running this code in a \u003Cdfn>\u003Cabbr title=\"Visual Studio Team Services\">VSTS\u003C/abbr>\u003C/dfn> or \u003Cdfn>\u003Cabbr title=\"Team Foundation Server\">TFS\u003C/abbr>\u003C/dfn> release pipeline.\r\nBut it can be used in any way you want to configure your environments.\u003C/p>\n\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\r\nDepending on how you run this script you might need to login first using \u003Ccode>Login-AzureRmAccount\u003C/code>\r\nand select the Azure Subscription you want to use using \u003Ccode>Select-AzureRmSubscription\u003C/code>.\u003C/p>\n\u003C/div>\n\u003Cp>The configuration is done in 6 steps.\u003C/p>\n\u003Col>\n\u003Cli>\n\u003Cp>We get the Storage Account where we want to store the Application Logs.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:53ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$sa\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Get-AzureRmStorageAccount\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:9ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">         \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">ResourceGroupName \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"loremipsumresourcegroup\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:9ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">         \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Name \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"loremipsumstore\"\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"$sa = Get-AzureRmStorageAccount         -ResourceGroupName &#x22;loremipsumresourcegroup&#x22;         -Name &#x22;loremipsumstore&#x22;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003Cli>\n\u003Cp>We make sure there is a container to store the logs.\r\nBecause we can run the script multiple times, we ignore the error if the container already exists.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:25ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">New-AzureStorageContainer\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:5ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">     \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Context \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$sa\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Context\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:5ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">     \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Name \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"webapp-logs\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:5ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">     \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">ErrorAction Ignore\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"New-AzureStorageContainer     -Context $sa.Context     -Name &#x22;webapp-logs&#x22;     -ErrorAction Ignore\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003Cli>\n\u003Cp>Next, we generate the SAS token for the container.\r\nWe use the same settings Microsoft uses when creating the link using the Azure Portal.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:58ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$sasToken\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">New-AzureStorageContainerSASToken\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:17ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                 \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Context \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$sa\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Context\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:17ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                 \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Name \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"webapp-logs\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:17ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                 \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">FullUri\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:17ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                 \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Permission rwdl\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:17ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                 \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">StartTime (\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Get-Date\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">).Date\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:17ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                 \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">ExpiryTime (\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Get-Date\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">).Date.AddYears(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">200\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"$sasToken = New-AzureStorageContainerSASToken                 -Context $sa.Context                 -Name &#x22;webapp-logs&#x22;                 -FullUri                 -Permission rwdl                 -StartTime (Get-Date).Date                 -ExpiryTime (Get-Date).Date.AddYears(200)\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003Cli>\n\u003Cp>We want to update the AppSettings as the configuration is stored there.\r\nBut when you update the AppSettings, any setting not present in the update will be removed.\r\nTherefore, we first want to get all the existing AppSettings.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:59ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$webApp\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Get-AzureRmWebApp\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:15ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">               \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">ResourceGroupName \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"loremipsumresourcegroup\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:15ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">               \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Name \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremIpsumWebApp\"\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"$webApp = Get-AzureRmWebApp               -ResourceGroupName &#x22;loremipsumresourcegroup&#x22;               -Name &#x22;LoremIpsumWebApp&#x22;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003Cli>\n\u003Cp>Strangely the \u003Ccode>Set-AzureRmWebApp\u003C/code> command does not accept the \u003Ccode>SiteConfig.AppSettings\u003C/code> we got from the \u003Ccode>Get-AzureRmWebApp\u003C/code> command.\r\nWe need to create a Hash Table for this.\u003Cbr>\nTo make sure the Application Settings keep the same order, we define the Hash Table as \u003Ccode>Ordered\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:71ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$appSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [\u003C/span>\u003Cspan style=\"--0:#569CD6\">ordered\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003Cspan style=\"--0:#569CD6\">@\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$webapp\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.SiteConfig.AppSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#C586C0\">%\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$appSettings\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$_\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">] \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$_\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Value\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$appSettings\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.DIAGNOSTICS_AZUREBLOBCONTAINERSASURL\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$sasToken\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"$appSettings = [ordered]@{}$webapp.SiteConfig.AppSettings | % { $appSettings[$_.Name] = $_.Value }$appSettings.DIAGNOSTICS_AZUREBLOBCONTAINERSASURL = [string]$sasToken\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003Cli>\n\u003Cp>Now we can update the App Service using the \u003Ccode>Set-AzureRmWebApp\u003C/code> command.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:47ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">Set-AzureRmWebApp\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:3ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">   \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">ResourceGroupName \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"loremipsumresourcegroup\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:3ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">   \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Name \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremIpsumWebApp\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:3ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">   \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">AppSettings \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$appSettings\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Set-AzureRmWebApp   -ResourceGroupName &#x22;loremipsumresourcegroup&#x22;   -Name &#x22;LoremIpsumWebApp&#x22;   -AppSettings $appSettings\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003C/li>\n\u003C/ol>\n\u003Ch2 id=\"source-code\">Source code\u003C/h2>\n\u003Cp>The complete source code is available as\r\n\u003Ca href=\"https://gist.github.com/eNeRGy164/6f055a0614bcb89586b3fbdad8d99c32\" rel=\"noopener noreferrer external\" target=\"_blank\">GitHub Gist\u003Cspan>\u003C/span>\u003C/a> for reference.\u003C/p>",{"headings":1917,"imagePaths":1924,"frontmatter":1899},[1918,1921,1922,1923],{"depth":780,"slug":1919,"text":1920},"the-arm-template","The ARM template",{"depth":780,"slug":255,"text":256},{"depth":780,"slug":258,"text":259},{"depth":780,"slug":1056,"text":1057},[],"2017-09-25-bing-for-business-part-1-branding",{"id":1925,"data":1927,"body":1940,"filePath":1941,"digest":1942,"rendered":1943},{"id":1928,"title":1929,"date":1930,"updated":1931,"author":15,"excerpt":1932,"layout":17,"permalink":1933,"image":1934,"categories":1935,"tags":1936,"draft":26},1224,"Bing for business – Part 1: Branding",["Date","2017-09-25T21:39:42.000Z"],["Date","2020-12-07T16:35:54.000Z"],"At the Ignite conference keynote Microsoft announced Bing for business. Winvision is one of the partners participating in the current preview.\nWith the public announcement of Bing for business, I’m now allowed to show you what the service is offering our company.\nIn the coming days I will be posting about several parts of Bing for business, starting with “branding”.\n","/2017/09/25/bing-for-business-part-1-branding/","/wp-content/uploads/2017/09/post-1224-thumbnail.png",[106],[1937,1938,1200,1939,138],"Bing","Bing for business","Preview","At the Ignite conference keynote\r\n[Microsoft announced Bing for business](https://blogs.bing.com/search/2017-09/finding-what-you-need-at-work-just-got-easier-with-bing-for-business):\r\n\r\n> A new intelligent search experience for Office 365 and Microsoft 365,\r\n> which uses AI and the Microsoft Graph to deliver more relevant search\r\n> results based on your organizational context.\r\n\r\nAs you might have heard at the end of the demo by [Li-Chen Miller](https://www.linkedin.com/in/lichenmiller/),\r\nWinvision was mentioned as one of the partners participating in the current preview.\r\n\r\nWith the public announcement of Bing for business,\r\nI am now allowed to show you what the service is currently offering.\r\n\r\nIn the coming days I will be posting more about Bing for business,\r\nstarting today with _branding_.\r\n\r\n\u003C!--more-->\r\n\r\n### Branding\r\n\r\nYou want the Bing for business search result to feel familiar for everybody in the company.\r\nTherefore, you can configure some settings that change the look and feel.\r\nMost notable the name and logo of the company and a recognizable color,\r\njust like you can in Office 365.\r\n\r\nFor our company, this it is something like the following configuration:\r\n\r\n![Configuring branding](/wp-content/uploads/2017/09/bingforbusiness-branding-configuration.png)\r\n\r\nThis will make the search results in Bing look like this:\r\n\r\n![Branded search results](/wp-content/uploads/2017/09/bingforbusiness-branding.png)\r\n\r\n\u003Csmall>The content is stripped to not distract from the branding.\u003C/small>\r\n\r\n> [!NOTE]\r\n> The Bing for business section is recognizable by the gray background bar.\r\n\r\nFrom the settings, we recognize:\r\n\r\n1. The company name\r\n2. The company color\r\n3. The logo\r\n4. The favicon\r\n\r\nEven when a Bing for business search result is shown in the sidebar,\r\nthe company logo and color immediately pop out and make it recognizable as a business result:\r\n\r\n![Branded side bar](/wp-content/uploads/2017/09/bingforbusiness-branding-sidebar.png)\r\n\r\nIf you are interested, visit \u003Chttps://www.bing.com/Business/explore>.","src/posts/2017-09-25-bing-for-business-part-1-branding.md","d6f78a44d0c510e0",{"html":1944,"metadata":1945},"\u003Cp>At the Ignite conference keynote\r\n\u003Ca href=\"https://blogs.bing.com/search/2017-09/finding-what-you-need-at-work-just-got-easier-with-bing-for-business\" rel=\"noopener noreferrer external\" target=\"_blank\">Microsoft announced Bing for business\u003Cspan>\u003C/span>\u003C/a>:\u003C/p>\n\u003Cblockquote>\n\u003Cp>A new intelligent search experience for Office 365 and Microsoft 365,\r\nwhich uses \u003Cdfn>\u003Cabbr title=\"Artificial Intelligence\">AI\u003C/abbr>\u003C/dfn> and the Microsoft Graph to deliver more relevant search\r\nresults based on your organizational context.\u003C/p>\n\u003C/blockquote>\n\u003Cp>As you might have heard at the end of the demo by \u003Ca href=\"https://www.linkedin.com/in/lichenmiller/\">Li-Chen Miller\u003C/a>,\r\nWinvision was mentioned as one of the partners participating in the current preview.\u003C/p>\n\u003Cp>With the public announcement of Bing for business,\r\nI am now allowed to show you what the service is currently offering.\u003C/p>\n\u003Cp>In the coming days I will be posting more about Bing for business,\r\nstarting today with \u003Cem>branding\u003C/em>.\u003C/p>\n\u003C!--more-->\n\u003Ch3 id=\"branding\">Branding\u003C/h3>\n\u003Cp>You want the Bing for business search result to feel familiar for everybody in the company.\r\nTherefore, you can configure some settings that change the look and feel.\r\nMost notable the name and logo of the company and a recognizable color,\r\njust like you can in Office 365.\u003C/p>\n\u003Cp>For our company, this it is something like the following configuration:\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2017/09/bingforbusiness-branding-configuration.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-configuration.webp\" type=\"image/webp\" media=\"(max-width: 988px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-configuration-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-configuration-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-configuration-636x181.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2017/09/bingforbusiness-branding-configuration-636x181.png\" alt=\"Configuring branding\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"181\" srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-configuration.png 988w, /wp-content/uploads/2017/09/bingforbusiness-branding-configuration-150x150.png 150w, /wp-content/uploads/2017/09/bingforbusiness-branding-configuration-185x185.png 185w, /wp-content/uploads/2017/09/bingforbusiness-branding-configuration-636x181.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003C/figure>\n\u003Cp>This will make the search results in Bing look like this:\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2017/09/bingforbusiness-branding.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding.webp\" type=\"image/webp\" media=\"(max-width: 1707px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-636x311.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2017/09/bingforbusiness-branding-636x311.png\" alt=\"Branded search results\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"311\" srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding.png 1707w, /wp-content/uploads/2017/09/bingforbusiness-branding-150x150.png 150w, /wp-content/uploads/2017/09/bingforbusiness-branding-185x185.png 185w, /wp-content/uploads/2017/09/bingforbusiness-branding-636x311.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003C/figure>\n\u003Cp>\u003Csmall>The content is stripped to not distract from the branding.\u003C/small>\u003C/p>\n\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\r\nThe Bing for business section is recognizable by the gray background bar.\u003C/p>\n\u003C/div>\n\u003Cp>From the settings, we recognize:\u003C/p>\n\u003Col>\n\u003Cli>The company name\u003C/li>\n\u003Cli>The company color\u003C/li>\n\u003Cli>The logo\u003C/li>\n\u003Cli>The favicon\u003C/li>\n\u003C/ol>\n\u003Cp>Even when a Bing for business search result is shown in the sidebar,\r\nthe company logo and color immediately pop out and make it recognizable as a business result:\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2017/09/bingforbusiness-branding-sidebar.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-sidebar.webp\" type=\"image/webp\" media=\"(max-width: 1702px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-sidebar-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-sidebar-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-sidebar-636x284.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2017/09/bingforbusiness-branding-sidebar-636x284.png\" alt=\"Branded side bar\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"284\" srcset=\"/wp-content/uploads/2017/09/bingforbusiness-branding-sidebar.png 1702w, /wp-content/uploads/2017/09/bingforbusiness-branding-sidebar-150x150.png 150w, /wp-content/uploads/2017/09/bingforbusiness-branding-sidebar-185x185.png 185w, /wp-content/uploads/2017/09/bingforbusiness-branding-sidebar-636x284.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003C/figure>\n\u003Cp>If you are interested, visit \u003Ca href=\"https://www.bing.com/Business/explore\" rel=\"noopener noreferrer external\" target=\"_blank\">https://www.bing.com/Business/explore\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>",{"headings":1946,"imagePaths":1950,"frontmatter":1927},[1947],{"depth":198,"slug":1948,"text":1949},"branding","Branding",[],"2017-09-28-bing-for-business-part-2-people-search",{"id":1951,"data":1953,"body":1963,"filePath":1964,"digest":1965,"rendered":1966},{"id":1954,"title":1955,"date":1956,"updated":1957,"author":15,"excerpt":1958,"layout":17,"permalink":1959,"image":1960,"categories":1961,"tags":1962,"draft":26},1245,"Bing for business – Part 2: People search",["Date","2017-09-27T22:49:13.000Z"],["Date","2020-12-07T16:41:02.000Z"],"This will be my second post about Bing for business: “the new intelligent search experience for Office 365 and Microsoft 365, which uses AI and the Microsoft Graph to deliver more relevant search results based on your organizational context”.\nIn this post, we will be focusing on “People Search”.\n","/2017/09/28/bing-for-business-part-2-people-search/","/wp-content/uploads/2017/09/post-1245-thumbnail.png",[106],[1937,1938,1200,1939,138],"This will be my second post about\r\n[Bing for business](https://blogs.bing.com/search/2017-09/finding-what-you-need-at-work-just-got-easier-with-bing-for-business),\r\n\"the new intelligent search experience for Office 365 and Microsoft 365,\r\nwhich uses AI and the Microsoft Graph to deliver more relevant search results based on your organizational context\".\r\n\r\nWe covered [branding](/2017/09/25/bing-for-business-part-1-branding) in the first article.\r\nIn this article, I will be focusing on _People Search_.\r\n\r\n\u003C!--more-->\r\n\r\n## Welcome bar\r\n\r\nWhen a user is logged in, Bing will show a welcome bar with some suggestions for queries.\r\n\r\n![Welcome bar](/wp-content/uploads/2017/09/bingforbusiness-welcome-bar.png)\r\n\r\nLet’s use the first query: _me_.\r\n\r\n## Searching for _me_\r\n\r\nWhen searching for _me_, besides all normal Bing search results, you will get your own profile.\r\n\r\n![Searching for me](/wp-content/uploads/2017/09/bingforbusiness-people-me.png)\r\n\r\nAs we can see, the person result page is structured in 3 columns.\r\n\r\n### Left column, profile\r\n\r\nIn the left column, the Azure AD profile information is shown.\r\n\r\n- My picture\r\n- My full name\r\n- My function title\r\n- My phone number\r\n- My e-mail address\r\n- My Skype for business alias\r\n\r\n### Center column, organization\r\n\r\nIn the center column, the organizational position is shown.\r\n\r\n- My manager\r\n- My peers (sharing the same manager)  \r\n  _When hovering over a profile image, the name and function are shown_\r\n- My department\r\n\r\n### Right column, events\r\n\r\nIn the right column, data from the agenda is shown.\r\n\r\n- My timeline for today\r\n- My first 2 upcoming events, with the title, time and location\r\n\r\nIn total, this gives a good overview of my contact details,\r\nposition in the organization and my schedule.\r\n\r\n## Searching for _sander_\r\n\r\nChances are that you won’t be searching for your own profile very often.  \r\nSo, let’s start looking for the profile of a colleague.\r\nFor this I entered _sander_ as search query in Bing.\r\n\r\nAlthough there are multiple colleagues working at Winvision with a first name of _Sander_,\r\nthe person that is displayed is the one closest in the organizational structure to me.\r\n\r\n![People manager](/wp-content/uploads/2017/09/bingforbusiness-people-manager.png)\r\n\r\nThe contact details are now an ideal way to start a call or chat with your colleague.\r\nOr you can send an email, if you prefer that as form of communication.\r\n\r\nThe agenda now does not show the first two events of the person you are looking at,\r\nbut the first two events where you are both part of!\r\nThis is where the use of the Graph API really starts to shine.\r\n\r\n## The other _sander_'s\r\n\r\nAs mentioned before, there are multiple colleagues with the first name of _Sander_.\r\nThis is also indicated at the bottom of the profile, where the first alternative is displayed.\r\n\r\n![Other Sander](/wp-content/uploads/2017/09/bingforbusiness-people-more.png)\r\n\r\nWe can now directly navigate to Sander Hoek's profile if we want,\r\nor we can open a list of all people matching the query:\r\n\r\n![More Sander's](/wp-content/uploads/2017/09/bingforbusiness-people-sanders.png)\r\n\r\nThis concludes this post about the people search in Bing for business.\r\nThe things shown in this post might change in the future, as the product is still under development.\r\n\r\nIf you are interested, visit \u003Chttps://www.bing.com/Business/explore>.","src/posts/2017-09-28-bing-for-business-part-2-people-search.md","68e53f1c79915de3",{"html":1967,"metadata":1968},"\u003Cp>This will be my second post about\r\n\u003Ca href=\"https://blogs.bing.com/search/2017-09/finding-what-you-need-at-work-just-got-easier-with-bing-for-business\" rel=\"noopener noreferrer external\" target=\"_blank\">Bing for business\u003Cspan>\u003C/span>\u003C/a>,\r\n“the new intelligent search experience for Office 365 and Microsoft 365,\r\nwhich uses \u003Cdfn>\u003Cabbr title=\"Artificial Intelligence\">AI\u003C/abbr>\u003C/dfn> and the Microsoft Graph to deliver more relevant search results based on your organizational context”.\u003C/p>\n\u003Cp>We covered \u003Ca href=\"/2017/09/25/bing-for-business-part-1-branding\">branding\u003C/a> in the first article.\r\nIn this article, I will be focusing on \u003Cem>People Search\u003C/em>.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"welcome-bar\">Welcome bar\u003C/h2>\n\u003Cp>When a user is logged in, Bing will show a welcome bar with some suggestions for queries.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-welcome-bar.webp\" type=\"image/webp\" media=\"(max-width: 613px)\">\u003Cimg src=\"/wp-content/uploads/2017/09/bingforbusiness-welcome-bar.png\" alt=\"Welcome bar\" loading=\"lazy\" decoding=\"async\" width=\"613\" height=\"48\" srcset=\"/wp-content/uploads/2017/09/bingforbusiness-welcome-bar.png 613w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>Let’s use the first query: \u003Cem>me\u003C/em>.\u003C/p>\n\u003Ch2 id=\"searching-for-me\">Searching for \u003Cem>me\u003C/em>\u003C/h2>\n\u003Cp>When searching for \u003Cem>me\u003C/em>, besides all normal Bing search results, you will get your own profile.\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2017/09/bingforbusiness-people-me.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-me.webp\" type=\"image/webp\" media=\"(max-width: 1206px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-me-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-me-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-me-636x235.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2017/09/bingforbusiness-people-me-636x235.png\" alt=\"Searching for me\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"235\" srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-me.png 1206w, /wp-content/uploads/2017/09/bingforbusiness-people-me-150x150.png 150w, /wp-content/uploads/2017/09/bingforbusiness-people-me-185x185.png 185w, /wp-content/uploads/2017/09/bingforbusiness-people-me-636x235.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003C/figure>\n\u003Cp>As we can see, the person result page is structured in 3 columns.\u003C/p>\n\u003Ch3 id=\"left-column-profile\">Left column, profile\u003C/h3>\n\u003Cp>In the left column, the Azure \u003Cdfn>\u003Cabbr title=\"Active Directory\">AD\u003C/abbr>\u003C/dfn> profile information is shown.\u003C/p>\n\u003Cul>\n\u003Cli>My picture\u003C/li>\n\u003Cli>My full name\u003C/li>\n\u003Cli>My function title\u003C/li>\n\u003Cli>My phone number\u003C/li>\n\u003Cli>My e-mail address\u003C/li>\n\u003Cli>My Skype for business alias\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"center-column-organization\">Center column, organization\u003C/h3>\n\u003Cp>In the center column, the organizational position is shown.\u003C/p>\n\u003Cul>\n\u003Cli>My manager\u003C/li>\n\u003Cli>My peers (sharing the same manager)\u003Cbr>\n\u003Cem>When hovering over a profile image, the name and function are shown\u003C/em>\u003C/li>\n\u003Cli>My department\u003C/li>\n\u003C/ul>\n\u003Ch3 id=\"right-column-events\">Right column, events\u003C/h3>\n\u003Cp>In the right column, data from the agenda is shown.\u003C/p>\n\u003Cul>\n\u003Cli>My timeline for today\u003C/li>\n\u003Cli>My first 2 upcoming events, with the title, time and location\u003C/li>\n\u003C/ul>\n\u003Cp>In total, this gives a good overview of my contact details,\r\nposition in the organization and my schedule.\u003C/p>\n\u003Ch2 id=\"searching-for-sander\">Searching for \u003Cem>sander\u003C/em>\u003C/h2>\n\u003Cp>Chances are that you won’t be searching for your own profile very often.\u003Cbr>\nSo, let’s start looking for the profile of a colleague.\r\nFor this I entered \u003Cem>sander\u003C/em> as search query in Bing.\u003C/p>\n\u003Cp>Although there are multiple colleagues working at Winvision with a first name of \u003Cem>Sander\u003C/em>,\r\nthe person that is displayed is the one closest in the organizational structure to me.\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2017/09/bingforbusiness-people-manager.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-manager.webp\" type=\"image/webp\" media=\"(max-width: 1205px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-manager-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-manager-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-manager-636x235.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2017/09/bingforbusiness-people-manager-636x235.png\" alt=\"People manager\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"235\" srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-manager.png 1205w, /wp-content/uploads/2017/09/bingforbusiness-people-manager-150x150.png 150w, /wp-content/uploads/2017/09/bingforbusiness-people-manager-185x185.png 185w, /wp-content/uploads/2017/09/bingforbusiness-people-manager-636x235.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003C/figure>\n\u003Cp>The contact details are now an ideal way to start a call or chat with your colleague.\r\nOr you can send an email, if you prefer that as form of communication.\u003C/p>\n\u003Cp>The agenda now does not show the first two events of the person you are looking at,\r\nbut the first two events where you are both part of!\r\nThis is where the use of the Graph \u003Cdfn>\u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr>\u003C/dfn> really starts to shine.\u003C/p>\n\u003Ch2 id=\"the-other-sanders\">The other \u003Cem>sander\u003C/em>’s\u003C/h2>\n\u003Cp>As mentioned before, there are multiple colleagues with the first name of \u003Cem>Sander\u003C/em>.\r\nThis is also indicated at the bottom of the profile, where the first alternative is displayed.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-more.webp\" type=\"image/webp\" media=\"(max-width: 565px)\">\u003Cimg src=\"/wp-content/uploads/2017/09/bingforbusiness-people-more.png\" alt=\"Other Sander\" loading=\"lazy\" decoding=\"async\" width=\"565\" height=\"63\" srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-more.png 565w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cp>We can now directly navigate to Sander Hoek’s profile if we want,\r\nor we can open a list of all people matching the query:\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2017/09/bingforbusiness-people-sanders.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-sanders.webp\" type=\"image/webp\" media=\"(max-width: 1205px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-sanders-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-sanders-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-sanders-636x175.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2017/09/bingforbusiness-people-sanders-636x175.png\" alt=\"More Sander&#x27;s\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"175\" srcset=\"/wp-content/uploads/2017/09/bingforbusiness-people-sanders.png 1205w, /wp-content/uploads/2017/09/bingforbusiness-people-sanders-150x150.png 150w, /wp-content/uploads/2017/09/bingforbusiness-people-sanders-185x185.png 185w, /wp-content/uploads/2017/09/bingforbusiness-people-sanders-636x175.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003C/figure>\n\u003Cp>This concludes this post about the people search in Bing for business.\r\nThe things shown in this post might change in the future, as the product is still under development.\u003C/p>\n\u003Cp>If you are interested, visit \u003Ca href=\"https://www.bing.com/Business/explore\" rel=\"noopener noreferrer external\" target=\"_blank\">https://www.bing.com/Business/explore\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>",{"headings":1969,"imagePaths":1991,"frontmatter":1953},[1970,1973,1976,1979,1982,1985,1988],{"depth":780,"slug":1971,"text":1972},"welcome-bar","Welcome bar",{"depth":780,"slug":1974,"text":1975},"searching-for-me","Searching for me",{"depth":198,"slug":1977,"text":1978},"left-column-profile","Left column, profile",{"depth":198,"slug":1980,"text":1981},"center-column-organization","Center column, organization",{"depth":198,"slug":1983,"text":1984},"right-column-events","Right column, events",{"depth":780,"slug":1986,"text":1987},"searching-for-sander","Searching for sander",{"depth":780,"slug":1989,"text":1990},"the-other-sanders","The other sander’s",[],"2017-03-25-missing-azure-apis-when-adding-permissions-to-an-azure-ad-app",{"id":1992,"data":1994,"body":2008,"filePath":2009,"digest":2010,"rendered":2011},{"id":1995,"title":1996,"date":1997,"updated":1998,"author":15,"excerpt":1999,"layout":17,"permalink":2000,"image":2001,"categories":2002,"tags":2003,"draft":26},1177,"“Missing” Azure APIs when adding permissions to an Azure AD app",["Date","2017-03-25T11:57:15.000Z"],["Date","2020-12-07T16:29:56.000Z"],"When I recently was configuring an Azure AD application, I couldn’t assign the delegated permissions for an Azure SQL Database. It did cost me a full day to find out the Azure Portal user interface has an unexpected user interaction when it comes to selecting APIs.\nIn this post, I’ll explain how you can find all APIs available for your application.\n","/2017/03/25/missing-azure-apis-when-adding-permissions-to-an-azure-ad-app/","/wp-content/uploads/2017/03/post-1177-thumbnail.png",[906],[2004,2005,906,2006,2007],"AD","App","Portal","UI","When I recently was configuring an Azure AD application,\r\nI could not assign the delegated permissions for an Azure SQL Database.\r\nIt did cost me a full day to find out the Azure Portal user interface has an unexpected user interaction when it comes to selecting APIs.\r\n\r\nIn this article, I will explain how you can find all APIs available for your application.\r\n\r\n\u003C!--more-->\r\n\r\n## The problem\r\n\r\nWhen we want to integrate an application with Azure AD, we need to register an app.\r\n\r\nIn my case I want to let a user access an Azure SQL Database using delegation.\r\nSo, the database connection will be created impersonating the user account, not a generic service account.\r\n\r\nTo grant delegation permissions to an API we go to the \u003Ckbd>Required permissions\u003C/kbd> section of the Azure AD app:\r\n\r\n![Required permissions menu item](/wp-content/uploads/2017/03/required-permissions-link.png \"Required permissions menu item\")\r\n\r\nWhen we've created a new app there is not much showing yet, other than the default Azure AD delegated permission to sign in as the user:\r\n\r\n![Required permissions pane with default entry](/wp-content/uploads/2017/03/required-permissions-pane.png \"Required permissions pane with default entry\")\r\n\r\nWe click on the \u003Ckbd>Add\u003C/kbd> button and choose the \u003Ckbd>Select an API\u003C/kbd> option:\r\n\r\n![Select an API menu item](/wp-content/uploads/2017/03/select-an-api.png \"Select an API menu item\")\r\n\r\nHere we get a list of APIs to choose from. But our Azure SQL Database is not listed.\r\n\r\nThere is a search function, but entering \u003Ckbd>SQL\u003C/kbd>, like my colleague [Remco Ploeg](https://www.linkedin.com/in/remcoploeg/) did, did not list any results.\r\n\r\nThis is where I started to search online if other people encountered the same problem.\r\nOne of the few related posts is by Michael Collier:\r\n[Connect to Azure SQL Database by Using Azure AD Authentication](https://michaelcollier.wordpress.com/2016/11/03/connect-to-azure-sql-database-by-using-azure-ad-authentication/).\r\n\r\nIn his post he mentions not having the API listed:\r\n\r\n> Before you can continue, you need to have followed the prerequisites steps stated at the top of this post.\r\n> You especially need to be sure you have created an Azure AD contained database user.\r\n> If you fail to do that, you will not see \"Azure SQL Database\" in the list (as specified below).\r\n\r\nBut following all his steps did not make the API appear.\r\n\r\nAfter wasting more time not finding any other related posts,\r\nadjusting multiple settings, and recreating Azure AD apps,\r\nI suddenly found a lead that pointed me in the right direction\r\n\r\n## The solution\r\n\r\nOne of the apps I created was named `AzureSqlAppTest`.\r\nBecause the list of registered apps is quite long,\r\nI wanted to use the search function and I entered the word \u003Ckbd>SQL\u003C/kbd>.\r\n\r\nTo my surprise no results.\r\n\r\nEntering \u003Ckbd>AzureSQL\u003C/kbd> _did_ show my app, So, …\r\n\r\n> [!WARNING]\r\n> The search function in the Azure Portal **is acting as a \"Begins With\" only filter!**\r\n\r\nDesperately, I tried this trick on the API list as well.\r\nMaybe the API search function does not show SQL related APIs because the name does not start with \u003Ckbd>SQL\u003C/kbd>.\r\n\r\nInstead of SQL I entered \u003Ckbd>Azure \u003C/kbd> in the search box, and to my amazement:\r\na whole new list of never-before-seen APIs showed up, including our Azure SQL Database:\r\n\r\n![Select an API pane listing many APIs that where hidden](/wp-content/uploads/2017/03/select-an-api-search-results.png)\r\n\r\n> [!WARNING]\r\n> There are many more APIs available in the Azure Portal, **there is just no indication in the UI!**\r\n\r\nAfter re-reading Michael Colliers blog post,\r\nI found he did mention this at the end of one of the steps:\r\n\r\n> 3\\. Add a new required permission and select Azure SQL Database as the API.\r\n> _You’ll want to search for “azure” to get “Azure SQL Database” to appear in the list._\r\n\r\nNow we can configure our app, and everything will work as expected.\r\n\r\n## The conclusion\r\n\r\nJust because the Azure Portal UI does not give any hint there are many more APIs hidden behind the search function,\r\nI wasted a lot of good time.\r\n\r\nI hope this post will prevent you from wasting yours, and I hope the Portal UI will improve.","src/posts/2017-03-25-missing-azure-apis-when-adding-permissions-to-an-azure-ad-app.md","a4af7ae57261d8df",{"html":2012,"metadata":2013},"\u003Cp>When I recently was configuring an Azure \u003Cdfn>\u003Cabbr title=\"Active Directory\">AD\u003C/abbr>\u003C/dfn> application,\r\nI could not assign the delegated permissions for an Azure \u003Cdfn>\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr>\u003C/dfn> Database.\r\nIt did cost me a full day to find out the Azure Portal user interface has an unexpected user interaction when it comes to selecting APIs.\u003C/p>\n\u003Cp>In this article, I will explain how you can find all APIs available for your application.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"the-problem\">The problem\u003C/h2>\n\u003Cp>When we want to integrate an application with Azure \u003Cabbr title=\"Active Directory\">AD\u003C/abbr>, we need to register an app.\u003C/p>\n\u003Cp>In my case I want to let a user access an Azure \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Database using delegation.\r\nSo, the database connection will be created impersonating the user account, not a generic service account.\u003C/p>\n\u003Cp>To grant delegation permissions to an \u003Cdfn>\u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr>\u003C/dfn> we go to the \u003Ckbd>Required permissions\u003C/kbd> section of the Azure \u003Cabbr title=\"Active Directory\">AD\u003C/abbr> app:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2017/03/required-permissions-link.webp\" type=\"image/webp\" media=\"(max-width: 315px)\">\u003Cimg src=\"/wp-content/uploads/2017/03/required-permissions-link.png\" alt=\"Required permissions menu item\" loading=\"lazy\" decoding=\"async\" width=\"315\" height=\"124\" srcset=\"/wp-content/uploads/2017/03/required-permissions-link.png 315w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Required permissions menu item\u003C/figcaption>\u003C/figure>\n\u003Cp>When we’ve created a new app there is not much showing yet, other than the default Azure \u003Cabbr title=\"Active Directory\">AD\u003C/abbr> delegated permission to sign in as the user:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2017/03/required-permissions-pane.webp\" type=\"image/webp\" media=\"(max-width: 583px)\">\u003Csource srcset=\"/wp-content/uploads/2017/03/required-permissions-pane-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2017/03/required-permissions-pane-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2017/03/required-permissions-pane.png\" alt=\"Required permissions pane with default entry\" loading=\"lazy\" decoding=\"async\" width=\"583\" height=\"203\" srcset=\"/wp-content/uploads/2017/03/required-permissions-pane.png 583w, /wp-content/uploads/2017/03/required-permissions-pane-150x150.png 150w, /wp-content/uploads/2017/03/required-permissions-pane-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Required permissions pane with default entry\u003C/figcaption>\u003C/figure>\n\u003Cp>We click on the \u003Ckbd>Add\u003C/kbd> button and choose the \u003Ckbd>Select an \u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr>\u003C/kbd> option:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2017/03/select-an-api.webp\" type=\"image/webp\" media=\"(max-width: 310px)\">\u003Csource srcset=\"/wp-content/uploads/2017/03/select-an-api-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2017/03/select-an-api-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2017/03/select-an-api.png\" alt=\"Select an API menu item\" loading=\"lazy\" decoding=\"async\" width=\"310\" height=\"221\" srcset=\"/wp-content/uploads/2017/03/select-an-api.png 310w, /wp-content/uploads/2017/03/select-an-api-150x150.png 150w, /wp-content/uploads/2017/03/select-an-api-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Select an API menu item\u003C/figcaption>\u003C/figure>\n\u003Cp>Here we get a list of APIs to choose from. But our Azure \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Database is not listed.\u003C/p>\n\u003Cp>There is a search function, but entering \u003Ckbd>\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr>\u003C/kbd>, like my colleague \u003Ca href=\"https://www.linkedin.com/in/remcoploeg/\">Remco Ploeg\u003C/a> did, did not list any results.\u003C/p>\n\u003Cp>This is where I started to search online if other people encountered the same problem.\r\nOne of the few related posts is by Michael Collier:\r\n\u003Ca href=\"https://michaelcollier.wordpress.com/2016/11/03/connect-to-azure-sql-database-by-using-azure-ad-authentication/\" rel=\"noopener noreferrer external\" target=\"_blank\">Connect to Azure \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Database by Using Azure \u003Cabbr title=\"Active Directory\">AD\u003C/abbr> Authentication\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>In his post he mentions not having the \u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr> listed:\u003C/p>\n\u003Cblockquote>\n\u003Cp>Before you can continue, you need to have followed the prerequisites steps stated at the top of this post.\r\nYou especially need to be sure you have created an Azure \u003Cabbr title=\"Active Directory\">AD\u003C/abbr> contained database user.\r\nIf you fail to do that, you will not see “Azure \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Database” in the list (as specified below).\u003C/p>\n\u003C/blockquote>\n\u003Cp>But following all his steps did not make the \u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr> appear.\u003C/p>\n\u003Cp>After wasting more time not finding any other related posts,\r\nadjusting multiple settings, and recreating Azure \u003Cabbr title=\"Active Directory\">AD\u003C/abbr> apps,\r\nI suddenly found a lead that pointed me in the right direction\u003C/p>\n\u003Ch2 id=\"the-solution\">The solution\u003C/h2>\n\u003Cp>One of the apps I created was named \u003Ccode>AzureSqlAppTest\u003C/code>.\r\nBecause the list of registered apps is quite long,\r\nI wanted to use the search function and I entered the word \u003Ckbd>\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr>\u003C/kbd>.\u003C/p>\n\u003Cp>To my surprise no results.\u003C/p>\n\u003Cp>Entering \u003Ckbd>AzureSQL\u003C/kbd> \u003Cem>did\u003C/em> show my app, So, …\u003C/p>\n\u003Cdiv class=\"markdown-alert markdown-alert-warning\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.146.146 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.163.163 0 0 1-.054.06.116.116 0 0 1-.066.017H1.146a.115.115 0 0 1-.066-.017.163.163 0 0 1-.054-.06.176.176 0 0 1 .002-.183L7.884 2.073a.147.147 0 0 1 .054-.057zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z\">\u003C/path>\u003Cpath d=\"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z\">\u003C/path>\u003C/svg>Warning\u003C/p>\n\u003Cp>\r\nThe search function in the Azure Portal \u003Cstrong>is acting as a “Begins With” only filter!\u003C/strong>\u003C/p>\n\u003C/div>\n\u003Cp>Desperately, I tried this trick on the \u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr> list as well.\r\nMaybe the \u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr> search function does not show \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> related APIs because the name does not start with \u003Ckbd>\u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr>\u003C/kbd>.\u003C/p>\n\u003Cp>Instead of \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> I entered \u003Ckbd>Azure \u003C/kbd> in the search box, and to my amazement:\r\na whole new list of never-before-seen APIs showed up, including our Azure \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Database:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2017/03/select-an-api-search-results.webp\" type=\"image/webp\" media=\"(max-width: 582px)\">\u003Csource srcset=\"/wp-content/uploads/2017/03/select-an-api-search-results-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2017/03/select-an-api-search-results-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2017/03/select-an-api-search-results.png\" alt=\"Select an API pane listing many APIs that where hidden\" loading=\"lazy\" decoding=\"async\" width=\"582\" height=\"613\" srcset=\"/wp-content/uploads/2017/03/select-an-api-search-results.png 582w, /wp-content/uploads/2017/03/select-an-api-search-results-150x150.png 150w, /wp-content/uploads/2017/03/select-an-api-search-results-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Cdiv class=\"markdown-alert markdown-alert-warning\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.146.146 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.163.163 0 0 1-.054.06.116.116 0 0 1-.066.017H1.146a.115.115 0 0 1-.066-.017.163.163 0 0 1-.054-.06.176.176 0 0 1 .002-.183L7.884 2.073a.147.147 0 0 1 .054-.057zm1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767L8.982 1.566z\">\u003C/path>\u003Cpath d=\"M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0zM7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z\">\u003C/path>\u003C/svg>Warning\u003C/p>\n\u003Cp>\r\nThere are many more APIs available in the Azure Portal, \u003Cstrong>there is just no indication in the \u003Cdfn>\u003Cabbr title=\"User Interface\">UI\u003C/abbr>\u003C/dfn>!\u003C/strong>\u003C/p>\n\u003C/div>\n\u003Cp>After re-reading Michael Colliers blog post,\r\nI found he did mention this at the end of one of the steps:\u003C/p>\n\u003Cblockquote>\n\u003Cp>3. Add a new required permission and select Azure \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Database as the \u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr>.\r\n\u003Cem>You’ll want to search for “azure” to get “Azure \u003Cabbr title=\"Structured Query Language\">SQL\u003C/abbr> Database” to appear in the list.\u003C/em>\u003C/p>\n\u003C/blockquote>\n\u003Cp>Now we can configure our app, and everything will work as expected.\u003C/p>\n\u003Ch2 id=\"the-conclusion\">The conclusion\u003C/h2>\n\u003Cp>Just because the Azure Portal \u003Cabbr title=\"User Interface\">UI\u003C/abbr> does not give any hint there are many more APIs hidden behind the search function,\r\nI wasted a lot of good time.\u003C/p>\n\u003Cp>I hope this post will prevent you from wasting yours, and I hope the Portal \u003Cabbr title=\"User Interface\">UI\u003C/abbr> will improve.\u003C/p>",{"headings":2014,"imagePaths":2020,"frontmatter":1994},[2015,2016,2017],{"depth":780,"slug":255,"text":256},{"depth":780,"slug":258,"text":259},{"depth":780,"slug":2018,"text":2019},"the-conclusion","The conclusion",[],"2020-06-11-unable-to-find-an-entry-point-named-ortgetapibase-in-dll-onnxruntime-with-microsoft-ml-onnxtransformer-1-5-0",{"id":2021,"data":2023,"body":2038,"filePath":2039,"digest":2040,"rendered":2041},{"id":2024,"title":2025,"date":2026,"updated":2027,"author":15,"excerpt":2028,"layout":17,"permalink":2029,"image":2030,"categories":2031,"tags":2033,"draft":26},1451,"Unable to find an entry point named ‘OrtGetApiBase’ in DLL ‘onnxruntime’ with Microsoft.ML.OnnxTransformer 1.5.0",["Date","2020-06-11T06:55:46.000Z"],["Date","2021-07-16T20:37:06.000Z"],"When trying to have an application work with an ONNX model I downloaded from the Microsoft Custom Vision portal, I got the following exception:\nTypeInitializationException: EntryPointNotFoundException: Unable to find an entry point named 'OrtGetApiBase' in DLL 'onnxruntime'.\nSearching for the error online did not yield any solutions. After solving the problem, I wanted to share the solution for anyone else running into the same exception.\n","/2020/06/11/unable-to-find-an-entry-point-named-ortgetapibase-in-dll-onnxruntime-with-microsoft-ml-onnxtransformer-1-5-0/","/wp-content/uploads/2020/06/post-1451-thumbnail.png",[183,2032],"Machine Learning",[2034,2035,187,2032,2036,2037],"Cognitive Services","Custom Vision","ML.NET","ONNX","When trying to have an application work with an ONNX model I downloaded from the Microsoft [Custom Vision](https://www.customvision.ai/) portal,\r\nI got the following exception:\r\n\r\n```plain\r\nSystem.TypeInitializationException: 'The type initializer for 'Microsoft.ML.OnnxRuntime.NativeMethods' threw an exception.'\r\n\r\nEntryPointNotFoundException: Unable to find an entry point named 'OrtGetApiBase' in DLL 'onnxruntime'.\r\n```\r\n\r\nSearching for the error online did not yield any solutions.\r\n\r\nAfter solving the problem, I wanted to share the solution for anyone else running into the same exception.\r\n\r\n\u003C!--more-->\r\n\r\n## The premise\r\n\r\nI started with following\r\n[the tutorial how to Detect objects using ONNX in ML.NET](https://learn.microsoft.com/dotnet/machine-learning/tutorials/object-detection-onnx).\r\n\r\nThe tutorial instructs you to install the following NuGet packages:\r\n\r\n- `Microsoft.ML`\r\n- `Microsoft.ML.ImageAnalytics`\r\n- `Microsoft.ML.OnnxTransformer`\r\n\r\nIt does not mention any other dependencies to add, or steps to take, to make the application run.\r\n\r\n## The problem\r\n\r\nI was very unlucky in my timing, as the Microsoft machine learning libraries got updated to\r\n[version 1.5.0](https://github.com/dotnet/machinelearning/releases/tag/v1.5.0) on May 27,\r\nthat's 2 weeks before I started working on the application.\r\n\r\nBefore version 1.5.0 the `Microsoft.ML.OnnxTransformer` package had a dependency on\r\n`Microsoft.ML.OnnxRuntime` >= 0.5.1. But version 1.5.0 now has a dependency on `Microsoft.ML.OnnxRuntime.Managed`.\r\n\r\nThe [release notes of ONNX Runtime v1.2.0](https://github.com/microsoft/onnxruntime/releases/tag/v1.2.0)\r\nare mentioning the change in package structure:\r\n\r\n> Nuget package structure updated. There is now a separate Managed Assembly (Microsoft.ML.OnnxRuntime.Managed)\r\n> shared between the CPU and GPU Nuget packages.\r\n> The \"native\" Nuget will depend on the \"managed\" Nuget to bring it into relevant projects automatically.  \r\n> …  \r\n> Note that this should transparent for customers installing the Nuget packages.\r\n\r\nCommenting on the last remark, it is transparent,\r\nif you would start with the `Microsoft.ML.OnnxRuntime` as it now depends on the `Managed` one.\r\nBut the `Microsoft.ML.OnnxTransformer` package doesn't depend directly on the `Microsoft.ML.OnnxRuntime`\r\nas the authors of that package allow the developer to be free to choose between a CPU or GPU runtime.\r\n\r\nThat the package structure change would result in a runtime exception and confused developers was\r\n[predicted in the GitHub issue](https://github.com/microsoft/onnxruntime/issues/2184#issuecomment-550099935)\r\nintroducing this change.\r\n\r\n## The solution\r\n\r\nNow knowing I was missing the actual runtime, it is an easy fix,\r\njust add _one_ of the runtime packages to your solution:\r\n\r\n- `Microsoft.ML.OnnxRuntime`\r\n- `Microsoft.ML.OnnxRuntime.Gpu`\r\n- `Microsoft.ML.OnnxRuntime.MKLML`\r\n\r\nNow my application works, and I can start classifying images locally.","src/posts/2020-06-11-unable-to-find-an-entry-point-named-ortgetapibase-in-dll-onnxruntime-with-microsoft-ml-onnxtransformer-1-5-0.md","9091a457f7b2e51b",{"html":2042,"metadata":2043},"\u003Cp>When trying to have an application work with an \u003Cdfn>\u003Cabbr title=\"Open Neural Network Exchange\">ONNX\u003C/abbr>\u003C/dfn> model I downloaded from the Microsoft \u003Ca href=\"https://www.customvision.ai/\" rel=\"noopener noreferrer external\" target=\"_blank\">Custom Vision\u003Cspan>\u003C/span>\u003C/a> portal,\r\nI got the following exception:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:123ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">System.TypeInitializationException: 'The type initializer for 'Microsoft.ML.OnnxRuntime.NativeMethods' threw an exception.'\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">EntryPointNotFoundException: Unable to find an entry point named 'OrtGetApiBase' in DLL 'onnxruntime'.\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"System.TypeInitializationException: &#x27;The type initializer for &#x27;Microsoft.ML.OnnxRuntime.NativeMethods&#x27; threw an exception.&#x27;EntryPointNotFoundException: Unable to find an entry point named &#x27;OrtGetApiBase&#x27; in DLL &#x27;onnxruntime&#x27;.\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Searching for the error online did not yield any solutions.\u003C/p>\n\u003Cp>After solving the problem, I wanted to share the solution for anyone else running into the same exception.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"the-premise\">The premise\u003C/h2>\n\u003Cp>I started with following\r\n\u003Ca href=\"https://learn.microsoft.com/dotnet/machine-learning/tutorials/object-detection-onnx?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">the tutorial how to Detect objects using \u003Cabbr title=\"Open Neural Network Exchange\">ONNX\u003C/abbr> in ML.NET\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>The tutorial instructs you to install the following NuGet packages:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>Microsoft.ML\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Microsoft.ML.ImageAnalytics\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Microsoft.ML.OnnxTransformer\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Cp>It does not mention any other dependencies to add, or steps to take, to make the application run.\u003C/p>\n\u003Ch2 id=\"the-problem\">The problem\u003C/h2>\n\u003Cp>I was very unlucky in my timing, as the Microsoft machine learning libraries got updated to\r\n\u003Ca href=\"https://github.com/dotnet/machinelearning/releases/tag/v1.5.0\" rel=\"noopener noreferrer external\" target=\"_blank\">version 1.5.0\u003Cspan>\u003C/span>\u003C/a> on May 27,\r\nthat’s 2 weeks before I started working on the application.\u003C/p>\n\u003Cp>Before version 1.5.0 the \u003Ccode>Microsoft.ML.OnnxTransformer\u003C/code> package had a dependency on\r\n\u003Ccode>Microsoft.ML.OnnxRuntime\u003C/code> >= 0.5.1. But version 1.5.0 now has a dependency on \u003Ccode>Microsoft.ML.OnnxRuntime.Managed\u003C/code>.\u003C/p>\n\u003Cp>The \u003Ca href=\"https://github.com/microsoft/onnxruntime/releases/tag/v1.2.0\" rel=\"noopener noreferrer external\" target=\"_blank\">release notes of \u003Cabbr title=\"Open Neural Network Exchange\">ONNX\u003C/abbr> Runtime v1.2.0\u003Cspan>\u003C/span>\u003C/a>\r\nare mentioning the change in package structure:\u003C/p>\n\u003Cblockquote>\n\u003Cp>Nuget package structure updated. There is now a separate Managed Assembly (Microsoft.ML.OnnxRuntime.Managed)\r\nshared between the \u003Cdfn>\u003Cabbr title=\"Central Processing Unit\">CPU\u003C/abbr>\u003C/dfn> and GPU Nuget packages.\r\nThe “native” Nuget will depend on the “managed” Nuget to bring it into relevant projects automatically.\u003Cbr>\n…\u003Cbr>\nNote that this should transparent for customers installing the Nuget packages.\u003C/p>\n\u003C/blockquote>\n\u003Cp>Commenting on the last remark, it is transparent,\r\nif you would start with the \u003Ccode>Microsoft.ML.OnnxRuntime\u003C/code> as it now depends on the \u003Ccode>Managed\u003C/code> one.\r\nBut the \u003Ccode>Microsoft.ML.OnnxTransformer\u003C/code> package doesn’t depend directly on the \u003Ccode>Microsoft.ML.OnnxRuntime\u003C/code>\r\nas the authors of that package allow the developer to be free to choose between a \u003Cabbr title=\"Central Processing Unit\">CPU\u003C/abbr> or GPU runtime.\u003C/p>\n\u003Cp>That the package structure change would result in a runtime exception and confused developers was\r\n\u003Ca href=\"https://github.com/microsoft/onnxruntime/issues/2184#issuecomment-550099935\" rel=\"noopener noreferrer external\" target=\"_blank\">predicted in the GitHub issue\u003Cspan>\u003C/span>\u003C/a>\r\nintroducing this change.\u003C/p>\n\u003Ch2 id=\"the-solution\">The solution\u003C/h2>\n\u003Cp>Now knowing I was missing the actual runtime, it is an easy fix,\r\njust add \u003Cem>one\u003C/em> of the runtime packages to your solution:\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>Microsoft.ML.OnnxRuntime\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Microsoft.ML.OnnxRuntime.Gpu\u003C/code>\u003C/li>\n\u003Cli>\u003Ccode>Microsoft.ML.OnnxRuntime.MKLML\u003C/code>\u003C/li>\n\u003C/ul>\n\u003Cp>Now my application works, and I can start classifying images locally.\u003C/p>",{"headings":2044,"imagePaths":2050,"frontmatter":2023},[2045,2048,2049],{"depth":780,"slug":2046,"text":2047},"the-premise","The premise",{"depth":780,"slug":255,"text":256},{"depth":780,"slug":258,"text":259},[],"2020-07-07-trick-bamboos-mstest-parser-when-we-skip-running-our-tests",{"id":2051,"data":2053,"body":2068,"filePath":2069,"digest":2070,"rendered":2071},{"id":2054,"title":2055,"date":2056,"updated":2057,"author":15,"excerpt":2058,"layout":17,"permalink":2059,"image":2060,"categories":2061,"tags":2062,"draft":26},1495,"Trick Bamboo’s MSTest parser when we skip running our tests",["Date","2020-07-07T11:57:40.000Z"],["Date","2020-12-07T16:56:14.000Z"],"I use the MSTest Parser task in a Bamboo build plan to add a report of tests that were executed and their outcome. But sometimes you want to skip running tests. For example, you are focusing on other changes in your CI/CD pipeline and want to keep the feedback loop as short as possible.\nThe problem is, if you don't run any tests, the parser task will fail. There are no configuration settings to influence this behavior or to disable the task conditionally. I could disable the task manually, but that would affect all other branches at the same time.\nSo, I found it was time to create a quick work around.\n","/2020/07/07/trick-bamboos-mstest-parser-when-we-skip-running-our-tests/","/wp-content/uploads/2020/07/post-1495-thumbnail.png",[1196],[2063,2064,2065,1196,2066,2067],"Bamboo","CI/CD","MSTest","Task","Work around","I use the [MSTest Parser task](https://confluence.atlassian.com/bamboo/mstest-parser-289277057.html) in a [Bamboo](https://www.atlassian.com/software/bamboo) build plan to add a report of tests that were executed and their outcome.\r\nBut sometimes you want to skip running tests.\r\nFor example, you are focusing on other changes in your CI/CD pipeline and want to keep the feedback loop as short as possible.\r\n\r\nThe problem is, if you do not run any tests, the parser task will fail.\r\nThere are no configuration settings to influence this behavior or to disable the task conditionally.\r\nI could disable the task manually, but that would affect all other branches at the same time.\r\n\r\n![Bamboo complaining that no failed tests were found.](/wp-content/uploads/2020/07/bamboo_complaining_no_tests_found.png \"Bamboo complaining about not finding any failed tests… which would be a good case in my book\")\r\n\r\nSo, it was time to create a quick work around.\r\n\r\n\u003C!--more-->\r\n\r\n## Creating a fake test run\r\n\r\n> [!NOTE]\r\n> I am working with [PowerShell Core](https://github.com/powershell/powershell) in my Bamboo environment,\r\n> but the same can be achieved in other scripting languages.\r\n\r\nIf you want to run tests conditionally, you will have a variable that indicates this.\r\nThe value can be the result of script execution or you have it configured as a variable on your build plan or branch.\r\n\r\nLet us assume there is an environment variable called `bamboo_run_tests` and holds the value `false`.\r\nNow we create a fake test run result that can be picked up by the parser.\r\n\r\n```powershell\r\nif (${env:bamboo_run_tests} -eq 'false') {\r\n@\"\r\n\u003CTestRun>\r\n    \u003CResults>\r\n        \u003CUnitTestResult testId=\"00000000-0000-0000-0000-000000000001\" testName=\"Skipped\" duration=\"00:00:00\" outcome=\"Passed\" />\r\n    \u003C/Results>\r\n    \u003CTestDefinitions>\r\n    \u003CUnitTest id=\"00000000-0000-0000-0000-000000000001\">\r\n        \u003CTestMethod className=\"ComponentTest\" />\r\n    \u003C/UnitTest>\r\n    \u003C/TestDefinitions>\r\n\u003C/TestRun>\r\n\"@ | Out-File skippedtestrun.trx -Encoding ascii\r\n}\r\n```\r\n\r\nNow we have a `.trx` file that can be inspected by the parser and it will not fail our build pipeline anymore.\r\n\r\n![Bamboo reporting on the skipped test run.](/wp-content/uploads/2020/07/bamboo_reporting_the_skipped_testrun.png \"Bamboo reporting on the skipped test run.\")\r\n\r\nInstead of showing the test as `Passed`, we could maybe show a different status.\r\nBut this was good enough of a fix to get my feedback loop short and move on to the task I wanted actually to work on.\r\n\r\nIf you have suggestions to this trick, let me know.","src/posts/2020-07-07-trick-bamboos-mstest-parser-when-we-skip-running-our-tests.md","5bcb7640998377a2",{"html":2072,"metadata":2073},"\u003Cp>I use the \u003Ca href=\"https://confluence.atlassian.com/bamboo/mstest-parser-289277057.html\" rel=\"noopener noreferrer external\" target=\"_blank\">MSTest Parser task\u003Cspan>\u003C/span>\u003C/a> in a \u003Ca href=\"https://www.atlassian.com/software/bamboo\" rel=\"noopener noreferrer external\" target=\"_blank\">Bamboo\u003Cspan>\u003C/span>\u003C/a> build plan to add a report of tests that were executed and their outcome.\r\nBut sometimes you want to skip running tests.\r\nFor example, you are focusing on other changes in your \u003Cdfn>\u003Cabbr title=\"Continuous Integration\">CI\u003C/abbr>\u003C/dfn>/\u003Cdfn>\u003Cabbr title=\"Continuous Deployment\">CD\u003C/abbr>\u003C/dfn> pipeline and want to keep the feedback loop as short as possible.\u003C/p>\n\u003Cp>The problem is, if you do not run any tests, the parser task will fail.\r\nThere are no configuration settings to influence this behavior or to disable the task conditionally.\r\nI could disable the task manually, but that would affect all other branches at the same time.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2020/07/bamboo_complaining_no_tests_found.webp\" type=\"image/webp\" media=\"(max-width: 518px)\">\u003Cimg src=\"/wp-content/uploads/2020/07/bamboo_complaining_no_tests_found.png\" alt=\"Bamboo complaining that no failed tests were found.\" loading=\"lazy\" decoding=\"async\" width=\"518\" height=\"79\" srcset=\"/wp-content/uploads/2020/07/bamboo_complaining_no_tests_found.png 518w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Bamboo complaining about not finding any failed tests… which would be a good case in my book\u003C/figcaption>\u003C/figure>\n\u003Cp>So, it was time to create a quick work around.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"creating-a-fake-test-run\">Creating a fake test run\u003C/h2>\n\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\r\nI am working with \u003Ca href=\"https://github.com/powershell/powershell\" rel=\"noopener noreferrer external\" target=\"_blank\">PowerShell Core\u003Cspan>\u003C/span>\u003C/a> in my Bamboo environment,\r\nbut the same can be achieved in other scripting languages.\u003C/p>\n\u003C/div>\n\u003Cp>If you want to run tests conditionally, you will have a variable that indicates this.\r\nThe value can be the result of script execution or you have it configured as a variable on your build plan or branch.\u003C/p>\n\u003Cp>Let us assume there is an environment variable called \u003Ccode>bamboo_run_tests\u003C/code> and holds the value \u003Ccode>false\u003C/code>.\r\nNow we create a fake test run result that can be picked up by the parser.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">\u003C/span>\u003Cspan class=\"sr-only\">Terminal window\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:128ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#C586C0\">if\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> (\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">${env:bamboo_run_tests}\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-eq\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">'false'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">) {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CE9178\">@\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CE9178\">&#x3C;TestRun>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CE9178\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;Results>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CE9178\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;UnitTestResult testId=\"00000000-0000-0000-0000-000000000001\" testName=\"Skipped\" duration=\"00:00:00\" outcome=\"Passed\" />\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CE9178\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;/Results>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CE9178\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;TestDefinitions>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CE9178\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;UnitTest id=\"00000000-0000-0000-0000-000000000001\">\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CE9178\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;TestMethod className=\"ComponentTest\" />\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CE9178\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;/UnitTest>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CE9178\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CE9178\">&#x3C;/TestDefinitions>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CE9178\">&#x3C;/TestRun>\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CE9178\">\"@\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Out-File\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> skippedtestrun.trx \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Encoding ascii\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"if (${env:bamboo_run_tests} -eq &#x27;false&#x27;) {@&#x22;\u003CTestRun>    \u003CResults>        \u003CUnitTestResult testId=&#x22;00000000-0000-0000-0000-000000000001&#x22; testName=&#x22;Skipped&#x22; duration=&#x22;00:00:00&#x22; outcome=&#x22;Passed&#x22; />    \u003C/Results>    \u003CTestDefinitions>    \u003CUnitTest id=&#x22;00000000-0000-0000-0000-000000000001&#x22;>        \u003CTestMethod className=&#x22;ComponentTest&#x22; />    \u003C/UnitTest>    \u003C/TestDefinitions>\u003C/TestRun>&#x22;@ | Out-File skippedtestrun.trx -Encoding ascii}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now we have a \u003Ccode>.trx\u003C/code> file that can be inspected by the parser and it will not fail our build pipeline anymore.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2020/07/bamboo_reporting_the_skipped_testrun.webp\" type=\"image/webp\" media=\"(max-width: 402px)\">\u003Csource srcset=\"/wp-content/uploads/2020/07/bamboo_reporting_the_skipped_testrun-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2020/07/bamboo_reporting_the_skipped_testrun-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2020/07/bamboo_reporting_the_skipped_testrun.png\" alt=\"Bamboo reporting on the skipped test run.\" loading=\"lazy\" decoding=\"async\" width=\"402\" height=\"267\" srcset=\"/wp-content/uploads/2020/07/bamboo_reporting_the_skipped_testrun.png 402w, /wp-content/uploads/2020/07/bamboo_reporting_the_skipped_testrun-150x150.png 150w, /wp-content/uploads/2020/07/bamboo_reporting_the_skipped_testrun-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Bamboo reporting on the skipped test run.\u003C/figcaption>\u003C/figure>\n\u003Cp>Instead of showing the test as \u003Ccode>Passed\u003C/code>, we could maybe show a different status.\r\nBut this was good enough of a fix to get my feedback loop short and move on to the task I wanted actually to work on.\u003C/p>\n\u003Cp>If you have suggestions to this trick, let me know.\u003C/p>",{"headings":2074,"imagePaths":2078,"frontmatter":2053},[2075],{"depth":780,"slug":2076,"text":2077},"creating-a-fake-test-run","Creating a fake test run",[],"2018-01-24-docker-run-throws-exec-user-process-errors",{"id":2079,"data":2081,"body":2096,"filePath":2097,"digest":2098,"rendered":2099},{"id":2082,"title":2083,"date":2084,"updated":2085,"author":15,"excerpt":2086,"layout":17,"permalink":2087,"image":2088,"categories":2089,"tags":2091,"draft":26},1275,"‘docker run’ throws “exec user process” errors",["Date","2018-01-24T15:48:41.000Z"],["Date","2020-12-07T16:50:07.000Z"],"When recently creating a Linux Docker image using Docker for Windows, I ran into a couple of vague errors. Searching online for the error messages, weren’t any solutions. But luckily some suggestions put me on the right track.\nIn this post I write about the solutions I found.\n","/2018/01/24/docker-run-throws-exec-user-process-errors/","/wp-content/uploads/2018/01/post-1275-thumbnail.png",[2090,240],"Docker",[2092,2090,2093,2094,2095,240],"Charset","Docker Desktop","Linefeed","Unicode","When recently creating a Linux [Docker](https://www.docker.com/) image using\r\n[Docker Desktop for Windows](https://docs.docker.com/docker-for-windows/),\r\nI ran into a couple of vague errors.\r\nSearching online for the error messages, there weren’t any solutions.\r\nBut luckily some suggestions put me on the right track.\r\n\r\nIn this post I describe the solutions I found.\r\nHopefully preventing you wasting time on the same issues.\r\n\r\n\u003C!--more-->\r\n\r\n## The Dockerfile\r\n\r\nMy Dockerfile is based on the [Azure App Service WordPress 0.3 Dockerfile](https://github.com/Azure-App-Service/apps/blob/master/Wordpress/0.3/Dockerfile).\r\n\r\nIn relation to the errors I encountered, the most important part in this file is the [ENTRYPOINT](https://docs.docker.com/engine/reference/builder/#entrypoint) that is declared:\r\n\r\n```dockerfile\r\nENTRYPOINT [\"entrypoint.sh\"]\r\n```\r\n\r\nAfter adding the `entrypoint.sh` file to the directory where I build my image, I ran the \u003Ckbd>docker build\u003C/kbd> command:\r\n\r\n```shell title=\"Docker\"\r\ndocker build --tag blog/demo:v1 .\r\n```\r\n\r\nOnce the build was completed, I launched the image locally:\r\n\r\n```shell title=\"Docker\"\r\ndocker run blog/demo:v1\r\n```\r\n\r\nBut that was not as straight forward as expected.\r\n\r\n## Linefeed matter: `no such file or directory`\r\n\r\nFirst, I got the following response:\r\n\r\n```plain\r\nstandard_init_linux.go:195: exec user process caused \"no such file or directory\"\r\n```\r\n\r\nThis is quite a generic error message and can describe a lot of files or directories that are part of the process of building and running Docker images and containers.\r\nMy first impression was that the image building was not working correctly.\r\nBut after a lot of rebuilds, the error didn’t go away.\r\n\r\nI finally found the real source of the issue: changing the linefeed in the `entrypoint.sh` file from `CRLF` to `LF`, somehow made the file discoverable.\r\n\r\n![Visual Studio Code showing CRLF in the status bar](/wp-content/uploads/2018/01/visual-studio-code-showing-crlf.png \"Visual Studio Code showing CRLF in the status bar\")\r\n\r\n![Changing the linefeed option in Visual Studio Code](/wp-content/uploads/2018/01/visual-studio-code-changing-linefeed.png \"Changing the linefeed option\")\r\n\r\nHowever, I still couldn't run my container, only the error message had changed…\r\n\r\n## Encoding matters: `exec format error`\r\n\r\nExecuting the \u003Ckbd>docker run\u003C/kbd> command again, the output was now a different error:\r\n\r\n```plain\r\nstandard_init_linux.go:195: exec user process caused \"exec format error\"\r\n```\r\n\r\nThe mentioning of a \"format error\" made me guess that this had something to do with incompatibilities running a Linux image on a Windows OS, or something related to x86 vs. x64. Many articles you’ll find searching on the error message are pointing in that direction.\r\n\r\nLuckily, I overheard a colleague solving a completely unrelated issue by changing the encoding of his XML file from `UTF-8` to `ISO-8859-15`.\r\nI figured to just try that with my file… solving the issue!\r\n\r\n![Save the file with encoding dialog in Visual Studio Code](/wp-content/uploads/2018/01/visual-studio-code-save-with-reencoding.png \"Save the file with encoding\")\r\n\r\n![Select the file encoding dialog in Visual Studio Code](/wp-content/uploads/2018/01/visual-studio-code-select-encoding.png \"Select the file encoding\")\r\n\r\n## Conclusion\r\n\r\nWhen using Docker on Windows and working with Linux containers,\r\nmake sure the encoding and linefeed of the files involved are correct,\r\notherwise you are hit with vague error messages that are not helpful at all.","src/posts/2018-01-24-docker-run-throws-exec-user-process-errors.md","d38160f3c6641be9",{"html":2100,"metadata":2101},"\u003Cp>When recently creating a Linux \u003Ca href=\"https://www.docker.com/\" rel=\"noopener noreferrer external\" target=\"_blank\">Docker\u003Cspan>\u003C/span>\u003C/a> image using\r\n\u003Ca href=\"https://docs.docker.com/docker-for-windows/\" rel=\"noopener noreferrer external\" target=\"_blank\">Docker Desktop for Windows\u003Cspan>\u003C/span>\u003C/a>,\r\nI ran into a couple of vague errors.\r\nSearching online for the error messages, there weren’t any solutions.\r\nBut luckily some suggestions put me on the right track.\u003C/p>\n\u003Cp>In this post I describe the solutions I found.\r\nHopefully preventing you wasting time on the same issues.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"the-dockerfile\">The Dockerfile\u003C/h2>\n\u003Cp>My Dockerfile is based on the \u003Ca href=\"https://github.com/Azure-App-Service/apps/blob/master/Wordpress/0.3/Dockerfile\" rel=\"noopener noreferrer external\" target=\"_blank\">Azure App Service WordPress 0.3 Dockerfile\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>In relation to the errors I encountered, the most important part in this file is the \u003Ca href=\"https://docs.docker.com/engine/reference/builder/#entrypoint\" rel=\"noopener noreferrer external\" target=\"_blank\">ENTRYPOINT\u003Cspan>\u003C/span>\u003C/a> that is declared:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"dockerfile\" class=\"wrap\" style=\"--ecMaxLine:28ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">ENTRYPOINT\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"entrypoint.sh\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"ENTRYPOINT [&#x22;entrypoint.sh&#x22;]\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>After adding the \u003Ccode>entrypoint.sh\u003C/code> file to the directory where I build my image, I ran the \u003Ckbd>docker build\u003C/kbd> command:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">Docker\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:33ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">docker\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">build\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">--tag\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">blog/demo:v1\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">.\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"docker build --tag blog/demo:v1 .\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Once the build was completed, I launched the image locally:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">Docker\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"shell\" class=\"wrap\" style=\"--ecMaxLine:23ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">docker\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">run\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">blog/demo:v1\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"docker run blog/demo:v1\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>But that was not as straight forward as expected.\u003C/p>\n\u003Ch2 id=\"linefeed-matter-no-such-file-or-directory\">Linefeed matter: \u003Ccode>no such file or directory\u003C/code>\u003C/h2>\n\u003Cp>First, I got the following response:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:80ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">standard_init_linux.go:195: exec user process caused \"no such file or directory\"\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"standard_init_linux.go:195: exec user process caused &#x22;no such file or directory&#x22;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This is quite a generic error message and can describe a lot of files or directories that are part of the process of building and running Docker images and containers.\r\nMy first impression was that the image building was not working correctly.\r\nBut after a lot of rebuilds, the error didn’t go away.\u003C/p>\n\u003Cp>I finally found the real source of the issue: changing the linefeed in the \u003Ccode>entrypoint.sh\u003C/code> file from \u003Ccode>CRLF\u003C/code> to \u003Ccode>LF\u003C/code>, somehow made the file discoverable.\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2018/01/visual-studio-code-showing-crlf.webp\" type=\"image/webp\" media=\"(max-width: 202px)\">\u003Cimg src=\"/wp-content/uploads/2018/01/visual-studio-code-showing-crlf.png\" alt=\"Visual Studio Code showing CRLF in the status bar\" loading=\"lazy\" decoding=\"async\" width=\"202\" height=\"24\" srcset=\"/wp-content/uploads/2018/01/visual-studio-code-showing-crlf.png 202w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Visual Studio Code showing CRLF in the status bar\u003C/figcaption>\u003C/figure>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2018/01/visual-studio-code-changing-linefeed.webp\" type=\"image/webp\" media=\"(max-width: 210px)\">\u003Cimg src=\"/wp-content/uploads/2018/01/visual-studio-code-changing-linefeed.png\" alt=\"Changing the linefeed option in Visual Studio Code\" loading=\"lazy\" decoding=\"async\" width=\"210\" height=\"90\" srcset=\"/wp-content/uploads/2018/01/visual-studio-code-changing-linefeed.png 210w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Changing the linefeed option\u003C/figcaption>\u003C/figure>\n\u003Cp>However, I still couldn’t run my container, only the error message had changed…\u003C/p>\n\u003Ch2 id=\"encoding-matters-exec-format-error\">Encoding matters: \u003Ccode>exec format error\u003C/code>\u003C/h2>\n\u003Cp>Executing the \u003Ckbd>docker run\u003C/kbd> command again, the output was now a different error:\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"plain\" class=\"wrap\" style=\"--ecMaxLine:72ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#cccccc\">standard_init_linux.go:195: exec user process caused \"exec format error\"\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"standard_init_linux.go:195: exec user process caused &#x22;exec format error&#x22;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>The mentioning of a “format error” made me guess that this had something to do with incompatibilities running a Linux image on a Windows OS, or something related to x86 vs. x64. Many articles you’ll find searching on the error message are pointing in that direction.\u003C/p>\n\u003Cp>Luckily, I overheard a colleague solving a completely unrelated issue by changing the encoding of his \u003Cdfn>\u003Cabbr title=\"eXtensible Markup Language\">XML\u003C/abbr>\u003C/dfn> file from \u003Ccode>UTF-8\u003C/code> to \u003Ccode>ISO-8859-15\u003C/code>.\r\nI figured to just try that with my file… solving the issue!\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2018/01/visual-studio-code-save-with-reencoding.webp\" type=\"image/webp\" media=\"(max-width: 196px)\">\u003Cimg src=\"/wp-content/uploads/2018/01/visual-studio-code-save-with-reencoding.png\" alt=\"Save the file with encoding dialog in Visual Studio Code\" loading=\"lazy\" decoding=\"async\" width=\"196\" height=\"87\" srcset=\"/wp-content/uploads/2018/01/visual-studio-code-save-with-reencoding.png 196w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Save the file with encoding\u003C/figcaption>\u003C/figure>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2018/01/visual-studio-code-select-encoding.webp\" type=\"image/webp\" media=\"(max-width: 252px)\">\u003Csource srcset=\"/wp-content/uploads/2018/01/visual-studio-code-select-encoding-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2018/01/visual-studio-code-select-encoding-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Cimg src=\"/wp-content/uploads/2018/01/visual-studio-code-select-encoding.png\" alt=\"Select the file encoding dialog in Visual Studio Code\" loading=\"lazy\" decoding=\"async\" width=\"252\" height=\"216\" srcset=\"/wp-content/uploads/2018/01/visual-studio-code-select-encoding.png 252w, /wp-content/uploads/2018/01/visual-studio-code-select-encoding-150x150.png 150w, /wp-content/uploads/2018/01/visual-studio-code-select-encoding-185x185.png 185w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003Cfigcaption>Select the file encoding\u003C/figcaption>\u003C/figure>\n\u003Ch2 id=\"conclusion\">Conclusion\u003C/h2>\n\u003Cp>When using Docker on Windows and working with Linux containers,\r\nmake sure the encoding and linefeed of the files involved are correct,\r\notherwise you are hit with vague error messages that are not helpful at all.\u003C/p>",{"headings":2102,"imagePaths":2113,"frontmatter":2081},[2103,2106,2109,2112],{"depth":780,"slug":2104,"text":2105},"the-dockerfile","The Dockerfile",{"depth":780,"slug":2107,"text":2108},"linefeed-matter-no-such-file-or-directory","Linefeed matter: no such file or directory",{"depth":780,"slug":2110,"text":2111},"encoding-matters-exec-format-error","Encoding matters: exec format error",{"depth":780,"slug":1149,"text":1150},[],"2020-06-01-using-uris-in-yaml-with-yamldotnet",{"id":2114,"data":2116,"body":2130,"filePath":2131,"digest":2132,"rendered":2133},{"id":2117,"title":2118,"date":2119,"updated":2120,"author":15,"excerpt":2121,"layout":17,"permalink":2122,"image":2123,"categories":2124,"tags":2125,"draft":26},1432,"Using URI’s in YAML with YamlDotNet",["Date","2020-06-01T05:00:00.000Z"],["Date","2020-07-27T13:04:01.000Z"],"Recently, I was using a YAML file for storing some data for a pet project. To work with this YAML in a .NET application, I use the excellent YamlDotNet library by Antoine Aubry.\nOne of my properties was a URL. Deserializing went fine, but when serializing back to a YAML file, things were not going as intended.\nIn this short article, I will explain how I did fix this.\n","/2020/06/01/using-uris-in-yaml-with-yamldotnet/","/wp-content/uploads/2020/05/post-1432-thumbnail.png",[183],[2126,2127,685,2128,2129],"CSharp","dotnet","YAML","YamlDotNet","Recently, I was using a [YAML](https://yaml.org/) file for storing some data for a pet project.\r\nTo work with this YAML in a .NET application,\r\nI use the excellent [YamlDotNet library](https://github.com/aaubry/YamlDotNet/) by Antoine Aubry.\r\n\r\nOne of my properties was a URL. Deserializing went fine, but when serializing back to a YAML file, things were not going as intended.\r\n\r\nIn this short article, I will explain how I did fix this.\r\n\r\n## The setup\r\n\r\nI have a quite simple piece of YAML describing a website with a name and URL.\r\n\r\n```yaml\r\nwebsite:\r\n  name: Blog\r\n  url: https://blog.hompus.nl\r\n```\r\n\r\nTo represent this in my application, I created a simple POCO.\r\n\r\n```csharp\r\npublic class Website {\r\n    public string Name { get; set; }\r\n\r\n    public Uri Url { get; set; }\r\n}\r\n```\r\n\r\n## Deserializing\r\n\r\nWhen deserializing the file, this works completely as expected.\r\nAs you can see in the VSCode debugger:\r\n\r\n![Deserialized data, as shown in the VSCode debugger](/wp-content/uploads/2020/05/yaml-data-showing-in-debugger.png)\r\n\r\n## Serializing\r\n\r\nNow I want to serialize the object back to YAML.\r\nHowever, it ends up looking quite different than before.\r\n\r\n```yaml\r\nwebsite:\r\n  name: Blog\r\n  url: &o0\r\n    absolutePath: /\r\n    absoluteUri: *o0\r\n    localPath: /\r\n    authority: blog.hompus.nl\r\n    hostNameType: Dns\r\n    isDefaultPort: true\r\n    pathAndQuery: /\r\n    segments:\r\n      - /\r\n    host: blog.hompus.nl\r\n    port: 443\r\n    query: \"\"\r\n    fragment: \"\"\r\n    scheme: https\r\n    originalString: https://blog.hompus.nl\r\n    dnsSafeHost: blog.hompus.nl\r\n    idnHost: blog.hompus.nl\r\n    isAbsoluteUri: true\r\n    userInfo: \"\"\r\n```\r\n\r\nThis was not what I expected.\r\n\r\nSo how can we encourage YamlDotNet to store the property as a string?\r\n\r\n## YamlMember\r\n\r\nThe `YamlMember` attribute can solve this problem.\r\nIt has the `SerializeAs` property that allows to set the Type that the serialize must use during serialization.\r\n\r\nFor this situation, I choose the `String` type.\r\n\r\n```csharp\r\npublic class Website {\r\n    public string Name { get; set; }\r\n\r\n    [YamlMember(typeof(string))]\r\n    public Uri Url { get; set; }\r\n}\r\n```\r\n\r\nAnd when generated the YAML file again, it looks like how I intended it.\r\n\r\n```yaml\r\nwebsite:\r\n  name: Blog\r\n  url: https://blog.hompus.nl/\r\n```","src/posts/2020-06-01-using-uris-in-yaml-with-yamldotnet.md","cce5dc15b8e12aa7",{"html":2134,"metadata":2135},"\u003Cp>Recently, I was using a \u003Ca href=\"https://yaml.org/\" rel=\"noopener noreferrer external\" target=\"_blank\">YAML\u003Cspan>\u003C/span>\u003C/a> file for storing some data for a pet project.\r\nTo work with this YAML in a .NET application,\r\nI use the excellent \u003Ca href=\"https://github.com/aaubry/YamlDotNet/\" rel=\"noopener noreferrer external\" target=\"_blank\">YamlDotNet library\u003Cspan>\u003C/span>\u003C/a> by Antoine Aubry.\u003C/p>\n\u003Cp>One of my properties was a \u003Cdfn>\u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>\u003C/dfn>. Deserializing went fine, but when serializing back to a YAML file, things were not going as intended.\u003C/p>\n\u003Cp>In this short article, I will explain how I did fix this.\u003C/p>\n\u003Ch2 id=\"the-setup\">The setup\u003C/h2>\n\u003Cp>I have a quite simple piece of YAML describing a website with a name and \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"yaml\" class=\"wrap\" style=\"--ecMaxLine:29ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">website\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">Blog\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">url\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">https://blog.hompus.nl\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"website:  name: Blog  url: https://blog.hompus.nl\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>To represent this in my application, I created a simple \u003Cdfn>\u003Cabbr title=\"Plain Old CLR Object\">POCO\u003C/abbr>\u003C/dfn>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:36ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">class\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Website\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#569CD6\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#569CD6\">set\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Uri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Url\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#569CD6\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#569CD6\">set\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"public class Website {    public string Name { get; set; }    public Uri Url { get; set; }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"deserializing\">Deserializing\u003C/h2>\n\u003Cp>When deserializing the file, this works completely as expected.\r\nAs you can see in the VSCode debugger:\u003C/p>\n\u003Cfigure class=\"wp-shadow\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2020/05/yaml-data-showing-in-debugger.webp\" type=\"image/webp\" media=\"(max-width: 358px)\">\u003Cimg src=\"/wp-content/uploads/2020/05/yaml-data-showing-in-debugger.png\" alt=\"Deserialized data, as shown in the VSCode debugger\" loading=\"lazy\" decoding=\"async\" width=\"358\" height=\"64\" srcset=\"/wp-content/uploads/2020/05/yaml-data-showing-in-debugger.png 358w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/figure>\n\u003Ch2 id=\"serializing\">Serializing\u003C/h2>\n\u003Cp>Now I want to serialize the object back to YAML.\r\nHowever, it ends up looking quite different than before.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"yaml\" class=\"wrap\" style=\"--ecMaxLine:42ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">website\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">Blog\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">url\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#C586C0\">&#x26;\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">o0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">absolutePath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">/\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">absoluteUri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#C586C0\">*\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">o0\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">localPath\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">/\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">authority\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">blog.hompus.nl\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">hostNameType\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">Dns\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">isDefaultPort\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#569CD6\">true\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">pathAndQuery\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">/\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">segments\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">- \u003C/span>\u003Cspan style=\"--0:#CE9178\">/\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">host\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">blog.hompus.nl\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">port\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">443\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">query\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">fragment\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">scheme\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">https\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">originalString\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">https://blog.hompus.nl\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">dnsSafeHost\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">blog.hompus.nl\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">idnHost\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">blog.hompus.nl\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">isAbsoluteUri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#569CD6\">true\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">userInfo\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\"\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"website:  name: Blog  url: &#x26;o0    absolutePath: /    absoluteUri: *o0    localPath: /    authority: blog.hompus.nl    hostNameType: Dns    isDefaultPort: true    pathAndQuery: /    segments:      - /    host: blog.hompus.nl    port: 443    query: &#x22;&#x22;    fragment: &#x22;&#x22;    scheme: https    originalString: https://blog.hompus.nl    dnsSafeHost: blog.hompus.nl    idnHost: blog.hompus.nl    isAbsoluteUri: true    userInfo: &#x22;&#x22;\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This was not what I expected.\u003C/p>\n\u003Cp>So how can we encourage YamlDotNet to store the property as a string?\u003C/p>\n\u003Ch2 id=\"yamlmember\">YamlMember\u003C/h2>\n\u003Cp>The \u003Ccode>YamlMember\u003C/code> attribute can solve this problem.\r\nIt has the \u003Ccode>SerializeAs\u003C/code> property that allows to set the Type that the serialize must use during serialization.\u003C/p>\n\u003Cp>For this situation, I choose the \u003Ccode>String\u003C/code> type.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:36ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">class\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Website\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#569CD6\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#569CD6\">set\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">YamlMember\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">typeof\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">))]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Uri\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Url\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#569CD6\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#569CD6\">set\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"public class Website {    public string Name { get; set; }    [YamlMember(typeof(string))]    public Uri Url { get; set; }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>And when generated the YAML file again, it looks like how I intended it.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"yaml\" class=\"wrap\" style=\"--ecMaxLine:30ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">website\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">:\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">name\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">Blog\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#569CD6\">url\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">https://blog.hompus.nl/\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"website:  name: Blog  url: https://blog.hompus.nl/\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>",{"headings":2136,"imagePaths":2149,"frontmatter":2116},[2137,2140,2143,2146],{"depth":780,"slug":2138,"text":2139},"the-setup","The setup",{"depth":780,"slug":2141,"text":2142},"deserializing","Deserializing",{"depth":780,"slug":2144,"text":2145},"serializing","Serializing",{"depth":780,"slug":2147,"text":2148},"yamlmember","YamlMember",[],"2020-05-22-link-an-azure-web-app-to-a-container-registry-using-arm-templates",{"id":2150,"data":2152,"body":2164,"filePath":2165,"digest":2166,"rendered":2167},{"id":2153,"title":2154,"date":2155,"updated":2156,"author":15,"excerpt":2157,"layout":17,"permalink":2158,"image":2159,"categories":2160,"tags":2161,"draft":26},1389,"Link an Azure Web App to a Container Registry using ARM templates",["Date","2020-05-22T11:30:19.000Z"],["Date","2021-07-29T07:35:44.000Z"],"Using Docker images for your Azure web app is not brand-new functionality. But if you want to deploy your container-based web app using ARM templates and use your own Azure container registry, you might discover it's not as straightforward as you might think.\nIn this article we will walk through the steps how we can make a connection to the container registry. In the end we will also make sure we do not have to pass along the password during the deployment.\n","/2020/05/22/link-an-azure-web-app-to-a-container-registry-using-arm-templates/","/wp-content/uploads/2020/05/post-1389-thumbnail.png",[906],[1806,906,2162,298,1843,2163],"Container Registry","Web App","Using Docker images for your Azure web app is not brand-new functionality.\r\nBut if you want to deploy your container-based web app using ARM templates and use your own Azure container registry,\r\nyou might discover it's not as straightforward as you might think.\r\n\r\nIn this article we will walk through the steps how we can make a connection to the container registry.\r\nIn the end we will also make sure we do not have to pass along the password during the deployment.\r\n\r\n\u003C!--more-->\r\n\r\n## Prerequisites\r\n\r\nTo begin, I have already an Azure container registry with the latest nginx image pushed as described in the\r\n\"[Push your first image to a private Docker container registry using the Docker CLI](https://learn.microsoft.com/azure/container-registry/container-registry-get-started-docker-cli?tabs=azure-cli)\" article.\r\n\r\n## Deploying the Web App\r\n\r\nWe will start with the web app, in this case a Linux container.\r\n\r\n```json\r\n{\r\n  \"type\": \"Microsoft.Web/sites\",\r\n  \"apiVersion\": \"2018-11-01\",\r\n  \"name\": \"appName\",\r\n  \"location\": \"[resourceGroup().location]\",\r\n  \"kind\": \"app,linux,container\",\r\n  \"properties\": {\r\n    \"serverFarmId\": \"[resourceId('Microsoft.Web/serverfarms', 'appPlanName')]\"\r\n  }\r\n}\r\n```\r\n\r\nNext, we link the Docker image we want to use. This is set with the `linuxFxVersion` property.\r\n\r\n```json {6}\r\n{\r\n  \"type\": \"Microsoft.Web/sites/config\",\r\n  \"apiVersion\": \"2018-11-01\",\r\n  \"name\": \"appName/web\",\r\n  \"properties\": {\r\n    \"linuxFxVersion\": \"DOCKER|hompus.azurecr.io/samples/nginx:latest\"\r\n  },\r\n},\r\n```\r\n\r\n## The problem\r\n\r\nBut, unless you deploy in the same resource group as the container registry, this will fail.\r\n\r\nIf you use the Azure portal to create a web app with a connection to your container registry,\r\nyou can see three *appsettings* on the app that contain the connection properties with a URL,\r\na username, and a password.\r\n\r\n## The solution\r\n\r\nSo, we will add the URL, username, and password to the template.\r\n\r\n```json {6-8}\r\n{\r\n  \"type\": \"Microsoft.Web/sites/config\",\r\n  \"apiVersion\": \"2018-11-01\",\r\n  \"name\": \"appName/appsettings\",\r\n  \"properties\": {\r\n    \"DOCKER_REGISTRY_SERVER_URL\": \"hompus.azurecr.io\",\r\n    \"DOCKER_REGISTRY_SERVER_USERNAME\": \"hompus\",\r\n    \"DOCKER_REGISTRY_SERVER_PASSWORD\": \"an admin password\",\r\n    \"WEBSITES_ENABLE_APP_SERVICE_STORAGE\": \"false\"\r\n  }\r\n}\r\n```\r\n\r\nThis works! But to be honest, we should not store passwords in our template,\r\nand therefore in a source repository.\r\n\r\nOf course, we can set it as a parameter, but you will still need to provide during deployment,\r\nand that means storing/retrieving it somewhere else and surfacing the password outside the Azure Resource Manager.\r\n\r\n## A better solution\r\n\r\nIt would be nice if we could use a [Managed Identity](https://learn.microsoft.com/azure/app-service/overview-managed-identity?tabs=portal%2Cdotnet)\r\nwhich we grant the [`AcrPull`](https://learn.microsoft.com/azure/role-based-access-control/built-in-roles#acrpull) rights.\r\nBut at this moment this is not possible.\r\nSo, we will have to settle for using the Resource Manager to get the details of the container registry for us.\r\n\r\nFor this to work we need a [`resourceId`](https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/template-functions-resource#resourceid) pointing to the container registry.\r\n\r\nBesides the required `resourceType` and `resourceName` of the container registry, you will need to supply the `resourceGroupName` and, if the registry is in another subscription, the `subsriptionId`.\r\n\r\nFirst, we add variables (or parameters) to build the `resourceId`.\r\n\r\n```json {5}\r\n\"variables\": {\r\n  \"registrySubscriptionId\": \"a-subscription-id\",\r\n  \"registryResourceGroup\": \"registry-resource-group-name\",\r\n  \"registryName\": \"hompus\",\r\n  \"registryResourceId\": \"[resourceId(variables('registrySubscriptionId'), variables('registryResourceGroup'), 'Microsoft.ContainerRegistry/registries', variables('registryName'))]\"\r\n},\r\n```\r\n\r\nThen, we add update the appsettings for the web app.\r\n\r\n```json {6-8}\r\n{\r\n  \"type\": \"Microsoft.Web/sites/config\",\r\n  \"apiVersion\": \"2018-11-01\",\r\n  \"name\": \"appName/appsettings\",\r\n  \"properties\": {\r\n    \"DOCKER_REGISTRY_SERVER_URL\": \"[reference(variables('registryResourceId'), '2019-05-01').loginServer]\",\r\n    \"DOCKER_REGISTRY_SERVER_USERNAME\": \"[listCredentials(variables('registryResourceId'), '2019-05-01').username]\",\r\n    \"DOCKER_REGISTRY_SERVER_PASSWORD\": \"[listCredentials(variables('registryResourceId'), '2019-05-01').passwords[0].value]\",\r\n    \"WEBSITES_ENABLE_APP_SERVICE_STORAGE\": \"false\"\r\n  }\r\n}\r\n```\r\n\r\nNow, we have removed the need for hardcoded, or supplied secrets.\r\nAnd the Azure Resource Manager takes care of handling the secrets for us.\r\n\r\nThe full example is available as a\r\n[GitHub Gist](https://gist.github.com/eNeRGy164/32150b536ae741e68e06dece5f8b16c5).","src/posts/2020-05-22-link-an-azure-web-app-to-a-container-registry-using-arm-templates.md","6cadde5748cdf13c",{"html":2168,"metadata":2169},"\u003Cp>Using Docker images for your Azure web app is not brand-new functionality.\r\nBut if you want to deploy your container-based web app using \u003Cdfn>\u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr>\u003C/dfn> templates and use your own Azure container registry,\r\nyou might discover it’s not as straightforward as you might think.\u003C/p>\n\u003Cp>In this article we will walk through the steps how we can make a connection to the container registry.\r\nIn the end we will also make sure we do not have to pass along the password during the deployment.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"prerequisites\">Prerequisites\u003C/h2>\n\u003Cp>To begin, I have already an Azure container registry with the latest nginx image pushed as described in the\r\n“\u003Ca href=\"https://learn.microsoft.com/azure/container-registry/container-registry-get-started-docker-cli?tabs=azure-cli&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Push your first image to a private Docker container registry using the Docker \u003Cdfn>\u003Cabbr title=\"Command Line Interface\">CLI\u003C/abbr>\u003C/dfn>\u003Cspan>\u003C/span>\u003C/a>” article.\u003C/p>\n\u003Ch2 id=\"deploying-the-web-app\">Deploying the Web App\u003C/h2>\n\u003Cp>We will start with the web app, in this case a Linux container.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:78ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.Web/sites\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2018-11-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"appName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"location\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceGroup().location]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"kind\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"app,linux,container\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"serverFarmId\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceId('Microsoft.Web/serverfarms', 'appPlanName')]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.Web/sites&#x22;,  &#x22;apiVersion&#x22;: &#x22;2018-11-01&#x22;,  &#x22;name&#x22;: &#x22;appName&#x22;,  &#x22;location&#x22;: &#x22;[resourceGroup().location]&#x22;,  &#x22;kind&#x22;: &#x22;app,linux,container&#x22;,  &#x22;properties&#x22;: {    &#x22;serverFarmId&#x22;: &#x22;[resourceId(&#x27;Microsoft.Web/serverfarms&#x27;, &#x27;appPlanName&#x27;)]&#x22;  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Next, we link the Docker image we want to use. This is set with the \u003Ccode>linuxFxVersion\u003C/code> property.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:69ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.Web/sites/config\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2018-11-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"appName/web\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"linuxFxVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"DOCKER|hompus.azurecr.io/samples/nginx:latest\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.Web/sites/config&#x22;,  &#x22;apiVersion&#x22;: &#x22;2018-11-01&#x22;,  &#x22;name&#x22;: &#x22;appName/web&#x22;,  &#x22;properties&#x22;: {    &#x22;linuxFxVersion&#x22;: &#x22;DOCKER|hompus.azurecr.io/samples/nginx:latest&#x22;  },},\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"the-problem\">The problem\u003C/h2>\n\u003Cp>But, unless you deploy in the same resource group as the container registry, this will fail.\u003C/p>\n\u003Cp>If you use the Azure portal to create a web app with a connection to your container registry,\r\nyou can see three \u003Cem>appsettings\u003C/em> on the app that contain the connection properties with a \u003Cdfn>\u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>\u003C/dfn>,\r\na username, and a password.\u003C/p>\n\u003Ch2 id=\"the-solution\">The solution\u003C/h2>\n\u003Cp>So, we will add the \u003Cabbr title=\"Uniform Resource Locator\">URL\u003C/abbr>, username, and password to the template.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:59ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.Web/sites/config\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2018-11-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"appName/appsettings\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"DOCKER_REGISTRY_SERVER_URL\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"hompus.azurecr.io\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"DOCKER_REGISTRY_SERVER_USERNAME\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"hompus\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"DOCKER_REGISTRY_SERVER_PASSWORD\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"an admin password\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"WEBSITES_ENABLE_APP_SERVICE_STORAGE\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"false\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.Web/sites/config&#x22;,  &#x22;apiVersion&#x22;: &#x22;2018-11-01&#x22;,  &#x22;name&#x22;: &#x22;appName/appsettings&#x22;,  &#x22;properties&#x22;: {    &#x22;DOCKER_REGISTRY_SERVER_URL&#x22;: &#x22;hompus.azurecr.io&#x22;,    &#x22;DOCKER_REGISTRY_SERVER_USERNAME&#x22;: &#x22;hompus&#x22;,    &#x22;DOCKER_REGISTRY_SERVER_PASSWORD&#x22;: &#x22;an admin password&#x22;,    &#x22;WEBSITES_ENABLE_APP_SERVICE_STORAGE&#x22;: &#x22;false&#x22;  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This works! But to be honest, we should not store passwords in our template,\r\nand therefore in a source repository.\u003C/p>\n\u003Cp>Of course, we can set it as a parameter, but you will still need to provide during deployment,\r\nand that means storing/retrieving it somewhere else and surfacing the password outside the Azure Resource Manager.\u003C/p>\n\u003Ch2 id=\"a-better-solution\">A better solution\u003C/h2>\n\u003Cp>It would be nice if we could use a \u003Ca href=\"https://learn.microsoft.com/azure/app-service/overview-managed-identity?tabs=portal%2Cdotnet&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Managed Identity\u003Cspan>\u003C/span>\u003C/a>\r\nwhich we grant the \u003Ca href=\"https://learn.microsoft.com/azure/role-based-access-control/built-in-roles?wt.mc_id=AZ-MVP-5004268#acrpull\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>AcrPull\u003C/code>\u003Cspan>\u003C/span>\u003C/a> rights.\r\nBut at this moment this is not possible.\r\nSo, we will have to settle for using the Resource Manager to get the details of the container registry for us.\u003C/p>\n\u003Cp>For this to work we need a \u003Ca href=\"https://docs.microsoft.com/en-us/azure/azure-resource-manager/templates/template-functions-resource?wt.mc_id=AZ-MVP-5004268#resourceid\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>resourceId\u003C/code>\u003Cspan>\u003C/span>\u003C/a> pointing to the container registry.\u003C/p>\n\u003Cp>Besides the required \u003Ccode>resourceType\u003C/code> and \u003Ccode>resourceName\u003C/code> of the container registry, you will need to supply the \u003Ccode>resourceGroupName\u003C/code> and, if the registry is in another subscription, the \u003Ccode>subsriptionId\u003C/code>.\u003C/p>\n\u003Cp>First, we add variables (or parameters) to build the \u003Ccode>resourceId\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:180ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CE9178\">\"variables\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"registrySubscriptionId\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"a-subscription-id\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"registryResourceGroup\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"registry-resource-group-name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"registryName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"hompus\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"registryResourceId\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"[resourceId(variables('registrySubscriptionId'), variables('registryResourceGroup'), 'Microsoft.ContainerRegistry/registries', variables('registryName'))]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"&#x22;variables&#x22;: {  &#x22;registrySubscriptionId&#x22;: &#x22;a-subscription-id&#x22;,  &#x22;registryResourceGroup&#x22;: &#x22;registry-resource-group-name&#x22;,  &#x22;registryName&#x22;: &#x22;hompus&#x22;,  &#x22;registryResourceId&#x22;: &#x22;[resourceId(variables(&#x27;registrySubscriptionId&#x27;), variables(&#x27;registryResourceGroup&#x27;), &#x27;Microsoft.ContainerRegistry/registries&#x27;, variables(&#x27;registryName&#x27;))]&#x22;},\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Then, we add update the appsettings for the web app.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:125ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.Web/sites/config\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2018-11-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"appName/appsettings\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"DOCKER_REGISTRY_SERVER_URL\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"[reference(variables('registryResourceId'), '2019-05-01').loginServer]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"DOCKER_REGISTRY_SERVER_USERNAME\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"[listCredentials(variables('registryResourceId'), '2019-05-01').username]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"DOCKER_REGISTRY_SERVER_PASSWORD\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"[listCredentials(variables('registryResourceId'), '2019-05-01').passwords[0].value]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"WEBSITES_ENABLE_APP_SERVICE_STORAGE\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"false\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.Web/sites/config&#x22;,  &#x22;apiVersion&#x22;: &#x22;2018-11-01&#x22;,  &#x22;name&#x22;: &#x22;appName/appsettings&#x22;,  &#x22;properties&#x22;: {    &#x22;DOCKER_REGISTRY_SERVER_URL&#x22;: &#x22;[reference(variables(&#x27;registryResourceId&#x27;), &#x27;2019-05-01&#x27;).loginServer]&#x22;,    &#x22;DOCKER_REGISTRY_SERVER_USERNAME&#x22;: &#x22;[listCredentials(variables(&#x27;registryResourceId&#x27;), &#x27;2019-05-01&#x27;).username]&#x22;,    &#x22;DOCKER_REGISTRY_SERVER_PASSWORD&#x22;: &#x22;[listCredentials(variables(&#x27;registryResourceId&#x27;), &#x27;2019-05-01&#x27;).passwords[0].value]&#x22;,    &#x22;WEBSITES_ENABLE_APP_SERVICE_STORAGE&#x22;: &#x22;false&#x22;  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now, we have removed the need for hardcoded, or supplied secrets.\r\nAnd the Azure Resource Manager takes care of handling the secrets for us.\u003C/p>\n\u003Cp>The full example is available as a\r\n\u003Ca href=\"https://gist.github.com/eNeRGy164/32150b536ae741e68e06dece5f8b16c5\" rel=\"noopener noreferrer external\" target=\"_blank\">GitHub Gist\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>",{"headings":2170,"imagePaths":2180,"frontmatter":2152},[2171,2172,2175,2176,2177],{"depth":780,"slug":728,"text":729},{"depth":780,"slug":2173,"text":2174},"deploying-the-web-app","Deploying the Web App",{"depth":780,"slug":255,"text":256},{"depth":780,"slug":258,"text":259},{"depth":780,"slug":2178,"text":2179},"a-better-solution","A better solution",[],"2020-05-19-arm-template-user-defined-functions-build-a-storage-account-connection-string",{"id":2181,"data":2183,"body":2196,"filePath":2197,"digest":2198,"rendered":2199},{"id":2184,"title":2185,"date":2186,"updated":2187,"author":15,"excerpt":2188,"layout":17,"permalink":2189,"image":2190,"categories":2191,"tags":2192,"draft":26},1373,"ARM Template User-defined Functions: Build a Storage Account Connection String",["Date","2020-05-19T12:52:58.000Z"],["Date","2021-07-16T20:42:40.000Z"],"When working with ARM Templates, chances are you have set a value that was a Storage Account Connection String. For example as the value of an appsetting, or as a secret in Azure Key Vault, which I did as an example in a previous blog post.\nHowever, this does not result in the most maintainable and readable piece of JSON. Even worse if you have multiple connection strings in the same template.\nIn this article I will show that adding a User-Defined Function to our template can improve on this.\n","/2020/05/19/arm-template-user-defined-functions-build-a-storage-account-connection-string/","/wp-content/uploads/2020/05/post-1373-thumbnail.png",[906],[1806,906,2193,2194,2195,1843],"Connection String","Function","Storage Account","When working with ARM Templates, chances are you have set a value that was a storage account connection string.\r\nFor example, as the value of an appsetting, or as a secret in Key Vault,\r\nwhich I did as an example in a [previous article](/2017/03/20/add-secrets-to-your-azure-key-vault-using-arm-templates).\r\n\r\nHowever, this does not result in the most maintainable and readable piece of JSON.\r\nEven worse if you have multiple connection strings in the same template.\r\n\r\nIn this article I will show that adding a user-defined function to our template can improve on this.\r\n\r\n\u003C!--more-->\r\n\r\nThe example from the earlier article.\r\n\r\n```json {7}\r\n{\r\n  \"type\": \"Microsoft.KeyVault/vaults/secrets\",\r\n  \"name\": \"LoremVault/ConnectionString\",\r\n  \"apiVersion\": \"2015-06-01\",\r\n  \"properties\": {\r\n    \"contentType\": \"text/plain\",\r\n    \"value\": \"[concat('DefaultEndpointsProtocol=https;AccountName=', 'loremipsumstore', ';AccountKey=', listKeys(resourceId('Microsoft.Storage/storageAccounts', 'loremipsumstore'), '2019-06-01').keys[0].value, ';EndpointSuffix=core.windows.net')]\"\r\n  },\r\n  \"dependsOn\": [\r\n    \"[resourceId('Microsoft.KeyVault/vaults', 'LoremVault')]\",\r\n    \"[resourceId('Microsoft.Storage/storageAccounts', 'loremipsumstore')]\"\r\n  ]\r\n}\r\n```\r\n\r\n## User-Defined Functions\r\n\r\nARM templates support [user-defined functions](https://learn.microsoft.com/azure/azure-resource-manager/templates/user-defined-functions),\r\nbut I do not see them very often, to be honest, I never encountered one in the wild.\r\n\r\nAlthough there are some [limitations](https://learn.microsoft.com/azure/azure-resource-manager/templates/user-defined-functions#limitations),\r\nnone of them will prevent us from improving our template.\r\n\r\nFirst, we will add a `functions` array to the root of the template and add a function outline.\r\nWe must specify a `namespace`, the `name` of the function and the `output` `type` and `value`.\r\n\r\n```json\r\n\"functions\": [\r\n  {\r\n    \"namespace\": \"storage\",\r\n    \"members\": {\r\n      \"connectionString\": {\r\n        \"output\": {\r\n          \"type\": \"string\",\r\n          \"value\": \"\"\r\n        }\r\n      }\r\n    }\r\n  }\r\n],\r\n```\r\n\r\nTo create a storage account connection string, we need the account name and one of the keys.\r\nAs user-defined functions cannot use the `reference` function or any of the `list*` functions,\r\nwe will need to supply these parameters to the function.\r\n\r\nSo, we add `accountName` and `accountKey` as `parameters`.\r\n\r\n```json {2-11}\r\n\"connectionString\": {\r\n  \"parameters\": [\r\n    {\r\n      \"name\": \"accountName\",\r\n      \"type\": \"string\"\r\n    },\r\n    {\r\n      \"name\": \"accountKey\",\r\n      \"type\": \"string\"\r\n    }\r\n  ],\r\n  \"output\": {\r\n    \"type\": \"string\",\r\n    \"value\": \"\"\r\n  }\r\n}\r\n```\r\n\r\nNow we concatenate the supplied parameter values with the static parts to form a complete connection string as the `output` `value`.\r\n\r\n```json {3}\r\n\"output\": {\r\n  \"type\": \"string\",\r\n  \"value\": \"[concat('DefaultEndpointsProtocol=https;AccountName=', parameters('accountName'), ';AccountKey=', parameters('accountKey'), ';EndpointSuffix=core.windows.net')]\"\r\n}\r\n```\r\n\r\n## Calling the function\r\n\r\nWith this done, we can replace the original value in our template with the return value of the new method we call.\r\n\r\n```json {7}\r\n{\r\n  \"type\": \"Microsoft.KeyVault/vaults/secrets\",\r\n  \"name\": \"LoremVault/ConnectionString\",\r\n  \"apiVersion\": \"2015-06-01\",\r\n  \"properties\": {\r\n    \"contentType\": \"text/plain\",\r\n    \"value\": \"[storage.connectionString('loremipsumstore', listKeys(resourceId('Microsoft.Storage/storageAccounts', 'loremipsumstore'), '2019-06-01').keys[0].value)]\"\r\n  },\r\n  \"dependsOn\": [\r\n    \"[resourceId('Microsoft.KeyVault/vaults', 'LoremVault')]\",\r\n    \"[resourceId('Microsoft.Storage/storageAccounts', 'loremipsumstore')]\"\r\n  ]\r\n}\r\n```\r\n\r\nAlthough user-defined functions have quite some limitations in ARM templates,\r\nthis makes for a much cleaner and more readable template.\r\n\r\nThe full example is available as a\r\n[GitHub Gist](https://gist.github.com/eNeRGy164/4daa1ac3d7a383074f19fcb6202d14ef).","src/posts/2020-05-19-arm-template-user-defined-functions-build-a-storage-account-connection-string.md","3da27947ac660846",{"html":2200,"metadata":2201},"\u003Cp>When working with \u003Cdfn>\u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr>\u003C/dfn> Templates, chances are you have set a value that was a storage account connection string.\r\nFor example, as the value of an appsetting, or as a secret in Key Vault,\r\nwhich I did as an example in a \u003Ca href=\"/2017/03/20/add-secrets-to-your-azure-key-vault-using-arm-templates\">previous article\u003C/a>.\u003C/p>\n\u003Cp>However, this does not result in the most maintainable and readable piece of \u003Cdfn>\u003Cabbr title=\"JavaScript Object Notation\">JSON\u003C/abbr>\u003C/dfn>.\r\nEven worse if you have multiple connection strings in the same template.\u003C/p>\n\u003Cp>In this article I will show that adding a user-defined function to our template can improve on this.\u003C/p>\n\u003C!--more-->\n\u003Cp>The example from the earlier article.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:247ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.KeyVault/vaults/secrets\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremVault/ConnectionString\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-06-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"contentType\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"text/plain\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"[concat('DefaultEndpointsProtocol=https;AccountName=', 'loremipsumstore', ';AccountKey=', listKeys(resourceId('Microsoft.Storage/storageAccounts', 'loremipsumstore'), '2019-06-01').keys[0].value, ';EndpointSuffix=core.windows.net')]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"dependsOn\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceId('Microsoft.KeyVault/vaults', 'LoremVault')]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceId('Microsoft.Storage/storageAccounts', 'loremipsumstore')]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.KeyVault/vaults/secrets&#x22;,  &#x22;name&#x22;: &#x22;LoremVault/ConnectionString&#x22;,  &#x22;apiVersion&#x22;: &#x22;2015-06-01&#x22;,  &#x22;properties&#x22;: {    &#x22;contentType&#x22;: &#x22;text/plain&#x22;,    &#x22;value&#x22;: &#x22;[concat(&#x27;DefaultEndpointsProtocol=https;AccountName=&#x27;, &#x27;loremipsumstore&#x27;, &#x27;;AccountKey=&#x27;, listKeys(resourceId(&#x27;Microsoft.Storage/storageAccounts&#x27;, &#x27;loremipsumstore&#x27;), &#x27;2019-06-01&#x27;).keys[0].value, &#x27;;EndpointSuffix=core.windows.net&#x27;)]&#x22;  },  &#x22;dependsOn&#x22;: [    &#x22;[resourceId(&#x27;Microsoft.KeyVault/vaults&#x27;, &#x27;LoremVault&#x27;)]&#x22;,    &#x22;[resourceId(&#x27;Microsoft.Storage/storageAccounts&#x27;, &#x27;loremipsumstore&#x27;)]&#x22;  ]}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"user-defined-functions\">User-Defined Functions\u003C/h2>\n\u003Cp>\u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> templates support \u003Ca href=\"https://learn.microsoft.com/azure/azure-resource-manager/templates/user-defined-functions?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">user-defined functions\u003Cspan>\u003C/span>\u003C/a>,\r\nbut I do not see them very often, to be honest, I never encountered one in the wild.\u003C/p>\n\u003Cp>Although there are some \u003Ca href=\"https://learn.microsoft.com/azure/azure-resource-manager/templates/user-defined-functions?wt.mc_id=AZ-MVP-5004268#limitations\" rel=\"noopener noreferrer external\" target=\"_blank\">limitations\u003Cspan>\u003C/span>\u003C/a>,\r\nnone of them will prevent us from improving our template.\u003C/p>\n\u003Cp>First, we will add a \u003Ccode>functions\u003C/code> array to the root of the template and add a function outline.\r\nWe must specify a \u003Ccode>namespace\u003C/code>, the \u003Ccode>name\u003C/code> of the function and the \u003Ccode>output\u003C/code> \u003Ccode>type\u003C/code> and \u003Ccode>value\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:27ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CE9178\">\"functions\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"namespace\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"storage\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"members\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"connectionString\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"output\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"string\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:10ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">          \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">        \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">      \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">],\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"&#x22;functions&#x22;: [  {    &#x22;namespace&#x22;: &#x22;storage&#x22;,    &#x22;members&#x22;: {      &#x22;connectionString&#x22;: {        &#x22;output&#x22;: {          &#x22;type&#x22;: &#x22;string&#x22;,          &#x22;value&#x22;: &#x22;&#x22;        }      }    }  }],\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>To create a storage account connection string, we need the account name and one of the keys.\r\nAs user-defined functions cannot use the \u003Ccode>reference\u003C/code> function or any of the \u003Ccode>list*\u003C/code> functions,\r\nwe will need to supply these parameters to the function.\u003C/p>\n\u003Cp>So, we add \u003Ccode>accountName\u003C/code> and \u003Ccode>accountKey\u003C/code> as \u003Ccode>parameters\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:28ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CE9178\">\"connectionString\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"parameters\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"accountName\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"string\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"accountKey\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:6ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">      \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"string\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">],\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"output\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"string\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"&#x22;connectionString&#x22;: {  &#x22;parameters&#x22;: [    {      &#x22;name&#x22;: &#x22;accountName&#x22;,      &#x22;type&#x22;: &#x22;string&#x22;    },    {      &#x22;name&#x22;: &#x22;accountKey&#x22;,      &#x22;type&#x22;: &#x22;string&#x22;    }  ],  &#x22;output&#x22;: {    &#x22;type&#x22;: &#x22;string&#x22;,    &#x22;value&#x22;: &#x22;&#x22;  }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now we concatenate the supplied parameter values with the static parts to form a complete connection string as the \u003Ccode>output\u003C/code> \u003Ccode>value\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:173ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CE9178\">\"output\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"string\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"[concat('DefaultEndpointsProtocol=https;AccountName=', parameters('accountName'), ';AccountKey=', parameters('accountKey'), ';EndpointSuffix=core.windows.net')]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"&#x22;output&#x22;: {  &#x22;type&#x22;: &#x22;string&#x22;,  &#x22;value&#x22;: &#x22;[concat(&#x27;DefaultEndpointsProtocol=https;AccountName=&#x27;, parameters(&#x27;accountName&#x27;), &#x27;;AccountKey=&#x27;, parameters(&#x27;accountKey&#x27;), &#x27;;EndpointSuffix=core.windows.net&#x27;)]&#x22;}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"calling-the-function\">Calling the function\u003C/h2>\n\u003Cp>With this done, we can replace the original value in our template with the return value of the new method we call.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"json\" class=\"wrap\" style=\"--ecMaxLine:166ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"type\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"Microsoft.KeyVault/vaults/secrets\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"name\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"LoremVault/ConnectionString\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"apiVersion\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"2015-06-01\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"properties\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"contentType\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"text/plain\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line highlight mark\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"value\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: \u003C/span>\u003Cspan style=\"--0:#d6a28d\">\"[storage.connectionString('loremipsumstore', listKeys(resourceId('Microsoft.Storage/storageAccounts', 'loremipsumstore'), '2019-06-01').keys[0].value)]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">},\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">  \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">\"dependsOn\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">: [\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceId('Microsoft.KeyVault/vaults', 'LoremVault')]\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">,\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"[resourceId('Microsoft.Storage/storageAccounts', 'loremipsumstore')]\"\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:2ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">  \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"{  &#x22;type&#x22;: &#x22;Microsoft.KeyVault/vaults/secrets&#x22;,  &#x22;name&#x22;: &#x22;LoremVault/ConnectionString&#x22;,  &#x22;apiVersion&#x22;: &#x22;2015-06-01&#x22;,  &#x22;properties&#x22;: {    &#x22;contentType&#x22;: &#x22;text/plain&#x22;,    &#x22;value&#x22;: &#x22;[storage.connectionString(&#x27;loremipsumstore&#x27;, listKeys(resourceId(&#x27;Microsoft.Storage/storageAccounts&#x27;, &#x27;loremipsumstore&#x27;), &#x27;2019-06-01&#x27;).keys[0].value)]&#x22;  },  &#x22;dependsOn&#x22;: [    &#x22;[resourceId(&#x27;Microsoft.KeyVault/vaults&#x27;, &#x27;LoremVault&#x27;)]&#x22;,    &#x22;[resourceId(&#x27;Microsoft.Storage/storageAccounts&#x27;, &#x27;loremipsumstore&#x27;)]&#x22;  ]}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Although user-defined functions have quite some limitations in \u003Cabbr title=\"Azure Resource Manager\">ARM\u003C/abbr> templates,\r\nthis makes for a much cleaner and more readable template.\u003C/p>\n\u003Cp>The full example is available as a\r\n\u003Ca href=\"https://gist.github.com/eNeRGy164/4daa1ac3d7a383074f19fcb6202d14ef\" rel=\"noopener noreferrer external\" target=\"_blank\">GitHub Gist\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>",{"headings":2202,"imagePaths":2209,"frontmatter":2183},[2203,2206],{"depth":780,"slug":2204,"text":2205},"user-defined-functions","User-Defined Functions",{"depth":780,"slug":2207,"text":2208},"calling-the-function","Calling the function",[],"2020-06-19-classify-a-bitmap-with-your-downloaded-custom-vision-onnx-model",{"id":2210,"data":2212,"body":2222,"filePath":2223,"digest":2224,"rendered":2225},{"id":2213,"title":2214,"date":2215,"updated":2216,"author":15,"excerpt":2217,"layout":17,"permalink":2218,"image":2219,"categories":2220,"tags":2221,"draft":26},1459,"Classify a Bitmap with your downloaded Custom Vision ONNX model",["Date","2020-06-19T14:38:56.000Z"],["Date","2021-07-16T20:36:40.000Z"],"The Custom Vision service is one of the Azure Cognitive Services that is provided by Microsoft. With custom vision, you can train a model with your own image data. The portal provides a Prediction API for the trained model to classify an image you supply.\nThere can be reasons why you might not want to use the online REST endpoint and you could prefer an offline model.\nTo work with machine learning in .NET, we can use ML.NET. There are several tutorials how to use this framework. But none of them combine the use of the Bitmap class with a downloaded ONNX model from the custom vision portal.\nIn this article I will walk through the steps to set up an application to classify bitmaps using a custom vision model with ML.NET.\n","/2020/06/19/classify-a-bitmap-with-your-downloaded-custom-vision-onnx-model/","/wp-content/uploads/2020/06/post-1459-thumbnail.png",[906,183,2032],[906,2034,2126,2032,2036,2037],"The Custom Vision service is one of the [Azure AI Services](https://azure.microsoft.com/products/ai-services/) that is provided by Microsoft.\r\nWith custom vision, you can train a model with your own image data.\r\nThe portal provides a [Prediction API](hhttps://learn.microsoft.com/rest/api/customvision/predictions?view=rest-customvision-v3.3) for the trained model to classify an image you supply.\r\n\r\nThere can be reasons why you might not want to use the online REST endpoint.\r\nFor example, when processing images from a video feed, performance, connectivity, security,\r\nand costs might be considerations why you could prefer an offline model.\r\n\r\nTo work with machine learning in .NET, we can use [ML.NET](https://dotnet.microsoft.com/apps/ai/ml-dotnet),\r\nan open source and cross-platform framework.\r\nThere are [several tutorials](https://dotnet.microsoft.com/learn/ml-dotnet/get-started-tutorial/intro) how to use this framework.\r\nBut none of them combine the [`Bitmap` class](https://learn.microsoft.com/dotnet/api/system.drawing.bitmap)\r\nwith a downloaded ONNX model from the custom vision portal.\r\n\r\nIn this article I will walk through the steps to set up an application to classify bitmaps using a custom vision model with ML.NET.\r\n\r\n\u003C!--more-->\r\n\r\n## Exporting the trained model\r\n\r\nFirst, get the model from the custom vision portal.\r\nIf you do not have a model yet, I suggest following\r\n[the quickstart \"How to build a classifier with Custom Vision\"](https://learn.microsoft.com/azure/ai-services/custom-vision-service/getting-started-build-a-classifier).\r\n\r\n1. Visit the [Custom Vision](https://www.customvision.ai/) portal.\r\n2. Select the **Performance** page.\r\n3. Use the **Export** button to download a zip file containing your model.\r\n\r\n   > [!NOTE]\r\n   > If there is no export button,\r\n   > the model is trained without using a compact domain. This can be changed in the settings of the project.\r\n   > After training the model again, the export button should be visible.\r\n\r\n4. Store the `model.onnx` file in a location where it can be loaded by the application.\r\n\r\n## Setting up the application\r\n\r\nThis example starts with a blank .NET C# Console application.\r\n\r\nThe following NuGet packages must be added:\r\n\r\n- Microsoft.ML.OnnxTransformer ([1.5.0](https://www.nuget.org/packages/Microsoft.ML.OnnxTransformer/1.5.0))\r\n- Microsoft.ML.OnnxRuntime ([1.3.0](https://www.nuget.org/packages/Microsoft.ML.OnnxTransformer/1.5.0))\r\n- Microsoft.ML.ImageAnalytics ([1.5.0](https://www.nuget.org/packages/Microsoft.ML.ImageAnalytics/1.5.0))\r\n\r\nAdding these packages will resolve all necessary dependencies.\r\nWe can start developing the application.\r\n\r\nThe goal is to create a [`PredictionEngine\u003CTSrc, TDst>` class](https://learn.microsoft.com/dotnet/api/microsoft.ml.predictionengine-2?view=ml-dotnet)\r\nbased on a [`TransformerChain`](https://learn.microsoft.com/dotnet/api/microsoft.ml.data.transformerchain-1?view=ml-dotnet).\r\nBut as you can see by the generic notation of the prediction engine, two types need to be supplied as source and destination.\r\nSo, these will be created first.\r\n\r\n## Adding support classes\r\n\r\nFor these two simple classes, we need to know the corresponding property names and data types from the ONNX model.\r\nFor this we can use a tool like [Netron](https://github.com/lutzroeder/Netron).\r\n\r\n![Screenshot of Netron showing the input and output properties.](/wp-content/uploads/2020/06/netron-model-input-output.png \"Netron showing the input and output properties\")\r\n\r\nThe first class we add will be the input for the transformation pipeline.\r\nAs the pipeline will not be able to infer the datatype from the .NET `Bitmap` type,\r\nwe annotate the property with the [`ImageTypeAttribute` class](https://learn.microsoft.com/dotnet/api/microsoft.ml.transforms.image.imagetypeattribute?view=ml-dotnet).\r\nAs we can see in Netron, the model expects an input array with the size of `3×224×224`.\r\nThis reflects three RGB bytes per pixel, for an image with a height of 224 pixels and a width of 224 pixels.\r\nSo, we set both the `height` and `width` parameters of the attribute to a value of `224`.\r\n\r\n```csharp title=\"ImageInputData.cs\"\r\npublic class ImageInputData\r\n{\r\n    [ImageType(224, 224)]\r\n    public Bitmap Image { get; set; }\r\n}\r\n```\r\n\r\nThe second class we add will reflect the output of the prediction engine. Looking at the information in Netron,\r\nthis will be an array of a single string, with the name `classLabel`.\r\n\r\n```csharp title=\"ImagePrediction.cs\"\r\npublic class ImagePrediction\r\n{\r\n    [ColumnName(\"classLabel\")]\r\n    public string[] Labels;\r\n}\r\n```\r\n\r\n## Building the prediction engine\r\n\r\nAll following code will be added to the `Main` method of _Program.cs_.\r\n\r\nOn the first line, we create an instance of the [`MLContext` class](https://learn.microsoft.com/dotnet/api/microsoft.ml.mlcontext?view=ml-dotnet).\r\nThe MLContext class is the starting point for all ML.NET operations.\r\n\r\n```csharp\r\nvar mlContext = new MLContext();\r\n```\r\n\r\nNext, we define the pipeline. The pipeline will consist of three transformation steps.\r\n\r\n- The [`ResizeImages` method](https://learn.microsoft.com/dotnet/api/microsoft.ml.imageestimatorscatalog.resizeimages?view=ml-dotnet)\r\n  resizes the image to the specified size. In this case, `224×224`.\r\n- The [`ExtractPixels` method](https://learn.microsoft.com/dotnet/api/microsoft.ml.imageestimatorscatalog.extractpixels?view=ml-dotnet)\r\n  extracts pixel values from the `Bitmap` into a numerical vector.\r\n- The [`ApplyOnnxModel` method](https://learn.microsoft.com/dotnet/api/microsoft.ml.onnxcatalog.applyonnxmodel?view=ml-dotnet#Microsoft_ML_OnnxCatalog_ApplyOnnxModel_Microsoft_ML_TransformsCatalog_System_String_System_String_System_String_System_Nullable_System_Int32__System_Boolean_)\r\n  applies the pre-trained ONNX model to score on the data that is provided.\r\n\r\nFor the first two steps, the first parameter is the name of the output column,\r\nand the last parameter is the name of the input column.\r\n\r\nThe third method has the file location of the ONNX model as last parameter.\r\nWe also need to make sure the input and output columns match the names of the ONNX model.\r\nLooking at Netron again, the column names are `classLabel` and `data`.\r\n\r\n```csharp\r\nvar pipeline = mlContext.Transforms\r\n    .ResizeImages(\"image\", 224, 224, nameof(ImageInputData.Image))\r\n    .Append(mlContext.Transforms.ExtractPixels(\"data\", \"image\"))\r\n    .Append(mlContext.Transforms.ApplyOnnxModel(\"classLabel\", \"data\", modelLocation));\r\n```\r\n\r\nThe pipeline needs to know the data schema to operate on when the\r\n[`Fit` method](https://learn.microsoft.com/en-us/dotnet/api/microsoft.ml.iestimator-1.fit?view=ml-dotnet) is called.\r\nBecause we are not training the model, we can just supply an empty list of the input type.\r\n\r\n```csharp\r\nvar data = mlContext.Data.LoadFromEnumerable(new List\u003CImageInputData>());\r\nvar model = pipeline.Fit(data);\r\n```\r\n\r\nWith this, everything is set up to create the prediction engine.\r\n\r\n```csharp\r\nvar predictionEngine =\r\n    mlContext.Model.CreatePredictionEngine\u003CImageInputData, ImagePrediction>(model);\r\n```\r\n\r\n## And finally: classifying a bitmap\r\n\r\nFirst, we create an input object with the bitmap.\r\nYou can load a bitmap from a file, a stream, a video feed, etc.\r\nThis depends on the design of your application.\r\n\r\n```csharp\r\nvar bitmap = … // your source of a bitmap\r\nvar input = new ImageInputData { Image = bitmap };\r\n```\r\n\r\nNow we can call the [`Predict` method](https://learn.microsoft.com/dotnet/api/microsoft.ml.predictionengine-2.predict?view=ml-dotnet)\r\non the prediction engine. This will return the classification.\r\n\r\n```csharp\r\nvar prediction = predictionEngine.Predict(input);\r\n\r\nvar classification = prediction.Labels[0];\r\n```\r\n\r\nThis should be all.\r\n\r\nI shared the sample code on [GitHub](https://github.com/eNeRGy164/BitmapOnnxPrediction).","src/posts/2020-06-19-classify-a-bitmap-with-your-downloaded-custom-vision-onnx-model.md","4e1df0f8146e9ccc",{"html":2226,"metadata":2227},"\u003Cp>The Custom Vision service is one of the \u003Ca href=\"https://azure.microsoft.com/products/ai-services/?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Azure \u003Cdfn>\u003Cabbr title=\"Artificial Intelligence\">AI\u003C/abbr>\u003C/dfn> Services\u003Cspan>\u003C/span>\u003C/a> that is provided by Microsoft.\r\nWith custom vision, you can train a model with your own image data.\r\nThe portal provides a \u003Ca href=\"hhttps://learn.microsoft.com/rest/api/customvision/predictions?view=rest-customvision-v3.3&#x26;wt.mc_id=AZ-MVP-5004268\">Prediction \u003Cdfn>\u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr>\u003C/dfn>\u003C/a> for the trained model to classify an image you supply.\u003C/p>\n\u003Cp>There can be reasons why you might not want to use the online \u003Cdfn>\u003Cabbr title=\"Representational State Transfer\">REST\u003C/abbr>\u003C/dfn> endpoint.\r\nFor example, when processing images from a video feed, performance, connectivity, security,\r\nand costs might be considerations why you could prefer an offline model.\u003C/p>\n\u003Cp>To work with machine learning in .NET, we can use \u003Ca href=\"https://dotnet.microsoft.com/apps/ai/ml-dotnet\" rel=\"noopener noreferrer external\" target=\"_blank\">ML.NET\u003Cspan>\u003C/span>\u003C/a>,\r\nan open source and cross-platform framework.\r\nThere are \u003Ca href=\"https://dotnet.microsoft.com/learn/ml-dotnet/get-started-tutorial/intro\" rel=\"noopener noreferrer external\" target=\"_blank\">several tutorials\u003Cspan>\u003C/span>\u003C/a> how to use this framework.\r\nBut none of them combine the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.drawing.bitmap?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Bitmap\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>\r\nwith a downloaded \u003Cdfn>\u003Cabbr title=\"Open Neural Network Exchange\">ONNX\u003C/abbr>\u003C/dfn> model from the custom vision portal.\u003C/p>\n\u003Cp>In this article I will walk through the steps to set up an application to classify bitmaps using a custom vision model with ML.NET.\u003C/p>\n\u003C!--more-->\n\u003Ch2 id=\"exporting-the-trained-model\">Exporting the trained model\u003C/h2>\n\u003Cp>First, get the model from the custom vision portal.\r\nIf you do not have a model yet, I suggest following\r\n\u003Ca href=\"https://learn.microsoft.com/azure/ai-services/custom-vision-service/getting-started-build-a-classifier?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">the quickstart “How to build a classifier with Custom Vision”\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Col>\n\u003Cli>\n\u003Cp>Visit the \u003Ca href=\"https://www.customvision.ai/\" rel=\"noopener noreferrer external\" target=\"_blank\">Custom Vision\u003Cspan>\u003C/span>\u003C/a> portal.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Select the \u003Cstrong>Performance\u003C/strong> page.\u003C/p>\n\u003C/li>\n\u003Cli>\n\u003Cp>Use the \u003Cstrong>Export\u003C/strong> button to download a zip file containing your model.\u003C/p>\n\u003Cdiv class=\"markdown-alert markdown-alert-note\">\u003Cp class=\"markdown-alert-title\">\u003Csvg xmlns=\"http://www.w3.org/2000/svg\" width=\"16\" height=\"16\" fill=\"currentColor\" viewBox=\"0 0 16 16\">\u003Cpath d=\"M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16\">\u003C/path>\u003Cpath d=\"m8.93 6.588-2.29.287-.082.38.45.083c.294.07.352.176.288.469l-.738 3.468c-.194.897.105 1.319.808 1.319.545 0 1.178-.252 1.465-.598l.088-.416c-.2.176-.492.246-.686.246-.275 0-.375-.193-.304-.533zM9 4.5a1 1 0 1 1-2 0 1 1 0 0 1 2 0\">\u003C/path>\u003C/svg>Note\u003C/p>\n\u003Cp>\r\nIf there is no export button,\r\nthe model is trained without using a compact domain. This can be changed in the settings of the project.\r\nAfter training the model again, the export button should be visible.\u003C/p>\n\u003C/div>\n\u003C/li>\n\u003Cli>\n\u003Cp>Store the \u003Ccode>model.onnx\u003C/code> file in a location where it can be loaded by the application.\u003C/p>\n\u003C/li>\n\u003C/ol>\n\u003Ch2 id=\"setting-up-the-application\">Setting up the application\u003C/h2>\n\u003Cp>This example starts with a blank .NET C# Console application.\u003C/p>\n\u003Cp>The following NuGet packages must be added:\u003C/p>\n\u003Cul>\n\u003Cli>Microsoft.ML.OnnxTransformer (\u003Ca href=\"https://www.nuget.org/packages/Microsoft.ML.OnnxTransformer/1.5.0\" rel=\"noopener noreferrer external\" target=\"_blank\">1.5.0\u003Cspan>\u003C/span>\u003C/a>)\u003C/li>\n\u003Cli>Microsoft.ML.OnnxRuntime (\u003Ca href=\"https://www.nuget.org/packages/Microsoft.ML.OnnxTransformer/1.5.0\" rel=\"noopener noreferrer external\" target=\"_blank\">1.3.0\u003Cspan>\u003C/span>\u003C/a>)\u003C/li>\n\u003Cli>Microsoft.ML.ImageAnalytics (\u003Ca href=\"https://www.nuget.org/packages/Microsoft.ML.ImageAnalytics/1.5.0\" rel=\"noopener noreferrer external\" target=\"_blank\">1.5.0\u003Cspan>\u003C/span>\u003C/a>)\u003C/li>\n\u003C/ul>\n\u003Cp>Adding these packages will resolve all necessary dependencies.\r\nWe can start developing the application.\u003C/p>\n\u003Cp>The goal is to create a \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.ml.predictionengine-2?view=ml-dotnet&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>PredictionEngine&#x3C;TSrc, TDst>\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>\r\nbased on a \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.ml.data.transformerchain-1?view=ml-dotnet&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>TransformerChain\u003C/code>\u003Cspan>\u003C/span>\u003C/a>.\r\nBut as you can see by the generic notation of the prediction engine, two types need to be supplied as source and destination.\r\nSo, these will be created first.\u003C/p>\n\u003Ch2 id=\"adding-support-classes\">Adding support classes\u003C/h2>\n\u003Cp>For these two simple classes, we need to know the corresponding property names and data types from the \u003Cabbr title=\"Open Neural Network Exchange\">ONNX\u003C/abbr> model.\r\nFor this we can use a tool like \u003Ca href=\"https://github.com/lutzroeder/Netron\" rel=\"noopener noreferrer external\" target=\"_blank\">Netron\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cfigure class=\"wp-shadow is-resized\">\u003Ca href=\"/wp-content/uploads/2020/06/netron-model-input-output.png\" aria-label=\"View full-size image\">\u003Cpicture>\u003Csource srcset=\"/wp-content/uploads/2020/06/netron-model-input-output.webp\" type=\"image/webp\" media=\"(max-width: 763px)\">\u003Csource srcset=\"/wp-content/uploads/2020/06/netron-model-input-output-150x150.webp\" type=\"image/webp\" media=\"(max-width: 150px)\">\u003Csource srcset=\"/wp-content/uploads/2020/06/netron-model-input-output-185x185.webp\" type=\"image/webp\" media=\"(max-width: 185px)\">\u003Csource srcset=\"/wp-content/uploads/2020/06/netron-model-input-output-636x430.webp\" type=\"image/webp\" media=\"(max-width: 636px)\">\u003Cimg src=\"/wp-content/uploads/2020/06/netron-model-input-output-636x430.png\" alt=\"Screenshot of Netron showing the input and output properties.\" loading=\"lazy\" decoding=\"async\" width=\"636\" height=\"430\" srcset=\"/wp-content/uploads/2020/06/netron-model-input-output.png 763w, /wp-content/uploads/2020/06/netron-model-input-output-150x150.png 150w, /wp-content/uploads/2020/06/netron-model-input-output-185x185.png 185w, /wp-content/uploads/2020/06/netron-model-input-output-636x430.png 636w\" sizes=\"(max-width: 636px) 100vw, 636px\" data-image-component=\"true\">\u003C/picture>\u003C/a>\u003Cfigcaption>Netron showing the input and output properties\u003C/figcaption>\u003C/figure>\n\u003Cp>The first class we add will be the input for the transformation pipeline.\r\nAs the pipeline will not be able to infer the datatype from the .NET \u003Ccode>Bitmap\u003C/code> type,\r\nwe annotate the property with the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.ml.transforms.image.imagetypeattribute?view=ml-dotnet&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ImageTypeAttribute\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>.\r\nAs we can see in Netron, the model expects an input array with the size of \u003Ccode>3×224×224\u003C/code>.\r\nThis reflects three \u003Cdfn>\u003Cabbr title=\"Red, Green, and Blue\">RGB\u003C/abbr>\u003C/dfn> bytes per pixel, for an image with a height of 224 pixels and a width of 224 pixels.\r\nSo, we set both the \u003Ccode>height\u003C/code> and \u003Ccode>width\u003C/code> parameters of the attribute to a value of \u003Ccode>224\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">ImageInputData.cs\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:37ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">class\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ImageInputData\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ImageType\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">224\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">224\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">Bitmap\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Image\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#569CD6\">get\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; \u003C/span>\u003Cspan style=\"--0:#569CD6\">set\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">; }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"public class ImageInputData{    [ImageType(224, 224)]    public Bitmap Image { get; set; }}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>The second class we add will reflect the output of the prediction engine. Looking at the information in Netron,\r\nthis will be an array of a single string, with the name \u003Ccode>classLabel\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">ImagePrediction.cs\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:30ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">class\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ImagePrediction\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">{\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ColumnName\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"classLabel\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">)]\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#569CD6\">public\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">string\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[] \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Labels\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">;\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"public class ImagePrediction{    [ColumnName(&#x22;classLabel&#x22;)]    public string[] Labels;}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"building-the-prediction-engine\">Building the prediction engine\u003C/h2>\n\u003Cp>All following code will be added to the \u003Ccode>Main\u003C/code> method of \u003Cem>Program.cs\u003C/em>.\u003C/p>\n\u003Cp>On the first line, we create an instance of the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.ml.mlcontext?view=ml-dotnet&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>MLContext\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>.\r\nThe MLContext class is the starting point for all ML.NET operations.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:32ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">mlContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">MLContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">();\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var mlContext = new MLContext();\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Next, we define the pipeline. The pipeline will consist of three transformation steps.\u003C/p>\n\u003Cul>\n\u003Cli>The \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.ml.imageestimatorscatalog.resizeimages?view=ml-dotnet&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ResizeImages\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>\r\nresizes the image to the specified size. In this case, \u003Ccode>224×224\u003C/code>.\u003C/li>\n\u003Cli>The \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.ml.imageestimatorscatalog.extractpixels?view=ml-dotnet&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ExtractPixels\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>\r\nextracts pixel values from the \u003Ccode>Bitmap\u003C/code> into a numerical vector.\u003C/li>\n\u003Cli>The \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.ml.onnxcatalog.applyonnxmodel?view=ml-dotnet&#x26;wt.mc_id=AZ-MVP-5004268#Microsoft_ML_OnnxCatalog_ApplyOnnxModel_Microsoft_ML_TransformsCatalog_System_String_System_String_System_String_System_Nullable_System_Int32__System_Boolean_\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>ApplyOnnxModel\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>\r\napplies the pre-trained \u003Cabbr title=\"Open Neural Network Exchange\">ONNX\u003C/abbr> model to score on the data that is provided.\u003C/li>\n\u003C/ul>\n\u003Cp>For the first two steps, the first parameter is the name of the output column,\r\nand the last parameter is the name of the input column.\u003C/p>\n\u003Cp>The third method has the file location of the \u003Cabbr title=\"Open Neural Network Exchange\">ONNX\u003C/abbr> model as last parameter.\r\nWe also need to make sure the input and output columns match the names of the \u003Cabbr title=\"Open Neural Network Exchange\">ONNX\u003C/abbr> model.\r\nLooking at Netron again, the column names are \u003Ccode>classLabel\u003C/code> and \u003Ccode>data\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:86ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">pipeline\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">mlContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Transforms\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ResizeImages\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"image\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">224\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#B5CEA8\">224\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#569CD6\">nameof\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">ImageInputData\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Image\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">))\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Append\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">mlContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Transforms\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ExtractPixels\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"data\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"image\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">))\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">\u003Cspan style=\"--0:#CCCCCC\">    \u003C/span>\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Append\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">mlContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Transforms\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">ApplyOnnxModel\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"classLabel\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"data\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">modelLocation\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">));\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var pipeline = mlContext.Transforms    .ResizeImages(&#x22;image&#x22;, 224, 224, nameof(ImageInputData.Image))    .Append(mlContext.Transforms.ExtractPixels(&#x22;data&#x22;, &#x22;image&#x22;))    .Append(mlContext.Transforms.ApplyOnnxModel(&#x22;classLabel&#x22;, &#x22;data&#x22;, modelLocation));\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>The pipeline needs to know the data schema to operate on when the\r\n\u003Ca href=\"https://learn.microsoft.com/en-us/dotnet/api/microsoft.ml.iestimator-1.fit?view=ml-dotnet&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Fit\u003C/code> method\u003Cspan>\u003C/span>\u003C/a> is called.\r\nBecause we are not training the model, we can just supply an empty list of the input type.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:73ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">data\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">mlContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Data\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">LoadFromEnumerable\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">List\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ImageInputData\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">>());\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">model\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">pipeline\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Fit\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">data\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var data = mlContext.Data.LoadFromEnumerable(new List\u003CImageInputData>());var model = pipeline.Fit(data);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>With this, everything is set up to create the prediction engine.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:83ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">predictionEngine\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">mlContext\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Model\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">CreatePredictionEngine\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">&#x3C;\u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ImageInputData\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">, \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ImagePrediction\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">>(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">model\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var predictionEngine =    mlContext.Model.CreatePredictionEngine\u003CImageInputData, ImagePrediction>(model);\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"and-finally-classifying-a-bitmap\">And finally: classifying a bitmap\u003C/h2>\n\u003Cp>First, we create an input object with the bitmap.\r\nYou can load a bitmap from a file, a stream, a video feed, etc.\r\nThis depends on the design of your application.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:50ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">bitmap\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> … \u003C/span>\u003Cspan style=\"--0:#76A162\">// your source of a bitmap\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">input\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#569CD6\">new\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#4EC9B0\">ImageInputData\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Image\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">bitmap\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> };\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var bitmap = … // your source of a bitmapvar input = new ImageInputData { Image = bitmap };\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Now we can call the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/microsoft.ml.predictionengine-2.predict?view=ml-dotnet&#x26;wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Predict\u003C/code> method\u003Cspan>\u003C/span>\u003C/a>\r\non the prediction engine. This will return the classification.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame\">\u003Cfigcaption class=\"header\">\u003C/figcaption>\u003Cpre data-language=\"csharp\" class=\"wrap\" style=\"--ecMaxLine:49ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">prediction\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">predictionEngine\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Predict\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">(\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">input\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">);\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#569CD6\">var\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">classification\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">prediction\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">.\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">Labels\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#B5CEA8\">0\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">];\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"var prediction = predictionEngine.Predict(input);var classification = prediction.Labels[0];\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>This should be all.\u003C/p>\n\u003Cp>I shared the sample code on \u003Ca href=\"https://github.com/eNeRGy164/BitmapOnnxPrediction\" rel=\"noopener noreferrer external\" target=\"_blank\">GitHub\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>",{"headings":2228,"imagePaths":2244,"frontmatter":2212},[2229,2232,2235,2238,2241],{"depth":780,"slug":2230,"text":2231},"exporting-the-trained-model","Exporting the trained model",{"depth":780,"slug":2233,"text":2234},"setting-up-the-application","Setting up the application",{"depth":780,"slug":2236,"text":2237},"adding-support-classes","Adding support classes",{"depth":780,"slug":2239,"text":2240},"building-the-prediction-engine","Building the prediction engine",{"depth":780,"slug":2242,"text":2243},"and-finally-classifying-a-bitmap","And finally: classifying a bitmap",[],"2020-07-27-remove-docker-images-from-a-container-registry-using-powershell",{"id":2245,"data":2247,"body":2257,"filePath":2258,"digest":2259,"rendered":2260},{"id":2248,"title":2249,"date":2250,"updated":2251,"author":15,"excerpt":2252,"layout":17,"permalink":2253,"image":2254,"categories":2255,"tags":2256,"draft":26},1508,"Remove docker images from a Container Registry using PowerShell",["Date","2020-07-27T12:48:02.000Z"],["Date","2024-12-03T19:05:00.000Z"],"When using a Docker Registry, like hub.docker.com, you will not often want to delete a published version of an image. You cannot know if someone, somewhere in the world is using that specific version.\nBut when using a repository as part of your CI/CD pipeline, you might have lots of versions that are not used by anyone anymore. So, what if you want to clean the repository automatically?\nIn this article, I will show how the delete images by tag, using PowerShell and the Docker Registry HTTP API V2.\n","/2020/07/27/remove-docker-images-from-a-container-registry-using-powershell/","/wp-content/uploads/2020/07/post-1508-thumbnail.png",[906,1196],[906,2162,1196],"When using a Docker Registry, like [hub.docker.com](https://hub.docker.com/),\r\nyou will not often want to delete a published version of an image.\r\nYou cannot know if someone, somewhere in the world is using that specific version.\r\n\r\nBut when using a repository as part of your CI/CD pipeline,\r\nyou might have lots of versions that are not used by anyone anymore.\r\nSo, what if you want to clean the repository automatically?\r\n\r\nIn this article, I will show how the delete images by tag,\r\nusing PowerShell and [the CNCF Distribution HTTP API V2](https://distribution.github.io/distribution/spec/api/).\r\nThis API is implemented by registries, like the [Azure Container Registry](https://azure.microsoft.com/products/container-registry/) service.\r\n\r\n\u003C!--more-->\r\n\r\n---\r\n\r\nIn the examples, we will have two variables, `Credentials` and `Name`.\r\n\r\n- `$Credentials` is the username and password to authenticate to the repository.\r\n- `$Name` is the name of the image, like `ubuntu` or `energy164/gw2pvo`, without the tag part.\r\n\r\n## Get all image tags\r\n\r\nFirst, retrieving all the existing tags for the image.\r\n\r\nAs the [`tags/list` response](https://distribution.github.io/distribution/spec/api/#listing-image-tags) can consist of multiple pages,\r\nusing the `FollowRelLink` switch of the [`Invoke-RestMethod` cmdlet](https://learn.microsoft.com/powershell/module/microsoft.powershell.utility/invoke-restmethod) will automatically stack the results of all pages together for us.\r\n\r\n```powershell title=\"PowerShell\"\r\n$tags = Invoke-RestMethod `\r\n            -Authentication Basic `\r\n            -Credential $DockerCredential `\r\n            -Uri \"https://lorem.azurecr.io/v2/$Name/tags/list\" `\r\n            -FollowRelLink `\r\n        | Select-Object -ExpandProperty tags\r\n```\r\n\r\n## Filter tags\r\n\r\nWith the list of tags, we can select which tags we want to remove.\r\nIf you use some form of versioning in your tags, like [SemVer](https://semver.org/), you can easily filter them using the [`Version` class](https://learn.microsoft.com/dotnet/api/system.version).\r\n\r\nThis ensures `2.0` is smaller than `10.0`, which is better than performing a textual comparison, as that would reason otherwise.\r\n\r\n```powershell title=\"PowerShell\"\r\n$tags | ? { [Version]$_ -lt [Version]'2.0.0' } | % {\r\n    $tag = $_\r\n\r\n    # More code here later\r\n}\r\n```\r\n\r\nSadly, we cannot just remove the tagged version directly.\r\nWe can only [delete an image](https://distribution.github.io/distribution/spec/api/#deleting-an-image) using the `digest` as the reference.\r\n\r\n## Retrieve the digest\r\n\r\nTo get the digest, we can request details of the specific tag.\r\nThe digest will be part of the response headers under the key `Docker-Content-Digest`.\r\nTo get access to the response headers we will not use the `Invoke-RestMethod` here, but the [`Invoke-WebRequest` cmdlet](https://learn.microsoft.com/powershell/module/microsoft.powershell.utility/invoke-webrequest) instead.\r\nAnd as we only need the headers, we can reduce network traffic by specifying the HTTP `HEAD` method.\r\n\r\nThere is also a caveat.\r\nThe `Docker-Content-Digest` header only holds the correct value if we specify an `Accept` header with the value `application/vnd.docker.distribution.manifest.v2+json`.\r\n\r\n```powershell title=\"PowerShell\"\r\n$response = Invoke-WebRequest `\r\n                -Method Head `\r\n                -Authentication Basic `\r\n                -Credential $DockerCredential `\r\n                -Uri \"https://lorem.azurecr.io/v2/$Name/manifests/$tag\" `\r\n                -Headers @{ 'Accept' = 'application/vnd.docker.distribution.manifest.v2+json' }\r\n\r\n$digest = $response.Headers['Docker-Content-Digest']\r\n```\r\n\r\n## Delete the image\r\n\r\nAnd finally, we can use the HTTP `DELETE` method on our image with the digest connected to the tag we wanted to remove.\r\n\r\n```powershell title=\"PowerShell\"\r\nInvoke-WebRequest `\r\n    -Method Delete `\r\n    -Authentication Basic `\r\n    -Credential $DockerCredential `\r\n    -Uri \"https://lorem.azurecr.io/v2/$Name/manifests/$digest\" `\r\n    | Select-Object -ExpandProperty StatusDescription\r\n```","src/posts/2020-07-27-remove-docker-images-from-a-container-registry-using-powershell.md","0d062d1e9bb40ffe",{"html":2261,"metadata":2262},"\u003Cp>When using a Docker Registry, like \u003Ca href=\"https://hub.docker.com/\" rel=\"noopener noreferrer external\" target=\"_blank\">hub.docker.com\u003Cspan>\u003C/span>\u003C/a>,\r\nyou will not often want to delete a published version of an image.\r\nYou cannot know if someone, somewhere in the world is using that specific version.\u003C/p>\n\u003Cp>But when using a repository as part of your \u003Cdfn>\u003Cabbr title=\"Continuous Integration\">CI\u003C/abbr>\u003C/dfn>/\u003Cdfn>\u003Cabbr title=\"Continuous Deployment\">CD\u003C/abbr>\u003C/dfn> pipeline,\r\nyou might have lots of versions that are not used by anyone anymore.\r\nSo, what if you want to clean the repository automatically?\u003C/p>\n\u003Cp>In this article, I will show how the delete images by tag,\r\nusing PowerShell and \u003Ca href=\"https://distribution.github.io/distribution/spec/api/\" rel=\"noopener noreferrer external\" target=\"_blank\">the CNCF Distribution \u003Cdfn>\u003Cabbr title=\"HyperText Transfer Protocol\">HTTP\u003C/abbr>\u003C/dfn> \u003Cdfn>\u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr>\u003C/dfn> V2\u003Cspan>\u003C/span>\u003C/a>.\r\nThis \u003Cabbr title=\"Application Programming Interface\">API\u003C/abbr> is implemented by registries, like the \u003Ca href=\"https://azure.microsoft.com/products/container-registry/?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Azure Container Registry\u003Cspan>\u003C/span>\u003C/a> service.\u003C/p>\n\u003C!--more-->\n\u003Chr>\n\u003Cp>In the examples, we will have two variables, \u003Ccode>Credentials\u003C/code> and \u003Ccode>Name\u003C/code>.\u003C/p>\n\u003Cul>\n\u003Cli>\u003Ccode>$Credentials\u003C/code> is the username and password to authenticate to the repository.\u003C/li>\n\u003Cli>\u003Ccode>$Name\u003C/code> is the name of the image, like \u003Ccode>ubuntu\u003C/code> or \u003Ccode>energy164/gw2pvo\u003C/code>, without the tag part.\u003C/li>\n\u003C/ul>\n\u003Ch2 id=\"get-all-image-tags\">Get all image tags\u003C/h2>\n\u003Cp>First, retrieving all the existing tags for the image.\u003C/p>\n\u003Cp>As the \u003Ca href=\"https://distribution.github.io/distribution/spec/api/#listing-image-tags\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>tags/list\u003C/code> response\u003Cspan>\u003C/span>\u003C/a> can consist of multiple pages,\r\nusing the \u003Ccode>FollowRelLink\u003C/code> switch of the \u003Ca href=\"https://learn.microsoft.com/powershell/module/microsoft.powershell.utility/invoke-restmethod?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Invoke-RestMethod\u003C/code> cmdlet\u003Cspan>\u003C/span>\u003C/a> will automatically stack the results of all pages together for us.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Clink rel=\"stylesheet\" href=\"/_astro/ec.zhsuw.css\">\u003Cscript type=\"module\" src=\"/_astro/ec.8zarh.js\">\u003C/script>\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:64ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$tags\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Invoke-RestMethod\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Authentication Basic \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Credential \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$DockerCredential\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Uri \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"https://lorem.azurecr.io/v2/\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$Name\u003C/span>\u003Cspan style=\"--0:#CE9178\">/tags/list\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:12ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">            \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">FollowRelLink \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:8ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">        \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Select-Object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">ExpandProperty tags\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"$tags = Invoke-RestMethod &#x60;            -Authentication Basic &#x60;            -Credential $DockerCredential &#x60;            -Uri &#x22;https://lorem.azurecr.io/v2/$Name/tags/list&#x22; &#x60;            -FollowRelLink &#x60;        | Select-Object -ExpandProperty tags\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"filter-tags\">Filter tags\u003C/h2>\n\u003Cp>With the list of tags, we can select which tags we want to remove.\r\nIf you use some form of versioning in your tags, like \u003Ca href=\"https://semver.org/\" rel=\"noopener noreferrer external\" target=\"_blank\">SemVer\u003Cspan>\u003C/span>\u003C/a>, you can easily filter them using the \u003Ca href=\"https://learn.microsoft.com/dotnet/api/system.version?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Version\u003C/code> class\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>This ensures \u003Ccode>2.0\u003C/code> is smaller than \u003Ccode>10.0\u003C/code>, which is better than performing a textual comparison, as that would reason otherwise.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:52ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$tags\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#C586C0\">?\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> { [\u003C/span>\u003Cspan style=\"--0:#569CD6\">Version\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$_\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-lt\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> [\u003C/span>\u003Cspan style=\"--0:#569CD6\">Version\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003Cspan style=\"--0:#CE9178\">'2.0.0'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> } \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#C586C0\">%\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> {\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$tag\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$_\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#76A162\"># More code here later\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#CCCCCC\">}\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"$tags | ? { [Version]$_ -lt [Version]&#x27;2.0.0&#x27; } | % {    $tag = $_}\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Cp>Sadly, we cannot just remove the tagged version directly.\r\nWe can only \u003Ca href=\"https://distribution.github.io/distribution/spec/api/#deleting-an-image\" rel=\"noopener noreferrer external\" target=\"_blank\">delete an image\u003Cspan>\u003C/span>\u003C/a> using the \u003Ccode>digest\u003C/code> as the reference.\u003C/p>\n\u003Ch2 id=\"retrieve-the-digest\">Retrieve the digest\u003C/h2>\n\u003Cp>To get the digest, we can request details of the specific tag.\r\nThe digest will be part of the response headers under the key \u003Ccode>Docker-Content-Digest\u003C/code>.\r\nTo get access to the response headers we will not use the \u003Ccode>Invoke-RestMethod\u003C/code> here, but the \u003Ca href=\"https://learn.microsoft.com/powershell/module/microsoft.powershell.utility/invoke-webrequest?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">\u003Ccode>Invoke-WebRequest\u003C/code> cmdlet\u003Cspan>\u003C/span>\u003C/a> instead.\r\nAnd as we only need the headers, we can reduce network traffic by specifying the \u003Cabbr title=\"HyperText Transfer Protocol\">HTTP\u003C/abbr> \u003Ccode>HEAD\u003C/code> method.\u003C/p>\n\u003Cp>There is also a caveat.\r\nThe \u003Ccode>Docker-Content-Digest\u003C/code> header only holds the correct value if we specify an \u003Ccode>Accept\u003C/code> header with the value \u003Ccode>application/vnd.docker.distribution.manifest.v2+json\u003C/code>.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:95ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$response\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Invoke-WebRequest\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Method Head \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Authentication Basic \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Credential \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$DockerCredential\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Uri \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"https://lorem.azurecr.io/v2/\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$Name\u003C/span>\u003Cspan style=\"--0:#CE9178\">/manifests/\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$tag\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:16ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">                \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Headers \u003C/span>\u003Cspan style=\"--0:#569CD6\">@\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">{ \u003C/span>\u003Cspan style=\"--0:#CE9178\">'Accept'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#CE9178\">'application/vnd.docker.distribution.manifest.v2+json'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> }\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\n\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#9CDCFE\">$digest\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">=\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$response\u003C/span>\u003Cspan style=\"--0:#DCDCAA\">.Headers\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">[\u003C/span>\u003Cspan style=\"--0:#CE9178\">'Docker-Content-Digest'\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">]\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"$response = Invoke-WebRequest &#x60;                -Method Head &#x60;                -Authentication Basic &#x60;                -Credential $DockerCredential &#x60;                -Uri &#x22;https://lorem.azurecr.io/v2/$Name/manifests/$tag&#x22; &#x60;                -Headers @{ &#x27;Accept&#x27; = &#x27;application/vnd.docker.distribution.manifest.v2+json&#x27; }$digest = $response.Headers[&#x27;Docker-Content-Digest&#x27;]\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>\n\u003Ch2 id=\"delete-the-image\">Delete the image\u003C/h2>\n\u003Cp>And finally, we can use the \u003Cabbr title=\"HyperText Transfer Protocol\">HTTP\u003C/abbr> \u003Ccode>DELETE\u003C/code> method on our image with the digest connected to the tag we wanted to remove.\u003C/p>\n\u003Cdiv class=\"expressive-code\">\u003Cfigure class=\"frame is-terminal has-title\">\u003Cfigcaption class=\"header\">\u003Cspan class=\"title\">PowerShell\u003C/span>\u003C/figcaption>\u003Cpre data-language=\"powershell\" class=\"wrap\" style=\"--ecMaxLine:64ch\">\u003Ccode>\u003Cdiv class=\"ec-line\">\u003Cdiv class=\"code\">\u003Cspan style=\"--0:#DCDCAA\">Invoke-WebRequest\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Method Delete \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Authentication Basic \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Credential \u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$DockerCredential\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">Uri \u003C/span>\u003Cspan style=\"--0:#CE9178\">\"https://lorem.azurecr.io/v2/\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$Name\u003C/span>\u003Cspan style=\"--0:#CE9178\">/manifests/\u003C/span>\u003Cspan style=\"--0:#9CDCFE\">$digest\u003C/span>\u003Cspan style=\"--0:#CE9178\">\"\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">`\u003C/span>\u003C/div>\u003C/div>\u003Cdiv class=\"ec-line\" style=\"--ecIndent:4ch\">\u003Cdiv class=\"code\">\u003Cspan class=\"indent\">    \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">|\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#DCDCAA\">Select-Object\u003C/span>\u003Cspan style=\"--0:#CCCCCC\"> \u003C/span>\u003Cspan style=\"--0:#D4D4D4\">-\u003C/span>\u003Cspan style=\"--0:#CCCCCC\">ExpandProperty StatusDescription\u003C/span>\u003C/div>\u003C/div>\u003C/code>\u003C/pre>\u003Cdiv class=\"copy\">\u003Cbutton title=\"Copy to clipboard\" data-copied=\"Copied!\" data-code=\"Invoke-WebRequest &#x60;    -Method Delete &#x60;    -Authentication Basic &#x60;    -Credential $DockerCredential &#x60;    -Uri &#x22;https://lorem.azurecr.io/v2/$Name/manifests/$digest&#x22; &#x60;    | Select-Object -ExpandProperty StatusDescription\">\u003Cdiv>\u003C/div>\u003C/button>\u003C/div>\u003C/figure>\u003C/div>",{"headings":2263,"imagePaths":2276,"frontmatter":2247},[2264,2267,2270,2273],{"depth":780,"slug":2265,"text":2266},"get-all-image-tags","Get all image tags",{"depth":780,"slug":2268,"text":2269},"filter-tags","Filter tags",{"depth":780,"slug":2271,"text":2272},"retrieve-the-digest","Retrieve the digest",{"depth":780,"slug":2274,"text":2275},"delete-the-image","Delete the image",[],"2017-10-12-techdays-2017-sharing-my-slides",{"id":2277,"data":2279,"body":2289,"filePath":2290,"digest":2291,"rendered":2292},{"id":2280,"title":2281,"date":2282,"updated":2283,"author":15,"excerpt":2284,"layout":17,"permalink":2285,"image":2286,"categories":2287,"tags":2288,"draft":26},1265,"TechDays 2017: sharing my slides",["Date","2017-10-12T14:09:28.000Z"],["Date","2020-12-07T16:43:39.000Z"],"Today I presented a session, in Dutch, titled 'Gebruik Azure Key Vault in je applicaties en zorg dat niemand achter je geheimen komt' during the TechDays 2017 event. The presentation is about using Azure Key Vault to improve security of your solutions.\nI’m sharing my slides and code, so you can start improving the security of your solutions and deployments using Azure Key Vault, the Azure Key Vault Configuration Provider and Azure Key Vault Storage Account Keys.\n","/2017/10/12/techdays-2017-sharing-my-slides/","/wp-content/uploads/2017/10/post-1265-thumbnail.png",[906],[906,1807,873,911,933],"Today I presented a session, in Dutch, titled\r\n\"\u003Cspan lang=\"nl\">Gebruik Azure Key Vault in je applicaties en zorg dat niemand achter je geheimen komt\u003C/span>\"\r\nduring the **TechDays 2017** event.\r\n\r\nThe session was about using Azure Key Vault to improve security of your solutions.\r\n\r\n\u003C!--more-->\r\n\r\nI would like to thank everyone attending this session. It was nice to see the room overflowing.\r\nToo bad the demo gods did not feel worshipped enough, and had to mess up my Azure Storage connection. 🫤\r\n\r\nI am sharing my slides and code,\r\nso you can start improving the security of your solutions and deployments using [Azure Key Vault](https://azure.microsoft.com/products/key-vault/),\r\nthe [Azure Key Vault Configuration Provider](https://learn.microsoft.com/aspnet/core/security/key-vault-configuration) and\r\n[Azure Key Vault Storage Account Keys](https://learn.microsoft.com/azure/key-vault/secrets/overview-storage-keys).\r\n\r\nThe code is available at [GitHub](https://github.com/eNeRGy164/TechDays2017NL).\r\n\r\n\u003Ciframe src=\"https://onedrive.live.com/embed?cid=2D38DB8234B02DA9&resid=2D38DB8234B02DA9%211423738&authkey=APUU1hJn3MqZEU4&em=2\" width=\"635\" height=\"381\" loading=\"lazy\" lang=\"nl\">\u003C/iframe>\r\n\r\nAnd the recording of the session is available on YouTube:\r\n\r\n\u003Chttps://www.youtube.com/embed/cgn3Cl1qbJk>\r\n\r\nAny questions about my session? Just contact me.","src/posts/2017-10-12-techdays-2017-sharing-my-slides.md","35e01a388004086e",{"html":2293,"metadata":2294},"\u003Cp>Today I presented a session, in Dutch, titled\r\n“\u003Cspan lang=\"nl\">Gebruik Azure Key Vault in je applicaties en zorg dat niemand achter je geheimen komt\u003C/span>”\r\nduring the \u003Cstrong>TechDays 2017\u003C/strong> event.\u003C/p>\n\u003Cp>The session was about using Azure Key Vault to improve security of your solutions.\u003C/p>\n\u003C!--more-->\n\u003Cp>I would like to thank everyone attending this session. It was nice to see the room overflowing.\r\nToo bad the demo gods did not feel worshipped enough, and had to mess up my Azure Storage connection. 🫤\u003C/p>\n\u003Cp>I am sharing my slides and code,\r\nso you can start improving the security of your solutions and deployments using \u003Ca href=\"https://azure.microsoft.com/products/key-vault/?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Azure Key Vault\u003Cspan>\u003C/span>\u003C/a>,\r\nthe \u003Ca href=\"https://learn.microsoft.com/aspnet/core/security/key-vault-configuration?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Azure Key Vault Configuration Provider\u003Cspan>\u003C/span>\u003C/a> and\r\n\u003Ca href=\"https://learn.microsoft.com/azure/key-vault/secrets/overview-storage-keys?wt.mc_id=AZ-MVP-5004268\" rel=\"noopener noreferrer external\" target=\"_blank\">Azure Key Vault Storage Account Keys\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>The code is available at \u003Ca href=\"https://github.com/eNeRGy164/TechDays2017NL\" rel=\"noopener noreferrer external\" target=\"_blank\">GitHub\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Ciframe src=\"https://onedrive.live.com/embed?cid=2D38DB8234B02DA9&#x26;resid=2D38DB8234B02DA9%211423738&#x26;authkey=APUU1hJn3MqZEU4&#x26;em=2\" width=\"635\" height=\"381\" loading=\"lazy\" lang=\"nl\">\u003C/iframe>\n\u003Cp>And the recording of the session is available on YouTube:\u003C/p>\n\u003Cfigure class=\"wp-shadow\" itemprop=\"video\" itemscope itemtype=\"http://schema.org/VideoObject\">\u003Ciframe allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" height=\"357.75\" loading=\"lazy\" referrerpolicy=\"no-referrer\" src=\"https://www.youtube-nocookie.com/embed/cgn3Cl1qbJk?\" title=\"TechDays 2017 - Michaël Hompus - Gebruik Azure Key Vault in je Applicaties\" width=\"636\" itemprop=\"url\">\u003C/iframe>\u003Cmeta content=\"TechDays 2017 - Michaël Hompus - Gebruik Azure Key Vault in je Applicaties\" itemprop=\"name\">\u003Cmeta content=\"https://i.ytimg.com/vi/cgn3Cl1qbJk/hqdefault.jpg\" itemprop=\"thumbnailUrl\">\u003C/figure>\n\u003Cp>Any questions about my session? Just contact me.\u003C/p>",{"headings":2295,"imagePaths":2296,"frontmatter":2279},[],[],"2018-09-03-wordcamp-nijmegen-2018-sharing-my-slides",{"id":2297,"data":2299,"body":2309,"filePath":2310,"digest":2311,"rendered":2312},{"id":2300,"title":2301,"date":2302,"updated":2303,"author":15,"excerpt":2304,"layout":17,"permalink":2305,"image":2306,"categories":2307,"tags":2308,"draft":26},1323,"WordCamp Nijmegen 2018: sharing my slides",["Date","2018-09-03T19:17:40.000Z"],["Date","2021-06-17T13:40:57.000Z"],"This weekend I was speaking at WordCamp Nijmegen about the possibilities of hosting a WordPress site using Microsoft Azure. I’m sharing my Dutch slides here, and soon I hope to add the recording for WordPress TV in this post as well.\n","/2018/09/03/wordcamp-nijmegen-2018-sharing-my-slides/","/wp-content/uploads/2018/09/post-1323-thumbnail.png",[906],[906,873,932,911,218],"This weekend I was speaking at [WordCamp Nijmegen](https://2018.nijmegen.wordcamp.org/)\r\nabout the possibilities of hosting a WordPress site using Microsoft Azure.\r\n\r\nEven though I expected to get some criticism for dropping the Microsoft name at such an event,\r\nI felt very welcome.\r\nI experienced the event as a large group of very warm people from all over the world that are coming together to help each other out.\r\nAnd like Microsoft nowadays, they set a high standard with their\r\n[code of conduct](https://2018.nijmegen.wordcamp.org/info/gedragscode/) ([in English](http://opensourcebridge.org/about/code-of-conduct/)).\r\n\r\n\u003C!--more-->\r\n\r\nI am sharing my Dutch slides here, and the recording for WordPress TV on YouTube.\r\n\r\n\u003Ciframe src=\"https://onedrive.live.com/embed?resid=2D38DB8234B02DA9%211430793&authkey=%21AIQjQP0yIgwW3zI&em=2&wdAr=1.7777777777777777\" width=\"635\" height=\"381\" loading=\"lazy\" lang=\"nl\">\u003C/iframe>\r\n\r\n\u003Chttps://www.youtube-nocookie.com/embed/2IqHp4Dtco8>","src/posts/2018-09-03-wordcamp-nijmegen-2018-sharing-my-slides.md","7acb7bdc0d61f746",{"html":2313,"metadata":2314},"\u003Cp>This weekend I was speaking at \u003Ca href=\"https://2018.nijmegen.wordcamp.org/\" rel=\"noopener noreferrer external\" target=\"_blank\">WordCamp Nijmegen\u003Cspan>\u003C/span>\u003C/a>\r\nabout the possibilities of hosting a WordPress site using Microsoft Azure.\u003C/p>\n\u003Cp>Even though I expected to get some criticism for dropping the Microsoft name at such an event,\r\nI felt very welcome.\r\nI experienced the event as a large group of very warm people from all over the world that are coming together to help each other out.\r\nAnd like Microsoft nowadays, they set a high standard with their\r\n\u003Ca href=\"https://2018.nijmegen.wordcamp.org/info/gedragscode/\" rel=\"noopener noreferrer external\" target=\"_blank\">code of conduct\u003Cspan>\u003C/span>\u003C/a> (\u003Ca href=\"http://opensourcebridge.org/about/code-of-conduct/\" rel=\"noopener noreferrer external\" target=\"_blank\">in English\u003Cspan>\u003C/span>\u003C/a>).\u003C/p>\n\u003C!--more-->\n\u003Cp>I am sharing my Dutch slides here, and the recording for WordPress TV on YouTube.\u003C/p>\n\u003Ciframe src=\"https://onedrive.live.com/embed?resid=2D38DB8234B02DA9%211430793&#x26;authkey=%21AIQjQP0yIgwW3zI&#x26;em=2&#x26;wdAr=1.7777777777777777\" width=\"635\" height=\"381\" loading=\"lazy\" lang=\"nl\">\u003C/iframe>\n\u003Cfigure class=\"wp-shadow\" itemprop=\"video\" itemscope itemtype=\"http://schema.org/VideoObject\">\u003Ciframe allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" height=\"357.75\" loading=\"lazy\" referrerpolicy=\"no-referrer\" src=\"https://www.youtube-nocookie.com/embed/2IqHp4Dtco8?\" title=\"Michaël Hompus: Je WordPress site hosten bij Microsoft? Are you serious?\" width=\"636\" itemprop=\"url\">\u003C/iframe>\u003Cmeta content=\"Michaël Hompus: Je WordPress site hosten bij Microsoft? Are you serious?\" itemprop=\"name\">\u003Cmeta content=\"https://i.ytimg.com/vi/2IqHp4Dtco8/hqdefault.jpg\" itemprop=\"thumbnailUrl\">\u003C/figure>",{"headings":2315,"imagePaths":2316,"frontmatter":2299},[],[],"2020-05-20-advanced-lockdown-lecture-oam-dapr",{"id":2317,"data":2319,"body":2333,"filePath":2334,"digest":2335,"rendered":2336},{"id":2320,"title":2321,"date":2322,"updated":2323,"author":15,"excerpt":2324,"layout":17,"permalink":2325,"image":2326,"categories":2327,"tags":2329,"draft":26},1391,"Advanced Lockdown Lecture: OAM & Dapr",["Date","2020-05-20T16:28:46.000Z"],["Date","2020-12-07T16:53:22.000Z"],"These times should not prevent us from sharing knowledge and keep learning about great new technologies. For this, Info Support organized the lockdown lectures.\nI was honored to take part in this series and have people learn about the Open Application Model (OAM) and the Distributed Application Runtime (Dapr).\nHere I share with you the recording and slides.\n","/2020/05/20/advanced-lockdown-lecture-oam-dapr/","/wp-content/uploads/2020/05/post-1391-thumbnail.png",[2328,906],"Architecture",[906,2330,2331,2332,873,932],"Dapr","Lecture","OAM","These times should not prevent us from sharing knowledge and keep learning about great innovative technologies.\r\nFor this, [Info Support](https://www.infosupport.com) organized the\r\n[lockdown lectures](https://www.youtube.com/playlist?list=PL9xhFTKAjJeHH5LqxGa2sGc0UH7zU8-I_).\r\n\r\nI was honored to take part in this series and have people learn about the\r\n[Open Application Model](https://oam.dev/) (OAM) and the [Distributed Application Runtime](https://dapr.io/) (Dapr).\r\n\r\n\u003C!--more-->\r\n\r\nHere I share with you the recording (in Dutch) and slides (in English).\r\n\r\n\u003Chttps://www.youtube-nocookie.com/embed/gmd2vMJTd9M?start=178>\r\n\r\n\u003Ciframe src=\"https://onedrive.live.com/embed?cid=2D38DB8234B02DA9&resid=2D38DB8234B02DA9%211433375&authkey=AOJOwsKkqxe-0hQ&em=2\" width=\"635\" height=\"381\" loading=\"lazy\" lang=\"en\">\u003C/iframe>","src/posts/2020-05-20-advanced-lockdown-lecture-oam-dapr.md","2d4df48bdc07f770",{"html":2337,"metadata":2338},"\u003Cp>These times should not prevent us from sharing knowledge and keep learning about great innovative technologies.\r\nFor this, \u003Ca href=\"https://www.infosupport.com\" rel=\"noopener noreferrer external\" target=\"_blank\">Info Support\u003Cspan>\u003C/span>\u003C/a> organized the\r\n\u003Ca href=\"https://www.youtube.com/playlist?list=PL9xhFTKAjJeHH5LqxGa2sGc0UH7zU8-I_\" rel=\"noopener noreferrer external\" target=\"_blank\">lockdown lectures\u003Cspan>\u003C/span>\u003C/a>.\u003C/p>\n\u003Cp>I was honored to take part in this series and have people learn about the\r\n\u003Ca href=\"https://oam.dev/\" rel=\"noopener noreferrer external\" target=\"_blank\">Open Application Model\u003Cspan>\u003C/span>\u003C/a> (OAM) and the \u003Ca href=\"https://dapr.io/\" rel=\"noopener noreferrer external\" target=\"_blank\">Distributed Application Runtime\u003Cspan>\u003C/span>\u003C/a> (\u003Cdfn>\u003Cabbr title=\"Distributed Application Runtime\">Dapr\u003C/abbr>\u003C/dfn>).\u003C/p>\n\u003C!--more-->\n\u003Cp>Here I share with you the recording (in Dutch) and slides (in English).\u003C/p>\n\u003Cfigure class=\"wp-shadow\" itemprop=\"video\" itemscope itemtype=\"http://schema.org/VideoObject\">\u003Ciframe allow=\"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share\" height=\"357.75\" loading=\"lazy\" referrerpolicy=\"no-referrer\" src=\"https://www.youtube-nocookie.com/embed/gmd2vMJTd9M?\" title=\"Advanced Lockdown Lecture:  Let&#x27;s make microservice development great again!\" width=\"636\" itemprop=\"url\">\u003C/iframe>\u003Cmeta content=\"Advanced Lockdown Lecture:  Let&#x27;s make microservice development great again!\" itemprop=\"name\">\u003Cmeta content=\"https://i.ytimg.com/vi/gmd2vMJTd9M/hqdefault.jpg\" itemprop=\"thumbnailUrl\">\u003C/figure>\n\u003Ciframe src=\"https://onedrive.live.com/embed?cid=2D38DB8234B02DA9&#x26;resid=2D38DB8234B02DA9%211433375&#x26;authkey=AOJOwsKkqxe-0hQ&#x26;em=2\" width=\"635\" height=\"381\" loading=\"lazy\" lang=\"en\">\u003C/iframe>",{"headings":2339,"imagePaths":2340,"frontmatter":2319},[],[]]