---
import BaseHead from '../components/BaseHead.astro'
import Header from '../components/Header.astro'
import Footer from '../components/Footer.astro'
import { SITE_TITLE, SITE_DESCRIPTION } from '../config.ts'
import { sortedPosts } from '@/js/util.js'

const { Posts, Year, Month } = Astro.props
const posts = sortedPosts(await Astro.glob('../posts/*.{md,mdx}'))

const monthName = new Date(Year, Month, 1).toLocaleDateString(undefined, { month: 'long' })

---

<!DOCTYPE html>
<html lang="en-us">
  <head>
    <BaseHead title={`${Year} ${monthName} | ${SITE_TITLE}`} description={SITE_DESCRIPTION} />
  </head>
  <body class="archive category" itemprop="mainEntity" itemscope itemtype="http://schema.org/WebPage" id="body">
    <meta itemprop="name" content=`${Year} ${monthName}` />
		<link itemprop="url" href="" />
		<div class="skip-content"><a href="#content">Skip to content</a></div>
		<div id="wrapper">
      <Header />
      <main id="content" itemprop="mainEntity" itemscope itemtype="http://schema.org/CollectionPage" itemref="publisher">
        <div class="post-box page-box" itemscope itemtype="http://schema.org/ItemList" itemprop="mainEntity">
          <meta itemprop="itemListOrder" content="http://schema.org/ItemListOrderDescending">
          <div class="meta clear">
            <h1 class="pagetitle" itemprop="name">Archive for {monthName}, {Year}</h1>
          </div>
          <div class="post-header">
            <div class="entries">
              <ul>
                {Posts.map(page => {
                  const date = new Date(page.frontmatter.date).toLocaleDateString(undefined, { year: 'numeric', month: 'short', day: '2-digit' });

                  return (
                  <li itemprop="itemListElement" itemscope itemtype="http://schema.org/BlogPosting" itemref="publisher">
                    <a itemprop="url" href={page.frontmatter.permalink} rel="bookmark" title={page.frontmatter.title}>
                      <span class="archdate">
                        <time class="published" datetime={page.frontmatter.date} itemprop="datePublished">{date}</time>
                      </span>
                      <span itemprop="name headline">{page.frontmatter.title}</span>
                    </a>
                  </li>
                );
              })}
              </ul>
            </div>
          </div>
        </div>
      </main>
      <Footer posts={[...posts]}/>
    </div>
  </body>
</html>
